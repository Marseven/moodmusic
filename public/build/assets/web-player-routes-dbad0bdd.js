var S=Object.defineProperty;var N=(e,t,s)=>t in e?S(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var k=(e,t,s)=>(N(e,typeof t!="symbol"?t+"":t,s),s);import{bb as QueryObserver,bc as infiniteQueryBehavior,bd as hasNextPage,be as hasPreviousPage,bf as parseQueryArgs,bg as useBaseQuery,r as reactExports,Y as apiClient,at as useParams,j as jsxRuntimeExports,A as AnimatePresence,o as m,c as clsx,ab as opacityAnimation,ar as ProgressCircle,bh as lazyLoader,bi as getFromLocalStorage,ai as cjs,bj as createStore,ak as immer,s as setInLocalStorage,bk as useStore,W as queryClient,bl as useIsDarkMode,I as IconButton,B as Button,T as Trans,au as useNavigate,D as DialogTrigger,bm as useAuth,al as useQuery,bn as getBootstrapData,U as useMutation,V as toast,m as message,X as showHttpErrorToast,aj as react,q as useDialogContext,a1 as Link,am as useLocation,t as Dialog,w as DialogBody,bo as useCopyClipboard,aW as slugifyString,u as useSettings,v as DialogHeader,J as DialogFooter,b as useIsMobileMediaQuery,G as TextField,b0 as SmallArtistImage,bp as getArtistLink,b1 as ArtistLink,Z as ConfirmationDialog,E as useTrans,bq as defaultImage,a2 as CheckIcon,b4 as UserProfileLink,br as getUserProfileLink,a as createSvgIcon,aS as Tooltip,bs as ContentGrid,L as Skeleton,b5 as FormattedRelativeTime,bt as $62d8ded9296f3872$export$cfa2225e87938781,bu as $e0b6e0b68ec7f50f$export$872b660ac5a1ff98,bv as useThemeSelector,aK as $df56164dff5785e2$export$4338b53315abf666,a3 as Chip,bw as Helmet,aZ as PageStatus,C as CustomMenu,aw as NavLink,H as SearchIcon,aX as ComboBoxForwardRef,af as Section,i as Item,bx as useListboxContext,P as ProgressBar,by as useCustomMenu,bz as CustomMenuItem,bA as Badge,bB as PersonIcon,aC as MenuTrigger,aD as Menu,bC as NavbarAuthMenu,_ as IllustratedMessage,K as KeyboardArrowDownIcon,aT as useMediaQuery,N as Navbar,O as Outlet,aH as memoize,bD as isAbsoluteUrl,bE as ArrowDropDownIcon,a4 as FormattedDate,bF as useLocalStorage,az as FullPageLoader,f as useSearchParams,bG as PageMetaTags,aq as FileUploadProvider,bH as ImageSelector,R as React,$ as $3ef42575df84b30b$export$9d1611c77c2fe928,ay as SiteConfigContext,l as $9bf71ea28793e738$export$20e40289641fbbb6,bI as getSmallArtistImage,bJ as PageErrorMessage,Q as StaticPageTitle,bK as PlayableMediaGridSkeleton,aA as onFormQueryError,x as useForm,y as Form,a6 as FormImageSelector,p as FormTextField,ba as NotFoundPage,ap as Navigate,b8 as useRoutes,b9 as AuthRoute}from"./main-0832b2fb.js";import{h as hasNextPage$1,q as channelQueryKey,r as channelEndpoint,P as PauseIcon,T as TRACK_MODEL,l as CreatePlaylistDialog,u as usePrevious,s as getGenreLink,t as getPlaylistLink,m as PlaylistLink,n as UpdatePlaylistDialog,v as useUpdatePlaylist,U as USER_MODEL,i as PLAYLIST_MODEL,N as NameWithAvatar,M as MoreVertIcon,w as NameWithAvatarPlaceholder,p as TrendingUpIcon,g as useVirtualizer,x as observeElementOffset,y as useSlider,S as Slider,G as GenreLink,C as CHANNEL_MODEL,k as useChannel,j as useSearchResults,d as downloadFileFromUrl,D as DashboardLayoutContext,a as DashboardLayout,b as DashboardSidenav,c as DashboardContent,I as ImageZoomDialog,f as artistPageTabs,z as ImageIcon,o as useDeleteComments,e as DeleteIcon}from"./TrendingUp-d556fb70.js";import{w as isCtrlOrShiftPressed,x as getTrackImageSrc,P as PlayArrowFilledIcon,a as KeyboardArrowRightIcon,b as AddIcon,c as Tabs,e as TabList,f as Tab,g as TabPanels,h as TabPanel,y as ShareMediaButtons,o as TrackImage,s as AlbumImage,z as getTrackLink,B as getAlbumLink,v as AlbumLink,E as ArtistLinks,H as useDeleteAlbum,p as TrackLink,k as defaultImage$1,G as GENRE_MODEL,j as ALBUM_MODEL,i as ARTIST_MODEL,n as TableContext,T as Table,q as FormattedDuration,I as TableRow,A as Avatar,t as themeValueToHex,W as WAVE_WIDTH,J as WAVE_HEIGHT,r as FormattedNumber,L as ShareIcon,K as KeyboardArrowLeftIcon,d as dotObject,M as usePrimaryArtistForCurrentUser,N as assignAlbumToTracks,O as useSortableTableData,Q as useArtist,R as albumLayoutKey,D as DragPreview,l as useIsTouchDevice,u as useSortable,U as UserAvatar,V as useAlbum,C as ChipList,X as useTrack,Y as ProfileLinksForm}from"./play-arrow-filled-4f6d7b8f.js";import{M as MoreHorizIcon}from"./MoreHoriz-07305c85.js";import{K as KeyboardBackspaceIcon,F as FavoriteIcon,a as FavoriteBorderIcon,S as StarIcon,b as ScheduleIcon,R as RepeatIcon,P as PlaylistAddIcon,c as ShuffleIcon,d as RepeatOneIcon,M as MicIcon,D as DownloadIcon,Q as QueueMusicIcon,e as KeyboardArrowUpIcon,V as VolumeOffIcon,f as VolumeDownIcon,g as VolumeUpIcon,h as FullscreenIcon,A as AlbumIcon,i as ViewAgendaIcon,G as GridViewIcon,j as AudiotrackIcon,B as BookmarkBorderIcon,C as CommentIcon,k as SortIcon,l as PlaylistPlayIcon,H as HistoryIcon}from"./History-75297ddc.js";import{O as Options,t as tokenize}from"./linkify.es-861b0b2d.js";import{E as EditIcon}from"./Edit-eb13cf61.js";class InfiniteQueryObserver extends QueryObserver{constructor(t,s){super(t,s)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(t,s){super.setOptions({...t,behavior:infiniteQueryBehavior()},s)}getOptimisticResult(t){return t.behavior=infiniteQueryBehavior(),super.getOptimisticResult(t)}fetchNextPage({pageParam:t,...s}={}){return this.fetch({...s,meta:{fetchMore:{direction:"forward",pageParam:t}}})}fetchPreviousPage({pageParam:t,...s}={}){return this.fetch({...s,meta:{fetchMore:{direction:"backward",pageParam:t}}})}createResult(t,s){var n,i,a,o,l,u;const{state:x}=t,c=super.createResult(t,s),{isFetching:j,isRefetching:d}=c,E=j&&((n=x.fetchMeta)==null||(i=n.fetchMore)==null?void 0:i.direction)==="forward",y=j&&((a=x.fetchMeta)==null||(o=a.fetchMore)==null?void 0:o.direction)==="backward";return{...c,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:hasNextPage(s,(l=x.data)==null?void 0:l.pages),hasPreviousPage:hasPreviousPage(s,(u=x.data)==null?void 0:u.pages),isFetchingNextPage:E,isFetchingPreviousPage:y,isRefetching:d&&!E&&!y}}}function useInfiniteQuery(e,t,s){const n=parseQueryArgs(e,t,s);return useBaseQuery(n,InfiniteQueryObserver)}function buildQueryKey({queryKey:e,defaultOrderDir:t,defaultOrderBy:s,queryParams:n},i,a=""){return i.orderBy||(i.orderBy=s),i.orderDir||(i.orderDir=t),[...e,i,a,n]}function useInfiniteData(e){var f,R;const{initialPage:t,endpoint:s,defaultOrderBy:n,defaultOrderDir:i,queryParams:a,paginate:o,transformResponse:l,willSortOrFilter:u=!1}=e,[x,c]=reactExports.useState(""),[j,d]=reactExports.useState({orderBy:n,orderDir:i}),E=useInfiniteQuery({keepPreviousData:u,queryKey:buildQueryKey(e,j,x),queryFn:({pageParam:h})=>{const g={...a,perPage:t==null?void 0:t.per_page,query:x,paginate:o,...j};return o==="cursor"?g.cursor=h:g.page=h||1,fetchData(s,g,l)},getNextPageParam:h=>{if(hasNextPage$1(h.pagination))return"next_cursor"in h.pagination?h.pagination.next_cursor:h.pagination.current_page+1},initialData:()=>{if(!(!t||j.orderBy!==n||j.orderDir!==i||x))return{pageParams:[void 0,1],pages:[{pagination:t}]}}}),y=reactExports.useMemo(()=>{var h;return((h=E.data)==null?void 0:h.pages.flatMap(g=>g.pagination.data))||[]},[(f=E.data)==null?void 0:f.pages]),v=(R=E.data)==null?void 0:R.pages[0].pagination,p=v&&"total"in v&&v.total?v.total:null;return{...E,items:y,totalItems:p,sortDescriptor:j,setSortDescriptor:d,searchQuery:x,setSearchQuery:c}}function fetchData(e,t,s){return apiClient.get(e,{params:t}).then(n=>s?s(n.data):n.data)}function usePaginatedChannelContent(e){const{filter:t}=useParams(),[s="popularity",n="desc"]=(e.config.contentOrder||"").split(":");return useInfiniteData({initialPage:e.content,queryKey:channelQueryKey(e.id,{filter:t||""}),endpoint:channelEndpoint(e.id),defaultOrderBy:s,defaultOrderDir:n,paginate:"simple",queryParams:{returnContentOnly:"true",filter:t||""}})}function InfiniteScrollSentinel({query:{isInitialLoading:e,fetchNextPage:t,isFetchingNextPage:s,hasNextPage:n},children:i,marginTop:a="mt-24",renderSentinelAs:o="span"}){const l=reactExports.useRef(null);reactExports.useEffect(()=>{const c=l.current;if(!c)return;const j=new IntersectionObserver(([d])=>{d.isIntersecting&&n&&!s&&!e&&t()});return j.observe(c),()=>{j.unobserve(c)}},[t,n,s,e]);const u=i?s?i:null:jsxRuntimeExports.jsx(AnimatePresence,{children:s&&jsxRuntimeExports.jsx(m.div,{className:clsx("flex justify-center w-full",a),...opacityAnimation,children:jsxRuntimeExports.jsx(ProgressCircle,{isIndeterminate:!0,"aria-label":"loading"})})}),x=o;return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(x,{ref:l,"aria-hidden":!0}),u]})}var key={fullscreenEnabled:0,fullscreenElement:1,requestFullscreen:2,exitFullscreen:3,fullscreenchange:4,fullscreenerror:5,fullscreen:6},webkit=["webkitFullscreenEnabled","webkitFullscreenElement","webkitRequestFullscreen","webkitExitFullscreen","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],moz=["mozFullScreenEnabled","mozFullScreenElement","mozRequestFullScreen","mozCancelFullScreen","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],ms=["msFullscreenEnabled","msFullscreenElement","msRequestFullscreen","msExitFullscreen","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"],document$1=typeof window<"u"&&typeof window.document<"u"?window.document:{},vendor="fullscreenEnabled"in document$1&&Object.keys(key)||webkit[0]in document$1&&webkit||moz[0]in document$1&&moz||ms[0]in document$1&&ms||[],fscreen={requestFullscreen:function(e){return e[vendor[key.requestFullscreen]]()},requestFullscreenFunction:function(e){return e[vendor[key.requestFullscreen]]},get exitFullscreen(){return document$1[vendor[key.exitFullscreen]].bind(document$1)},get fullscreenPseudoClass(){return":"+vendor[key.fullscreen]},addEventListener:function(e,t,s){return document$1.addEventListener(vendor[key[e]],t,s)},removeEventListener:function(e,t,s){return document$1.removeEventListener(vendor[key[e]],t,s)},get fullscreenEnabled(){return!!document$1[vendor[key.fullscreenEnabled]]},set fullscreenEnabled(e){},get fullscreenElement(){return document$1[vendor[key.fullscreenElement]]},set fullscreenElement(e){},get onfullscreenchange(){return document$1[("on"+vendor[key.fullscreenchange]).toLowerCase()]},set onfullscreenchange(e){return document$1[("on"+vendor[key.fullscreenchange]).toLowerCase()]=e},get onfullscreenerror(){return document$1[("on"+vendor[key.fullscreenerror]).toLowerCase()]},set onfullscreenerror(e){return document$1[("on"+vendor[key.fullscreenerror]).toLowerCase()]=e}};const fscreen$1=fscreen;function elIsInFullscreen(e){if(fscreen$1.fullscreenElement===e)return!0;try{return e.classList.contains(fscreen$1.fullscreenPseudoClass)}catch{return!1}}class PlayerProvider{constructor(t,s,n){this.listeners=t,this.initialState=s,this.options=n}destroy(){fscreen$1.removeEventListener("fullscreenchange",this.fullscreenListener.bind(this)),fscreen$1.removeEventListener("fullscreenerror",this.fullscreenListener.bind(this))}fullscreenListener(){var n,i;const t=this.getFullscreenEl();if(t!=null&&elIsInFullscreen(t))try{screen.orientation.lock("landscape").catch(()=>{})}catch{}else screen.orientation.unlock();(i=(n=this.listeners).onFullscreenChange)==null||i.call(n,t!=null&&elIsInFullscreen(t))}enterFullscreen(){const t=this.getFullscreenEl();t&&(fscreen$1.addEventListener("fullscreenchange",this.fullscreenListener.bind(this)),fscreen$1.addEventListener("fullscreenerror",this.fullscreenListener.bind(this)),fscreen$1.requestFullscreen(t))}}function isSameMedia(e,t){return!e||!t?!1:e.id===t.id&&e.groupId===t.groupId}const YoutubePlayerVars={autoplay:0,rel:0,showinfo:0,disablekb:1,controls:0,modestbranding:1,iv_load_policy:3,playsinline:1};class YoutubeProvider extends PlayerProvider{constructor(){super(...arguments);k(this,"name","youtube");k(this,"youtube");k(this,"cuedMedia");k(this,"containerEl")}async play(s){var n;await this.cueMedia(s),(n=this.youtube)==null||n.playVideo()}pause(){var s;(s=this.youtube)==null||s.pauseVideo()}stop(){var s;(s=this.youtube)==null||s.stopVideo()}seek(s){var n;(n=this.youtube)==null||n.seekTo(s,!0)}getDuration(){var s;return((s=this.youtube)==null?void 0:s.getDuration())||0}getCurrentTime(){var s;return((s=this.youtube)==null?void 0:s.getCurrentTime())||0}setVolume(s){var n;(n=this.youtube)==null||n.setVolume(s)}setMuted(s){var n,i;s?(n=this.youtube)==null||n.mute():(i=this.youtube)==null||i.unMute()}async cueMedia(s){var i,a,o,l;if(isSameMedia(this.cuedMedia,s))return;this.cuedMedia=s;const[,n]=await Promise.all([loadYoutubePlayer(),s.src==="resolve"?(a=(i=this.options.youtube)==null?void 0:i.srcResolver)==null?void 0:a.call(i,s):Promise.resolve(s)]);if(!(n!=null&&n.src)||!youtubePlayerIsLoaded()){(l=(o=this.listeners).onError)==null||l.call(o);return}await this.cueYoutubeVideo(n)}destroy(){var s,n;try{super.destroy(),(s=this.youtube)==null||s.destroy()}catch{}(n=this.containerEl)==null||n.remove(),this.youtube=void 0,this.cuedMedia=void 0}async cueYoutubeVideo(s){var i,a;const n=await this.getYoutubeId();s.src!==n&&(this.youtube?(a=this.youtube)==null||a.loadVideoById({videoId:s.src,suggestedQuality:(i=this.options.youtube)==null?void 0:i.suggestedQuality}):(this.containerEl=document.createElement("div"),this.options.ref.current.appendChild(this.containerEl),await new Promise(o=>{this.youtube=new YT.Player(this.containerEl,{videoId:s.src,playerVars:YoutubePlayerVars,events:{onReady:()=>{this.initialState.muted&&this.setMuted(!0),this.setVolume(this.initialState.volume??30),o()},onError:this.listeners.onError,onStateChange:this.onYoutubeStateChange.bind(this)}})}))),this.cuedMedia=s}getYoutubeId(){var n,i;const s=(i=(n=this.youtube)==null?void 0:n.getVideoUrl)==null?void 0:i.call(n);return s?s.split("v=")[1]:void 0}onYoutubeStateChange(s){var n,i,a,o,l,u,x,c,j,d;switch((i=(n=this.options.youtube)==null?void 0:n.onStateChange)==null||i.call(n,s),s.data){case YT.PlayerState.ENDED:(o=(a=this.listeners).onPlaybackEnd)==null||o.call(a);break;case YT.PlayerState.PLAYING:(u=(l=this.listeners).onPlay)==null||u.call(l);break;case YT.PlayerState.BUFFERING:(c=(x=this.listeners).onBuffering)==null||c.call(x);break;case YT.PlayerState.PAUSED:(d=(j=this.listeners).onPause)==null||d.call(j);break}}getFullscreenEl(){var s;return(s=this.youtube)==null?void 0:s.getIframe()}}function loadYoutubePlayer(){return new Promise(e=>{if(youtubePlayerIsLoaded()){e(window.YT);return}else lazyLoader.loadAsset("https://www.youtube.com/iframe_api",{type:"js"});const t=window.onYouTubeIframeAPIReady;window.onYouTubeIframeAPIReady=()=>{t&&t(),e(window.YT)}})}function youtubePlayerIsLoaded(){return window.YT&&window.YT.Player&&window.YT.Player instanceof Function}function shuffleArray(e,t=!1){let s=t?e.shift():null,n=e.length,i,a;for(;n!==0;)a=Math.floor(Math.random()*n),n-=1,i=e[n],e[n]=e[a],e[a]=i;return s&&e.unshift(s),[...e]}function getPlayerStateFromLocalStorage(e,t){const s=(t==null?void 0:t.defaultVolume)||30;return{state:{muted:getFromLocalStorage(`player.${e}.muted`)??!1,repeat:getFromLocalStorage(`player.${e}.repeat`)??"all",shuffling:getFromLocalStorage(`player.${e}.shuffling`)??!1,volume:getFromLocalStorage(`player.${e}.volume`)??s},queue:getFromLocalStorage(`player.${e}.queue`,[]),cuedMediaId:getFromLocalStorage(`player.${e}.cuedMediaId`)}}class HtmlVideoProvider extends PlayerProvider{constructor(){super(...arguments);k(this,"name","htmlVideo");k(this,"element");k(this,"cuedMedia")}async play(s){var n,i,a;await this.cueMedia(s);try{await((n=this.element)==null?void 0:n.play())}catch(o){(a=(i=this.listeners).onError)==null||a.call(i,o)}}pause(){var s;(s=this.element)==null||s.pause()}stop(){this.pause(),this.seek(0)}seek(s){s===1/0||!this.element||(this.element.currentTime=s)}getDuration(){var s,n;return(s=this.element)!=null&&s.seekable&&this.element.seekable.length>0?(n=this.element)==null?void 0:n.seekable.end(0):0}getCurrentTime(){var s;return((s=this.element)==null?void 0:s.currentTime)||0}setVolume(s){this.element&&(this.element.volume=s/100)}setMuted(s){this.element&&(this.element.muted=s)}async cueMedia(s){var n,i;if(!isSameMedia(this.cuedMedia,s)){if(this.createElement(),!this.element){(i=(n=this.listeners).onError)==null||i.call(n);return}this.element.src=s.src,s.image&&(this.element.poster=s.image),this.cuedMedia=s}}getFullscreenEl(){return this.element}destroy(){super.destroy(),this.element&&this.element.remove(),this.element=void 0,this.cuedMedia=void 0}createElement(){var s;this.element||(this.element=document.createElement("video"),this.element.setAttribute("playsinline","true"),this.element.setAttribute("oncontextmenu","return false;"),this.element.setAttribute("controlsList","nodownload"),this.element.id="html5-player",(s=this.options.ref.current)==null||s.appendChild(this.element),this.setMuted(this.initialState.muted??!1),this.setVolume(this.initialState.volume??30),this.bindStateChangeEvents())}bindStateChangeEvents(){this.element&&(this.element.addEventListener("ended",()=>{var s,n;(n=(s=this.listeners).onPlaybackEnd)==null||n.call(s)}),this.element.addEventListener("waiting",s=>{var n,i;(i=(n=this.listeners).onBuffering)==null||i.call(n)}),this.element.addEventListener("playing",()=>{var s,n;(n=(s=this.listeners).onPlay)==null||n.call(s)}),this.element.addEventListener("pause",()=>{var s,n;(n=(s=this.listeners).onPause)==null||n.call(s)}),this.element.addEventListener("error",s=>{var n,i;(i=(n=this.listeners).onError)==null||i.call(n,s)}))}}function prependToArrayAtIndex(e,t,s=0){const n=[...e],i=n.splice(s+1);return[...n,...t,...i]}function resetMediaSession(){"mediaSession"in navigator&&(["play","pause","previoustrack","nexttrack","stop","seekbackward","seekforward","seekto"].forEach(t=>navigator.mediaSession.setActionHandler(t,null)),navigator.mediaSession.metadata=null,navigator.mediaSession.playbackState="none")}function playerQueue(e){const t=()=>e().cuedMedia&&e().shuffledQueue.findIndex(u=>{var x;return u.id===((x=e().cuedMedia)==null?void 0:x.id)})||0;return{getPointer:t,getCurrent:()=>e().shuffledQueue[t()],getFirst:()=>e().shuffledQueue[0],getLast:()=>e().shuffledQueue[e().shuffledQueue.length-1],getNext:()=>e().shuffledQueue[t()+1],getPrevious:()=>e().shuffledQueue[t()-1],isLast:()=>t()===e().originalQueue.length-1}}function handlePlayerKeybinds(e,t){var s;["input","textarea"].includes((s=e.target)==null?void 0:s.tagName.toLowerCase())||(e.key===" "&&(e.preventDefault(),t().status==="playing"?t().pause():t().play()),e.key==="ArrowRight"&&isCtrlOrShiftPressed(e)&&(e.preventDefault(),t().playNext()),e.key==="ArrowLeft"&&isCtrlOrShiftPressed(e)&&(e.preventDefault(),t().playPrevious()))}function initPlayerMediaSession(e,t){var s;if("mediaSession"in navigator){const n={play:()=>e().play(),pause:()=>e().pause(),previoustrack:()=>e().playPrevious(),nexttrack:()=>e().playNext(),stop:()=>e().stop(),seekbackward:()=>e().seek(e().getCurrentTime()-10),seekforward:()=>e().seek(e().getCurrentTime()+10),seekto:a=>e().seek(a.seekTime||0)};for(const a in n)try{navigator.mediaSession.setActionHandler(a,n[a])}catch{}const i=e().cuedMedia;i&&((s=t.setMediaSessionMetadata)==null||s.call(t,i))}}const createPlayerStore=(e,t)=>{const s=new Set;t.listeners&&s.add(t.listeners);const n=cjs(getPlayerStateFromLocalStorage(e,t),t.initialData||{}),i=(a,o)=>{setInLocalStorage(`player.${e}.${a}`,o)};return createStore()(immer((a,o)=>{var j,d,E,y,v;const l=playerQueue(o),u=p=>{handlePlayerKeybinds(p,o)},x=p=>{const f={onPlay:()=>{var g;a(b=>{b.status="playing"}),s.forEach(b=>{var T;return(T=b.onPlay)==null?void 0:T.call(b,o().cuedMedia)});const h=(g=o().provider)==null?void 0:g.getDuration();h&&a(b=>{b.mediaDuration=h})},onPause:()=>{a(h=>{h.status="paused"}),s.forEach(h=>{var g;return(g=h.onPause)==null?void 0:g.call(h)})},onError:h=>{a(g=>{g.status="paused"}),s.forEach(g=>{var b;return(b=g.onError)==null?void 0:b.call(g,h,o())})},onBuffering:()=>{a(h=>{h.status="buffering"}),s.forEach(h=>{var g;return(g=h.onBuffering)==null?void 0:g.call(h)})},onSeek:h=>{s.forEach(g=>{var b;return(b=g.onSeek)==null?void 0:b.call(g,h)})},onPlaybackEnd:async()=>{const h=o().cuedMedia;if(s.forEach(g=>{var b;return(b=g.onPlaybackEnd)==null?void 0:b.call(g,h)}),l.isLast()&&t.loadMoreMediaItems){const g=await t.loadMoreMediaItems(h);g!=null&&g.length&&o().appendToQueue(g)}o().playNext()},onCued:()=>{s.forEach(h=>{var g;return(g=h.onCued)==null?void 0:g.call(h,o().cuedMedia)})},onFullscreenChange:h=>{s.forEach(g=>{var b;return(b=g.onFullscreenChange)==null?void 0:b.call(g,h)}),a(g=>{g.isFullscreen=h})}},R={...n.state,volume:o().volume,muted:o().muted,shuffling:o().shuffling,repeat:o().repeat};switch(p){case"youtube":return new YoutubeProvider(f,R,t);case"htmlVideo":return new HtmlVideoProvider(f,R,t)}},c=n.queue||[];return{originalQueue:c,shuffledQueue:(j=n.state)!=null&&j.shuffling?shuffleArray(c):c,status:"uninitialized",volume:((d=n.state)==null?void 0:d.volume)??30,setVolume:p=>{var f;(f=o().provider)==null||f.setVolume(p),a(R=>{R.volume=p}),i("volume",p)},muted:((E=n.state)==null?void 0:E.muted)??!1,setMuted:p=>{var f;(f=o().provider)==null||f.setMuted(p),a(R=>{R.muted=p}),i("muted",p)},repeat:((y=n.state)==null?void 0:y.repeat)??"all",toggleRepeatMode:()=>{let p="all";const f=o().repeat;f==="all"?p="one":f==="one"&&(p=!1),a(R=>{R.repeat=p}),i("repeat",p)},shuffling:((v=n.state)==null?void 0:v.shuffling)??!1,toggleShuffling:()=>{let p=[];o().shuffling?p=o().originalQueue:p=shuffleArray([...o().shuffledQueue]),a(f=>{f.shuffling=!f.shuffling,f.shuffledQueue=p})},mediaDuration:0,provider:null,seek:p=>{var f;(f=o().provider)==null||f.seek(p),s.forEach(R=>{var h;return(h=R.onSeek)==null?void 0:h.call(R,p)})},subscribe:p=>(s.add(p),()=>s.delete(p)),getCurrentTime:()=>{var p;return((p=o().provider)==null?void 0:p.getCurrentTime())||0},play:async p=>{var R,h;if(p?await o().cue(p):p=o().cuedMedia||l.getCurrent(),!p){o().stop();return}const f=(R=t.onBeforePlay)==null?void 0:R.call(t,p);f!=null&&f.preventPlayback||await((h=o().provider)==null?void 0:h.play(p))},pause:()=>{var p;(p=o().provider)==null||p.pause()},stop:()=>{o().status==="playing"&&(o().pause(),o().seek(0),a(p=>{p.status="paused"}))},playNext:async()=>{o().stop();let p=l.getCurrent();o().repeat==="all"&&l.isLast()?p=l.getFirst():o().repeat!=="one"&&(p=l.getNext()),p?await o().play(p):(o().seek(0),o().play())},playPrevious:async()=>{o().stop();let p=l.getCurrent();o().repeat==="all"&&l.getPointer()===0?p=l.getLast():o().repeat!=="one"&&(p=l.getPrevious()),p?await o().play(p):(o().seek(0),o().play())},cue:async p=>{var f,R,h;if(!isSameMedia(p,o().cuedMedia)){if(((f=o().provider)==null?void 0:f.name)!==p.provider){(R=o().provider)==null||R.destroy();const g=x(p.provider);g&&a(b=>({...b,provider:g}))}a(g=>{g.cuedMedia=p}),await o().provider.cueMedia(p),a(g=>{var b,T;g.mediaDuration=((b=o().provider)==null?void 0:b.getDuration())||((T=o().cuedMedia)==null?void 0:T.duration)||0,g.status="paused"}),p&&((h=t.setMediaSessionMetadata)==null||h.call(t,p)),s.forEach(g=>{var b;return(b=g.onCued)==null?void 0:b.call(g,p)}),s.forEach(g=>{var b;return(b=g.onPause)==null?void 0:b.call(g)}),i("cuedMediaId",p.id)}},async overrideQueue(p,f=0){if(!(p!=null&&p.length))return;const R=[...p];a(g=>{g.shuffledQueue=o().shuffling?shuffleArray(R,!0):R,g.originalQueue=R}),i("queue",o().originalQueue.slice(0,15));const h=f>-1?p[f]:l.getCurrent();if(h)return o().cue(h)},appendToQueue:(p,f=!0)=>{const R=o().shuffling?shuffleArray([...p]):[...p],h=f?l.getPointer():0;a(g=>{g.shuffledQueue=prependToArrayAtIndex(g.shuffledQueue,R,h),g.originalQueue=prependToArrayAtIndex(g.originalQueue,p,h)}),i("queue",o().originalQueue.slice(0,15))},removeFromQueue:p=>{a(f=>{f.shuffledQueue=f.shuffledQueue.filter(R=>!p.find(h=>isSameMedia(h,R))),f.originalQueue=f.originalQueue.filter(R=>!p.find(h=>isSameMedia(h,R)))}),i("queue",o().originalQueue.slice(0,15))},isFullscreen:!1,enterFullscreen:()=>{var p;(p=o().provider)==null||p.enterFullscreen()},exitFullscreen:()=>{fscreen$1.exitFullscreen()},destroy:()=>{var p,f;(p=o().provider)==null||p.destroy(),(f=t==null?void 0:t.onDestroy)==null||f.call(t),resetMediaSession(),s.clear(),document.removeEventListener("keydown",u)},init:async()=>{var f;const p=(f=n.queue)==null?void 0:f.find(R=>R.id===n.cuedMediaId);p&&await o().cue(p),initPlayerMediaSession(o,t),document.addEventListener("keydown",u)}}}))},PlayerStoreContext=reactExports.createContext(null);function PlayerContext({children:e,id:t,options:s}){const[n]=reactExports.useState(()=>createPlayerStore(t,s));return jsxRuntimeExports.jsx(PlayerStoreContext.Provider,{value:n,children:e})}const usePlayerStore=(e,t)=>{const s=reactExports.useContext(PlayerStoreContext);return useStore(s,e,t)};function usePlayerActions(){const e=reactExports.useContext(PlayerStoreContext);return reactExports.useMemo(()=>{const t=e.getState(),s=async(n,i)=>(await t.overrideQueue(n,i),t.play());return{play:t.play,playNext:t.playNext,playPrevious:t.playPrevious,pause:t.pause,subscribe:t.subscribe,getCurrentTime:t.getCurrentTime,seek:t.seek,toggleRepeatMode:t.toggleRepeatMode,toggleShuffling:t.toggleShuffling,getState:e.getState,setVolume:t.setVolume,setMuted:t.setMuted,overrideQueue:t.overrideQueue,appendToQueue:t.appendToQueue,removeFromQueue:t.removeFromQueue,enterFullscreen:t.enterFullscreen,exitFullscreen:t.exitFullscreen,cue:t.cue,overrideQueueAndPlay:s}},[e])}async function loadMediaItemTracks(e,t){const s={queryKey:["player/tracks",{queueId:e,trackId:t==null?void 0:t.id}],queryFn:async()=>loadTracks(e,t),staleTime:1/0};try{const n=queryClient.getQueryData(s.queryKey)??await queryClient.fetchQuery(s);return(n==null?void 0:n.tracks)||[]}catch{return[]}}function loadTracks(e,t){return apiClient.post("player/tracks",{queueId:e,lastTrack:t}).then(s=>s.data)}function trackToMediaItem(e,t){return e.url?{id:e.id,src:e.url,provider:"htmlVideo",meta:e,image:getTrackImageSrc(e),duration:e.duration?Math.round(e.duration/1e3):void 0,groupId:t}:{id:e.id,provider:"youtube",meta:e,src:e.youtube_id?e.youtube_id:"resolve",duration:e.duration?Math.round(e.duration/1e3):void 0,groupId:t}}function tracksToMediaItems(e,t,s){return e.map(n=>(s&&!n.album&&(n={...n,album:{...s,tracks:void 0}}),trackToMediaItem(n)))}const white=""+new URL("equalizer-white-29f31645.gif",import.meta.url).href,black=""+new URL("equalizer-black-498817c4.gif",import.meta.url).href;function EqualizerImage({className:e,color:t}){const s=useIsDarkMode();return t||(t=s?"white":"black"),jsxRuntimeExports.jsx("div",{className:clsx("flex items-center justify-center w-20 h-20",e),children:jsxRuntimeExports.jsx("img",{src:t==="white"?white:black,alt:"",className:"w-12 h-12","aria-hidden":!0})})}function PlaybackToggleButton({queueId:e,track:t,tracks:s,radius:n,variant:i,color:a,disabled:o,className:l,buttonType:u,equalizerColor:x=u==="text"?"white":"black"}){const[c,j]=reactExports.useState(!1),d=usePlayerStore(R=>!!(R.cuedMedia&&e&&R.cuedMedia.groupId===e||R.cuedMedia&&t&&R.cuedMedia.meta.id===t.id)),y=usePlayerStore(R=>R.status==="playing")&&d,v=usePlayerActions(),p=y?c?jsxRuntimeExports.jsx(PauseIcon,{}):jsxRuntimeExports.jsx(EqualizerImage,{color:x}):jsxRuntimeExports.jsx(PlayArrowFilledIcon,{}),f={disabled:o,onPointerEnter:()=>{j(!0)},onPointerLeave:()=>{j(!1)},onClick:async()=>{if(y)v.pause();else if(d)await v.play();else{let R=[],h=0;s?(R=[...s],h=t?s.findIndex(g=>g.id===t.id):0):t?R=[t]:R=await loadMediaItemTracks(e),R.length&&await v.overrideQueueAndPlay(R.map(g=>trackToMediaItem(g,e)),h)}}};return u==="icon"?jsxRuntimeExports.jsx(IconButton,{...f,variant:i,color:a,radius:n,className:l,children:p}):jsxRuntimeExports.jsx(Button,{...f,variant:i||"flat",color:a||"primary",radius:n||"rounded-full",startIcon:p,className:l,children:y?jsxRuntimeExports.jsx(Trans,{message:"Pause"}):jsxRuntimeExports.jsx(Trans,{message:"Play"})})}function queueGroupId(e,t="*",s){let n=`${e.model_type}.${e.id}.${t}`;return s!=null&&s.orderBy&&(s!=null&&s.orderDir)&&(n+=`.${s.orderBy.replace(".","^")}|${s.orderDir}`),n}function PlayableGridItem({image:e,title:t,subtitle:s,model:n,newQueue:i,link:a,likeButton:o,contextDialog:l,radius:u="rounded"}){const x=useNavigate();return jsxRuntimeExports.jsxs("div",{className:"snap-start snap-normal",children:[jsxRuntimeExports.jsxs(DialogTrigger,{type:"popover",placement:"bottom-start",triggerOnContextMenu:!0,children:[jsxRuntimeExports.jsxs("div",{className:"w-full relative isolate group",children:[jsxRuntimeExports.jsx("div",{className:"w-full aspect-square",onClick:()=>x(a),children:reactExports.cloneElement(e,{size:"w-full h-full",className:`${u} shadow-md z-10`})}),jsxRuntimeExports.jsx("div",{className:`absolute top-0 left-0 w-full h-full bg-gradient-to-b from-transparent to-black/75 ${u} z-20 opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none`},"bg-overlay"),jsxRuntimeExports.jsxs("div",{className:clsx("absolute bottom-0 left-0 w-full p-12 z-30 flex items-center gap-14",u==="rounded-full"&&"justify-center"),children:[jsxRuntimeExports.jsx(PlaybackToggleButton,{radius:"rounded-full",className:clsx("shadow-md",u==="rounded-full"&&"invisible group-hover:visible"),variant:"flat",color:"white",buttonType:"icon",track:n.model_type===TRACK_MODEL?n:void 0,tracks:i,queueId:queueGroupId(n)}),jsxRuntimeExports.jsxs(DialogTrigger,{type:"popover",children:[jsxRuntimeExports.jsx(IconButton,{className:"invisible md:group-hover:visible",color:"white",children:jsxRuntimeExports.jsx(MoreHorizIcon,{})}),l]}),u!=="rounded-full"&&o&&reactExports.cloneElement(o,{className:"invisible md:group-hover:visible ml-auto",size:"md",color:"white"})]})]}),l]}),jsxRuntimeExports.jsxs("div",{className:clsx(u==="rounded-full"&&"text-center","text-sm mt-12"),children:[jsxRuntimeExports.jsx("div",{className:"overflow-hidden overflow-ellipsis",children:t}),jsxRuntimeExports.jsx("div",{className:"text-muted mt-4 whitespace-nowrap overflow-hidden overflow-ellipsis",children:s})]})]})}function useAuthUserPlaylists(){const{isLoggedIn:e,user:t}=useAuth();return useQuery(["playlists","library",t==null?void 0:t.id,"compact"],()=>fetchPlaylists(),{enabled:e,initialData:()=>({playlists:getBootstrapData().playlists||[]})})}function fetchPlaylists(){return apiClient.get("users/me/playlists",{params:{perPage:30,orderBy:"updated_at",orderDir:"desc"}}).then(e=>({playlists:e.data.pagination.data}))}function useAddTracksToPlaylist(){return useMutation(e=>addTracks(e),{onSuccess:(e,{tracks:t})=>{toast(message("Added [one 1 track|other :count tracks] to playlist",{values:{count:t.length}})),queryClient.invalidateQueries(["playlists",e.playlist.id])},onError:e=>showHttpErrorToast(e)})}function addTracks(e){const t={ids:e.tracks.map(s=>s.id)};return apiClient.post(`playlists/${e.playlistId}/tracks/add`,t).then(s=>s.data)}const useGlobalDialogStore=react()(immer((e,t)=>({dialog:null,data:void 0,resolveClosePromise:null,openDialog:(s,n)=>new Promise(i=>{e(a=>{a.dialog=s,a.data=n,a.resolveClosePromise=i})}),closeActiveDialog:s=>{var n,i;(i=(n=t()).resolveClosePromise)==null||i.call(n,s),e(a=>{a.dialog=null,a.data=void 0,a.resolveClosePromise=null})}}))),openGlobalDialog=useGlobalDialogStore.getState().openDialog,closeGlobalDialog=e=>{useGlobalDialogStore.getState().closeActiveDialog(e)};function useAuthClickCapture(){const e=useDialogContext(),{isLoggedIn:t}=useAuth(),s=useNavigate();return reactExports.useCallback(n=>{t||(n.preventDefault(),n.stopPropagation(),e&&e.close(),s("/login"))},[s,t,e])}function PlaylistPanel(){const{data:e}=useAuthUserPlaylists(),{user:t}=useAuth(),{close:s}=useDialogContext(),{loadTracks:n,setPlaylistPanelIsActive:i}=reactExports.useContext(ContextMenuLayoutState),a=useAddTracksToPlaylist(),o=reactExports.useMemo(()=>e.playlists.filter(l=>l.owner_id===(t==null?void 0:t.id)||l.collaborative),[e,t]);return jsxRuntimeExports.jsxs(m.div,{initial:{x:"100%",opacity:0},animate:{x:0,opacity:1},exit:{x:"-100%",opacity:0},transition:{type:"tween",duration:.14},children:[jsxRuntimeExports.jsx("div",{className:"border-b pb-10 my-10 px-10",children:jsxRuntimeExports.jsx(Button,{startIcon:jsxRuntimeExports.jsx(KeyboardBackspaceIcon,{}),onClick:()=>i(!1),children:jsxRuntimeExports.jsx(Trans,{message:"Back"})})}),jsxRuntimeExports.jsxs("ul",{className:"overflow-y-auto overflow-x-hidden max-h-350",children:[jsxRuntimeExports.jsx(ContextMenuButton,{startIcon:jsxRuntimeExports.jsx(AddIcon,{}),onClick:async()=>{s();const[l,u]=await Promise.all([openGlobalDialog(CreatePlaylistDialog),n()]);u.length&&l&&a.mutate({playlistId:l.id,tracks:u})},className:"text-primary",children:jsxRuntimeExports.jsx(Trans,{message:"New playlist"})}),o.map(l=>jsxRuntimeExports.jsx(ContextMenuButton,{onClick:async()=>{s();const u=await n();u!=null&&u.length&&!a.isLoading?a.mutate({playlistId:l.id,tracks:u}):toast(message("This item does not have tracks yet"))},children:l.name},l.id))]})]})}function PlaylistPanelButton(){const e=useAuthClickCapture(),{playlistPanelIsActive:t,setPlaylistPanelIsActive:s}=reactExports.useContext(ContextMenuLayoutState);return jsxRuntimeExports.jsx(ContextMenuButton,{endIcon:jsxRuntimeExports.jsx(KeyboardArrowRightIcon,{}),onClickCapture:e,onClick:()=>{s(!t)},children:jsxRuntimeExports.jsx(Trans,{message:"Add to playlist"})})}const ContextMenuLayoutState=reactExports.createContext(null);function ContextDialogLayout({image:e,title:t,description:s,children:n,loadTracks:i}){const[a,o]=reactExports.useState(!1),{close:l}=useDialogContext(),u=reactExports.useMemo(()=>({playlistPanelIsActive:a,setPlaylistPanelIsActive:o,loadTracks:i}),[a,i]),{pathname:x}=useLocation(),c=usePrevious(x);reactExports.useEffect(()=>{c&&c!==x&&l()},[x,c,l]);const j=e||t?jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-14 border-b p-14 mb-10",children:[e&&reactExports.cloneElement(e,{className:"w-44 h-44 rounded"}),jsxRuntimeExports.jsxs("div",{className:"whitespace-nowrap overflow-hidden overflow-ellipsis",children:[t,s&&jsxRuntimeExports.jsx("div",{className:"text-xs text-muted",children:s})]})]}):null;return jsxRuntimeExports.jsx(ContextMenuLayoutState.Provider,{value:u,children:jsxRuntimeExports.jsx(Dialog,{size:"xs",children:jsxRuntimeExports.jsx(DialogBody,{padding:"p-0",onContextMenu:d=>{d.preventDefault(),d.stopPropagation()},children:jsxRuntimeExports.jsxs("div",{className:"pb-10",children:[j,jsxRuntimeExports.jsx(AnimatePresence,{initial:!1,mode:"wait",children:a?jsxRuntimeExports.jsx(PlaylistPanel,{},"playlist-panel"):jsxRuntimeExports.jsx("ul",{className:"text-base md:text-sm",children:n},"menu")})]})})})})}const ContextMenuButton=reactExports.forwardRef(({children:e,endIcon:t,startIcon:s,className:n,type:i="button",to:a,...o},l)=>{const u=i==="button"?"button":Link;return jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsxs(u,{...o,to:a,ref:l,className:clsx("flex items-center gap-12 py-12 px-20 hover:bg-hover cursor-pointer outline-none focus-visible:ring focus-visible:ring-inset w-full text-left",n),children:[s,jsxRuntimeExports.jsx("span",{className:"mr-auto whitespace-nowrap overflow-hidden overflow-ellipsis min-w-0",children:e}),t]})})});function createCountableStore(e){const t=getBootstrapData()[e];return react()(immer((s,n)=>({track:(t==null?void 0:t.track)||{},album:(t==null?void 0:t.album)||{},artist:t&&"artist"in t&&(t==null?void 0:t.artist)||{},has:i=>(Array.isArray(i)?i:[i]).every(o=>n()[o.model_type][o.id]),add:i=>{const a=i[0].model_type;s(o=>{i.forEach(l=>{o[a][l.id]=!0})})},remove:i=>{const a=i[0].model_type;s(o=>{i.forEach(l=>{delete o[a][l.id]})})}})))}const useLibraryStore=createCountableStore("likes"),userLibrary=useLibraryStore.getState;function useAddItemsToLibrary(){return useMutation(e=>addToLibrary$1(e),{onSuccess:(e,t)=>{toast(getMessage$1(t.likeables[0])),userLibrary().add(t.likeables),queryClient.invalidateQueries([`${t.likeables[0]}s`,"library"])},onError:e=>showHttpErrorToast(e)})}function addToLibrary$1(e){const t=e.likeables.filter(s=>!userLibrary().has(s)).map(s=>({likeable_id:s.id,likeable_type:s.model_type}));return apiClient.post("users/me/add-to-library",{likeables:t}).then(s=>s.data)}function getMessage$1(e){switch(e.model_type){case"artist":return message("Added to your artists");case"album":return message("Added to your albums");case"track":return message("Added to your liked songs")}}function useRemoveItemsFromLibrary(){return useMutation(e=>addToLibrary(e),{onSuccess:(e,t)=>{toast(getMessage(t.likeables[0])),userLibrary().remove(t.likeables),queryClient.invalidateQueries([`${t.likeables[0]}s`,"library"])},onError:e=>showHttpErrorToast(e)})}function addToLibrary(e){const t=e.likeables.filter(s=>userLibrary().has(s)).map(s=>({likeable_id:s.id,likeable_type:s.model_type}));return apiClient.post("users/me/remove-from-library",{likeables:t}).then(s=>s.data)}function getMessage(e){switch(e.model_type){case"artist":return message("Removed from your artists");case"album":return message("Removed from your albums");case"track":return message("Removed from your liked songs")}}function ToggleInLibraryMenuButton({items:e}){const t=useAuthClickCapture(),{close:s}=useDialogContext(),n=useAddItemsToLibrary(),i=useRemoveItemsFromLibrary();return useLibraryStore(o=>o.has(e))?jsxRuntimeExports.jsx(ContextMenuButton,{onClickCapture:t,onClick:()=>{s(),i.mutate({likeables:e})},children:jsxRuntimeExports.jsx(Trans,{message:"Remove from your music"})}):jsxRuntimeExports.jsx(ContextMenuButton,{onClickCapture:t,onClick:()=>{s(),n.mutate({likeables:e})},children:jsxRuntimeExports.jsx(Trans,{message:"Add to your music"})})}function CopyLinkMenuButton({link:e,children:t}){const{close:s}=useDialogContext(),[,n]=useCopyClipboard(e);return jsxRuntimeExports.jsx(ContextMenuButton,{onClick:()=>{n(),s(),toast(message("Copied link to clipboard"))},children:t})}function useArtistPermissions(e){const{user:t,hasPermission:s}=useAuth();return reactExports.useMemo(()=>{var i;const n={canEdit:!1,canDelete:!1};if(t!=null&&t.id){const a=!!((i=t.artists)!=null&&i.find(o=>e.id));n.canEdit=s("artists.update")||s("music.update")||a,n.canDelete=s("artists.delete")||s("music.delete")||a}return n},[t,e,s])}function useDeleteArtist(e){const{pathname:t}=useLocation(),s=useNavigate(),{getRedirectUri:n}=useAuth();return useMutation(()=>deleteArtist(e),{onSuccess:()=>{toast(message("Artist deleted")),t.startsWith(`/artist/${e}`)&&s(n()),queryClient.invalidateQueries(["tracks"]),queryClient.invalidateQueries(["albums"]),queryClient.invalidateQueries(["artists"])},onError:i=>showHttpErrorToast(i)})}function deleteArtist(e){return apiClient.delete(`artists/${e}`).then(t=>t.data)}function getRadioLink(e,{absolute:t}={}){let s=`/radio/${e.model_type}/${e.id}/${slugifyString(e.name)}`;return t&&(s=`${getBootstrapData().settings.base_url}${s}`),s}function useShouldShowRadioButton(){const{player:e,artist_provider:t}=useSettings();return!(e!=null&&e.hide_radio_button)&&t==="spotify"}function ShareMediaDialog({item:e}){const{close:t}=useDialogContext();return jsxRuntimeExports.jsxs(Dialog,{size:"xl",children:[jsxRuntimeExports.jsx(DialogHeader,{children:jsxRuntimeExports.jsx(Trans,{message:"Share :name",values:{name:e.name}})}),jsxRuntimeExports.jsx(DialogBody,{children:e.model_type==="artist"?jsxRuntimeExports.jsx(SharePanel,{item:e}):jsxRuntimeExports.jsxs(Tabs,{children:[jsxRuntimeExports.jsxs(TabList,{children:[jsxRuntimeExports.jsx(Tab,{children:jsxRuntimeExports.jsx(Trans,{message:"Share"})}),jsxRuntimeExports.jsx(Tab,{children:jsxRuntimeExports.jsx(Trans,{message:"Embed"})})]}),jsxRuntimeExports.jsxs(TabPanels,{className:"pt-20",children:[jsxRuntimeExports.jsx(TabPanel,{children:jsxRuntimeExports.jsx(SharePanel,{item:e})}),jsxRuntimeExports.jsx(TabPanel,{children:jsxRuntimeExports.jsx(EmbedPanel,{item:e})})]})]})}),jsxRuntimeExports.jsx(DialogFooter,{children:jsxRuntimeExports.jsx(Button,{onClick:()=>t(),children:jsxRuntimeExports.jsx(Trans,{message:"Close"})})})]})}function EmbedPanel({item:e}){const t=useIsMobileMediaQuery(),s=`${getLink(e)}/embed`,n=e.model_type==="track"?174:384,i=`<iframe width="100%" height="${n}" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture" src="${s}"></iframe>`;return jsxRuntimeExports.jsxs("div",{children:[!t&&jsxRuntimeExports.jsx("iframe",{src:s,width:"100%",height:n,allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0}),jsxRuntimeExports.jsx(TextField,{className:"mt-20",inputElementType:"textarea",readOnly:!0,value:i,rows:3,onClick:a=>{a.currentTarget.focus(),a.currentTarget.select()}})]})}function SharePanel({item:e}){const t=getLink(e),s=reactExports.useRef(null),[n,i]=useCopyClipboard(t,{successDuration:600});return jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-14",children:[jsxRuntimeExports.jsx(MediaImage,{item:e,size:"w-128 h-128",className:"rounded object-cover flex-shrink-0 hidden md:block"}),jsxRuntimeExports.jsxs("div",{className:"flex-auto",children:[jsxRuntimeExports.jsx("div",{className:"text-xl mb-8",children:e.name}),jsxRuntimeExports.jsx(TextField,{className:"mb-8",inputRef:s,readOnly:!0,onClick:a=>{a.currentTarget.focus(),a.currentTarget.select()},value:t,endAppend:jsxRuntimeExports.jsx(Button,{variant:"flat",color:"primary",onClick:()=>{var a;(a=s.current)==null||a.select(),i()},children:n?jsxRuntimeExports.jsx(Trans,{message:"Copied!"}):jsxRuntimeExports.jsx(Trans,{message:"Copy"})})}),jsxRuntimeExports.jsx(ShareMediaButtons,{link:t,image:"image"in e?e.image:e.image_small,name:e.name})]})]})}function MediaImage({item:e,className:t,size:s}){switch(e.model_type){case"artist":return jsxRuntimeExports.jsx(SmallArtistImage,{size:s,className:t,artist:e});case"album":return jsxRuntimeExports.jsx(AlbumImage,{size:s,className:t,album:e});case"track":return jsxRuntimeExports.jsx(TrackImage,{size:s,className:t,track:e})}}function getLink(e){switch(e.model_type){case"artist":return getArtistLink(e,{absolute:!0});case"album":return getAlbumLink(e,{absolute:!0});case"track":return getTrackLink(e,{absolute:!0})}}function ShareMediaButton({item:e}){const{close:t}=useDialogContext();return jsxRuntimeExports.jsx(ContextMenuButton,{onClick:()=>{t(),openGlobalDialog(ShareMediaDialog,{item:e})},children:jsxRuntimeExports.jsx(Trans,{message:"Share"})})}function ArtistContextDialog({artist:e}){const t=useShouldShowRadioButton(),{canEdit:s}=useArtistPermissions(e),n=reactExports.useCallback(()=>loadArtistTracks(),[e]);return jsxRuntimeExports.jsxs(ContextDialogLayout,{image:jsxRuntimeExports.jsx(SmallArtistImage,{artist:e}),title:jsxRuntimeExports.jsx(ArtistLink,{artist:e}),loadTracks:n,children:[jsxRuntimeExports.jsx(ToggleInLibraryMenuButton,{items:[e]}),t&&jsxRuntimeExports.jsx(ContextMenuButton,{type:"link",to:getRadioLink(e),children:jsxRuntimeExports.jsx(Trans,{message:"Go to artist radio"})}),jsxRuntimeExports.jsx(CopyLinkMenuButton,{link:getArtistLink(e,{absolute:!0}),children:jsxRuntimeExports.jsx(Trans,{message:"Copy artist link"})}),jsxRuntimeExports.jsx(ShareMediaButton,{item:e}),s&&jsxRuntimeExports.jsx(ContextMenuButton,{type:"link",to:`/backstage/artists/${e.id}/insights`,children:jsxRuntimeExports.jsx(Trans,{message:"Insights"})}),s&&jsxRuntimeExports.jsx(ContextMenuButton,{type:"link",to:`/backstage/artists/${e.id}/edit`,children:jsxRuntimeExports.jsx(Trans,{message:"Edit"})}),jsxRuntimeExports.jsx(DeleteButton$3,{artist:e})]})}function DeleteButton$3({artist:e}){const{close:t}=useDialogContext(),s=useDeleteArtist(e.id),{canDelete:n}=useArtistPermissions(e);return n?jsxRuntimeExports.jsx(ContextMenuButton,{disabled:s.isLoading,onClick:()=>{t(),openGlobalDialog(ConfirmationDialog,{isDanger:!0,title:jsxRuntimeExports.jsx(Trans,{message:"Delete artist"}),body:jsxRuntimeExports.jsx(Trans,{message:"Are you sure you want to delete this artist?"}),confirm:jsxRuntimeExports.jsx(Trans,{message:"Delete"}),onConfirm:()=>{s.mutate()}})},children:jsxRuntimeExports.jsx(Trans,{message:"Delete"})}):null}async function loadArtistTracks(e){return Promise.resolve([])}function LikeIconButton({likeable:e,size:t="sm",...s}){const n=useAuthClickCapture(),i=useAddItemsToLibrary(),a=useRemoveItemsFromLibrary(),o=useLibraryStore(u=>u.has(e)),l=i.isLoading||a.isLoading;return o?jsxRuntimeExports.jsx(IconButton,{...s,size:t,color:"primary",disabled:l,onClickCapture:n,onClick:u=>{u.stopPropagation(),a.mutate({likeables:[e]})},children:jsxRuntimeExports.jsx(FavoriteIcon,{})}):jsxRuntimeExports.jsx(IconButton,{...s,size:t,disabled:l,onClickCapture:n,onClick:u=>{u.stopPropagation(),i.mutate({likeables:[e]})},children:jsxRuntimeExports.jsx(FavoriteBorderIcon,{})})}function ArtistGridItem({artist:e,radius:t="rounded-full"}){return jsxRuntimeExports.jsx(PlayableGridItem,{image:jsxRuntimeExports.jsx(SmallArtistImage,{artist:e}),title:jsxRuntimeExports.jsx(ArtistLink,{artist:e}),model:e,link:getArtistLink(e),likeButton:jsxRuntimeExports.jsx(LikeIconButton,{likeable:e}),contextDialog:jsxRuntimeExports.jsx(ArtistContextDialog,{artist:e}),radius:t})}function useAlbumPermissions(e){const{user:t,hasPermission:s}=useAuth();return reactExports.useMemo(()=>{var i,a;const n={canEdit:!1,canDelete:!1,managesAlbum:!1};if(t!=null&&t.id&&e){const o=(i=e.artists)==null?void 0:i.map(u=>u.id),l=e.owner_id===t.id||!!((a=t.artists)!=null&&a.find(u=>o==null?void 0:o.includes(u.id)));n.canEdit=s("albums.update")||s("music.update")||l,n.canDelete=s("albums.delete")||s("music.delete")||l,n.managesAlbum=l}return n},[t,e,s])}function AddToQueueButton({item:e,loadTracks:t}){const{close:s}=useDialogContext(),n=usePlayerActions();return jsxRuntimeExports.jsx(ContextMenuButton,{onClick:async()=>{s();const i=await t();n.appendToQueue(tracksToMediaItems(i,Array.isArray(e)?void 0:queueGroupId(e)))},children:jsxRuntimeExports.jsx(Trans,{message:"Add to queue"})})}const useRepostsStore=createCountableStore("reposts"),userReposts=useRepostsStore.getState;function useToggleRepost(){return useMutation(e=>toggleRepost(e),{onSuccess:(e,{repostable:t})=>{e.action==="added"?userReposts().add([t]):userReposts().remove([t]),queryClient.invalidateQueries(["reposts"])},onError:e=>showHttpErrorToast(e)})}function toggleRepost({repostable:e}){const t={repostable_id:e.id,repostable_type:e.model_type};return apiClient.post("reposts/toggle",t).then(s=>s.data)}function ToggleRepostMenuButton({item:e}){const t=useAuthClickCapture(),{close:s}=useDialogContext(),{player:n}=useSettings(),i=useToggleRepost(),a=useRepostsStore(o=>o.has(e));return n!=null&&n.enable_repost?jsxRuntimeExports.jsx(ContextMenuButton,{onClickCapture:t,onClick:()=>{s(),i.mutate({repostable:e})},children:a?jsxRuntimeExports.jsx(Trans,{message:"Reposted"}):jsxRuntimeExports.jsx(Trans,{message:"Repost"})}):null}function AlbumContextDialog({album:e}){var i;const{canEdit:t}=useAlbumPermissions(e),s=useIsMobileMediaQuery(),n=reactExports.useCallback(()=>loadAlbumTracks(e),[e]);return jsxRuntimeExports.jsxs(ContextDialogLayout,{image:jsxRuntimeExports.jsx(AlbumImage,{album:e}),title:jsxRuntimeExports.jsx(AlbumLink,{album:e}),description:jsxRuntimeExports.jsx(ArtistLinks,{artists:e.artists}),loadTracks:n,children:[jsxRuntimeExports.jsx(AddToQueueButton,{item:e,loadTracks:n}),jsxRuntimeExports.jsx(PlaylistPanelButton,{}),jsxRuntimeExports.jsx(ToggleInLibraryMenuButton,{items:[e]}),s&&((i=e.artists)==null?void 0:i[0])&&jsxRuntimeExports.jsx(ContextMenuButton,{type:"link",to:getArtistLink(e.artists[0]),children:jsxRuntimeExports.jsx(Trans,{message:"Go to artist"})}),!s&&jsxRuntimeExports.jsx(CopyLinkMenuButton,{link:getAlbumLink(e,{absolute:!0}),children:jsxRuntimeExports.jsx(Trans,{message:"Copy album link"})}),jsxRuntimeExports.jsx(ShareMediaButton,{item:e}),jsxRuntimeExports.jsx(ToggleRepostMenuButton,{item:e}),t&&jsxRuntimeExports.jsx(ContextMenuButton,{type:"link",to:`/backstage/albums/${e.id}/insights`,children:jsxRuntimeExports.jsx(Trans,{message:"Insights"})}),t&&jsxRuntimeExports.jsx(ContextMenuButton,{type:"link",to:`/backstage/albums/${e.id}/edit`,children:jsxRuntimeExports.jsx(Trans,{message:"Edit"})}),jsxRuntimeExports.jsx(DeleteButton$2,{album:e})]})}function DeleteButton$2({album:e}){const{close:t}=useDialogContext(),s=useDeleteAlbum(),{canDelete:n}=useAlbumPermissions(e);return n?jsxRuntimeExports.jsx(ContextMenuButton,{disabled:s.isLoading,onClick:()=>{t(),openGlobalDialog(ConfirmationDialog,{isDanger:!0,title:jsxRuntimeExports.jsx(Trans,{message:"Delete album"}),body:jsxRuntimeExports.jsx(Trans,{message:"Are you sure you want to delete this album?"}),confirm:jsxRuntimeExports.jsx(Trans,{message:"Delete"}),onConfirm:()=>{s.mutate({albumId:e.id})}})},children:jsxRuntimeExports.jsx(Trans,{message:"Delete"})}):null}async function loadAlbumTracks(e){if(typeof e.tracks>"u"){const t=await loadMediaItemTracks(queueGroupId(e));return t.length||toast(message("This album has no tracks yet.")),t}return e.tracks}function AlbumGridItem({album:e}){return jsxRuntimeExports.jsx(PlayableGridItem,{image:jsxRuntimeExports.jsx(AlbumImage,{album:e}),title:jsxRuntimeExports.jsx(AlbumLink,{album:e}),subtitle:jsxRuntimeExports.jsx(ArtistLinks,{artists:e.artists}),link:getAlbumLink(e),likeButton:jsxRuntimeExports.jsx(LikeIconButton,{likeable:e}),model:e,contextDialog:jsxRuntimeExports.jsx(AlbumContextDialog,{album:e})})}function GenreImage({genre:e,className:t,size:s}){const{trans:n}=useTrans();return jsxRuntimeExports.jsx("img",{className:clsx(t,s,"object-cover bg-fg-base/4"),draggable:!1,loading:"lazy",src:getGenreImage(e),alt:n(message("Image for :name",{values:{name:e.name}}))})}function getGenreImage(e){const t=getBootstrapData();return e!=null&&e.image?`${t.settings.base_url}/${e==null?void 0:e.image}`:defaultImage}function GenreGridItem({genre:e}){return jsxRuntimeExports.jsxs(Link,{to:getGenreLink(e),className:"block relative h-max after:bg-black/50 after:top-0 after:left-0 after:w-full after:h-full after:absolute rounded overflow-hidden cursor-pointer isolate",children:[jsxRuntimeExports.jsx(GenreImage,{genre:e,className:"shadow-md w-full aspect-square"}),jsxRuntimeExports.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 text-xl font-semibold capitalize text-white whitespace-nowrap overflow-hidden overflow-ellipsis max-w-[86%] z-20",children:e.name})]})}function useTrackPermissions(e){const{user:t,hasPermission:s}=useAuth();return reactExports.useMemo(()=>{const n={canEdit:!0,canDelete:!0,managesTrack:!0};return e.every(i=>{var l,u;if(!i){n.canEdit=!1,n.canDelete=!1,n.managesTrack=!1;return}const a=(l=i.artists)==null?void 0:l.map(x=>x.id),o=i.owner_id===(t==null?void 0:t.id)||!!((u=t==null?void 0:t.artists)!=null&&u.find(x=>a==null?void 0:a.includes(x.id)));o||(n.managesTrack=!1),!s("tracks.update")&&!s("music.update")&&!o&&(n.canEdit=!1),!s("tracks.delete")&&!s("music.delete")&&!o&&(n.canDelete=!1)}),n},[t,e,s])}function useDeleteTracks(){const{pathname:e}=useLocation(),t=useNavigate(),{getRedirectUri:s}=useAuth();return useMutation(n=>deleteTracks(n),{onSuccess:(n,{trackIds:i})=>{toast(message("[one track|other :count tracks] deleted",{values:{count:i.length}})),i.some(a=>e.startsWith(`/track/${a}`))&&t(s()),queryClient.invalidateQueries(["tracks"])},onError:n=>showHttpErrorToast(n)})}function deleteTracks({trackIds:e}){return apiClient.delete(`tracks/${e.join(",")}`).then(t=>t.data)}function TrackContextDialog({children:e,tracks:t,showAddToQueueButton:s=!0}){var c;const n=useIsMobileMediaQuery(),i=t[0],{canEdit:a,canDelete:o}=useTrackPermissions(t),l=useShouldShowRadioButton(),u=reactExports.useCallback(()=>Promise.resolve(t),[t]),x=t.length===1?{image:jsxRuntimeExports.jsx(TrackImage,{track:i}),title:jsxRuntimeExports.jsx(TrackLink,{track:i}),description:jsxRuntimeExports.jsx(ArtistLinks,{artists:i.artists})}:{};return jsxRuntimeExports.jsxs(ContextDialogLayout,{...x,loadTracks:u,children:[s&&jsxRuntimeExports.jsx(AddToQueueButton,{item:t,loadTracks:u}),jsxRuntimeExports.jsx(ToggleInLibraryMenuButton,{items:t}),e==null?void 0:e(t),jsxRuntimeExports.jsx(PlaylistPanelButton,{}),t.length===1?jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[l&&jsxRuntimeExports.jsx(ContextMenuButton,{type:"link",to:getRadioLink(i),children:jsxRuntimeExports.jsx(Trans,{message:"Go to song radio"})}),n&&jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[((c=i.artists)==null?void 0:c[0])&&jsxRuntimeExports.jsx(ContextMenuButton,{type:"link",to:getArtistLink(i.artists[0]),children:jsxRuntimeExports.jsx(Trans,{message:"Go to artist"})}),i.album&&jsxRuntimeExports.jsx(ContextMenuButton,{type:"link",to:getAlbumLink(i.album),children:jsxRuntimeExports.jsx(Trans,{message:"Go to album"})}),jsxRuntimeExports.jsx(ContextMenuButton,{type:"link",to:getTrackLink(i),children:jsxRuntimeExports.jsx(Trans,{message:"Go to track"})})]}),!n&&jsxRuntimeExports.jsx(CopyLinkMenuButton,{link:getTrackLink(i,{absolute:!0}),children:jsxRuntimeExports.jsx(Trans,{message:"Copy song link"})}),t.length===1&&jsxRuntimeExports.jsx(ShareMediaButton,{item:i}),t.length===1?jsxRuntimeExports.jsx(ToggleRepostMenuButton,{item:t[0]}):null,t.length===1&&a&&jsxRuntimeExports.jsx(ContextMenuButton,{type:"link",to:`/backstage/tracks/${i.id}/insights`,children:jsxRuntimeExports.jsx(Trans,{message:"Insights"})}),t.length===1&&a&&jsxRuntimeExports.jsx(ContextMenuButton,{type:"link",to:`/backstage/tracks/${i.id}/edit`,children:jsxRuntimeExports.jsx(Trans,{message:"Edit"})})]}):null,o&&jsxRuntimeExports.jsx(DeleteButton$1,{tracks:t})]})}function DeleteButton$1({tracks:e}){const{close:t}=useDialogContext(),s=useDeleteTracks(),{canDelete:n}=useTrackPermissions(e);return n?jsxRuntimeExports.jsx(ContextMenuButton,{disabled:s.isLoading,onClick:()=>{t(),openGlobalDialog(ConfirmationDialog,{isDanger:!0,title:jsxRuntimeExports.jsx(Trans,{message:"Delete tracks"}),body:jsxRuntimeExports.jsx(Trans,{message:"Are you sure you want to delete selected tracks?"}),confirm:jsxRuntimeExports.jsx(Trans,{message:"Delete"}),onConfirm:()=>{s.mutate({trackIds:e.map(i=>i.id)})}})},children:jsxRuntimeExports.jsx(Trans,{message:"Delete"})}):null}function TrackGridItem({track:e,newQueue:t}){return jsxRuntimeExports.jsx(PlayableGridItem,{image:jsxRuntimeExports.jsx(TrackImage,{track:e}),title:jsxRuntimeExports.jsx(TrackLink,{track:e}),subtitle:jsxRuntimeExports.jsx(ArtistLinks,{artists:e.artists}),link:getTrackLink(e),likeButton:jsxRuntimeExports.jsx(LikeIconButton,{likeable:e}),model:e,newQueue:t,contextDialog:jsxRuntimeExports.jsx(TrackContextDialog,{tracks:[e]})})}function PlaylistImage({playlist:e,className:t,size:s}){const{trans:n}=useTrans();return jsxRuntimeExports.jsx("img",{className:clsx(t,s,"object-cover bg-fg-base/4"),draggable:!1,loading:"lazy",src:getPlaylistImageSrc(e),alt:n(message("Image for :name",{values:{name:e.name}}))})}function getPlaylistImageSrc(e){var s;if(e.image)return e.image;const t=(s=e.tracks)!=null&&s[0]?getTrackImageSrc(e.tracks[0]):null;return t||defaultImage$1}function usePlaylistPermissions(e){const{user:t}=useAuth(),s=!!(t!=null&&t.id&&t.id===e.owner_id);return{canEdit:s,canDelete:s,isCreator:s}}function useIsFollowingPlaylist(e){const{data:t}=useAuthUserPlaylists(),{user:s}=useAuth(),n=t.playlists.find(i=>i.id===+e);return!!(n&&s&&s.id!==n.owner_id)}function useDeletePlaylist(e){const{pathname:t}=useLocation(),s=useNavigate(),{getRedirectUri:n}=useAuth();return useMutation(()=>deletePlaylist(e),{onSuccess:()=>{toast(message("Playlist deleted")),queryClient.invalidateQueries(["playlists"]),t.startsWith(`/playlist/${e}`)&&s(n())},onError:i=>showHttpErrorToast(i)})}function deletePlaylist(e){return apiClient.delete(`playlists/${e}`).then(t=>t.data)}function useFollowPlaylist(e){return useMutation(()=>followPlaylist(e.id),{onSuccess:()=>{toast(message("Following :name",{values:{name:e.name}})),queryClient.invalidateQueries(["playlists"])},onError:t=>showHttpErrorToast(t)})}function followPlaylist(e){return apiClient.post(`playlists/${e}/follow`).then(t=>t.data)}function useUnfollowPlaylist(e){return useMutation(()=>unfollowPlaylist(e.id),{onSuccess:()=>{toast(message("Stopped following :name",{values:{name:e.name}})),queryClient.invalidateQueries(["playlists"])},onError:t=>showHttpErrorToast(t)})}function unfollowPlaylist(e){return apiClient.post(`playlists/${e}/unfollow`).then(t=>t.data)}function PlaylistContextDialog({playlist:e}){const{close:t}=useDialogContext(),[,s]=useCopyClipboard(getPlaylistLink(e,{absolute:!0})),{canEdit:n}=usePlaylistPermissions(e),i=reactExports.useCallback(()=>loadPlaylistTracks(e),[e]);return jsxRuntimeExports.jsxs(ContextDialogLayout,{image:jsxRuntimeExports.jsx(PlaylistImage,{playlist:e}),title:jsxRuntimeExports.jsx(PlaylistLink,{playlist:e}),description:jsxRuntimeExports.jsx(PlaylistOwnerName,{playlist:e}),loadTracks:i,children:[jsxRuntimeExports.jsx(AddToQueueButton,{item:e,loadTracks:i}),jsxRuntimeExports.jsx(TogglePublicButton,{playlist:e}),jsxRuntimeExports.jsx(ToggleCollaborativeButton,{playlist:e}),jsxRuntimeExports.jsx(FollowButtons,{playlist:e}),jsxRuntimeExports.jsx(ContextMenuButton,{onClick:()=>{s(),t(),toast(message("Copied link to clipboard"))},children:jsxRuntimeExports.jsx(Trans,{message:"Copy playlist link"})}),jsxRuntimeExports.jsx(ContextMenuButton,{children:jsxRuntimeExports.jsx(Trans,{message:"Share"})}),n&&jsxRuntimeExports.jsx(ContextMenuButton,{onClick:()=>{t(),openGlobalDialog(UpdatePlaylistDialog,{playlist:e})},children:jsxRuntimeExports.jsx(Trans,{message:"Edit"})}),jsxRuntimeExports.jsx(DeleteButton,{playlist:e})]})}function FollowButtons({playlist:e}){const t=useIsFollowingPlaylist(e.id),{close:s}=useDialogContext(),n=useFollowPlaylist(e),i=useUnfollowPlaylist(e),{isCreator:a}=usePlaylistPermissions(e);return a?null:jsxRuntimeExports.jsx(reactExports.Fragment,{children:t?jsxRuntimeExports.jsx(ContextMenuButton,{onClick:()=>{s(),i.mutate()},children:jsxRuntimeExports.jsx(Trans,{message:"Unfollow"})}):jsxRuntimeExports.jsx(ContextMenuButton,{onClick:()=>{s(),n.mutate()},children:jsxRuntimeExports.jsx(Trans,{message:"Follow"})})})}function TogglePublicButton({playlist:e}){const{close:t}=useDialogContext(),s=useUpdatePlaylist({playlistId:e.id}),{isCreator:n}=usePlaylistPermissions(e);if(!n)return null;const i=()=>{t(),s.mutate({public:!e.public})};return jsxRuntimeExports.jsx(ContextMenuButton,{disabled:s.isLoading,onClick:()=>i(),children:e.public?jsxRuntimeExports.jsx(Trans,{message:"Make private"}):jsxRuntimeExports.jsx(Trans,{message:"Make public"})})}function ToggleCollaborativeButton({playlist:e}){const{close:t}=useDialogContext(),s=useUpdatePlaylist({playlistId:e.id}),{isCreator:n}=usePlaylistPermissions(e);if(!n)return null;const i=()=>{t(),s.mutate({collaborative:!e.collaborative})};return jsxRuntimeExports.jsx(ContextMenuButton,{disabled:s.isLoading,startIcon:e.collaborative?jsxRuntimeExports.jsx(CheckIcon,{}):void 0,onClick:()=>i(),children:jsxRuntimeExports.jsx(Trans,{message:"Collaborative"})})}function DeleteButton({playlist:e}){const{close:t}=useDialogContext(),s=useDeletePlaylist(e.id),{canDelete:n}=usePlaylistPermissions(e);return n?jsxRuntimeExports.jsx(ContextMenuButton,{disabled:s.isLoading,onClick:()=>{t(),openGlobalDialog(ConfirmationDialog,{isDanger:!0,title:jsxRuntimeExports.jsx(Trans,{message:"Delete playlist"}),body:jsxRuntimeExports.jsx(Trans,{message:"Are you sure you want to delete this playlist?"}),confirm:jsxRuntimeExports.jsx(Trans,{message:"Delete"}),onConfirm:()=>{s.mutate()}})},children:jsxRuntimeExports.jsx(Trans,{message:"Delete"})}):null}async function loadPlaylistTracks(e){if(typeof e.tracks>"u"){const t=await loadMediaItemTracks(queueGroupId(e));return t.length||toast(message("This playlist has no tracks yet.")),t}return e.tracks}function FollowPlaylistButton({playlist:e,size:t="sm",className:s,buttonType:n="text",radius:i}){const{isCreator:a}=usePlaylistPermissions(e),o=useFollowPlaylist(e),l=useUnfollowPlaylist(e),u=useIsFollowingPlaylist(e.id),x=o.isLoading||l.isLoading;return a?null:n==="icon"?u?jsxRuntimeExports.jsx(IconButton,{size:t,radius:i,color:"primary",className:s,disabled:x,onClick:()=>l.mutate(),children:jsxRuntimeExports.jsx(FavoriteIcon,{})}):jsxRuntimeExports.jsx(IconButton,{size:t,radius:i,disabled:x,className:s,onClick:()=>o.mutate(),children:jsxRuntimeExports.jsx(FavoriteBorderIcon,{})}):u?jsxRuntimeExports.jsx(Button,{size:t,variant:"outline",radius:i||"rounded-full",startIcon:jsxRuntimeExports.jsx(FavoriteIcon,{className:"text-primary"}),disabled:x,className:s,onClick:()=>l.mutate(),children:jsxRuntimeExports.jsx(Trans,{message:"Following"})}):jsxRuntimeExports.jsx(Button,{size:t,variant:"outline",radius:i||"rounded-full",startIcon:jsxRuntimeExports.jsx(FavoriteBorderIcon,{}),disabled:x,className:s,onClick:()=>o.mutate(),children:jsxRuntimeExports.jsx(Trans,{message:"Follow"})})}function PlaylistGridItem({playlist:e}){return jsxRuntimeExports.jsx(PlayableGridItem,{image:jsxRuntimeExports.jsx(PlaylistImage,{playlist:e}),title:jsxRuntimeExports.jsx(PlaylistLink,{playlist:e}),subtitle:jsxRuntimeExports.jsx(PlaylistOwnerName,{playlist:e}),link:getPlaylistLink(e),likeButton:jsxRuntimeExports.jsx(FollowPlaylistButton,{buttonType:"icon",size:"md",playlist:e}),model:e,contextDialog:jsxRuntimeExports.jsx(PlaylistContextDialog,{playlist:e})})}function PlaylistOwnerName({playlist:e}){var s;const t=e.owner||((s=e.editors)==null?void 0:s[0]);return t?jsxRuntimeExports.jsx(Trans,{message:"By :name",values:{name:jsxRuntimeExports.jsx(UserProfileLink,{user:t})}}):null}const userDefaultImage=""+new URL("user-default-4b239e07.svg",import.meta.url).href;function UserImage({user:e,className:t,size:s,showProBadge:n}){var o;const{trans:i}=useTrans(),a=n&&((o=e.subscriptions)==null?void 0:o.find(l=>l.valid));return jsxRuntimeExports.jsxs("div",{className:clsx("relative flex-shrink-0 isolate overflow-hidden",s,t),children:[jsxRuntimeExports.jsx("img",{className:"object-cover bg-fg-base/4 w-full h-full",draggable:!1,src:getUserImage(e),alt:i(message("Avatar for :name",{values:{name:e.display_name}}))}),a&&jsxRuntimeExports.jsxs("div",{className:"absolute bottom-12 text-sm left-0 right-0 w-max max-w-full mx-auto flex items-center gap-6 bg-black/60 text-white rounded-full py-4 px-8",color:"positive",children:[jsxRuntimeExports.jsx("div",{className:"bg-primary rounded-full p-1",children:jsxRuntimeExports.jsx(StarIcon,{className:"text-white",size:"sm"})}),jsxRuntimeExports.jsx(Trans,{message:"PRO user"})]})]})}function getUserImage(e){return e.avatar||userDefaultImage}function UserGridItem({user:e}){return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(Link,{to:getUserProfileLink(e),children:jsxRuntimeExports.jsx(UserImage,{user:e,className:"shadow-md w-full aspect-square rounded"})}),jsxRuntimeExports.jsxs("div",{className:"text-sm mt-12",children:[jsxRuntimeExports.jsx("div",{className:"overflow-hidden overflow-ellipsis",children:jsxRuntimeExports.jsx(Link,{to:getUserProfileLink(e),children:e.display_name})}),e.followers_count?jsxRuntimeExports.jsx("div",{className:"text-muted mt-4 whitespace-nowrap overflow-hidden overflow-ellipsis",children:jsxRuntimeExports.jsx(Trans,{message:":count followers",values:{count:e.followers_count}})}):null]})]})}function ChannelContentGridItem({item:e,items:t}){switch(e.model_type){case ARTIST_MODEL:return jsxRuntimeExports.jsx(ArtistGridItem,{artist:e});case ALBUM_MODEL:return jsxRuntimeExports.jsx(AlbumGridItem,{album:e});case GENRE_MODEL:return jsxRuntimeExports.jsx(GenreGridItem,{genre:e});case TRACK_MODEL:return jsxRuntimeExports.jsx(TrackGridItem,{track:e,newQueue:t});case PLAYLIST_MODEL:return jsxRuntimeExports.jsx(PlaylistGridItem,{playlist:e});case USER_MODEL:return jsxRuntimeExports.jsx(UserGridItem,{user:e});default:return null}}const AntennaIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M12 7.5c.69 0 1.27.23 1.76.7s.74 1.07.74 1.8c0 1.05-.5 1.81-1.5 2.28V21h-2v-8.72c-1-.47-1.5-1.23-1.5-2.28 0-.73.26-1.33.74-1.8s1.07-.7 1.76-.7m4.69-2.2c1.25 1.25 1.92 2.81 2.01 4.7 0 1.8-.67 3.38-2.01 4.72L15.5 13.5c1-.91 1.5-2.08 1.5-3.5 0-1.33-.5-2.5-1.5-3.5l1.19-1.2M6.09 4.08C4.5 5.67 3.7 7.64 3.7 10s.8 4.3 2.39 5.89l-1.17 1.22C3 15.08 2 12.7 2 10s1-5.06 2.92-7.09l1.17 1.17m12.99-1.17C21 4.94 22 7.3 22 10c0 2.8-1 5.17-2.92 7.11l-1.17-1.22C19.5 14.3 20.3 12.33 20.3 10s-.8-4.33-2.39-5.92l1.17-1.17M7.31 5.3L8.5 6.5C7.5 7.42 7 8.58 7 10c0 1.33.5 2.5 1.5 3.5l-1.19 1.22C5.97 13.38 5.3 11.8 5.3 10c0-1.8.67-3.36 2.01-4.7z"}),"Radio");function ChannelHeading({channel:e,isNested:t,margin:s=t?"mb-16 md:mb-20":"mb-20 md:mb-40"}){const n=useShouldShowRadioButton();return e.config.hideTitle?null:t?jsxRuntimeExports.jsxs("div",{className:clsx("text-xl flex items-center gap-4",s),children:[jsxRuntimeExports.jsx(NestedChannelLink,{channel:e}),jsxRuntimeExports.jsx(KeyboardArrowRightIcon,{className:"mt-4"})]}):n&&e.genre?jsxRuntimeExports.jsxs("div",{className:clsx("flex gap-24 items-center justify-between",s),children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl flex-auto",children:e.name}),jsxRuntimeExports.jsx(Tooltip,{label:jsxRuntimeExports.jsx(Trans,{message:"Genre radio"}),children:jsxRuntimeExports.jsx(IconButton,{className:"flex-shrink-0",elementType:Link,to:getRadioLink(e.genre),children:jsxRuntimeExports.jsx(AntennaIcon,{})})})]}):jsxRuntimeExports.jsx("h1",{className:clsx("text-3xl",s),children:e.name})}function NestedChannelLink({channel:e}){const{filter:t}=useParams();return jsxRuntimeExports.jsx(Link,{className:"hover:underline outline-none focus-visible:underline",to:e.config.connectToGenreViaUrl&&t?`/channel/${e.slug}/${t}`:`/channel/${e.slug}`,children:e.name})}function ChannelContentGrid(e){return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(ChannelHeading,{...e}),e.isNested||e.channel.config.contentType!=="listAll"?jsxRuntimeExports.jsx(SimpleGrid,{...e}):jsxRuntimeExports.jsx(PaginatedGrid,{...e})]})}function SimpleGrid({channel:e}){var s;const t=((s=e.content)==null?void 0:s.data)||[];return jsxRuntimeExports.jsx(ContentGrid,{children:t.map(n=>jsxRuntimeExports.jsx(ChannelContentGridItem,{item:n,items:t},`${n.id}-${n.model_type}`))})}function PaginatedGrid({channel:e}){const t=usePaginatedChannelContent(e),s=t.items||[];return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(ContentGrid,{children:s.map(n=>jsxRuntimeExports.jsx(ChannelContentGridItem,{item:n,items:s},`${n.id}-${n.model_type}`))}),jsxRuntimeExports.jsx(InfiniteScrollSentinel,{query:t})]})}const stableObj={};function useTrackTableMeta(){const{meta:e}=reactExports.useContext(TableContext);return e||stableObj}function useIsTrackCued(e,t){return usePlayerStore(s=>{var n,i;return!((n=s.cuedMedia)!=null&&n.meta.id)||s.cuedMedia.meta.id!==e?!1:!!(!((i=s.cuedMedia)!=null&&i.groupId)&&!t||t&&s.cuedMedia.groupId===t)})}function useIsTrackPlaying(e,t){const s=useIsTrackCued(e,t),n=usePlayerStore(i=>i.status==="playing");return s&&n}function TogglePlaybackColumn({track:e,rowIndex:t,isHovered:s}){const{queueGroupId:n}=useTrackTableMeta(),i=useIsTrackPlaying(e.id,n),a=useIsTrackCued(e.id,n);return jsxRuntimeExports.jsx("div",{className:"w-24 h-24",children:s||i?jsxRuntimeExports.jsx(TogglePlaybackButton,{track:e,trackIndex:t,isPlaying:i}):jsxRuntimeExports.jsx("span",{className:clsx(a?"text-primary":"text-muted"),children:t+1})})}function TogglePlaybackButton({track:e,trackIndex:t,isPlaying:s}){const{trans:n}=useTrans(),i=usePlayerActions(),{data:a}=reactExports.useContext(TableContext),{queueGroupId:o}=useTrackTableMeta(),[l,u]=reactExports.useState(!1);return s?jsxRuntimeExports.jsx("button",{onPointerEnter:()=>u(!0),onPointerLeave:()=>u(!1),"aria-label":n(message("Pause :name",{values:{name:e.name}})),tabIndex:0,onClick:x=>{x.stopPropagation(),i.pause()},children:l?jsxRuntimeExports.jsx(PauseIcon,{}):jsxRuntimeExports.jsx(EqualizerImage,{})}):jsxRuntimeExports.jsx("button",{"aria-label":n(message("Play :name",{values:{name:e.name}})),tabIndex:0,onClick:async x=>{x.stopPropagation();const c=a.map(j=>trackToMediaItem(j,o));i.overrideQueueAndPlay(c,t)},children:jsxRuntimeExports.jsx(PlayArrowFilledIcon,{})})}function TrackNameColumn({track:e}){var a;const t=useIsMobileMediaQuery(),{hideTrackImage:s,queueGroupId:n}=useTrackTableMeta(),i=useIsTrackCued(e.id,n);return jsxRuntimeExports.jsx(NameWithAvatar,{image:s?void 0:getTrackImageSrc(e),label:e.name,avatarSize:t?"lg":"md",description:t?(a=e.artists)==null?void 0:a.map(o=>o.name).join(", "):void 0,labelClassName:clsx(i&&"text-primary",t&&"text-[15px] leading-6")})}function TableTrackContextDialog({children:e,...t}){const{selectedRows:s,data:n}=reactExports.useContext(TableContext),i=reactExports.useMemo(()=>s.map(a=>n.find(o=>o.id===a)).filter(a=>!!a),[s,n]);return jsxRuntimeExports.jsx(TrackContextDialog,{...t,tracks:i,children:e})}function TrackOptionsColumn({track:e,isHovered:t}){const s=useIsMobileMediaQuery();return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsxs(DialogTrigger,{type:"popover",children:[jsxRuntimeExports.jsx(IconButton,{size:s?"sm":"md",className:clsx(s?"ml-8 -mr-8 text-muted":"mr-8",!s&&!t&&"invisible"),children:s?jsxRuntimeExports.jsx(MoreVertIcon,{}):jsxRuntimeExports.jsx(MoreHorizIcon,{})}),jsxRuntimeExports.jsx(TrackContextDialog,{tracks:[e]})]}),!s&&jsxRuntimeExports.jsx(LikeIconButton,{size:"xs",likeable:e})]})}const columnConfig=[{key:"index",header:()=>jsxRuntimeExports.jsx("span",{children:"#"}),width:"w-1",padding:"pl-16 pr-22",align:"center",body:(e,t)=>t.isPlaceholder?jsxRuntimeExports.jsx(Skeleton,{size:"w-20 h-20",variant:"rect"}):jsxRuntimeExports.jsx(TogglePlaybackColumn,{track:e,rowIndex:t.index,isHovered:t.isHovered})},{key:"name",allowsSorting:!0,padding:"pr-16",width:"max-sm:w-5/6 max-sm:max-w-1",header:()=>jsxRuntimeExports.jsx(Trans,{message:"Title"}),body:(e,t)=>t.isPlaceholder?jsxRuntimeExports.jsx(NameWithAvatarPlaceholder,{showDescription:!1}):jsxRuntimeExports.jsx(TrackNameColumn,{track:e})},{key:"artist",header:()=>jsxRuntimeExports.jsx(Trans,{message:"Artist"}),body:(e,t)=>t.isPlaceholder?jsxRuntimeExports.jsx(Skeleton,{className:"leading-3 max-w-4/5"}):jsxRuntimeExports.jsx(ArtistLinks,{artists:e.artists})},{key:"album_name",allowsSorting:!0,header:()=>jsxRuntimeExports.jsx(Trans,{message:"Album"}),body:(e,t)=>t.isPlaceholder?jsxRuntimeExports.jsx(Skeleton,{className:"leading-3 max-w-4/5"}):e.album?jsxRuntimeExports.jsx(AlbumLink,{album:e.album}):null},{key:"added_at",sortingKey:"likes.created_at",allowsSorting:!0,width:"w-1",header:()=>jsxRuntimeExports.jsx(Trans,{message:"Date added"}),body:(e,t)=>t.isPlaceholder?jsxRuntimeExports.jsx(Skeleton,{className:"leading-3 max-w-4/5"}):jsxRuntimeExports.jsx(FormattedRelativeTime,{date:e.added_at})},{key:"options",width:"w-1",padding:"px-4",align:"end",header:()=>jsxRuntimeExports.jsx(Trans,{message:"Options"}),hideHeader:!0,body:(e,t)=>t.isPlaceholder?jsxRuntimeExports.jsx("div",{className:"flex justify-end",children:jsxRuntimeExports.jsx(Skeleton,{size:"w-20 h-20",variant:"rect"})}):jsxRuntimeExports.jsx(TrackOptionsColumn,{track:e,isHovered:t.isHovered})},{key:"duration",allowsSorting:!0,width:"w-1",className:"text-muted",header:()=>jsxRuntimeExports.jsx(ScheduleIcon,{}),body:(e,t)=>t.isPlaceholder?jsxRuntimeExports.jsx(Skeleton,{className:"leading-3"}):e.duration?jsxRuntimeExports.jsx(FormattedDuration,{ms:e.duration}):null},{key:"popularity",allowsSorting:!0,width:"w-90",className:"text-muted",header:()=>jsxRuntimeExports.jsx(TrendingUpIcon,{}),body:(e,t)=>t.isPlaceholder?jsxRuntimeExports.jsx(Skeleton,{className:"leading-3"}):jsxRuntimeExports.jsx("div",{className:"h-6 w-full relative bg-chip",children:jsxRuntimeExports.jsx("div",{style:{width:`${e.popularity||50}%`},className:"h-full w-0 absolute top-0 left-0 bg-black/30"})})}];function TrackTable({tracks:e,hideArtist:t=!1,hideAlbum:s=!1,hideHeaderRow:n=!1,hideTrackImage:i=!1,hidePopularity:a=!0,hideAddedAtColumn:o=!0,queueGroupId:l,contextDialog:u,renderRowAs:x,...c}){const j=usePlayerActions(),d=useIsMobileMediaQuery();n=n||!!d;const E=reactExports.useMemo(()=>d?columnConfig.filter(v=>v.key==="name"||v.key==="options"):columnConfig.filter(v=>!(v.key==="artist"&&t||v.key==="album_name"&&s||v.key==="popularity"&&a||v.key==="added_at"&&o)),[d,t,s,a,o]),y=reactExports.useMemo(()=>({queueGroupId:l,hideTrackImage:i}),[l,i]);return jsxRuntimeExports.jsx(Table,{closeOnInteractOutside:!0,hideHeaderRow:n,selectionStyle:"highlight",enableSelection:!d,selectRowOnContextMenu:!0,renderRowAs:x||TrackTableRowWithContextMenu,columns:E,data:e,meta:y,hideBorder:!!d,onAction:(v,p)=>{const f=e.map(R=>trackToMediaItem(R,l));j.overrideQueueAndPlay(f,p)},...c})}function TrackTableRowWithContextMenu({item:e,children:t,...s}){const n=jsxRuntimeExports.jsx("tr",{...s,children:t});return e.isPlaceholder?n:jsxRuntimeExports.jsxs(DialogTrigger,{type:"popover",triggerOnContextMenu:!0,placement:"bottom-start",children:[n,jsxRuntimeExports.jsx(TableTrackContextDialog,{})]})}function VirtualTableBody({renderRowAs:e,totalItems:t=0,query:s,hideBorder:n}){const{data:i}=reactExports.useContext(TableContext),a=Math.min(t-i.length,10);return t<91?jsxRuntimeExports.jsx(Body,{placeholderRowCount:a,renderRowAs:e,query:s,hideBorder:n}):jsxRuntimeExports.jsx(VirtualizedBody,{placeholderRowCount:a,renderRowAs:e,query:s,hideBorder:n})}function Body({renderRowAs:e,placeholderRowCount:t,query:s,hideBorder:n}){const{data:i}=reactExports.useContext(TableContext);return jsxRuntimeExports.jsxs("tbody",{children:[i.map((a,o)=>jsxRuntimeExports.jsx(TableRow,{item:a,index:o,renderAs:e,hideBorder:n},a.id)),jsxRuntimeExports.jsx(Sentinel,{dataCount:i.length,placeholderRowCount:t,query:s})]})}function VirtualizedBody({renderRowAs:e,placeholderRowCount:t,query:s}){var j,d;const{data:n}=reactExports.useContext(TableContext),i=reactExports.useRef(null),a=reactExports.useRef(null),o=reactExports.useRef(0);reactExports.useEffect(()=>{i.current&&(a.current=$62d8ded9296f3872$export$cfa2225e87938781(i.current),o.current=i.current.getBoundingClientRect().top+a.current.scrollTop)},[i]);const l=useVirtualizer({overscan:10,count:n.length,getScrollElement:()=>a.current,estimateSize:()=>48,observeElementOffset:(E,y)=>observeElementOffset(E,v=>{y(v-o.current)})}),u=l.getVirtualItems(),x=u.length>0&&((j=u==null?void 0:u[0])==null?void 0:j.start)||0,c=u.length>0?l.getTotalSize()-(((d=u==null?void 0:u[u.length-1])==null?void 0:d.end)||0):0;return jsxRuntimeExports.jsxs("tbody",{ref:i,children:[x>0&&jsxRuntimeExports.jsx("tr",{children:jsxRuntimeExports.jsx("td",{style:{height:`${x}px`,border:"none"}})}),u.map(E=>{const y=n[E.index];return jsxRuntimeExports.jsx(TableRow,{item:y,index:E.index,renderAs:e},y.id)}),jsxRuntimeExports.jsx(Sentinel,{dataCount:l.range.endIndex,placeholderRowCount:t,query:s}),c>0&&jsxRuntimeExports.jsx("tr",{children:jsxRuntimeExports.jsx("td",{style:{height:`${c}px`,border:"none"}})})]})}function Sentinel({dataCount:e,placeholderRowCount:t,renderRowAs:s,query:n}){return t<=0?null:jsxRuntimeExports.jsx(InfiniteScrollSentinel,{query:n,renderSentinelAs:"tr",children:[...new Array(t).keys()].map((i,a)=>{const o=`placeholder-${i}`;return jsxRuntimeExports.jsx(TableRow,{item:{id:o,isPlaceholder:!0},index:e+a,renderAs:s},o)})})}function ChannelTrackTable(e){return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(ChannelHeading,{...e}),e.isNested?jsxRuntimeExports.jsx(SimpleTable,{...e}):jsxRuntimeExports.jsx(PaginatedTable,{...e})]})}function SimpleTable({channel:e}){var t;return jsxRuntimeExports.jsx(TrackTable,{tracks:((t=e.content)==null?void 0:t.data)||[],enableSorting:!1})}function PaginatedTable({channel:e}){const t=usePaginatedChannelContent(e),s=e.content&&"total"in e.content?e.content.total:void 0;return jsxRuntimeExports.jsx(TrackTable,{enableSorting:!1,tracks:t.items,tableBody:jsxRuntimeExports.jsx(VirtualTableBody,{query:t,totalItems:s})})}function queryKey(e){return["tracks",+e,"wave-data"]}function invalidateWaveData(e){queryClient.invalidateQueries(queryKey(e))}function useTrackWaveData(e,{enabled:t}={}){return useQuery(queryKey(e),()=>fetchWaveData(e),{onError:s=>showHttpErrorToast(s),enabled:t})}function fetchWaveData(e){return apiClient.get(`tracks/${e}/wave`).then(t=>t.data)}function drawWaveform(e,t,s){const n=t.getContext("2d");n&&(n.clearRect(0,0,t.width,t.height),n.fillStyle=s,n.globalAlpha=.5,e.forEach(i=>{const a=.55*i[3];n.fillRect(i[0],i[1]+i[3]+1,i[2],a)}),n.fillStyle=s,n.globalAlpha=1,e.forEach(i=>{n.fillRect(i[0],i[1],i[2],i[3])}))}function useBaseSeekbar(){const[e,t]=reactExports.useState(0),s=usePlayerActions(),n=reactExports.useRef(),i=reactExports.useCallback(()=>{clearInterval(n.current),n.current=void 0},[]),a=reactExports.useCallback(()=>{i(),t(Math.round(s.getCurrentTime())),n.current=setInterval(()=>{t(l=>{const u=l+1;return u>s.getState().mediaDuration?(i(),l):u})},1e3)},[s,i]),o=reactExports.useMemo(()=>({onPlay:()=>{a()},onPause:()=>{i()},onSeek:l=>t(l),onPlaybackEnd:()=>i()}),[a,i]);return reactExports.useEffect(()=>i,[i]),{time:e,setTime:t,listeners:o,startTimer:a,stopTimer:i,player:s}}function useTrackSeekbar(e,t){const s=usePlayerStore(x=>{var c;return((c=x.cuedMedia)==null?void 0:c.id)===e.id&&x.mediaDuration?x.mediaDuration:(e.duration||0)/1e3}),{player:n,startTimer:i,stopTimer:a,listeners:o,time:l,setTime:u}=useBaseSeekbar();return reactExports.useEffect(()=>{var j;let x;((j=n.getState().cuedMedia)==null?void 0:j.id)===e.id&&(x=n.subscribe(o),n.getState().status==="playing"&&i());const c=n.subscribe({onCued:d=>{(d==null?void 0:d.id)===e.id?x=n.subscribe(o):(x==null||x(),a(),u(0))}});return()=>{c==null||c(),x==null||x()}},[n,e,o,u,a,i]),{duration:s,minValue:0,maxValue:s,value:l,onPointerDown:()=>{a(),n.pause(),n.cue(trackToMediaItem(e))},onChange:x=>{u(x),n.seek(x)},onChangeEnd:()=>{if(t!=null&&t.length){const x=t==null?void 0:t.findIndex(c=>c.id===e.id);n.overrideQueueAndPlay(tracksToMediaItems(t),x)}else n.play(e?trackToMediaItem(e):void 0)}}}const CommentBarContext=reactExports.createContext(null);function CommentBarContextProvider({children:e,disableCommenting:t=!1}){const[s,n]=reactExports.useState(!1),i=reactExports.useRef(null),a=reactExports.useRef(0),o=reactExports.useMemo(()=>({newCommentInputRef:i,newCommentPositionRef:a,markerIsVisible:s,setMarkerIsVisible:n,disableCommenting:t}),[s,t]);return jsxRuntimeExports.jsx(CommentBarContext.Provider,{value:o,children:e})}function CommentBar({comments:e,track:t}){const{user:s,hasPermission:n}=useAuth(),{newCommentInputRef:i,newCommentPositionRef:a,markerIsVisible:o,setMarkerIsVisible:l,...u}=reactExports.useContext(CommentBarContext),x=u.disableCommenting||!n("comments.create"),{domProps:c,groupId:j,trackRef:d,getThumbPercent:E}=useSlider({onChange:()=>{l(!0),a.current=E(0)*100},onChangeEnd:()=>{var y;(y=i.current)==null||y.focus()}});return $e0b6e0b68ec7f50f$export$872b660ac5a1ff98({ref:d,onInteractOutside:y=>{var v;(v=i.current)!=null&&v.contains(y.target)||l(!1)}}),jsxRuntimeExports.jsxs("div",{className:clsx("absolute top-48 left-0 h-26 w-full isolate",!x&&"cursor-pointer"),ref:d,...x?{}:c,id:j,children:[o?jsxRuntimeExports.jsx("div",{className:"absolute top-0 left-0 z-20 overflow-hidden w-26 h-26 shadow-md -translate-x-1/2 cursor-move",style:{left:`${E(0)*100}%`},children:jsxRuntimeExports.jsx(Avatar,{src:s==null?void 0:s.avatar,size:"w-full h-full"})}):null,e.map(y=>y.user?jsxRuntimeExports.jsxs(DialogTrigger,{type:"popover",triggerOnHover:!0,children:[jsxRuntimeExports.jsx("div",{style:{left:`${Math.min(99,y.position||0)}%`},className:clsx("transition-opacity duration-300 ease-in-out absolute top-0 -translate-x-1/2 cursor-pointer",o?"opacity-40":"opacity-100"),children:jsxRuntimeExports.jsx("div",{className:"bg-cover w-16 h-16 rounded shadow bg-chip",style:{backgroundImage:`url(${getUserImage(y.user)})`}})}),jsxRuntimeExports.jsx(CommentDialog,{comment:y})]},y.id):null)]})}function CommentDialog({comment:e}){return jsxRuntimeExports.jsx(Dialog,{size:"w-auto",children:jsxRuntimeExports.jsx(DialogBody,{padding:"p-8",children:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-10",children:[e.user&&jsxRuntimeExports.jsx("div",{className:"text-primary",children:e.user.display_name}),jsxRuntimeExports.jsx("div",{children:e.content})]})})})}const durationClassName="text-[11px] absolute bottom-32 p-3 rounded text-white font-semibold z-30 pointer-events-none bg-black/80";function Waveform({track:e,queue:t,className:s}){const n=reactExports.useRef(null),i=reactExports.useRef(null),a=reactExports.useRef(null),[o,l]=reactExports.useState(!1),[u,x]=reactExports.useState(!1),{data:c}=useTrackWaveData(e.id,{enabled:o}),j=useThemeSelector();reactExports.useEffect(()=>{const b=new IntersectionObserver(T=>{T.forEach(P=>{P.isIntersecting&&P.target===n.current&&(l(!0),b.disconnect())})},{root:document.body});return n.current&&b.observe(n.current),()=>b.disconnect()},[]),reactExports.useEffect(()=>{i.current&&(c!=null&&c.waveData)&&a.current&&(drawWaveform(c.waveData,i.current,"#666"),drawWaveform(c.waveData,a.current,themeValueToHex(j.selectedTheme.colors["--be-primary"])),x(!0))},[c,j.selectedTheme]);const{value:d,onChange:E,duration:y,...v}=useTrackSeekbar(e,t),{domProps:p,groupId:f,thumbIds:R,trackRef:h,getThumbPercent:g}=useSlider({...v,value:[d],onChange:([b])=>E(b)});return jsxRuntimeExports.jsx(AnimatePresence,{mode:"wait",children:jsxRuntimeExports.jsxs("section",{className:"relative max-w-full",children:[jsxRuntimeExports.jsxs("div",{id:f,role:"group",ref:n,className:clsx("relative isolate h-70 cursor-pointer overflow-hidden transition-opacity duration-200 ease-in",u?"opacity-100":"opacity-0",s),children:[jsxRuntimeExports.jsx("output",{className:clsx(durationClassName,"left-0"),htmlFor:R[0],"aria-live":"off",children:d?jsxRuntimeExports.jsx(FormattedDuration,{seconds:d}):"0:00"}),jsxRuntimeExports.jsxs("div",{...p,ref:h,children:[jsxRuntimeExports.jsx("canvas",{ref:i,width:WAVE_WIDTH,height:WAVE_HEIGHT+25}),jsxRuntimeExports.jsx("div",{className:"absolute top-0 left-0 z-20 overflow-hidden w-0",style:{width:`${g(0)*100}%`},children:jsxRuntimeExports.jsx("canvas",{ref:a,width:WAVE_WIDTH,height:WAVE_HEIGHT+25})})]},"wave"),jsxRuntimeExports.jsx("div",{className:clsx(durationClassName,"right-0"),children:jsxRuntimeExports.jsx(FormattedDuration,{seconds:y})})]}),(c==null?void 0:c.comments)&&jsxRuntimeExports.jsx(CommentBar,{comments:c.comments,track:e})]})})}function TrackSeekbar({track:e,queue:t,className:s}){const{duration:n,...i}=useTrackSeekbar(e,t);return jsxRuntimeExports.jsxs("div",{className:clsx("flex items-center gap-12",s),children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-muted flex-shrink-0 min-w-40 text-right",children:i.value?jsxRuntimeExports.jsx(FormattedDuration,{seconds:i.value}):"0:00"}),jsxRuntimeExports.jsx(Slider,{trackColor:"neutral",thumbSize:"w-14 h-14",showThumbOnHoverOnly:!0,className:"flex-auto",width:"w-auto",...i}),jsxRuntimeExports.jsx("div",{className:"text-xs text-muted flex-shrink-0 min-w-40",children:jsxRuntimeExports.jsx(FormattedDuration,{seconds:n})})]})}function trackIsLocallyUploaded(e){return(e==null?void 0:e.url)!=null&&(e.url.startsWith("storage")||e.url.includes("storage/track_media"))}function useCreateComment(){return useMutation(e=>createComment(e),{onSuccess:(e,t)=>{toast(message("Comment posted")),queryClient.invalidateQueries(["comment",`${t.commentable.id}-${t.commentable.model_type}`])},onError:e=>showHttpErrorToast(e)})}function createComment({commentable:e,content:t,inReplyTo:s,...n}){const i={commentable_id:e.id,commentable_type:e.model_type,content:t,inReplyTo:s,...n};return apiClient.post("comment",i).then(a=>a.data)}function NewCommentForm({commentable:e,inReplyTo:t,onSuccess:s,className:n,autoFocus:i,payload:a,...o}){const{trans:l}=useTrans(),{user:u}=useAuth(),x=useCreateComment(),c=$df56164dff5785e2$export$4338b53315abf666(o.inputRef);return jsxRuntimeExports.jsxs("form",{className:clsx("py-6",n),onSubmit:j=>{var d,E;j.preventDefault(),(d=c.current)!=null&&d.value&&!x.isLoading&&x.mutate({...a,commentable:e,content:(E=c.current)==null?void 0:E.value,inReplyTo:t},{onSuccess:()=>{c.current&&(c.current.value=""),s==null||s()}})},children:[jsxRuntimeExports.jsx(TextField,{inputRef:c,autoFocus:i,startAdornment:jsxRuntimeExports.jsx(Avatar,{src:u==null?void 0:u.avatar,label:u==null?void 0:u.display_name}),placeholder:l(message("Write a reply")),minLength:3}),jsxRuntimeExports.jsx("button",{type:"submit",className:"sr-only",disabled:x.isLoading,children:jsxRuntimeExports.jsx(Trans,{message:"Submit"})})]})}function CommentBarNewCommentForm({commentable:e,className:t}){const{isLoggedIn:s}=useAuth(),{newCommentInputRef:n,newCommentPositionRef:i,setMarkerIsVisible:a}=reactExports.useContext(CommentBarContext);return s?jsxRuntimeExports.jsx(NewCommentForm,{inputRef:n,className:t,commentable:e,payload:{position:i.current},onSuccess:()=>{a(!1),invalidateWaveData(e.id)}}):null}function LikeButton({likeable:e,radius:t="rounded-full",disabled:s,...n}){const i=useAuthClickCapture(),a=useAddItemsToLibrary(),o=useRemoveItemsFromLibrary(),l=useLibraryStore(c=>c.has(e)),u=a.isLoading||o.isLoading,x=getLabels(e);return l?jsxRuntimeExports.jsx(Button,{...n,variant:"outline",radius:t,startIcon:jsxRuntimeExports.jsx(FavoriteIcon,{className:"text-primary"}),disabled:s||u,onClickCapture:i,onClick:()=>{o.mutate({likeables:[e]})},children:jsxRuntimeExports.jsx(Trans,{...x.removeLike})}):jsxRuntimeExports.jsx(Button,{...n,variant:"outline",radius:t,startIcon:jsxRuntimeExports.jsx(FavoriteBorderIcon,{}),disabled:s||u,onClickCapture:i,onClick:()=>{a.mutate({likeables:[e]})},children:jsxRuntimeExports.jsx(Trans,{...x.like})})}function getLabels(e){switch(e.model_type){case"artist":return{like:message("Follow"),removeLike:message("Following")};default:return{like:message("Like"),removeLike:message("Liked")}}}function RepostButton({item:e,className:t,size:s="xs",radius:n,disabled:i}){const a=useAuthClickCapture(),{player:o}=useSettings(),l=useToggleRepost(),u=useRepostsStore(x=>x.has(e));return o!=null&&o.enable_repost?jsxRuntimeExports.jsx(Button,{className:t,variant:"outline",size:s,radius:n,startIcon:jsxRuntimeExports.jsx(RepeatIcon,{className:clsx(u&&"text-primary")}),disabled:i||l.isLoading,onClickCapture:a,onClick:()=>l.mutate({repostable:e}),children:u?jsxRuntimeExports.jsx(Trans,{message:"Reposted"}):jsxRuntimeExports.jsx(Trans,{message:"Repost"})}):null}function MediaItemStats({item:e,className:t,showPlays:s=!0}){return jsxRuntimeExports.jsxs("div",{className:clsx("flex items-center gap-20 text-sm text-muted",t),children:[s&&jsxRuntimeExports.jsx(PlayCount,{item:e}),jsxRuntimeExports.jsx(LikesCount,{item:e}),e.model_type!=="artist"&&jsxRuntimeExports.jsx(RepostsCount,{item:e})]})}function PlayCount({item:e}){if(!e.plays)return null;const t=jsxRuntimeExports.jsx(FormattedNumber,{compactDisplay:"short",notation:"compact",value:e.plays});return jsxRuntimeExports.jsx(Tooltip,{label:jsxRuntimeExports.jsx(Trans,{message:":count plays",values:{count:t}}),children:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(PlayArrowFilledIcon,{size:"xs",className:"mr-4"}),t]})})}function LikesCount({item:e}){if(!e.likes_count)return null;const t=jsxRuntimeExports.jsx(FormattedNumber,{value:e.likes_count});return jsxRuntimeExports.jsx(Tooltip,{label:jsxRuntimeExports.jsx(Trans,{message:":count likes",values:{count:t}}),children:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(FavoriteIcon,{size:"xs",className:"mr-4"}),t]})})}function RepostsCount({item:e}){if(!e.reposts_count)return null;const t=jsxRuntimeExports.jsx(FormattedNumber,{value:e.reposts_count});return jsxRuntimeExports.jsx(Tooltip,{label:jsxRuntimeExports.jsx(Trans,{message:":count reposts",values:{count:t}}),children:jsxRuntimeExports.jsxs("div",{className:"hidden @[566px]:block",children:[jsxRuntimeExports.jsx(RepeatIcon,{size:"xs",className:"mr-4"}),t]})})}function TrackActionsBar({item:e,managesItem:t,buttonClassName:s,buttonGap:n="mr-8",buttonSize:i="xs",buttonRadius:a="rounded",children:o,className:l}){const u=useIsMobileMediaQuery();return jsxRuntimeExports.jsxs("div",{className:clsx("flex items-center gap-24 justify-center md:justify-between overflow-hidden @container",l),children:[jsxRuntimeExports.jsxs("div",{children:[o,!u&&jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(LikeButton,{size:i,likeable:e,className:clsx(n,s),radius:a,disabled:t}),jsxRuntimeExports.jsx(RepostButton,{item:e,size:i,radius:a,disabled:t,className:clsx(n,s,"hidden @[840px]:inline-flex")})]}),!u&&jsxRuntimeExports.jsxs(DialogTrigger,{type:"modal",children:[jsxRuntimeExports.jsx(Button,{size:i,variant:"outline",startIcon:jsxRuntimeExports.jsx(ShareIcon,{}),className:clsx(n,s,"hidden @[660px]:inline-flex"),radius:a,children:jsxRuntimeExports.jsx(Trans,{message:"Share"})}),jsxRuntimeExports.jsx(ShareMediaDialog,{item:e})]}),jsxRuntimeExports.jsxs(DialogTrigger,{type:"popover",children:[jsxRuntimeExports.jsx(Button,{variant:"outline",size:i,startIcon:jsxRuntimeExports.jsx(MoreHorizIcon,{}),className:clsx(n,s),radius:a,children:jsxRuntimeExports.jsx(Trans,{message:"More"})}),jsxRuntimeExports.jsx(MoreDialog,{item:e})]})]}),!u&&jsxRuntimeExports.jsx(MediaItemStats,{item:e})]})}function MoreDialog({item:e}){return e.model_type==="track"?jsxRuntimeExports.jsx(TrackContextDialog,{tracks:[e]}):jsxRuntimeExports.jsx(AlbumContextDialog,{album:e})}const TrackListItem=reactExports.memo(({track:e,queue:t,reposter:s,className:n,hideArtwork:i=!1,hideActions:a=!1,linksInNewTab:o=!1})=>{var j;const{player:l}=useSettings(),u=useIsMobileMediaQuery();i=i||!!u;const{managesTrack:x}=useTrackPermissions([e]),c=(l==null?void 0:l.seekbar_type)==="waveform"&&trackIsLocallyUploaded(e);return jsxRuntimeExports.jsxs("div",{className:clsx("overflow-hidden",!i&&"flex gap-24",n),children:[!i&&jsxRuntimeExports.jsx(TrackImage,{track:e,className:"flex-shrink-0 rounded",size:"w-184 h-184"}),jsxRuntimeExports.jsxs("div",{className:"flex-auto min-w-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-14",children:[jsxRuntimeExports.jsx(PlaybackToggleButton,{track:e,tracks:t,buttonType:"icon",color:"primary",variant:"flat",radius:"rounded-full",equalizerColor:"white"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"text-sm text-muted flex items-center gap-6",children:[jsxRuntimeExports.jsx(ArtistLinks,{artists:e.artists,target:o?"_blank":void 0}),s&&jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(RepeatIcon,{size:"xs"}),jsxRuntimeExports.jsx(UserProfileLink,{user:s,target:o?"_blank":void 0})]})]}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(TrackLink,{track:e,target:o?"_blank":void 0})})]}),jsxRuntimeExports.jsxs("div",{className:"ml-auto text-sm",children:[jsxRuntimeExports.jsx(FormattedRelativeTime,{date:e.created_at}),((j=e.genres)==null?void 0:j.length)&&jsxRuntimeExports.jsx(Chip,{className:"mt-6 w-max",size:"xs",children:jsxRuntimeExports.jsx(GenreLink,{genre:e.genres[0],target:o?"_blank":void 0})})]})]}),jsxRuntimeExports.jsx("div",{className:"mt-20",children:c?jsxRuntimeExports.jsx(CommentBarContextProvider,{disableCommenting:a,children:jsxRuntimeExports.jsx(WaveformWithComments,{track:e,queue:t})}):jsxRuntimeExports.jsx(TrackSeekbar,{track:e,queue:t})}),!a&&jsxRuntimeExports.jsx(TrackActionsBar,{item:e,managesItem:x,className:"mt-20"})]})]})});function WaveformWithComments({track:e,queue:t}){const{markerIsVisible:s}=reactExports.useContext(CommentBarContext);return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(Waveform,{track:e,queue:t}),jsxRuntimeExports.jsx(AnimatePresence,{mode:"wait",children:s&&jsxRuntimeExports.jsx(CommentBarNewCommentForm,{className:"mt-28 mb-8",commentable:e})})]})}function TrackList({tracks:e,query:t}){const s=useIsMobileMediaQuery();return e||(e=t?t.items:[]),s?t?jsxRuntimeExports.jsx(TrackTable,{tracks:e,tableBody:jsxRuntimeExports.jsx(VirtualTableBody,{query:t})}):jsxRuntimeExports.jsx(TrackTable,{tracks:e}):jsxRuntimeExports.jsxs("div",{children:[e.map(n=>jsxRuntimeExports.jsx(TrackListItem,{queue:e,track:n,className:"mb-40"},n.id)),t&&jsxRuntimeExports.jsx(InfiniteScrollSentinel,{query:t})]})}function ChannelTrackList(e){var t;return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(ChannelHeading,{...e}),e.isNested?jsxRuntimeExports.jsx(TrackList,{tracks:(t=e.channel.content)==null?void 0:t.data}):jsxRuntimeExports.jsx(PaginatedList,{...e})]})}function PaginatedList({channel:e}){const t=usePaginatedChannelContent(e);return jsxRuntimeExports.jsx(TrackList,{query:t})}var functionDebounce=debounce;function debounce(e,t,s){var n=null,i=null,a=function(){n&&(clearTimeout(n),i=null,n=null)},o=function(){var u=i;a(),u&&u()},l=function(){if(!t)return e.apply(this,arguments);var u=this,x=arguments,c=s&&!n;if(a(),i=function(){e.apply(u,x)},n=setTimeout(function(){if(n=null,!c){var j=i;return i=null,j()}},t),c)return i()};return l.cancel=a,l.flush=o,l}function ChannelContentCarousel(e){var c;const{channel:t}=e,s=reactExports.useRef(null),n=reactExports.useRef(0),[i,a]=reactExports.useState(!1),[o,l]=reactExports.useState(!0),u=reactExports.useCallback(()=>{const j=s.current;j&&n.current&&(a(j.scrollLeft>0),l(j.scrollWidth-j.scrollLeft!==j.clientWidth))},[]);reactExports.useEffect(()=>{const j=s.current,d=functionDebounce(()=>u(),100);return j&&j.addEventListener("scroll",d),()=>j==null?void 0:j.removeEventListener("scroll",d)},[u]),reactExports.useLayoutEffect(()=>{const j=s.current;if(j){const d=j.children.item(0),E=new ResizeObserver(y=>{n.current=y[0].contentRect.width,u()});return d&&E.observe(d),()=>E.unobserve(j)}},[u]);const x=()=>n.current*(3-1);return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between gap-24 mb-14",children:[jsxRuntimeExports.jsx(ChannelHeading,{...e,margin:"mb-4"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(IconButton,{disabled:!i,onClick:()=>{s.current&&s.current.scrollBy({left:-x()})},children:jsxRuntimeExports.jsx(KeyboardArrowLeftIcon,{})}),jsxRuntimeExports.jsx(IconButton,{disabled:!o,onClick:()=>{s.current&&s.current.scrollBy({left:x()})},children:jsxRuntimeExports.jsx(KeyboardArrowRightIcon,{})})]})]}),jsxRuntimeExports.jsx("div",{ref:s,className:"content-carousel content-grid relative w-full grid grid-flow-col grid-rows-[auto] overflow-x-auto overflow-y-hidden gap-24 snap-always snap-x snap-mandatory hidden-scrollbar scroll-smooth",children:(c=t.content)==null?void 0:c.data.map(j=>{var d;return jsxRuntimeExports.jsx(ChannelContentGridItem,{item:j,items:(d=t.content)==null?void 0:d.data},`${j.id}-${j.model_type}`)})})]})}function ChannelContent(e){const{channel:t,isNested:s}=e,n=t.config.contentModel,i=t.config.layout;return t.content?n===TRACK_MODEL&&i==="trackList"?jsxRuntimeExports.jsx(ChannelTrackList,{...e}):n===TRACK_MODEL&&i==="trackTable"?jsxRuntimeExports.jsx(ChannelTrackTable,{...e}):n===CHANNEL_MODEL?jsxRuntimeExports.jsx(NestedChannels,{...e}):t.config.carouselWhenNested&&s?jsxRuntimeExports.jsx(ChannelContentCarousel,{...e}):jsxRuntimeExports.jsx(ChannelContentGrid,{...e}):null}function NestedChannels({channel:e}){var t;return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(ChannelHeading,{channel:e}),(t=e.content)==null?void 0:t.data.map(s=>jsxRuntimeExports.jsx("div",{className:"mb-50",children:jsxRuntimeExports.jsx(ChannelContent,{channel:s,isNested:!0})},s.id))]})}function AdHost({slot:e,className:t}){var a;const s=useSettings(),{isSubscribed:n}=useAuth(),i=reactExports.useMemo(()=>dotObject.pick(`ads.${e}`,s),[e,s]);return(a=s.ads)!=null&&a.disable||n||!i?null:jsxRuntimeExports.jsx(InvariantAd,{className:t,slot:e,adCode:i})}const InvariantAd=reactExports.memo(({slot:e,adCode:t,className:s})=>{const n=reactExports.useRef(null),i=reactExports.useId();return reactExports.useEffect(()=>(n.current&&loadAdScripts(t,n.current).then(()=>{executeAdJavascript(t,i)}),()=>{delete window.google_ad_modifications}),[t,i]),jsxRuntimeExports.jsx("div",{ref:n,id:i,className:clsx("ad-host flex items-center justify-center w-full max-w-full overflow-hidden min-h-90 max-h-[600px]",`${e.replace(/\./g,"-")}-host`,s),dangerouslySetInnerHTML:{__html:getAdHtml(t)}})},()=>!1);function getAdHtml(e){return e==null?void 0:e.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").trim()}function loadAdScripts(e,t){const s=[],n=/<script.*?src=['"](.*?)['"]/g;let i;for(;i=n.exec(e);)i[1]&&s.push(lazyLoader.loadAsset(i[1],{type:"js",parentEl:t}));return Promise.all(s)}function executeAdJavascript(adCode,id){const pattern=/<script\b[^>]*>([\s\S]*?)<\/script>/g;let content;for(;content=pattern.exec(adCode);)if(content[1]){const r=`var d = document.createElement('div'); d.innerHTML = $1; document.getElementById('${id}').appendChild(d.firstChild);`,toEval=content[1].replace(/document.write\((.+?)\);/,r);eval(toEval)}}function ChannelPage({slugOrId:e}){const t=useChannel(e);return t.data?jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(Helmet,{tags:t.data.seo}),jsxRuntimeExports.jsxs("div",{className:"pb-24",children:[jsxRuntimeExports.jsx(AdHost,{slot:"general_top",className:"mb-34"}),jsxRuntimeExports.jsx(ChannelContent,{channel:t.data.channel},t.data.channel.id),jsxRuntimeExports.jsx(AdHost,{slot:"general_bottom",className:"mt-34"})]})]}):jsxRuntimeExports.jsx(PageStatus,{query:t,loaderClassName:"absolute inset-0 m-auto"})}const endpoint=e=>{var s,n,i,a,o;const t=((n=(s=e.artists)==null?void 0:s[0])==null?void 0:n.name)||((o=(a=(i=e.album)==null?void 0:i.artists)==null?void 0:a[0])==null?void 0:o.name);return`search/audio/${e.id}/${doubleEncode(t)}/${doubleEncode(e.name)}`};async function findYoutubeVideosForTrack(e){const t={queryKey:[endpoint(e)],queryFn:async()=>findMatch(e),staleTime:1/0},s=queryClient.getQueryData(t.queryKey)??await queryClient.fetchQuery(t);return(s==null?void 0:s.results)||[]}function findMatch(e){return apiClient.get(endpoint(e)).then(t=>t.data)}function doubleEncode(e){return encodeURIComponent(encodeURIComponent(e))}const usePlayerOverlayStore=react()(immer((e,t)=>({isMaximized:!1,isQueueOpen:!1,toggle:()=>{e(s=>{s.isMaximized=!s.isMaximized})},toggleQueue:()=>{e(s=>{s.isQueueOpen=!s.isQueueOpen})}}))),playerOverlayState=usePlayerOverlayStore.getState(),trackPlays=new Set;let playbackStartedViaGesture=!1;const failedVideoId=" ",failedVideoIds=new Set;let tracksSkippedDueToError=0;async function resolveSrc(e){var n;const t=await findYoutubeVideosForTrack(e.meta),s=(n=t==null?void 0:t.find(i=>!failedVideoIds.has(`${i.id}`)))==null?void 0:n.id;return{...e,src:s||failedVideoId}}function setMediaSessionMetadata(e){var t,s,n;if("mediaSession"in navigator){const i=e.meta,a=i.image||((t=i.album)==null?void 0:t.image);navigator.mediaSession.metadata=new MediaMetadata({title:i.name,artist:(s=i.artists)==null?void 0:s[0].name,album:(n=i.album)==null?void 0:n.name,artwork:a?[{src:a,sizes:"300x300",type:"image/jpg"}]:void 0})}}var w,I;const playerStoreOptions={defaultVolume:(w=getBootstrapData().settings.player)==null?void 0:w.default_volume,setMediaSessionMetadata,youtube:{srcResolver:resolveSrc,suggestedQuality:(I=getBootstrapData().settings.youtube)==null?void 0:I.suggested_quality,onStateChange:e=>{e.data===YT.PlayerState.PLAYING&&(tracksSkippedDueToError=0)}},onBeforePlay:()=>{var s;const e=getBootstrapData().settings.player;if(!userHasPlayPermission())return toast.danger(message("Your current plan does not allow music playback.")),{preventPlayback:!0};!playbackStartedViaGesture&&((s=e==null?void 0:e.mobile)!=null&&s.auto_open_overlay)&&window.matchMedia("(max-width: 768px)").matches&&(playerOverlayState.toggle(),playbackStartedViaGesture=!0)},loadMoreMediaItems:async e=>{if(e!=null&&e.groupId){const t=await loadMediaItemTracks(e.groupId,e.meta);return tracksToMediaItems(t)}},listeners:{onCued:e=>{var i;if(!e)return;const t=getBootstrapData().settings.branding.site_name;let s=`${e.meta.name}`;const n=(i=e.meta.artists)==null?void 0:i[0].name;n?s=`${s} - ${n} - ${t}`:s=`${s} - ${t}`,document.title=s},onPlay:e=>{e&&!trackPlays.has(e.meta.id)&&(trackPlays.add(e.meta.id),apiClient.post(`track/plays/${e.meta.id}/log`,{queueId:e.groupId}))},onPlaybackEnd:e=>{e&&trackPlays.delete(e.meta.id)},onError:async(e,t)=>{var s,n,i,a;if(((s=t==null?void 0:t.provider)==null?void 0:s.name)==="youtube"){const o=t.provider;logYoutubeError(e);const l=o.getYoutubeId();l&&failedVideoIds.add(`${l}`);const u=o.cuedMedia?await resolveSrc(o.cuedMedia):null;u!=null&&u.src&&(u==null?void 0:u.src)!==failedVideoId?(await o.cueYoutubeVideo(u),(n=o.youtube)==null||n.playVideo()):(tracksSkippedDueToError++,tracksSkippedDueToError<=2&&((a=(i=o.listeners).onPlaybackEnd)==null||a.call(i)))}else tracksSkippedDueToError=0}},onDestroy:()=>{tracksSkippedDueToError=0}};function logYoutubeError(e){var s;const t=(s=e==null?void 0:e.target)==null?void 0:s.getVideoUrl();!e||!t||t.endsWith("%20")||apiClient.post("youtube/log-client-error",{code:e.data,videoUrl:e.target.getVideoUrl()})}function userHasPlayPermission(){const e=getBootstrapData().user,t=getBootstrapData().guest_role,s=(e==null?void 0:e.permissions)||(t==null?void 0:t.permissions);return(s==null?void 0:s.find(n=>n.name==="music.play"))!=null}const menuItemClassName=e=>clsx("h-44 px-12 mx-12 hover:bg-hover rounded-lg",e&&"text-primary");function Sidenav({className:e}){return jsxRuntimeExports.jsxs("div",{className:clsx("border-r py-12 bg-alt overflow-y-auto",e),children:[jsxRuntimeExports.jsx(Logo,{}),jsxRuntimeExports.jsx(CustomMenu,{className:"mt-24 items-stretch",menu:"sidebar-primary",orientation:"vertical",gap:"gap-none",iconClassName:"text-muted",itemClassName:({isActive:t})=>menuItemClassName(t)}),jsxRuntimeExports.jsxs("div",{className:"mt-48",children:[jsxRuntimeExports.jsx(SectionTitle,{children:jsxRuntimeExports.jsx(Trans,{message:"Your Music"})}),jsxRuntimeExports.jsx(CustomMenu,{className:"mt-12 text-sm items-stretch",menu:"sidebar-secondary",orientation:"vertical",gap:"gap-none",iconClassName:"text-muted",itemClassName:({isActive:t})=>menuItemClassName(t)}),jsxRuntimeExports.jsx(PlaylistSection,{})]})]})}function SectionTitle({children:e}){return jsxRuntimeExports.jsx("div",{className:"uppercase text-xs font-semibold text-muted mb-8 mx-24",children:e})}function Logo(){const{branding:e}=useSettings(),{trans:t}=useTrans(),n=useIsDarkMode()?e.logo_light:e.logo_dark;return jsxRuntimeExports.jsx(Link,{to:"/",className:"block flex-shrink-0 mx-18","aria-label":t({message:"Go to homepage"}),children:jsxRuntimeExports.jsx("img",{className:"block w-auto h-56 max-w-[188px]",src:n,alt:t({message:"Site logo"})})})}function PlaylistSection(){var n;const{data:e}=useAuthUserPlaylists(),t=useNavigate(),s=useAuthClickCapture();return jsxRuntimeExports.jsxs("div",{className:"mt-40",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between mr-24",children:[jsxRuntimeExports.jsx(SectionTitle,{children:jsxRuntimeExports.jsx(Trans,{message:"Playlists"})}),jsxRuntimeExports.jsxs(DialogTrigger,{type:"modal",onClose:i=>{i&&t(getPlaylistLink(i))},children:[jsxRuntimeExports.jsx(IconButton,{className:"flex-shrink-0 text-muted",onClickCapture:s,children:jsxRuntimeExports.jsx(PlaylistAddIcon,{})}),jsxRuntimeExports.jsx(CreatePlaylistDialog,{})]})]}),(n=e==null?void 0:e.playlists)==null?void 0:n.map(i=>jsxRuntimeExports.jsx(NavLink,{to:getPlaylistLink(i),className:({isActive:a})=>clsx(menuItemClassName(a),"flex items-center text-sm"),children:jsxRuntimeExports.jsx("div",{className:"overflow-hidden overflow-ellipsis",children:i.name})},i.id))]})}function useIsMediaPlaying(e,t){return usePlayerStore(s=>{var n;return s.status==="playing"&&((n=s.cuedMedia)==null?void 0:n.id)===e&&(!t||t===s.cuedMedia.groupId)})}function QueueSidenav(){const e=usePlayerStore(n=>n.shuffledQueue),{player:t}=useSettings(),s=usePlayerStore(n=>n.cuedMedia!=null);return jsxRuntimeExports.jsx("div",{className:"border-l bg h-full",children:jsxRuntimeExports.jsx("div",{className:clsx("overflow-y-auto overflow-x-hidden",t!=null&&t.hide_video||!s?"h-full":"h-[calc(100%-213px)]"),children:e.map((n,i)=>jsxRuntimeExports.jsx(QueueItem,{media:n},`${n.id}-${i}`))})})}function QueueItem({media:e}){const t=usePlayerStore(a=>{var o;return((o=a.cuedMedia)==null?void 0:o.id)===e.id}),s=useIsMediaPlaying(e.id),[n,i]=reactExports.useState(!1);return jsxRuntimeExports.jsxs(DialogTrigger,{type:"popover",triggerOnContextMenu:!0,placement:"bottom-start",children:[jsxRuntimeExports.jsxs("div",{onPointerEnter:()=>i(!0),onPointerLeave:()=>i(!1),className:clsx("flex items-center gap-10 p-8 border-b",t&&"bg-primary/80 text-white"),children:[jsxRuntimeExports.jsxs("div",{className:"relative overflow-hidden",children:[jsxRuntimeExports.jsx(TrackImage,{className:"w-34 h-34 flex-shrink-0 rounded object-cover",track:e.meta}),(n||s)&&jsxRuntimeExports.jsx(TogglePlaybackOverlay,{media:e,isHover:n})]}),jsxRuntimeExports.jsxs("div",{className:"flex-auto max-w-180 whitespace-nowrap",children:[jsxRuntimeExports.jsx("div",{className:"text-sm overflow-hidden overflow-ellipsis",children:e.meta.name}),jsxRuntimeExports.jsx(ArtistLinks,{className:clsx("text-muted text-xs overflow-hidden overflow-ellipsis",t?"text-inherit":"text-muted"),artists:e.meta.artists})]})]}),jsxRuntimeExports.jsx(TrackContextDialog,{tracks:[e.meta],showAddToQueueButton:!1,children:()=>jsxRuntimeExports.jsx(RemoveFromQueueContextButton,{media:e})})]})}function TogglePlaybackOverlay({media:e,isHover:t}){const s=useIsMediaPlaying(e.id),{trans:n}=useTrans(),i=usePlayerActions();let a;return s?a=jsxRuntimeExports.jsx("button",{"aria-label":n(message("Pause :name",{values:{name:e.meta.name}})),tabIndex:0,onClick:()=>i.pause(),children:t?jsxRuntimeExports.jsx(PauseIcon,{}):jsxRuntimeExports.jsx(EqualizerImage,{})}):a=jsxRuntimeExports.jsx("button",{"aria-label":n(message("Play :name",{values:{name:e.meta.name}})),tabIndex:0,onClick:()=>i.play(e),children:jsxRuntimeExports.jsx(PlayArrowFilledIcon,{})}),jsxRuntimeExports.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-black/50 rounded flex items-center justify-center text-white",children:a})}function RemoveFromQueueContextButton({media:e}){const{close:t}=useDialogContext(),s=usePlayerActions();return jsxRuntimeExports.jsx(ContextMenuButton,{onClick:async()=>{t(),s.removeFromQueue([e])},children:jsxRuntimeExports.jsx(Trans,{message:"Remove from queue"})})}const mainSearchModels=[ARTIST_MODEL,ALBUM_MODEL,TRACK_MODEL,USER_MODEL,PLAYLIST_MODEL];function SearchAutocomplete({className:e}){const{searchQuery:t}=useParams(),{trans:s}=useTrans(),n=useNavigate(),[i,a]=reactExports.useState(t||""),[o,l]=reactExports.useState(!1),{isFetching:u,data:x}=useSearchResults({query:i,types:mainSearchModels,limit:3});return jsxRuntimeExports.jsxs("form",{onSubmit:c=>{c.preventDefault(),i.trim().length&&(l(!1),n(`/search/${i.trim()}`))},className:clsx("flex items-center gap-14 flex-auto",e),children:[jsxRuntimeExports.jsx("button",{type:"submit","aria-label":s(message("Search")),children:jsxRuntimeExports.jsx(SearchIcon,{className:"text-muted flex-shrink-0"})}),jsxRuntimeExports.jsx(ComboBoxForwardRef,{unstyled:!0,className:"w-full max-w-780 flex-auto",offset:12,inputClassName:"w-full outline-none bg-transparent h-42 placeholder:text-muted",hideEndAdornment:!0,inputBorder:"border-none",isAsync:!0,placeholder:s(message("Search")),isLoading:u,inputValue:i,onInputValueChange:a,clearInputOnItemSelection:!0,blurReferenceOnItemSelection:!0,selectionMode:"none",openMenuOnFocus:!0,floatingMaxHeight:670,isOpen:o,onOpenChange:l,children:Object.entries((x==null?void 0:x.results)||{}).map(([c,j])=>jsxRuntimeExports.jsx(Section,{label:jsxRuntimeExports.jsx(Trans,{message:c}),children:j.map(d=>{const E=`${c}-${d.id}`;switch(d.model_type){case ARTIST_MODEL:return jsxRuntimeExports.jsx(Item,{value:E,onSelected:()=>{n(getArtistLink(d))},startIcon:jsxRuntimeExports.jsx(PlayableImage,{model:d,className:"rounded-full",value:E,children:jsxRuntimeExports.jsx(SmallArtistImage,{artist:d})}),description:jsxRuntimeExports.jsx(Trans,{message:"Artist"}),textLabel:d.name,children:jsxRuntimeExports.jsx(ArtistLink,{artist:d})},E);case ALBUM_MODEL:return jsxRuntimeExports.jsx(Item,{value:E,onSelected:()=>{n(getAlbumLink(d))},startIcon:jsxRuntimeExports.jsx(PlayableImage,{model:d,value:E,children:jsxRuntimeExports.jsx(AlbumImage,{album:d})}),description:jsxRuntimeExports.jsx(ArtistLinks,{artists:d.artists}),textLabel:d.name,children:jsxRuntimeExports.jsx(AlbumLink,{album:d})},E);case TRACK_MODEL:return jsxRuntimeExports.jsx(Item,{value:E,onSelected:()=>{n(getTrackLink(d))},startIcon:jsxRuntimeExports.jsx(PlayableImage,{model:d,value:E,children:jsxRuntimeExports.jsx(TrackImage,{track:d})}),description:jsxRuntimeExports.jsx(ArtistLinks,{artists:d.artists}),textLabel:d.name,children:jsxRuntimeExports.jsx(TrackLink,{track:d})},E);case USER_MODEL:return jsxRuntimeExports.jsx(Item,{value:E,onSelected:()=>{n(getUserProfileLink(d))},startIcon:jsxRuntimeExports.jsx(UserImage,{className:"w-48 h-48",user:d}),description:d.followers_count?jsxRuntimeExports.jsx(Trans,{message:":count followers",values:{count:d.followers_count}}):null,textLabel:d.display_name,children:jsxRuntimeExports.jsx(UserProfileLink,{user:d})},E);case PLAYLIST_MODEL:return jsxRuntimeExports.jsx(Item,{value:E,onSelected:()=>{n(getPlaylistLink(d))},startIcon:jsxRuntimeExports.jsx(PlayableImage,{model:d,value:E,children:jsxRuntimeExports.jsx(PlaylistImage,{playlist:d})}),description:jsxRuntimeExports.jsx(PlaylistOwnerName,{playlist:d}),textLabel:d.name,children:jsxRuntimeExports.jsx(PlaylistLink,{playlist:d})},E)}})},c))})]})}function PlayableImage({children:e,model:t,className:s,value:n}){var c;const{collection:i,state:{activeIndex:a}}=useListboxContext(),o=(c=i.get(n))==null?void 0:c.index,l=a===o,u=queueGroupId(t),x=usePlayerStore(j=>{var d;return j.status==="playing"&&((d=j.originalQueue[0])==null?void 0:d.groupId)===u});return jsxRuntimeExports.jsxs("div",{className:clsx(s,"relative w-48 h-48 overflow-hidden"),onClick:j=>{j.preventDefault(),j.stopPropagation()},children:[reactExports.cloneElement(e,{size:"w-full h-full"}),jsxRuntimeExports.jsx(AnimatePresence,{children:l||x?jsxRuntimeExports.jsx(m.div,{...opacityAnimation,transition:{duration:.24},className:"absolute w-full h-full inset-0 bg-black/60 m-auto flex items-center justify-center",children:jsxRuntimeExports.jsx(PlaybackToggleButton,{buttonType:"icon",color:"white",equalizerColor:"white",track:t.model_type===TRACK_MODEL?t:void 0,queueId:u})},"play-overlay"):null})]})}function useCuedTrack(){const e=usePlayerStore(t=>t.cuedMedia);if(e)return e.meta}const SkipPreviousFilledIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M5.5 18V6h2v12Zm13 0-9-6 9-6Z"}),"SkipPreviousFilled"),SkipNextFilledIcon=createSvgIcon(jsxRuntimeExports.jsx("path",{d:"M16.5 18V6h2v12Zm-11 0V6l9 6Z"}),"SkipNextFilled");function MobilePlayerControls(){return jsxRuntimeExports.jsxs("div",{className:"fixed bottom-0 left-0 right-0 w-[calc(100%-20px)] mx-auto bg-background/95",children:[jsxRuntimeExports.jsx(PlayerControls,{}),jsxRuntimeExports.jsx(MobileNavbar,{})]})}function PlayerControls(){return usePlayerStore(t=>t.cuedMedia!=null)?jsxRuntimeExports.jsxs("div",{className:"bg-chip rounded p-6 flex items-center gap-24 justify-between shadow relative",onClick:()=>{playerOverlayState.toggle()},children:[jsxRuntimeExports.jsx(QueuedTrack$2,{}),jsxRuntimeExports.jsx(PlaybackButtons$1,{}),jsxRuntimeExports.jsx(PlayerProgressBar,{})]}):null}function QueuedTrack$2(){var t;const e=useCuedTrack();return e?jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-10 min-w-0 flex-auto",children:[jsxRuntimeExports.jsx(TrackImage,{className:"rounded w-36 h-36 object-cover",track:e}),jsxRuntimeExports.jsxs("div",{className:"flex-auto whitespace-nowrap overflow-hidden",children:[jsxRuntimeExports.jsx("div",{className:"text-sm font-medium overflow-hidden overflow-ellipsis",children:e.name}),jsxRuntimeExports.jsx("div",{className:"text-xs text-muted overflow-hidden overflow-ellipsis",children:(t=e.artists)==null?void 0:t.map(s=>s.name).join(", ")})]})]}):null}function PlaybackButtons$1(){const e=usePlayerStore(n=>n.status==="uninitialized"),t=usePlayerActions(),{trans:s}=useTrans();return jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center",children:[jsxRuntimeExports.jsx(IconButton,{disabled:e,size:"md","aria-label":s(message("Previous")),onClick:n=>{n.stopPropagation(),t.playPrevious()},children:jsxRuntimeExports.jsx(SkipPreviousFilledIcon,{})}),jsxRuntimeExports.jsx(PlayButton$1,{}),jsxRuntimeExports.jsx(IconButton,{disabled:e,"aria-label":s(message("Next")),size:"md",onClick:n=>{n.stopPropagation(),t.playNext()},children:jsxRuntimeExports.jsx(SkipNextFilledIcon,{})})]})}function PlayButton$1(){const e=usePlayerStore(i=>i.status),t=usePlayerActions(),{trans:s}=useTrans(),n=s(e==="playing"?message("Pause"):message("Play"));return jsxRuntimeExports.jsx(IconButton,{"aria-label":n,size:"md",iconSize:"lg",disabled:e==="uninitialized",onClick:i=>{i.stopPropagation(),e==="playing"?t.pause():t.play()},children:e==="playing"?jsxRuntimeExports.jsx(PauseIcon,{}):jsxRuntimeExports.jsx(PlayArrowFilledIcon,{})})}function PlayerProgressBar(){const e=usePlayerStore(o=>o.mediaDuration),{time:t,player:s,listeners:n,stopTimer:i,setTime:a}=useBaseSeekbar();return reactExports.useEffect(()=>{const o=s.subscribe({...n,onCued:()=>{i(),a(0)}});return()=>{o()}},[s,n,i,a]),jsxRuntimeExports.jsx(ProgressBar,{size:"xs",className:"absolute left-0 right-0 bottom-0",progressColor:"bg-white",trackColor:"bg-white/10",trackHeight:"h-2",radius:"rounded-none",minValue:0,maxValue:e,value:t})}function MobileNavbar(){const e=useCustomMenu("mobile-bottom");return e?jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center gap-30 my-12",children:[e.items.map(t=>jsxRuntimeExports.jsx(CustomMenuItem,{unstyled:!0,iconClassName:"block mx-auto mb-6",iconSize:"md",className:({isActive:s})=>clsx("text-xs",s&&"font-bold"),item:t},t.id)),jsxRuntimeExports.jsx(AccountButton,{})]}):null}function AccountButton(){const{user:e}=useAuth(),t=!!(e!=null&&e.unread_notifications_count),s=useNavigate(),{registration:n}=useSettings(),i=jsxRuntimeExports.jsxs("button",{className:"text-xs",children:[jsxRuntimeExports.jsx(Badge,{badgeClassName:"mb-6",badgeLabel:e==null?void 0:e.unread_notifications_count,badgeIsVisible:t,children:jsxRuntimeExports.jsx(PersonIcon,{size:"md"})}),jsxRuntimeExports.jsx("div",{className:"text-xs",children:jsxRuntimeExports.jsx(Trans,{message:"Account"})})]});return e?jsxRuntimeExports.jsx(NavbarAuthMenu,{children:i}):jsxRuntimeExports.jsxs(MenuTrigger,{children:[i,jsxRuntimeExports.jsxs(Menu,{children:[jsxRuntimeExports.jsx(Item,{value:"login",onSelected:()=>s("/login"),children:jsxRuntimeExports.jsx(Trans,{message:"Login"})}),!n.disable&&jsxRuntimeExports.jsx(Item,{value:"register",onSelected:()=>s("/register"),children:jsxRuntimeExports.jsx(Trans,{message:"Register"})})]})]})}function MainSeekbar(){const e=usePlayerStore(u=>u.mediaDuration),t=usePlayerStore(u=>u.status==="uninitialized"),{time:s,player:n,listeners:i,startTimer:a,stopTimer:o,setTime:l}=useBaseSeekbar();return reactExports.useEffect(()=>{const u=n.subscribe({...i,onCued:()=>{o(),l(0)}});return n.getState().status==="playing"&&a(),()=>{u()}},[n,i,o,a,l]),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-12",children:[jsxRuntimeExports.jsx("div",{className:"text-xs text-muted flex-shrink-0 min-w-40 text-right",children:s?jsxRuntimeExports.jsx(FormattedDuration,{seconds:s}):"0:00"}),jsxRuntimeExports.jsx(Slider,{isDisabled:t,trackColor:"neutral",thumbSize:"w-14 h-14",showThumbOnHoverOnly:!0,minValue:0,maxValue:e,className:"flex-auto",width:"w-auto",value:s,onPointerDown:()=>{o(),n.pause()},onChange:u=>{l(u),n.seek(u)},onChangeEnd:()=>{n.play()}}),jsxRuntimeExports.jsx("div",{className:"text-xs text-muted flex-shrink-0 min-w-40",children:jsxRuntimeExports.jsx(FormattedDuration,{seconds:e})})]})}function PlaybackControls({className:e}){return jsxRuntimeExports.jsxs("div",{className:e,children:[jsxRuntimeExports.jsx(PlaybackButtons,{}),jsxRuntimeExports.jsx(MainSeekbar,{})]})}function PlaybackButtons(){const e=useIsMobileMediaQuery(),t=usePlayerStore(i=>i.status==="uninitialized"),s=usePlayerActions(),{trans:n}=useTrans();return jsxRuntimeExports.jsxs("div",{className:clsx("flex items-center justify-center gap-6",e&&"mb-20"),children:[jsxRuntimeExports.jsx(ShuffleButton,{}),jsxRuntimeExports.jsx(IconButton,{disabled:t,size:"md","aria-label":n(message("Previous")),onClick:()=>{s.playPrevious()},children:jsxRuntimeExports.jsx(SkipPreviousFilledIcon,{})}),jsxRuntimeExports.jsx(PlayButton,{}),jsxRuntimeExports.jsx(IconButton,{disabled:t,"aria-label":n(message("Next")),size:"md",onClick:()=>{s.playNext()},children:jsxRuntimeExports.jsx(SkipNextFilledIcon,{})}),jsxRuntimeExports.jsx(RepeatButton,{})]})}function PlayButton(){const e=usePlayerStore(i=>i.status),t=usePlayerActions(),{trans:s}=useTrans(),n=s(e==="playing"?message("Pause"):message("Play"));return jsxRuntimeExports.jsx("div",{className:"relative w-42 h-42 isolate",children:jsxRuntimeExports.jsx(IconButton,{"aria-label":n,size:"md",iconSize:"xl",disabled:e==="uninitialized",className:"relative z-20",onClick:()=>{e==="playing"?t.pause():t.play()},children:e==="playing"?jsxRuntimeExports.jsx(PauseIcon,{}):jsxRuntimeExports.jsx(PlayArrowFilledIcon,{})})})}function ShuffleButton(){const e=usePlayerStore(i=>i.shuffling),t=usePlayerActions(),{trans:s}=useTrans(),n=s(e?message("Disable shuffle"):message("Enable shuffle"));return jsxRuntimeExports.jsx(IconButton,{"aria-label":n,iconSize:"sm",color:e?"primary":void 0,onClick:()=>{t.toggleShuffling()},children:jsxRuntimeExports.jsx(ShuffleIcon,{})})}function RepeatButton(){const e=usePlayerStore(i=>i.repeat),t=usePlayerActions(),{trans:s}=useTrans();let n;return e==="all"?n=s(message("Enable repeat one")):e==="one"?n=s(message("Disable repeat")):n=s(message("Enable repeat")),jsxRuntimeExports.jsx(IconButton,{"aria-label":n,iconSize:"sm",color:e?"primary":void 0,onClick:()=>{t.toggleRepeatMode()},children:e==="one"?jsxRuntimeExports.jsx(RepeatOneIcon,{}):jsxRuntimeExports.jsx(RepeatIcon,{})})}function useLyrics(e){return useQuery(["lyrics",e.id],()=>fetchLyrics(e.id))}function fetchLyrics(e){return apiClient.get(`tracks/${e}/lyrics`).then(t=>t.data)}function LyricsDialog({track:e}){var i,a;const{data:t,isLoading:s}=useLyrics(e);let n;return(i=t==null?void 0:t.lyric)!=null&&i.text?n=jsxRuntimeExports.jsx(m.div,{className:"text-lg",...opacityAnimation,dangerouslySetInnerHTML:{__html:((a=t==null?void 0:t.lyric)==null?void 0:a.text)||""}},"lyrics"):s?n=jsxRuntimeExports.jsx(LyricSkeleton,{}):n=jsxRuntimeExports.jsx(IllustratedMessage,{image:jsxRuntimeExports.jsx(MicIcon,{size:"xl"}),imageHeight:"h-auto",title:jsxRuntimeExports.jsx(Trans,{message:"We do not have lyrics for this song yet"}),description:jsxRuntimeExports.jsx(Trans,{message:"Please try again later"})}),jsxRuntimeExports.jsxs(Dialog,{size:"fullscreenTakeover",children:[jsxRuntimeExports.jsx(DialogHeader,{closeButtonSize:"lg",children:jsxRuntimeExports.jsx("div",{className:"sr-only",children:jsxRuntimeExports.jsx(Trans,{message:"Lyrics"})})}),jsxRuntimeExports.jsxs(DialogBody,{className:"flex items-stretch gap-24 h-full",padding:"p-0",children:[jsxRuntimeExports.jsx("div",{className:"hidden md:flex-[0.4_1_0%] md:flex items-center justify-end pl-40",children:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(TrackImage,{track:e,size:"w-400 max-w-full aspect-square",className:"flex-shrink-0 shadow-md rounded"}),jsxRuntimeExports.jsx("div",{className:"mt-14 text-center text-xl",children:e.name}),jsxRuntimeExports.jsx("div",{className:"mt-4 text-center text-base text-muted",children:jsxRuntimeExports.jsx(ArtistLinks,{artists:e.artists})})]})}),jsxRuntimeExports.jsx("div",{className:"flex-auto md:flex-[0.6_1_0%] overflow-y-auto w-max text-center pl-14 pr-14 md:pl-0 md:pr-40 pb-40",children:jsxRuntimeExports.jsx("div",{className:"flex items-center justify-center min-h-full",children:jsxRuntimeExports.jsx(AnimatePresence,{children:n})})})]})]})}function LyricSkeleton(){return jsxRuntimeExports.jsx(m.div,{...opacityAnimation,className:"w-full max-w-720",children:[...new Array(16).keys()].map(e=>jsxRuntimeExports.jsx(Skeleton,{variant:"text",className:"mb-20"},e))},"skeleton")}function LyricsButton(){const{player:e}=useSettings(),t=useCuedTrack();return!t||e!=null&&e.hide_lyrics?null:jsxRuntimeExports.jsxs(DialogTrigger,{type:"modal",children:[jsxRuntimeExports.jsx(IconButton,{children:jsxRuntimeExports.jsx(MicIcon,{})}),jsxRuntimeExports.jsx(LyricsDialog,{track:t})]})}function DownloadTrackButton(){const{player:e,base_url:t}=useSettings(),s=useCuedTrack(),{hasPermission:n}=useAuth();return!(e!=null&&e.enable_download)||!s||!trackIsLocallyUploaded(s)||!n("music.download")?null:jsxRuntimeExports.jsx(IconButton,{onClick:()=>{downloadFileFromUrl(`${t}/api/v1/tracks/${s.id}/download`)},children:jsxRuntimeExports.jsx(DownloadIcon,{})})}function DesktopPlayerControls(){return usePlayerStore(t=>t.cuedMedia!=null)?jsxRuntimeExports.jsxs("div",{className:"h-96 px-16 flex items-center justify-between border-t bg dashboard-grid-footer z-30",children:[jsxRuntimeExports.jsx(QueuedTrack$1,{}),jsxRuntimeExports.jsx(PlaybackControls,{className:"w-2/5 max-w-[722px]"}),jsxRuntimeExports.jsx(SecondaryControls,{})]}):null}function QueuedTrack$1(){const e=useCuedTrack();let t;return e?t=jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-14",children:[jsxRuntimeExports.jsx(TrackImage,{className:"rounded w-56 h-56 object-cover",track:e}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("div",{className:"text-sm",children:e.name}),jsxRuntimeExports.jsx("div",{className:"text-xs text-muted",children:jsxRuntimeExports.jsx(ArtistLinks,{artists:e.artists})})]}),jsxRuntimeExports.jsx(LikeIconButton,{likeable:e})]}):t=null,jsxRuntimeExports.jsx("div",{className:"min-w-180 w-[30%]",children:t})}function SecondaryControls(){const{rightSidenavStatus:e,setRightSidenavStatus:t}=reactExports.useContext(DashboardLayoutContext);return jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-end min-w-180 w-[30%]",children:[jsxRuntimeExports.jsx(LyricsButton,{}),jsxRuntimeExports.jsx(DownloadTrackButton,{}),jsxRuntimeExports.jsx(IconButton,{className:"flex-shrink-0",onClick:()=>{t(e==="closed"?"open":"closed")},children:jsxRuntimeExports.jsx(QueueMusicIcon,{})}),jsxRuntimeExports.jsx(VolumeControls,{}),jsxRuntimeExports.jsx(OverlayButton,{})]})}function OverlayButton(){const e=usePlayerOverlayStore(n=>n.isMaximized),t=usePlayerStore(n=>n.status==="uninitialized"),{player:s}=useSettings();return s!=null&&s.hide_video_button?null:jsxRuntimeExports.jsx(IconButton,{className:"flex-shrink-0 ml-26",color:"chip",variant:"flat",radius:"rounded",size:"xs",iconSize:"sm",disabled:t,onClick:()=>{playerOverlayState.toggle()},children:e?jsxRuntimeExports.jsx(KeyboardArrowDownIcon,{}):jsxRuntimeExports.jsx(KeyboardArrowUpIcon,{})})}function VolumeControls(){const e=usePlayerStore(n=>n.volume),t=usePlayerActions(),s=usePlayerStore(n=>n.status==="uninitialized");return jsxRuntimeExports.jsxs("div",{className:"flex w-min items-center gap-4",children:[jsxRuntimeExports.jsx(ToggleMuteButton,{}),jsxRuntimeExports.jsx(Slider,{isDisabled:s,showThumbOnHoverOnly:!0,thumbSize:"w-14 h-14",trackColor:"neutral",minValue:0,maxValue:100,className:"flex-auto",width:"w-96",value:e,onChange:n=>{t.setVolume(n)}})]})}function ToggleMuteButton(){const{trans:e}=useTrans(),t=usePlayerStore(a=>a.muted),s=usePlayerStore(a=>a.volume),n=usePlayerActions(),i=usePlayerStore(a=>a.status==="uninitialized");return t?jsxRuntimeExports.jsx(IconButton,{disabled:i,size:"sm",iconSize:"md","aria-label":e(message("Unmute")),onClick:()=>n.setMuted(!1),children:jsxRuntimeExports.jsx(VolumeOffIcon,{})}):jsxRuntimeExports.jsx(IconButton,{disabled:i,size:"sm",iconSize:"md","aria-label":e(message("Mute")),onClick:()=>n.setMuted(!0),children:s<40?jsxRuntimeExports.jsx(VolumeDownIcon,{}):jsxRuntimeExports.jsx(VolumeUpIcon,{})})}function PlayerOverlay({playerRef:e}){const{player:t}=useSettings(),s=useMediaQuery("(max-width: 1024px)"),n=usePlayerOverlayStore(l=>l.isMaximized),i=usePlayerOverlayStore(l=>l.isQueueOpen),a=usePlayerStore(l=>l.cuedMedia!=null),o=reactExports.useRef(null);return reactExports.useEffect(()=>{if(!n)return;const l=u=>{u.key==="Escape"&&playerOverlayState.toggle()};return document.addEventListener("keydown",l),()=>document.removeEventListener("keydown",l)},[n]),jsxRuntimeExports.jsxs("div",{ref:o,className:clsx("fixed bg right-0 transition-all outline-none",(!a||s&&!n)&&"hidden",n?"bottom-0 w-full h-full flex flex-col pb-50 player-overlay-bg":"bottom-96 right-0 w-256 h-[213px]",((t==null?void 0:t.hide_video)||s)&&!n&&"hidden"),children:[n&&jsxRuntimeExports.jsxs("div",{className:"flex items-center flex-shrink-0 p-10 mb-10",children:[jsxRuntimeExports.jsx(IconButton,{className:"mr-auto",onClick:()=>playerOverlayState.toggle(),children:jsxRuntimeExports.jsx(KeyboardArrowDownIcon,{})}),s&&jsxRuntimeExports.jsx(LyricsButton,{}),s&&jsxRuntimeExports.jsx(DownloadTrackButton,{}),jsxRuntimeExports.jsx(IconButton,{onClick:()=>playerOverlayState.toggleQueue(),color:i?"primary":void 0,children:jsxRuntimeExports.jsx(QueueMusicIcon,{})}),jsxRuntimeExports.jsx(FullscreenButton,{overlayRef:o})]}),jsxRuntimeExports.jsx("div",{className:clsx("min-h-0 max-w-full flex-auto",n&&s&&"aspect-square",n&&!s&&"aspect-video",n?"mx-auto px-14 mt-auto":"w-full h-full"),children:jsxRuntimeExports.jsx(PlayerContainer$2,{playerRef:e})}),n&&jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(QueuedTrack,{}),jsxRuntimeExports.jsx(PlaybackControls,{className:"container mx-auto px-14 flex-shrink-0 mb-auto"})]}),n&&i&&jsxRuntimeExports.jsx(PlayerQueue,{})]})}function FullscreenButton({overlayRef:e}){const t=usePlayerStore(n=>n.status==="uninitialized"),s=useIsMobileMediaQuery();return!fscreen$1.fullscreenEnabled||s?null:jsxRuntimeExports.jsx(IconButton,{className:"flex-shrink-0 ml-12",size:"sm",disabled:t,onClick:()=>{e.current&&(fscreen$1.fullscreenElement?fscreen$1.exitFullscreen():fscreen$1.requestFullscreen(e.current))},children:jsxRuntimeExports.jsx(FullscreenIcon,{})})}function QueuedTrack(){const e=useCuedTrack();return e?jsxRuntimeExports.jsxs("div",{className:"container mx-auto px-14 my-40 flex-shrink-0 flex items-center justify-center gap-34",children:[jsxRuntimeExports.jsx(LikeIconButton,{likeable:e}),jsxRuntimeExports.jsxs("div",{className:"text-center",children:[jsxRuntimeExports.jsx("div",{className:"text-base",children:jsxRuntimeExports.jsx(TrackLink,{track:e})}),jsxRuntimeExports.jsx("div",{className:"text-sm text-muted",children:jsxRuntimeExports.jsx(ArtistLinks,{artists:e.artists})})]}),jsxRuntimeExports.jsxs(DialogTrigger,{type:"popover",children:[jsxRuntimeExports.jsx(IconButton,{children:jsxRuntimeExports.jsx(MoreVertIcon,{})}),jsxRuntimeExports.jsx(TrackContextDialog,{tracks:[e]})]})]}):null}const PlayerContainer$2=reactExports.memo(({playerRef:e})=>{const{getState:t}=reactExports.useContext(PlayerStoreContext);return jsxRuntimeExports.jsx("div",{className:"w-full h-full flex-auto bg-black player-container",ref:s=>{s?(e.current=s,t().init()):t().destroy()}})});function PlayerQueue(){const e=usePlayerStore(t=>t.shuffledQueue);return jsxRuntimeExports.jsx("div",{className:"bg-inherit fixed top-70 left-0 right-0 bottom-0 px-14 md:px-50 overflow-y-auto",children:jsxRuntimeExports.jsx(TrackTable,{tracks:e.map(t=>t.meta)})})}function WebPlayerLayout(){const e=reactExports.useRef(null),{player:t}=useSettings(),s=useIsMobileMediaQuery(),n=reactExports.useMemo(()=>({...playerStoreOptions,ref:e}),[]);return jsxRuntimeExports.jsxs(PlayerContext,{id:"web-player",options:n,children:[jsxRuntimeExports.jsxs(DashboardLayout,{name:"web-player",initialRightSidenavStatus:t!=null&&t.hide_queue?"closed":"open",children:[!s&&jsxRuntimeExports.jsx(PlayerNavbar,{}),!s&&jsxRuntimeExports.jsx(DashboardSidenav,{position:"left",display:"block",children:jsxRuntimeExports.jsx(Sidenav,{})}),jsxRuntimeExports.jsx(DashboardContent,{children:jsxRuntimeExports.jsx(Main,{})}),!s&&jsxRuntimeExports.jsx(RightSidenav,{}),jsxRuntimeExports.jsx(PlayerControlsBar,{})]}),jsxRuntimeExports.jsx(PlayerOverlay,{playerRef:e})]})}function PlayerControlsBar(){const{isMobileMode:e}=reactExports.useContext(DashboardLayoutContext);return e?jsxRuntimeExports.jsx(MobilePlayerControls,{}):jsxRuntimeExports.jsx(DesktopPlayerControls,{})}function PlayerNavbar(){const e=useNavigate(),t=usePrimaryArtistForCurrentUser(),{player:s}=useSettings(),n=reactExports.useMemo(()=>t?[jsxRuntimeExports.jsx(Item,{value:"author",startIcon:jsxRuntimeExports.jsx(MicIcon,{}),onSelected:()=>{e(getArtistLink(t))},children:jsxRuntimeExports.jsx(Trans,{message:"Artist profile"})},"author")]:s!=null&&s.show_become_artist_btn?[jsxRuntimeExports.jsx(Item,{value:"author",startIcon:jsxRuntimeExports.jsx(MicIcon,{}),onSelected:()=>{e("/backstage/requests")},children:jsxRuntimeExports.jsx(Trans,{message:"Become an author"})},"author")]:[],[t,e,s==null?void 0:s.show_become_artist_btn]);return jsxRuntimeExports.jsxs(Navbar,{hideLogo:!0,color:"bg",darkModeColor:"bg",size:"sm",authMenuItems:n,className:"dashboard-grid-header",children:[jsxRuntimeExports.jsx(SearchAutocomplete,{}),jsxRuntimeExports.jsx(ActionButtons$2,{})]})}function Main({className:e}){const t=useIsMobileMediaQuery();return jsxRuntimeExports.jsx("main",{className:clsx("overflow-x-hidden relative",e,t&&"pb-124"),children:jsxRuntimeExports.jsxs("div",{className:"web-player-container @container min-h-full mx-auto p-16 md:p-30",children:[jsxRuntimeExports.jsx(Outlet,{}),jsxRuntimeExports.jsx(GlobalDialogContainer,{})]})})}function RightSidenav(){const e=useMediaQuery("(max-width: 1280px)"),t=usePlayerStore(s=>!s.shuffledQueue.length);return jsxRuntimeExports.jsx(DashboardSidenav,{position:"right",size:"w-256",mode:e?"overlay":void 0,overlayPosition:"absolute",display:"block",forceClosed:t,children:jsxRuntimeExports.jsx(QueueSidenav,{})})}function ActionButtons$2(){const{player:e,billing:t}=useSettings(),{isLoggedIn:s,hasPermission:n,isSubscribed:i}=useAuth(),a=(e==null?void 0:e.show_upload_btn)&&s&&n("music.create"),o=(t==null?void 0:t.enable)&&n("plans.view")&&!i;return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[o&&jsxRuntimeExports.jsx(Button,{variant:"outline",size:"xs",color:"primary",elementType:Link,to:"/pricing",children:jsxRuntimeExports.jsx(Trans,{message:"Try Pro"})}),a&&jsxRuntimeExports.jsx(Button,{variant:o?"text":"outline",size:"xs",color:o?void 0:"primary",elementType:Link,to:"/backstage/upload",children:jsxRuntimeExports.jsx(Trans,{message:"Upload"})})]})}function GlobalDialogContainer(){const{dialog:e,data:t}=useGlobalDialogStore();return jsxRuntimeExports.jsx(DialogTrigger,{type:"modal",isOpen:e!=null,onClose:s=>{closeGlobalDialog(s)},children:e?jsxRuntimeExports.jsx(e,{...t}):null})}function MediaPageHeaderLayout({className:e,image:t,title:s,subtitle:n,description:i,actionButtons:a,footer:o,centerItems:l=!1}){return jsxRuntimeExports.jsxs("header",{className:clsx("flex flex-col md:flex-row gap-24 md:gap-34",l&&"items-center",e),children:[reactExports.cloneElement(t,{size:t.props.size||"w-256 h-256",className:clsx(t.props.className,"mx-auto flex-shrink-0")}),jsxRuntimeExports.jsxs("div",{className:"flex-auto min-w-0",children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl md:text-4xl font-semibold mb-14 text-center md:text-start",children:s}),n&&jsxRuntimeExports.jsx("div",{className:"w-max mx-auto md:mx-0",children:n}),i?jsxRuntimeExports.jsx("div",{className:"text-muted mt-18 md:mt-26 text-sm w-max mx-auto md:mx-0",children:i}):null,jsxRuntimeExports.jsx("div",{className:"mt-30",children:a}),o?jsxRuntimeExports.jsx("div",{className:"mt-30",children:o}):null]})]})}function actionButtonClassName({isFirst:e}={}){return clsx("min-h-40",e?"min-w-128 mr-20":"mr-10 min-w-100")}function RemoteFavicon({url:e,className:t,size:s="w-16 h-16",alt:n}){if(!e)return null;const i=getFaviconSrc(e);return jsxRuntimeExports.jsx("img",{className:clsx(s,t),src:getFaviconSrc(e),alt:n||`${i} favicon`})}const getFaviconSrc=memoize(e=>e.includes("youtube")?"https://www.youtube.com/s/desktop/ca54e1bd/img/favicon.ico":(isAbsoluteUrl(e)||(e=`${window.location.protocol}//${window.location.host}`),"https://www.google.com/s2/favicons?domain="+new URL(e).origin));function ProfileLinks({links:e}){return e!=null&&e.length?jsxRuntimeExports.jsx("div",{className:"flex items-center",children:e.map(t=>jsxRuntimeExports.jsx(Tooltip,{label:t.title,children:jsxRuntimeExports.jsx(IconButton,{size:"xs",elementType:"a",href:t.url,target:"_blank",rel:"noreferrer",children:jsxRuntimeExports.jsx(RemoteFavicon,{url:t.url,alt:t.title})})},t.url))}):null}function ProfileDescription({profile:e,links:t,shortDescription:s}){return e?jsxRuntimeExports.jsxs("div",{className:"text-sm",children:[e.description&&jsxRuntimeExports.jsx("div",{className:"p-10 rounded bg-alt/80 dark:bg text-secondary max-w-720",dangerouslySetInnerHTML:{__html:s?e.description.slice(0,300):e.description}}),e.city||e.country||t!=null&&t.length?jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-24 justify-between mt-20",children:[(e.city||e.country)&&jsxRuntimeExports.jsxs("div",{className:"p-10 rounded bg-alt/80 dark:bg text-secondary w-max",children:[e.city,e.country&&","," ",e.country]}),jsxRuntimeExports.jsx(ProfileLinks,{links:t})]}):null]}):null}function ArtistPageHeader({artist:e}){const{artistPage:t}=useSettings(),s=useIsMobileMediaQuery();return jsxRuntimeExports.jsx(MediaPageHeaderLayout,{centerItems:!0,image:jsxRuntimeExports.jsx(SmallArtistImage,{showVerifiedBadge:!0,artist:e,className:"rounded-full shadow-lg object-cover"}),title:e.name,subtitle:jsxRuntimeExports.jsx(GenreList,{genres:e.genres}),actionButtons:jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-24 justify-center md:justify-between",children:[jsxRuntimeExports.jsx(ActionButtons$1,{artist:e}),!s&&jsxRuntimeExports.jsx(MediaItemStats,{item:e})]}),footer:t.showDescription&&jsxRuntimeExports.jsx(ProfileDescription,{profile:e.profile,links:e.links,shortDescription:!0})})}function GenreList({genres:e}){return useIsMobileMediaQuery()?null:jsxRuntimeExports.jsx("ul",{className:"flex items-center justify-start gap-14 text-muted text-sm max-w-620 overflow-hidden overflow-ellipsis whitespace-nowrap",children:e==null?void 0:e.slice(0,5).map(s=>jsxRuntimeExports.jsx("li",{children:jsxRuntimeExports.jsx(GenreLink,{genre:s})},s.id))})}function ActionButtons$1({artist:e}){const t=useIsMobileMediaQuery();return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(PlaybackToggleButton,{queueId:queueGroupId(e),buttonType:"text",className:actionButtonClassName({isFirst:!0})}),!t&&jsxRuntimeExports.jsx(LikeButton,{likeable:e,className:actionButtonClassName()}),jsxRuntimeExports.jsxs(DialogTrigger,{type:"popover",children:[jsxRuntimeExports.jsx(Button,{variant:"outline",radius:"rounded-full",endIcon:jsxRuntimeExports.jsx(ArrowDropDownIcon,{}),className:actionButtonClassName(),children:jsxRuntimeExports.jsx(Trans,{message:"More"})}),jsxRuntimeExports.jsx(ArtistContextDialog,{artist:e})]})]})}function TopTracksTable({tracks:e}){const[t,s]=reactExports.useState(!1),n=reactExports.useMemo(()=>({all:e||[],sliced:(e==null?void 0:e.slice(0,5))||[]}),[e]);return jsxRuntimeExports.jsxs("div",{className:"flex-auto",children:[jsxRuntimeExports.jsx("h2",{className:"text-muted text-base my-16",children:jsxRuntimeExports.jsx(Trans,{message:"Popular songs"})}),jsxRuntimeExports.jsx(TrackTable,{tracks:t?n.all:n.sliced,hideArtist:!0,hideAlbum:!0,hideHeaderRow:!0}),jsxRuntimeExports.jsx(Button,{radius:"rounded-full",className:"mt-20",variant:"outline",onClick:()=>{s(!t)},children:t?jsxRuntimeExports.jsx(Trans,{message:"Show less"}):jsxRuntimeExports.jsx(Trans,{message:"Show more"})})]})}const albumListViewPerPage=5,albumGridViewPerPage=25;function useArtistAlbums(e,t){const{artistId:s}=useParams();return useInfiniteData({endpoint:`artists/${s}/albums`,queryKey:["artists",+s,"albums",t],queryParams:{albumsPerPage:t==="list"?albumListViewPerPage:albumGridViewPerPage},initialPage:e,transformResponse:n=>(n.pagination.data=n.pagination.data.map(i=>assignAlbumToTracks(i)),n)})}function NoDiscographyMessage(){return jsxRuntimeExports.jsx(IllustratedMessage,{className:"my-80",imageHeight:"h-auto",image:jsxRuntimeExports.jsx(AlbumIcon,{size:"xl",className:"text-muted"}),title:jsxRuntimeExports.jsx(Trans,{message:"We do not have discography for this artist yet"})})}function ArtistAlbumsList({initialAlbums:e}){const t=useArtistAlbums(e,"list"),{isInitialLoading:s,items:n}=t;return!s&&!n.length?jsxRuntimeExports.jsx(NoDiscographyMessage,{}):jsxRuntimeExports.jsxs("section",{children:[n.map(i=>jsxRuntimeExports.jsxs("div",{className:"mb-40",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-14 mb-20",children:[jsxRuntimeExports.jsx(AlbumImage,{album:i,size:"w-110 h-110",className:"rounded object-cover flex-shrink-0"}),jsxRuntimeExports.jsxs("div",{className:"flex-auto",children:[jsxRuntimeExports.jsx("h4",{className:"font-semibold text-lg whitespace-nowrap min-w-0 overflow-hidden overflow-ellipsis",children:jsxRuntimeExports.jsx(AlbumLink,{album:i})}),i.release_date&&jsxRuntimeExports.jsx("div",{className:"text-muted text-sm mt-2 mb-18",children:jsxRuntimeExports.jsx(FormattedDate,{date:i.release_date})}),jsxRuntimeExports.jsxs(DialogTrigger,{type:"popover",offset:10,children:[jsxRuntimeExports.jsx(Button,{variant:"outline",size:"xs",radius:"rounded-full",endIcon:jsxRuntimeExports.jsx(ArrowDropDownIcon,{}),children:jsxRuntimeExports.jsx(Trans,{message:"More"})}),jsxRuntimeExports.jsx(AlbumContextDialog,{album:i})]})]})]}),jsxRuntimeExports.jsx(AlbumTrackTable$2,{album:i})]},i.id)),jsxRuntimeExports.jsx(InfiniteScrollSentinel,{query:t})]})}function AlbumTrackTable$2({album:e}){const{data:t,sortDescriptor:s,onSortChange:n}=useSortableTableData(e.tracks);return jsxRuntimeExports.jsx(TrackTable,{tracks:t,hideArtist:!0,hideAlbum:!0,hideTrackImage:!0,sortDescriptor:s,onSortChange:n,queueGroupId:queueGroupId(e,"*",s)})}function ArtistAlbumsGrid({initialAlbums:e}){const t=useArtistAlbums(e,"grid");return!t.isInitialLoading&&!t.items.length?jsxRuntimeExports.jsx(NoDiscographyMessage,{}):jsxRuntimeExports.jsxs(ContentGrid,{children:[t.items.map(s=>jsxRuntimeExports.jsx(AlbumGridItem,{album:s},s.id)),jsxRuntimeExports.jsx(InfiniteScrollSentinel,{query:t})]})}function DiscographyTab({artist:e,initialAlbums:t}){const{player:s}=useSettings(),[n,i]=useLocalStorage("artistPage.albumLayout",(s==null?void 0:s.default_artist_view)||"list");return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(Header,{artist:e}),jsxRuntimeExports.jsx(AdHost,{slot:"artist_bottom",className:"mt-34"}),jsxRuntimeExports.jsxs("div",{className:"mt-44",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center border-b pb-4 mb-30 text-muted",children:[jsxRuntimeExports.jsx("h2",{className:"text-base mr-auto",children:jsxRuntimeExports.jsx(Trans,{message:"Albums"})}),jsxRuntimeExports.jsx(Tooltip,{label:jsxRuntimeExports.jsx(Trans,{message:"List view"}),children:jsxRuntimeExports.jsx(IconButton,{className:"ml-24 flex-shrink-0",color:n==="list"?"primary":void 0,onClick:()=>i("list"),children:jsxRuntimeExports.jsx(ViewAgendaIcon,{})})}),jsxRuntimeExports.jsx(Tooltip,{label:jsxRuntimeExports.jsx(Trans,{message:"Grid view"}),children:jsxRuntimeExports.jsx(IconButton,{className:"flex-shrink-0",color:n==="grid"?"primary":void 0,onClick:()=>i("grid"),children:jsxRuntimeExports.jsx(GridViewIcon,{})})})]}),n==="list"?jsxRuntimeExports.jsx(ArtistAlbumsList,{artist:e,initialAlbums:(t==null?void 0:t.per_page)===albumListViewPerPage?t:null}):jsxRuntimeExports.jsx(ArtistAlbumsGrid,{artist:e,initialAlbums:(t==null?void 0:t.per_page)===albumGridViewPerPage?t:null})]})]})}function Header({artist:e}){var n,i;const t=useIsMobileMediaQuery();if(!((n=e.top_tracks)!=null&&n.length))return null;const s=((i=e.similar)==null?void 0:i.slice(0,4))||[];return jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-30",children:[jsxRuntimeExports.jsx(TopTracksTable,{tracks:e.top_tracks}),!t&&jsxRuntimeExports.jsxs("div",{className:"w-1/3 max-w-320",children:[jsxRuntimeExports.jsx("h2",{className:"text-muted text-base my-16",children:jsxRuntimeExports.jsx(Trans,{message:"Similar artists"})}),jsxRuntimeExports.jsx("div",{children:s.map(a=>jsxRuntimeExports.jsxs(Link,{to:getArtistLink(a),className:"flex items-center gap-14 block p-4 mb-4 rounded hover:bg-hover cursor-pointer",children:[jsxRuntimeExports.jsx(SmallArtistImage,{artist:a,className:"w-44 h-44 object-cover rounded-full"}),jsxRuntimeExports.jsx("div",{className:"text-sm",children:a.name})]},a.id))})]})]})}function SimilarArtistsPanel({artist:e}){var t;return jsxRuntimeExports.jsx(ContentGrid,{children:(t=e.similar)==null?void 0:t.map(s=>jsxRuntimeExports.jsx(ArtistGridItem,{artist:s},s.id))})}function escapeText(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function escapeAttr(e){return e.replace(/"/g,"&quot;")}function attributesToString(e){const t=[];for(const s in e){let n=e[s]+"";t.push(`${s}="${escapeAttr(n)}"`)}return t.join(" ")}function defaultRender(e){let{tagName:t,attributes:s,content:n}=e;return`<${t} ${attributesToString(s)}>${escapeText(n)}</${t}>`}function linkifyStr(e,t){t===void 0&&(t={}),t=new Options(t,defaultRender);const s=tokenize(e),n=[];for(let i=0;i<s.length;i++){const a=s[i];a.t==="nl"&&t.get("nl2br")?n.push(`<br>
`):!a.isLink||!t.check(a)?n.push(escapeText(a.toString())):n.push(t.render(a))}return n.join("")}String.prototype.linkify||Object.defineProperty(String.prototype,"linkify",{writable:!1,value:function(t){return linkifyStr(this,t)}});function useLinkifiedString(e){return reactExports.useMemo(()=>e&&linkifyStr(e,{nl2br:!0,attributes:{rel:"nofollow"}}),[e])}function ArtistAboutPanel({artist:e}){var n;const t=useLinkifiedString((n=e.profile)==null?void 0:n.description),s=reactExports.useMemo(()=>{var i;return((i=e.profile_images)==null?void 0:i.map(a=>a.url))||[]},[e.profile_images]);return jsxRuntimeExports.jsxs("div",{className:"",children:[jsxRuntimeExports.jsx("div",{className:"grid grid-cols-3 lg:grid-cols-4 gap-24",children:s.map((i,a)=>jsxRuntimeExports.jsxs(DialogTrigger,{type:"modal",children:[jsxRuntimeExports.jsx("button",{type:"button",className:"outline-none focus-visible:ring cursor-zoom-in rounded overflow-hidden hover:scale-105 transition",children:jsxRuntimeExports.jsx("img",{className:"aspect-video object-cover rounded shadow cursor-zoom-in",src:i,alt:""})}),jsxRuntimeExports.jsx(ImageZoomDialog,{images:s,defaultActiveIndex:a})]},i))}),jsxRuntimeExports.jsx("div",{className:"py-24 text-sm whitespace-pre-wrap",dangerouslySetInnerHTML:{__html:t||""}})]})}function ArtistTracksPanel({artist:e,initialTracks:t}){const s=useInfiniteData({queryKey:["tracks",e.id],endpoint:`artists/${e.id}/tracks`,initialPage:t});return s.isInitialLoading?jsxRuntimeExports.jsx(FullPageLoader,{className:"min-h-100"}):s.items.length?jsxRuntimeExports.jsx(TrackList,{query:s}):jsxRuntimeExports.jsx(IllustratedMessage,{imageHeight:"h-auto",imageMargin:"mb-14",image:jsxRuntimeExports.jsx(AudiotrackIcon,{size:"lg",className:"text-muted"}),title:jsxRuntimeExports.jsx(Trans,{message:"No tracks yet"}),description:jsxRuntimeExports.jsx(Trans,{message:"Follow :artist for updates on their latest releases.",values:{artist:e.name}})})}const AlbumListItem=reactExports.memo(({album:e,reposter:t,className:s,hideArtwork:n,hideActions:i,linksInNewTab:a,maxHeight:o})=>{var v;const l=queueGroupId(e),{player:u}=useSettings(),x=useIsMobileMediaQuery();n=n||!!x;const{managesAlbum:c}=useAlbumPermissions(e),j=(e==null?void 0:e.tracks)||[],d=usePlayerStore(p=>p.cuedMedia),E=j.find(p=>p.id===(d==null?void 0:d.meta.id))||j[0],y=(u==null?void 0:u.seekbar_type)==="waveform"&&trackIsLocallyUploaded(E);return jsxRuntimeExports.jsxs("div",{className:clsx("overflow-hidden",!n&&"flex gap-24",s,o),children:[!n&&jsxRuntimeExports.jsx(AlbumImage,{album:e,className:"flex-shrink-0 rounded",size:"w-184 h-184"}),jsxRuntimeExports.jsxs("div",{className:clsx("flex-auto min-w-0",o&&"flex flex-col h-full"),children:[jsxRuntimeExports.jsxs("div",{className:"flex-shrink-0",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-14",children:[jsxRuntimeExports.jsx(PlaybackToggleButton,{queueId:l,track:E,tracks:e.tracks,buttonType:"icon",color:"primary",variant:"flat",radius:"rounded-full",equalizerColor:"white"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs("div",{className:"text-sm text-muted flex items-center gap-6",children:[jsxRuntimeExports.jsx(ArtistLinks,{artists:e.artists,target:a?"_blank":void 0}),t&&jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(RepeatIcon,{size:"xs"}),jsxRuntimeExports.jsx(UserProfileLink,{user:t,target:a?"_blank":void 0})]})]}),jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsx(AlbumLink,{album:e,target:a?"_blank":void 0})})]}),jsxRuntimeExports.jsxs("div",{className:"ml-auto text-sm",children:[jsxRuntimeExports.jsx(FormattedRelativeTime,{date:e.created_at}),((v=e.genres)==null?void 0:v.length)&&jsxRuntimeExports.jsx(Chip,{className:"mt-6 w-max",size:"xs",children:jsxRuntimeExports.jsx(GenreLink,{genre:e.genres[0],target:a?"_blank":void 0})})]})]}),jsxRuntimeExports.jsx("div",{className:"my-20",children:y?jsxRuntimeExports.jsx(CommentBarContextProvider,{disableCommenting:i,children:jsxRuntimeExports.jsx(WaveformWithComments,{track:E,queue:e.tracks})}):jsxRuntimeExports.jsx(TrackSeekbar,{track:E,queue:e.tracks})})]}),jsxRuntimeExports.jsx("div",{className:"flex-auto overflow-y-auto",children:j.map((p,f)=>{var g;const R=f-1===((g=e.tracks)==null?void 0:g.length),h=(E==null?void 0:E.id)===p.id;return jsxRuntimeExports.jsx(TrackItem,{track:p,album:e,index:f,isLast:R,isActive:h},p.id)})}),!i&&jsxRuntimeExports.jsx(TrackActionsBar,{className:"mt-20",item:e,managesItem:c})]})]},e.id)});function TrackItem({track:e,index:t,isLast:s,isActive:n,album:i}){const a=usePlayerActions();return jsxRuntimeExports.jsxs("div",{className:clsx("flex items-center text-[13px] gap-8 p-8 cursor-pointer hover:bg-hover",!s&&"border-b",n&&"text-primary"),onClick:()=>{var o;(o=i.tracks)!=null&&o.length&&a.overrideQueueAndPlay(tracksToMediaItems(i.tracks),t)},children:[jsxRuntimeExports.jsx(TrackImage,{track:e,size:"w-20 h-20",className:"rounded"}),jsxRuntimeExports.jsx("div",{children:t+1}),jsxRuntimeExports.jsx("div",{className:"mx-10 flex-auto",children:e.name}),e.plays&&e.plays>0?jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(PlayArrowFilledIcon,{size:"xs",className:"text-muted ml-auto"}),jsxRuntimeExports.jsx("div",{className:"text-muted",children:jsxRuntimeExports.jsx(FormattedNumber,{value:e.plays})})]}):null]},e.id)}function AlbumList({albums:e,query:t}){const s=useIsMobileMediaQuery();return!e&&t?e=t.items:e=[],s?jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(ContentGrid,{children:e.map(n=>jsxRuntimeExports.jsx(AlbumGridItem,{album:n},n.id))}),t&&jsxRuntimeExports.jsx(InfiniteScrollSentinel,{query:t})]}):jsxRuntimeExports.jsxs("div",{children:[e.map(n=>jsxRuntimeExports.jsx(AlbumListItem,{album:n,className:"mb-40"},n.id)),t&&jsxRuntimeExports.jsx(InfiniteScrollSentinel,{query:t})]})}function ArtistAlbumsPanel({artist:e}){const t=useInfiniteData({queryKey:["albums",e.id],endpoint:`artists/${e.id}/albums`});return t.isInitialLoading?jsxRuntimeExports.jsx(FullPageLoader,{className:"min-h-100"}):t.items.length?jsxRuntimeExports.jsx(AlbumList,{query:t}):jsxRuntimeExports.jsx(IllustratedMessage,{imageHeight:"h-auto",imageMargin:"mb-14",image:jsxRuntimeExports.jsx(AlbumIcon,{size:"lg",className:"text-muted"}),title:jsxRuntimeExports.jsx(Trans,{message:"No albums yet"}),description:jsxRuntimeExports.jsx(Trans,{message:"Follow :artist for updates on their latest releases.",values:{artist:e.name}})})}function useArtistPageTabs(e){const[t]=useSearchParams(),{artistPage:s}=useSettings();return reactExports.useMemo(()=>{var x,c,j,d;const n=(x=e.similar)==null?void 0:x.length,i=((c=e.profile_images)==null?void 0:c.length)||((j=e.profile)==null?void 0:j.description),a=(d=s==null?void 0:s.tabs)==null?void 0:d.filter(E=>!(!E.active||E.id===artistPageTabs.similar&&!n||E.id===artistPageTabs.about&&!i)),o=artistPageTabs[t.get("tab")],l=a==null?void 0:a.findIndex(E=>E.id===o);return{selectedIndex:l>-1?l:0,activeTabs:a}},[e,s.tabs,t])}const userFollowsStore=react()(immer((e,t)=>{var s,n;return{followedUsers:((n=(s=getBootstrapData().user)==null?void 0:s.followed_users)==null?void 0:n.map(i=>i.id))||[],isFollowing:i=>t().followedUsers.includes(i),add:i=>{e(a=>{a.followedUsers.push(i)})},remove:i=>{e(a=>{a.followedUsers=a.followedUsers.filter(o=>o!==i)})}}})),userFollows=userFollowsStore.getState;function useFollowUser(){return useMutation(e=>followUser(e),{onSuccess:(e,{user:t})=>{userFollows().add(t.id),toast(message("Following :name",{values:{name:t.display_name}})),queryClient.invalidateQueries(["users"])},onError:e=>showHttpErrorToast(e)})}function followUser({user:e}){return apiClient.post(`users/${e.id}/follow`).then(t=>t.data)}function useUnfollowUser(){return useMutation(e=>unfollowUser(e),{onSuccess:(e,{user:t})=>{userFollows().remove(t.id),toast(message("Stopped following :name",{values:{name:t.display_name}})),queryClient.invalidateQueries(["users"])},onError:e=>showHttpErrorToast(e)})}function unfollowUser({user:e}){return apiClient.post(`users/${e.id}/unfollow`).then(t=>t.data)}function FollowerListItem({follower:e}){const t=userFollowsStore(s=>s.isFollowing(e.id));return jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-16 mb-16 pb-16 border-b",children:[jsxRuntimeExports.jsx(UserImage,{user:e,className:"w-64 h-64 rounded"}),jsxRuntimeExports.jsxs("div",{className:"text-sm",children:[jsxRuntimeExports.jsx(UserProfileLink,{user:e}),e.followers_count&&e.followers_count>0?jsxRuntimeExports.jsx("div",{className:"text-xs text-muted",children:jsxRuntimeExports.jsx(Trans,{message:"[one 1 followers|other :count followers]",values:{count:e.followers_count}})}):null]}),t?jsxRuntimeExports.jsx(UnfollowUserButton,{user:e}):jsxRuntimeExports.jsx(FollowUserButton,{user:e})]},e.id)}function FollowUserButton({user:e}){const t=useFollowUser(),{user:s}=useAuth();return(s==null?void 0:s.id)===e.id?null:jsxRuntimeExports.jsx(Button,{variant:"outline",radius:"rounded-full",className:"flex-shrink-0 ml-auto",onClick:()=>t.mutate({user:e}),disabled:t.isLoading,children:jsxRuntimeExports.jsx(Trans,{message:"Follow"})})}function UnfollowUserButton({user:e}){const t=useUnfollowUser(),{user:s}=useAuth();return(s==null?void 0:s.id)===e.id?null:jsxRuntimeExports.jsx(Button,{variant:"outline",radius:"rounded-full",className:"flex-shrink-0 ml-auto",onClick:()=>t.mutate({user:e}),disabled:t.isLoading,children:jsxRuntimeExports.jsx(Trans,{message:"Unfollow"})})}function ArtistFollowersPanel({artist:e}){const t=useInfiniteData({queryKey:["artists",e.id,"followers"],endpoint:`artists/${e.id}/followers`});return t.isInitialLoading?jsxRuntimeExports.jsx(FullPageLoader,{className:"min-h-100"}):t.items.length?jsxRuntimeExports.jsxs("div",{children:[t.items.map(s=>jsxRuntimeExports.jsx(FollowerListItem,{follower:s},s.id)),jsxRuntimeExports.jsx(InfiniteScrollSentinel,{query:t})]}):jsxRuntimeExports.jsx(IllustratedMessage,{imageHeight:"h-auto",imageMargin:"mb-14",image:jsxRuntimeExports.jsx(BookmarkBorderIcon,{size:"lg",className:"text-muted"}),description:jsxRuntimeExports.jsx(Trans,{message:"Seems like no one is following :name yet.",values:{name:e.name}})})}function ArtistPageTabs({data:e}){const{selectedIndex:t,activeTabs:s}=useArtistPageTabs(e.artist);return jsxRuntimeExports.jsxs(Tabs,{className:"mt-24 md:mt-48",selectedTab:t,isLazy:!0,children:[jsxRuntimeExports.jsx(TabList,{children:s.map(n=>{switch(n.id){case artistPageTabs.discography:return jsxRuntimeExports.jsx(Tab,{elementType:Link,children:jsxRuntimeExports.jsx(Trans,{message:"Discography"})},artistPageTabs.discography);case artistPageTabs.similar:return jsxRuntimeExports.jsx(Tab,{elementType:Link,to:{search:"?tab=similar"},children:jsxRuntimeExports.jsx(Trans,{message:"Similar artists"})},artistPageTabs.similar);case artistPageTabs.about:return jsxRuntimeExports.jsx(Tab,{elementType:Link,to:{search:"?tab=about"},children:jsxRuntimeExports.jsx(Trans,{message:"About"})},artistPageTabs.about);case artistPageTabs.tracks:return jsxRuntimeExports.jsx(Tab,{elementType:Link,to:{search:"?tab=tracks"},children:jsxRuntimeExports.jsx(Trans,{message:"Tracks"})},artistPageTabs.tracks);case artistPageTabs.albums:return jsxRuntimeExports.jsx(Tab,{elementType:Link,to:{search:"?tab=albums"},children:jsxRuntimeExports.jsx(Trans,{message:"Albums"})},artistPageTabs.albums);case artistPageTabs.followers:return jsxRuntimeExports.jsx(Tab,{elementType:Link,to:{search:"?tab=followers"},children:jsxRuntimeExports.jsx(Trans,{message:"Followers"})},artistPageTabs.followers)}})}),jsxRuntimeExports.jsx(TabPanels,{className:"mt-12 md:mt-24",children:s.map(n=>{switch(n.id){case artistPageTabs.discography:return jsxRuntimeExports.jsx(TabPanel,{children:jsxRuntimeExports.jsx(DiscographyTab,{artist:e.artist,initialAlbums:e.albums})},artistPageTabs.discography);case artistPageTabs.similar:return jsxRuntimeExports.jsx(TabPanel,{children:jsxRuntimeExports.jsx(SimilarArtistsPanel,{artist:e.artist})},artistPageTabs.similar);case artistPageTabs.about:return jsxRuntimeExports.jsx(TabPanel,{children:jsxRuntimeExports.jsx(ArtistAboutPanel,{artist:e.artist})},artistPageTabs.about);case artistPageTabs.tracks:return jsxRuntimeExports.jsx(TabPanel,{children:jsxRuntimeExports.jsx(ArtistTracksPanel,{artist:e.artist,initialTracks:e.tracks})},artistPageTabs.tracks);case artistPageTabs.albums:return jsxRuntimeExports.jsx(TabPanel,{children:jsxRuntimeExports.jsx(ArtistAlbumsPanel,{artist:e.artist})},artistPageTabs.albums);case artistPageTabs.followers:return jsxRuntimeExports.jsx(TabPanel,{children:jsxRuntimeExports.jsx(ArtistFollowersPanel,{artist:e.artist})},artistPageTabs.followers)}})})]})}function ArtistPage(){const e=getFromLocalStorage(albumLayoutKey,"list")==="list",{artistPage:t}=useSettings(),s=t.tabs.filter(o=>o.active).map(o=>o.id);let n=["similar","genres","profile"];s.includes(artistPageTabs.tracks)&&n.push("tracks"),s.includes(artistPageTabs.discography)&&(n=[...n,"albums","topTracks"]);const a=useArtist({with:n,withCount:"likes",autoUpdate:!0,loadAlbumTracks:e,albumsPerPage:e?5:25});return a.data?jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(PageMetaTags,{query:a}),jsxRuntimeExports.jsx(AdHost,{slot:"general_top",className:"mb-34"}),jsxRuntimeExports.jsx(ArtistPageHeader,{artist:a.data.artist}),jsxRuntimeExports.jsx(AdHost,{slot:"artist_top",className:"mt-14"}),jsxRuntimeExports.jsx(ArtistPageTabs,{data:a.data}),jsxRuntimeExports.jsx(AdHost,{slot:"general_bottom",className:"mt-34"})]}):jsxRuntimeExports.jsx(PageStatus,{query:a,loaderClassName:"absolute inset-0 m-auto"})}function usePlaylist(){const{playlistId:e}=useParams();return useQuery(["playlists",+e],()=>fetchPlaylist(e))}function fetchPlaylist(e){return apiClient.get(`playlists/${e}`).then(t=>t.data)}function AvatarGroup(e){const t=reactExports.Children.toArray(e.children),s=t[0].props.link,n=t[0].props.label;return jsxRuntimeExports.jsxs("div",{className:clsx("pl-10 flex isolate items-center",e.className),children:[jsxRuntimeExports.jsx(reactExports.Fragment,{children:t.map((i,a)=>jsxRuntimeExports.jsx("div",{style:{zIndex:5-a},className:clsx("relative border-2 border-bg-alt bg-alt rounded-full -ml-10 overflow-hidden flex-shrink-0"),children:i},a))}),jsxRuntimeExports.jsxs("div",{className:"text-sm whitespace-nowrap ml-10",children:[s&&n?jsxRuntimeExports.jsx(Link,{to:s,className:"hover:underline",children:n}):null,t.length>1&&jsxRuntimeExports.jsxs("span",{children:[" ",jsxRuntimeExports.jsx(Trans,{message:"+ :count more",values:{count:t.length-1}})]})]})]})}function BulletSeparatedItems({children:e,className:t}){const s=reactExports.Children.toArray(e);return jsxRuntimeExports.jsx("div",{className:clsx("flex items-center gap-4",t),children:s.map((n,i)=>jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{children:n}),i<s.length-1?jsxRuntimeExports.jsx("div",{children:""}):null]},i))})}function PlaylistPageHeader({playlist:e,totalDuration:t,queueId:s}){var n;return jsxRuntimeExports.jsx(reactExports.Fragment,{children:jsxRuntimeExports.jsx(MediaPageHeaderLayout,{image:jsxRuntimeExports.jsx(EditableImage,{playlist:e}),title:e.name,subtitle:jsxRuntimeExports.jsx(AvatarGroup,{children:(n=e.editors)==null?void 0:n.map(i=>jsxRuntimeExports.jsx(Avatar,{circle:!0,src:i.avatar,label:i.display_name,link:getUserProfileLink(i)},i.id))}),description:jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[e.description,e.tracks_count?jsxRuntimeExports.jsxs(BulletSeparatedItems,{className:"mt-14 text-sm text-muted",children:[jsxRuntimeExports.jsx(Trans,{message:"[one 1 track|other :count tracks]",values:{count:e.tracks_count}}),jsxRuntimeExports.jsx(FormattedDuration,{ms:t,verbose:!0}),e.collaborative&&jsxRuntimeExports.jsx(Trans,{message:"Collaborative"})]}):null]}),actionButtons:jsxRuntimeExports.jsx(ActionButtons,{playlist:e,hasTracks:t>0,queueId:s})})})}function EditableImage({playlist:e,size:t,className:s}){const n=useUpdatePlaylist();return usePlaylistPermissions(e)?jsxRuntimeExports.jsx(FileUploadProvider,{children:jsxRuntimeExports.jsx(ImageSelector,{showEditButtonOnHover:!0,diskPrefix:"playlist_media",variant:"square",previewSize:t,className:s,value:getPlaylistImageSrc(e),onChange:a=>{n.mutate({image:a})},placeholderIcon:jsxRuntimeExports.jsx(ImageIcon,{}),stretchPreview:!0})}):jsxRuntimeExports.jsx(PlaylistImage,{className:`${t} ${s} object-cover rounded`,playlist:e})}function ActionButtons({playlist:e,hasTracks:t,queueId:s}){return jsxRuntimeExports.jsxs("div",{className:"text-center md:text-start",children:[jsxRuntimeExports.jsx(PlaybackToggleButton,{disabled:!t,buttonType:"text",queueId:s,className:actionButtonClassName({isFirst:!0})}),jsxRuntimeExports.jsx(FollowPlaylistButton,{buttonType:"text",playlist:e,className:actionButtonClassName()}),jsxRuntimeExports.jsxs(DialogTrigger,{type:"popover",children:[jsxRuntimeExports.jsx(Button,{variant:"outline",radius:"rounded-full",endIcon:jsxRuntimeExports.jsx(ArrowDropDownIcon,{}),className:actionButtonClassName(),children:jsxRuntimeExports.jsx(Trans,{message:"More"})}),jsxRuntimeExports.jsx(PlaylistContextDialog,{playlist:e})]})]})}function useRemoveTracksFromPlaylist(){return useMutation(e=>removeTracks(e),{onSuccess:(e,{tracks:t})=>{toast(message("Removed [one 1 track|other :count tracks] from playlist",{values:{count:t.length}})),queryClient.invalidateQueries(["playlists",e.playlist.id])},onError:e=>showHttpErrorToast(e)})}function removeTracks(e){const t={ids:e.tracks.map(s=>s.id)};return apiClient.post(`playlists/${e.playlistId}/tracks/remove`,t).then(s=>s.data)}function PlaylistTrackContextDialog({playlist:e,...t}){const{close:s}=useDialogContext(),n=useRemoveTracksFromPlaylist();return jsxRuntimeExports.jsx(TableTrackContextDialog,{...t,children:i=>jsxRuntimeExports.jsx(ContextMenuButton,{onClick:()=>{n.isLoading||(n.mutate({playlistId:e.id,tracks:i}),s())},children:jsxRuntimeExports.jsx(Trans,{message:"Remove from this playlist"})})})}function moveMultipleItemsInArray(e,t,s){const n=Array.isArray(t)?t:[t],i=e[s+(s<n[0]?0:1)],a=n.map(u=>e[u]),o=[];for(let u=0;u<e.length;){const x=e[u];a.indexOf(x)>=0?(o.push(x),e.splice(u,1)):++u}let l=e.indexOf(i);return l<0&&(l=e.length),e.splice(l,0,...o),e}function useReorderPlaylistTracks(){const{playlistId:e}=useParams();return useMutation(t=>reorderTracks(e,t),{onSuccess:()=>{queryClient.invalidateQueries(["playlists",+e,"tracks"])},onError:t=>showHttpErrorToast(t)})}function reorderTracks(e,{tracks:t,oldIndexes:s,newIndex:n}){const i=t.map(a=>a.id);return moveMultipleItemsInArray(i,s,n),apiClient.post(`playlists/${e}/tracks/order`,{ids:i}).then(a=>a.data)}function PlaylistTableRow({item:e,children:t,className:s,...n}){const i=useIsTouchDevice(),{data:a,selectRow:o,selectedRows:l,sortDescriptor:u}=reactExports.useContext(TableContext),x=reactExports.useRef(null),c=reactExports.useRef(null),j=useReorderPlaylistTracks(),{data:d}=usePlaylist(),{sortableProps:E}=useSortable({ref:x,disabled:(i??!1)||j.isLoading||(u==null?void 0:u.orderBy)!=="position",item:e,items:a,type:"playlistTrack",preview:c,previewVariant:"line",onDragEnd:()=>{o(null)},onSortStart:()=>{l.includes(e.id)||o(e)},onSortEnd:(y,v)=>{j.mutate({tracks:a,oldIndexes:l.length>1?l.map(p=>a.findIndex(f=>f.id===p)):y,newIndex:v})}});return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsxs(DialogTrigger,{type:"popover",triggerOnContextMenu:!0,placement:"bottom-start",children:[jsxRuntimeExports.jsx("tr",{className:s,ref:x,...$3ef42575df84b30b$export$9d1611c77c2fe928(E,n),children:t}),jsxRuntimeExports.jsx(PlaylistTrackContextDialog,{playlist:d.playlist})]}),!e.isPlaceholder&&jsxRuntimeExports.jsx(RowDragPreview,{track:e,ref:c})]})}const RowDragPreview=React.forwardRef(({track:e},t)=>{var i;const{selectedRows:s}=reactExports.useContext(TableContext),n=s.length>1?jsxRuntimeExports.jsx(Trans,{message:":count tracks",values:{count:s.length}}):`${e.name} - ${(i=e.artists)==null?void 0:i[0].name}`;return jsxRuntimeExports.jsx(DragPreview,{ref:t,children:()=>jsxRuntimeExports.jsx("div",{className:"p-8 rounded shadow bg-chip text-base",children:n})})});function MediaPageNoResultsMessage({description:e,searchQuery:t,className:s}){return t?jsxRuntimeExports.jsx(IllustratedMessage,{className:s,title:jsxRuntimeExports.jsx(Trans,{message:"No results found"}),description:jsxRuntimeExports.jsx(Trans,{message:"Try another search query or different filters"})}):jsxRuntimeExports.jsx(IllustratedMessage,{className:s,title:jsxRuntimeExports.jsx(Trans,{message:"Nothing to display"}),description:e})}function PlaylistPage(){const e=usePlaylist();return e.data?jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(PageMetaTags,{query:e}),jsxRuntimeExports.jsx(PageContent$2,{initialTracks:e.data.tracks,playlist:e.data.playlist,totalDuration:e.data.totalDuration})]}):jsxRuntimeExports.jsx(PageStatus,{query:e,loaderClassName:"absolute inset-0 m-auto"})}function PageContent$2({initialTracks:e,playlist:t,totalDuration:s}){const{trans:n}=useTrans(),i=useInfiniteData({initialPage:e,queryKey:["playlists",t.id],endpoint:`playlists/${t.id}/tracks`,defaultOrderBy:"position",defaultOrderDir:"asc",paginate:"simple",willSortOrFilter:!0}),{isInitialLoading:a,sortDescriptor:o,setSortDescriptor:l,searchQuery:u,setSearchQuery:x,items:c}=i,j=t.tracks_count||0,d=queueGroupId(t,"*",o);return jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(AdHost,{slot:"general_top",className:"mb-44"}),jsxRuntimeExports.jsx(PlaylistPageHeader,{playlist:t,totalDuration:s,queueId:d}),jsxRuntimeExports.jsx(TextField,{value:u,onChange:E=>x(E.target.value),className:"max-w-512 mt-28 mb-44 md:mb-24",size:"sm",startAdornment:jsxRuntimeExports.jsx(SearchIcon,{}),placeholder:n(message("Search within playlist"))}),jsxRuntimeExports.jsx(TrackTable,{queueGroupId:d,tracks:c,sortDescriptor:o,onSortChange:l,renderRowAs:PlaylistTableRow,contextDialog:jsxRuntimeExports.jsx(PlaylistTrackContextDialog,{playlist:t}),tableBody:jsxRuntimeExports.jsx(VirtualTableBody,{query:i,totalItems:j})}),!c.length&&!a&&jsxRuntimeExports.jsx(MediaPageNoResultsMessage,{className:"mt-34",searchQuery:u,description:jsxRuntimeExports.jsx(Trans,{message:"This playlist does not have any tracks yet"})}),jsxRuntimeExports.jsx(AdHost,{slot:"general_bottom",className:"mt-44"})]})}function commentsQueryKey(e){return["comment",`${e.id}-${e.model_type}`]}function useComments(e){return useInfiniteData({queryKey:commentsQueryKey(e),endpoint:"commentable/comments",queryParams:{commentable_type:e.model_type,commentable_id:e.id}})}function CommentListItem({comment:e,commentable:t,canDelete:s}){const n=useIsMobileMediaQuery(),{user:i,hasPermission:a}=useAuth(),[o,l]=reactExports.useState(!1);return jsxRuntimeExports.jsxs("div",{style:{paddingLeft:`${e.depth*20}px`},onClick:()=>{n&&l(!o)},children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-10 py-10 min-h-70 group",children:[jsxRuntimeExports.jsx(UserAvatar,{className:"flex-shrink-0",user:e.user,size:"lg"}),e.deleted?jsxRuntimeExports.jsx("span",{className:"text-muted text-sm italic pt-10",children:jsxRuntimeExports.jsx(Trans,{message:"This comment has been deleted."})}):jsxRuntimeExports.jsxs("div",{className:"text-sm flex-auto",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[e.user&&jsxRuntimeExports.jsx(UserDisplayName,{user:e.user}),e.position?jsxRuntimeExports.jsx(Position,{commentable:t,position:e.position}):null]}),jsxRuntimeExports.jsx("div",{children:e.content})]}),jsxRuntimeExports.jsxs("div",{className:"ml-auto md:min-w-86 flex-shrink-0 text-end",children:[jsxRuntimeExports.jsx("time",{className:"text-muted text-xs",children:jsxRuntimeExports.jsx(FormattedRelativeTime,{date:e.created_at,style:n?"narrow":"long"})}),i!=null&&!e.deleted&&!n&&jsxRuntimeExports.jsxs("div",{className:"mt-2 flex items-center gap-6 justify-end invisible group-hover:visible",children:[e.depth<5&&a("comments.create")&&jsxRuntimeExports.jsx(Button,{variant:"outline",size:"2xs",onClick:()=>l(!o),children:jsxRuntimeExports.jsx(Trans,{message:"Reply"})}),(e.user_id===i.id||s)&&jsxRuntimeExports.jsx(DeleteCommentButton,{comment:e})]})]})]}),o?jsxRuntimeExports.jsx(NewCommentForm,{className:e!=null&&e.depth?void 0:"pl-20",commentable:t,inReplyTo:e,autoFocus:!0,onSuccess:()=>{l(!1)}}):null]})}const Position=reactExports.memo(({commentable:e,position:t})=>{if(!e.duration)return null;const s=t/100*(e.duration/1e3);return jsxRuntimeExports.jsx("span",{className:"text-muted text-xs",children:jsxRuntimeExports.jsx(Trans,{message:"at :position",values:{position:jsxRuntimeExports.jsx(FormattedDuration,{seconds:s})}})})});function DeleteCommentButton({comment:e}){const t=useDeleteComments();return jsxRuntimeExports.jsxs(DialogTrigger,{type:"modal",onClose:s=>{s&&t.mutate({commentIds:[e.id]},{onSuccess:()=>{queryClient.invalidateQueries(["comment"])}})},children:[jsxRuntimeExports.jsx(IconButton,{size:"2xs",variant:"outline",radius:"rounded",disabled:t.isLoading,children:jsxRuntimeExports.jsx(DeleteIcon,{})}),jsxRuntimeExports.jsx(ConfirmationDialog,{isDanger:!0,title:jsxRuntimeExports.jsx(Trans,{message:"Delete comment?"}),body:jsxRuntimeExports.jsx(Trans,{message:"Are you sure you want to delete this comment?"}),confirm:jsxRuntimeExports.jsx(Trans,{message:"Delete"})})]})}function UserDisplayName({user:e}){const{auth:t}=reactExports.useContext(SiteConfigContext);return t.getUserProfileLink?jsxRuntimeExports.jsx(Link,{to:t.getUserProfileLink(e),className:"hover:underline",children:e.display_name}):jsxRuntimeExports.jsx("div",{className:"text-muted",children:e.display_name})}function CommentList({className:e,commentable:t,canDeleteAllComments:s=!1}){const{items:n,totalItems:i,...a}=useComments(t);return a.isError?null:jsxRuntimeExports.jsxs("div",{className:e,children:[jsxRuntimeExports.jsxs("div",{className:"mb-8 pb-8 border-b flex items-center gap-8",children:[jsxRuntimeExports.jsx(CommentIcon,{size:"sm",className:"text-muted"}),a.isInitialLoading?jsxRuntimeExports.jsx(Trans,{message:"Loading comments..."}):jsxRuntimeExports.jsx(Trans,{message:":count comments",values:{count:jsxRuntimeExports.jsx(FormattedNumber,{value:i||0})}})]}),jsxRuntimeExports.jsx(AnimatePresence,{initial:!1,mode:"wait",children:a.isInitialLoading?jsxRuntimeExports.jsx(CommentSkeletons,{count:4}):jsxRuntimeExports.jsx(CommentListItems,{comments:n,canDeleteAllComments:s,commentable:t})}),jsxRuntimeExports.jsx(InfiniteScrollSentinel,{query:a})]})}function CommentListItems({comments:e,commentable:t,canDeleteAllComments:s}){return e.length?jsxRuntimeExports.jsx(m.div,{...opacityAnimation,children:e.map(n=>jsxRuntimeExports.jsx(CommentListItem,{comment:n,commentable:t,canDelete:s},n.id))},"comments"):jsxRuntimeExports.jsx(IllustratedMessage,{className:"mt-24",size:"sm",title:jsxRuntimeExports.jsx(Trans,{message:"Seems a little quiet over here"}),description:jsxRuntimeExports.jsx(Trans,{message:"Be the first to comment"})})}function CommentSkeletons({count:e}){return jsxRuntimeExports.jsx(m.div,{...opacityAnimation,children:[...new Array(e).keys()].map(t=>jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-10 py-10 min-h-70 group",children:[jsxRuntimeExports.jsx(Skeleton,{variant:"avatar"}),jsxRuntimeExports.jsxs("div",{className:"flex-auto max-w-384",children:[jsxRuntimeExports.jsx(Skeleton,{className:"leading-3 max-w-120"}),jsxRuntimeExports.jsx(Skeleton,{className:"leading-3"})]}),jsxRuntimeExports.jsx("div",{className:"w-64 ml-auto",children:jsxRuntimeExports.jsx(Skeleton,{className:"leading-3"})})]},t))},"loading-skeleton")}function TruncatedDescription({description:e,className:t}){const s=useLinkifiedString(e),n=reactExports.useRef(null),i=reactExports.useRef(null),[a,o]=reactExports.useState(!1),[l,u]=reactExports.useState(!1);return reactExports.useLayoutEffect(()=>{var j,d;const x=((j=n.current)==null?void 0:j.getBoundingClientRect().height)||0;(((d=n.current)==null?void 0:d.scrollHeight)||0)>x&&o(!0)},[]),s?jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{ref:n,className:clsx("relative",t,!l&&"max-h-160 overflow-hidden",!l&&"after:absolute after:bottom-0 after:left-0 after:w-full after:h-20 after:bg-gradient-to-b after:from-transparent after:to-background"),children:jsxRuntimeExports.jsx("div",{ref:i,dangerouslySetInnerHTML:{__html:s}})}),a&&jsxRuntimeExports.jsx(Button,{size:"xs",className:"mt-20",variant:"outline",onClick:()=>u(!l),children:l?jsxRuntimeExports.jsx(Trans,{message:"Show less"}):jsxRuntimeExports.jsx(Trans,{message:"Show more"})})]}):null}function AlbumPage(){var n,i;const{player:e}=useSettings(),t=useAlbum({autoUpdate:!0,defaultRelations:!0}),{canEdit:s}=useAlbumPermissions((n=t.data)==null?void 0:n.album);return t.data?jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsxs(CommentBarContextProvider,{children:[jsxRuntimeExports.jsx(PageMetaTags,{query:t}),jsxRuntimeExports.jsx(AdHost,{slot:"general_top",className:"mb-44"}),jsxRuntimeExports.jsx(AlbumPageHeader,{album:t.data.album}),e!=null&&e.track_comments?jsxRuntimeExports.jsx(CommentBarNewCommentForm,{className:"mb-16",commentable:t.data.album}):null]}),(i=t.data.album.tags)!=null&&i.length?jsxRuntimeExports.jsx($9bf71ea28793e738$export$20e40289641fbbb6,{children:jsxRuntimeExports.jsx(ChipList,{className:"mb-16",selectable:!0,children:t.data.album.tags.map(a=>jsxRuntimeExports.jsxs(Chip,{elementType:Link,to:`/tag/${a.name}`,children:["#",a.display_name||a.name]},a.id))})}):null,jsxRuntimeExports.jsx(TruncatedDescription,{description:t.data.album.description,className:"text-sm mt-24"}),jsxRuntimeExports.jsx(AdHost,{slot:"album_above",className:"mt-34"}),jsxRuntimeExports.jsx(AlbumTrackTable$1,{album:t.data.album}),jsxRuntimeExports.jsx(CommentList,{className:"mt-34",commentable:t.data.album,canDeleteAllComments:s}),jsxRuntimeExports.jsx(AdHost,{slot:"general_bottom",className:"mt-44"})]}):jsxRuntimeExports.jsx(PageStatus,{query:t,loaderClassName:"absolute inset-0 m-auto"})}function AlbumTrackTable$1({album:e}){var i;const{data:t,sortDescriptor:s,onSortChange:n}=useSortableTableData(e.tracks);return jsxRuntimeExports.jsxs("div",{className:"mt-44",children:[jsxRuntimeExports.jsx(TrackTable,{queueGroupId:queueGroupId(e),tracks:t,sortDescriptor:s,onSortChange:n,hideTrackImage:!0,hideArtist:!0,hideAlbum:!0,hidePopularity:!1}),!((i=e.tracks)!=null&&i.length)&&jsxRuntimeExports.jsx(IllustratedMessage,{className:"mt-34",title:jsxRuntimeExports.jsx(Trans,{message:"Nothing to display"}),description:jsxRuntimeExports.jsx(Trans,{message:"This album does not have any tracks yet"})})]})}function AlbumPageHeader({album:e}){var s,n,i,a,o;const t=(s=e.tracks)==null?void 0:s.reduce((l,u)=>l+(u.duration||0),0);return jsxRuntimeExports.jsx(reactExports.Fragment,{children:jsxRuntimeExports.jsx(MediaPageHeaderLayout,{className:"mb-28",image:jsxRuntimeExports.jsx(AlbumImage,{album:e,className:"rounded"}),title:e.name,subtitle:jsxRuntimeExports.jsx(AvatarGroup,{children:(n=e.artists)==null?void 0:n.map(l=>jsxRuntimeExports.jsx(Avatar,{circle:!0,src:getSmallArtistImage(l),label:l.name,link:getArtistLink(l)},l.id))}),description:jsxRuntimeExports.jsxs(BulletSeparatedItems,{className:"text-sm text-muted",children:[(i=e.tracks)!=null&&i.length?jsxRuntimeExports.jsx(Trans,{message:"[one 1 track|other :count tracks]",values:{count:e.tracks.length}}):null,(a=e.tracks)!=null&&a.length?jsxRuntimeExports.jsx(FormattedDuration,{ms:t,verbose:!0}):null,jsxRuntimeExports.jsx(FormattedDate,{date:e.release_date})]}),actionButtons:jsxRuntimeExports.jsx(TrackActionsBar,{item:e,managesItem:!1,buttonGap:void 0,buttonSize:"sm",buttonRadius:"rounded-full",buttonClassName:actionButtonClassName(),children:jsxRuntimeExports.jsx(PlaybackToggleButton,{disabled:!((o=e.tracks)!=null&&o.length),buttonType:"text",queueId:queueGroupId(e),className:actionButtonClassName({isFirst:!0})})})})})}const libraryTracksQueryKey=e=>{const t=getBootstrapData().user;return e===(t==null?void 0:t.id)&&(e="me"),["tracks","library",e]};function useUserLikedTracks(e,t){return useInfiniteData({queryKey:libraryTracksQueryKey(e),endpoint:`users/${e}/liked-tracks`,defaultOrderBy:"likes.created_at",defaultOrderDir:"desc",...t})}function LibraryTracksPage(){const e=useLibraryStore(d=>Object.keys(d.track).length),t=useUserLikedTracks("me",{willSortOrFilter:!0}),{isInitialLoading:s,sortDescriptor:n,setSortDescriptor:i,searchQuery:a,setSearchQuery:o,items:l,isError:u}=t,{user:x}=useAuth(),{trans:c}=useTrans(),j=queueGroupId(x,"libraryTracks",n);return u?jsxRuntimeExports.jsx(PageErrorMessage,{}):jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(StaticPageTitle,{children:jsxRuntimeExports.jsx(Trans,{message:"Your tracks"})}),jsxRuntimeExports.jsx(AdHost,{slot:"general_top",className:"mb-34"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap items-center gap-24 justify-between mb-34",children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-semibold w-max md:w-full whitespace-nowrap",children:e?jsxRuntimeExports.jsx(Trans,{message:"[one 1 liked song|other :count liked songs]",values:{count:e}}):jsxRuntimeExports.jsx(Trans,{message:"My songs"})}),jsxRuntimeExports.jsx(PlaybackToggleButton,{queueId:j,buttonType:"text",className:"min-w-128 flex-shrink-0"}),jsxRuntimeExports.jsx(TextField,{value:a,onChange:d=>o(d.target.value),className:"max-w-512 flex-auto",size:"sm",startAdornment:jsxRuntimeExports.jsx(SearchIcon,{}),placeholder:c(message("Search within tracks"))})]}),jsxRuntimeExports.jsx(TrackTable,{queueGroupId:j,tracks:s?getPlaceholderItems$1(e):l,sortDescriptor:n,onSortChange:i,hideAddedAtColumn:!1,tableBody:jsxRuntimeExports.jsx(VirtualTableBody,{query:t,totalItems:e})}),!l.length&&!s&&jsxRuntimeExports.jsx(MediaPageNoResultsMessage,{className:"mt-34",searchQuery:a,description:jsxRuntimeExports.jsx(Trans,{message:"You have not added any songs to your library yet."})}),jsxRuntimeExports.jsx(AdHost,{slot:"general_bottom",className:"mt-34"})]})}function getPlaceholderItems$1(e){return[...new Array(Math.min(e,30)).keys()].map((t,s)=>({isPlaceholder:!0,id:`placeholder-${t}`}))}function LibraryPageSortDropdown({items:e,sortDescriptor:t,setSortDescriptor:s}){const n=useIsMobileMediaQuery(),i=`${t.orderBy}:${t.orderDir}`;return jsxRuntimeExports.jsxs(MenuTrigger,{selectionMode:"single",selectedValue:i,onSelectionChange:a=>{const[o,l]=a.split(":");s({orderBy:o,orderDir:l})},children:[n?jsxRuntimeExports.jsx(IconButton,{children:jsxRuntimeExports.jsx(SortIcon,{})}):jsxRuntimeExports.jsx(Button,{variant:"outline",className:"flex-shrink-0",endIcon:jsxRuntimeExports.jsx(ArrowDropDownIcon,{}),children:jsxRuntimeExports.jsx(Trans,{...e[i]})}),jsxRuntimeExports.jsx(Menu,{children:Object.entries(e).map(([a,o])=>jsxRuntimeExports.jsx(Item,{value:a,children:jsxRuntimeExports.jsx(Trans,{...o})},a))})]})}const libraryAlbumsQueryKey=(e,t)=>{const s=getBootstrapData().user;e===(s==null?void 0:s.id)&&(e="me");const n=["albums","library",e];return t&&n.push(t),n};function useUserLikedAlbums(e,t){return useInfiniteData({queryKey:libraryAlbumsQueryKey(e),endpoint:`users/${e}/liked-albums`,defaultOrderBy:"likes.created_at",defaultOrderDir:"desc",...t})}const sortItems$2={"likes.created_at:desc":message("Recently added"),"name:asc":message("A-Z"),"release_date:desc":message("Release date")};function LibraryAlbumsPage(){const{trans:e}=useTrans(),t=useLibraryStore(c=>Object.keys(c.album).length),s=useUserLikedAlbums("me",{willSortOrFilter:!0}),{isInitialLoading:n,sortDescriptor:i,setSortDescriptor:a,searchQuery:o,setSearchQuery:l,items:u,isError:x}=s;return x?jsxRuntimeExports.jsx(PageErrorMessage,{}):jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(StaticPageTitle,{children:jsxRuntimeExports.jsx(Trans,{message:"Your albums"})}),jsxRuntimeExports.jsx(AdHost,{slot:"general_top",className:"mb-34"}),jsxRuntimeExports.jsx("h1",{className:"text-2xl font-semibold mb-20",children:t?jsxRuntimeExports.jsx(Trans,{message:"[one 1 liked album|other :count liked albums]",values:{count:t}}):jsxRuntimeExports.jsx(Trans,{message:"My albums"})}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-24 justify-between",children:[jsxRuntimeExports.jsx(TextField,{value:o,onChange:c=>l(c.target.value),className:"max-w-512 flex-auto",size:"sm",startAdornment:jsxRuntimeExports.jsx(SearchIcon,{}),placeholder:e(message("Search within albums"))}),jsxRuntimeExports.jsx(LibraryPageSortDropdown,{items:sortItems$2,sortDescriptor:i,setSortDescriptor:a})]}),jsxRuntimeExports.jsx("div",{className:"mt-34",children:jsxRuntimeExports.jsx(AnimatePresence,{initial:!1,mode:"wait",children:n?jsxRuntimeExports.jsx(PlayableMediaGridSkeleton,{itemCount:t}):jsxRuntimeExports.jsx(m.div,{...opacityAnimation,children:jsxRuntimeExports.jsxs(ContentGrid,{children:[u.map(c=>jsxRuntimeExports.jsx(AlbumGridItem,{album:c},c.id)),jsxRuntimeExports.jsx(InfiniteScrollSentinel,{query:s})]})},"media-grid")})}),!u.length&&!n&&jsxRuntimeExports.jsx(MediaPageNoResultsMessage,{className:"mt-34",searchQuery:o,description:jsxRuntimeExports.jsx(Trans,{message:"You have not added any albums to your library yet."})}),jsxRuntimeExports.jsx(AdHost,{slot:"general_bottom",className:"mt-34"})]})}const libraryArtistsQueryKey=e=>{const t=getBootstrapData().user;return e===(t==null?void 0:t.id)&&(e="me"),["artists","library",e]};function useUserLikedArtists(e,t){return useInfiniteData({queryKey:libraryArtistsQueryKey(e),endpoint:`users/${e}/liked-artists`,defaultOrderBy:"likes.created_at",defaultOrderDir:"desc",...t})}const sortItems$1={"likes.created_at:desc":message("Recently added"),"name:asc":message("A-Z")};function LibraryArtistsPage(){const{trans:e}=useTrans(),t=useLibraryStore(c=>Object.keys(c.artist).length),s=useUserLikedArtists("me",{willSortOrFilter:!0}),{isInitialLoading:n,sortDescriptor:i,setSortDescriptor:a,searchQuery:o,setSearchQuery:l,items:u,isError:x}=s;return x?jsxRuntimeExports.jsx(PageErrorMessage,{}):jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(StaticPageTitle,{children:jsxRuntimeExports.jsx(Trans,{message:"Your artists"})}),jsxRuntimeExports.jsx(AdHost,{slot:"general_top",className:"mb-34"}),jsxRuntimeExports.jsx("h1",{className:"text-2xl font-semibold mb-20",children:t?jsxRuntimeExports.jsx(Trans,{message:"[one 1 liked artist|other :count liked artists]",values:{count:t}}):jsxRuntimeExports.jsx(Trans,{message:"My artists"})}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-24 justify-between",children:[jsxRuntimeExports.jsx(TextField,{value:o,onChange:c=>l(c.target.value),className:"max-w-512 flex-auto",size:"sm",startAdornment:jsxRuntimeExports.jsx(SearchIcon,{}),placeholder:e(message("Search within artists"))}),jsxRuntimeExports.jsx(LibraryPageSortDropdown,{items:sortItems$1,sortDescriptor:i,setSortDescriptor:a})]}),jsxRuntimeExports.jsx("div",{className:"mt-34",children:jsxRuntimeExports.jsx(AnimatePresence,{initial:!1,mode:"wait",children:n?jsxRuntimeExports.jsx(PlayableMediaGridSkeleton,{itemCount:t,itemRadius:"rounded-full",showDescription:!1}):jsxRuntimeExports.jsx(m.div,{...opacityAnimation,children:jsxRuntimeExports.jsxs(ContentGrid,{children:[u.map(c=>jsxRuntimeExports.jsx(ArtistGridItem,{artist:c},c.id)),jsxRuntimeExports.jsx(InfiniteScrollSentinel,{query:s})]})},"media-grid")})}),!u.length&&!n&&jsxRuntimeExports.jsx(MediaPageNoResultsMessage,{className:"mt-34",searchQuery:o,description:jsxRuntimeExports.jsx(Trans,{message:"You have not added any artists to your library yet."})}),jsxRuntimeExports.jsx(AdHost,{slot:"general_bottom",className:"mt-34"})]})}const libraryHistoryQueryKey=["tracks","history","me"];function LibraryHistoryPage(){const{user:e}=useAuth(),t=useInfiniteData({queryKey:libraryHistoryQueryKey,endpoint:`track/plays/${e.id}`,defaultOrderBy:"track_plays.created_at",defaultOrderDir:"desc",paginate:"simple",willSortOrFilter:!0}),{isInitialLoading:s,sortDescriptor:n,setSortDescriptor:i,searchQuery:a,setSearchQuery:o,items:l,isError:u}=t,{trans:x}=useTrans(),c=queueGroupId(e,"playHistory",n);return u?jsxRuntimeExports.jsx(PageErrorMessage,{}):jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(StaticPageTitle,{children:jsxRuntimeExports.jsx(Trans,{message:"Listening history"})}),jsxRuntimeExports.jsx(AdHost,{slot:"general_top",className:"mb-34"}),jsxRuntimeExports.jsxs("div",{className:"flex flex-wrap items-center gap-24 justify-between mb-34",children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-semibold w-max md:w-full whitespace-nowrap",children:jsxRuntimeExports.jsx(Trans,{message:"Listening history"})}),jsxRuntimeExports.jsx(PlaybackToggleButton,{queueId:c,buttonType:"text",className:"min-w-128 flex-shrink-0"}),jsxRuntimeExports.jsx(TextField,{value:a,onChange:j=>o(j.target.value),className:"max-w-512 flex-auto",size:"sm",startAdornment:jsxRuntimeExports.jsx(SearchIcon,{}),placeholder:x(message("Search within history"))})]}),jsxRuntimeExports.jsx(TrackTable,{queueGroupId:c,tracks:s?getPlaceholderItems():l,sortDescriptor:n,onSortChange:i,hideAddedAtColumn:!1,tableBody:jsxRuntimeExports.jsx(VirtualTableBody,{query:t})}),!l.length&&!s&&jsxRuntimeExports.jsx(MediaPageNoResultsMessage,{className:"mt-34",searchQuery:a,description:jsxRuntimeExports.jsx(Trans,{message:"You have not played any songs yet."})}),jsxRuntimeExports.jsx(AdHost,{slot:"general_bottom",className:"mt-34"})]})}function getPlaceholderItems(){return[...new Array(10).keys()].map(e=>({isPlaceholder:!0,id:`placeholder-${e}`}))}function TrackPage(){var n;const e=useTrack({autoUpdate:!0}),{canEdit:t}=useTrackPermissions([(n=e.data)==null?void 0:n.track]),{player:s}=useSettings();return e.data?jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsxs(CommentBarContextProvider,{children:[jsxRuntimeExports.jsx(PageMetaTags,{query:e}),jsxRuntimeExports.jsx(AdHost,{slot:"general_top",className:"mb-44"}),jsxRuntimeExports.jsx(TrackPageHeader,{track:e.data.track}),s!=null&&s.track_comments?jsxRuntimeExports.jsx(CommentBarNewCommentForm,{className:"mb-16",commentable:e.data.track}):null]}),e.data.track.tags.length?jsxRuntimeExports.jsx($9bf71ea28793e738$export$20e40289641fbbb6,{children:jsxRuntimeExports.jsx(ChipList,{className:"mb-16",selectable:!0,children:e.data.track.tags.map(i=>jsxRuntimeExports.jsxs(Chip,{elementType:Link,to:`/tag/${i.name}`,children:["#",i.display_name||i.name]},i.id))})}):null,jsxRuntimeExports.jsx(TruncatedDescription,{description:e.data.track.description,className:"text-sm mt-24"}),s!=null&&s.track_comments?jsxRuntimeExports.jsx(CommentList,{className:"mt-34",commentable:e.data.track,canDeleteAllComments:t}):null,e.data.track.album&&jsxRuntimeExports.jsx(AlbumTrackTable,{album:e.data.track.album}),jsxRuntimeExports.jsx(AdHost,{slot:"general_bottom",className:"mt-44"})]}):jsxRuntimeExports.jsx(PageStatus,{query:e,loaderClassName:"absolute inset-0 m-auto"})}function AlbumTrackTable({album:e}){var i;const{data:t,sortDescriptor:s,onSortChange:n}=useSortableTableData(e.tracks);return jsxRuntimeExports.jsxs("div",{className:"mt-44",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-16 bg-hover rounded overflow-hidden mb-14",children:[jsxRuntimeExports.jsx(AlbumImage,{album:e,className:"flex-shrink-0 rounded",size:"w-70 h-70"}),jsxRuntimeExports.jsxs("div",{className:"flex-auto",children:[jsxRuntimeExports.jsx("div",{className:"text-sm",children:jsxRuntimeExports.jsx(Trans,{message:"From the album"})}),jsxRuntimeExports.jsx("div",{className:"font-semibold text-sm",children:e.name})]})]}),jsxRuntimeExports.jsx(TrackTable,{queueGroupId:queueGroupId(e),tracks:t,sortDescriptor:s,onSortChange:n,hideTrackImage:!0,hideArtist:!0,hideAlbum:!0,hidePopularity:!1}),!((i=e.tracks)!=null&&i.length)&&jsxRuntimeExports.jsx(IllustratedMessage,{className:"mt-34",title:jsxRuntimeExports.jsx(Trans,{message:"Nothing to display"}),description:jsxRuntimeExports.jsx(Trans,{message:"This album does not have any tracks yet"})})]})}function TrackPageHeader({track:e}){var o,l,u;const t=useIsMobileMediaQuery(),{player:s}=useSettings(),n=((o=e.album)==null?void 0:o.release_date)||e.created_at,i=(l=e.genres)==null?void 0:l[0],a=!t&&(s==null?void 0:s.seekbar_type)==="waveform"&&trackIsLocallyUploaded(e);return jsxRuntimeExports.jsx(reactExports.Fragment,{children:jsxRuntimeExports.jsx(MediaPageHeaderLayout,{className:"mb-28",image:jsxRuntimeExports.jsx(TrackImage,{track:e}),title:e.name,subtitle:jsxRuntimeExports.jsx(AvatarGroup,{children:(u=e.artists)==null?void 0:u.map(x=>jsxRuntimeExports.jsx(Avatar,{circle:!0,src:getSmallArtistImage(x),label:x.name,link:getArtistLink(x)},x.id))}),description:jsxRuntimeExports.jsxs(BulletSeparatedItems,{className:"text-sm text-muted",children:[e.duration?jsxRuntimeExports.jsx(FormattedDuration,{ms:e.duration,verbose:!0}):null,n&&jsxRuntimeExports.jsx(FormattedDate,{date:n}),i&&jsxRuntimeExports.jsx(GenreLink,{genre:i}),e.plays&&!(s!=null&&s.enable_repost)?jsxRuntimeExports.jsx(Trans,{message:":count plays",values:{count:jsxRuntimeExports.jsx(FormattedNumber,{value:e.plays})}}):null]}),actionButtons:jsxRuntimeExports.jsx(TrackActionsBar,{item:e,managesItem:!1,buttonGap:void 0,buttonSize:"sm",buttonRadius:"rounded-full",buttonClassName:actionButtonClassName(),children:jsxRuntimeExports.jsx(PlaybackToggleButton,{buttonType:"text",track:e,className:actionButtonClassName({isFirst:!0})})}),footer:a?jsxRuntimeExports.jsx(Waveform,{track:e}):void 0})})}function useUserProfile(){const{userId:e}=useParams();return useQuery(userProfileQueryKey(e),()=>fetchUser(e))}function fetchUser(e){return apiClient.get(`users/${e}`).then(t=>t.data)}function userProfileQueryKey(e){return["users",+e,"profile"]}function ProfileRepostsPanel({user:e}){const t=useIsMobileMediaQuery(),s=useInfiniteData({queryKey:["reposts",e.id],endpoint:`users/${e.id}/reposts`});return s.isInitialLoading?jsxRuntimeExports.jsx(FullPageLoader,{className:"min-h-100"}):s.items.length?t?jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(ContentGrid,{children:s.items.map(n=>{var i,a;return((i=n.repostable)==null?void 0:i.model_type)==="track"?jsxRuntimeExports.jsx(TrackGridItem,{track:n.repostable},n.id):((a=n.repostable)==null?void 0:a.model_type)==="album"?jsxRuntimeExports.jsx(AlbumGridItem,{album:n.repostable},n.id):null})}),jsxRuntimeExports.jsx(InfiniteScrollSentinel,{query:s})]}):jsxRuntimeExports.jsxs("div",{children:[s.items.map(n=>{var i,a;return((i=n.repostable)==null?void 0:i.model_type)==="track"?jsxRuntimeExports.jsx(TrackListItem,{className:"mb-40",track:n.repostable,reposter:e},n.id):((a=n.repostable)==null?void 0:a.model_type)==="album"?jsxRuntimeExports.jsx(AlbumListItem,{album:n.repostable,className:"mb-40"},n.id):null}),jsxRuntimeExports.jsx(InfiniteScrollSentinel,{query:s})]}):jsxRuntimeExports.jsx(IllustratedMessage,{imageHeight:"h-auto",imageMargin:"mb-14",image:jsxRuntimeExports.jsx(AudiotrackIcon,{size:"lg",className:"text-muted"}),title:jsxRuntimeExports.jsx(Trans,{message:"No reposts yet"}),description:jsxRuntimeExports.jsx(Trans,{message:"Follow :user for updates on tracks and albums they repost in the future.",values:{user:e.display_name}})})}function ProfileTracksPanel({user:e}){const t=useUserLikedTracks(e.id);return t.isInitialLoading?jsxRuntimeExports.jsx(FullPageLoader,{className:"min-h-100"}):t.items.length?jsxRuntimeExports.jsx(TrackList,{query:t}):jsxRuntimeExports.jsx(IllustratedMessage,{imageHeight:"h-auto",imageMargin:"mb-14",image:jsxRuntimeExports.jsx(AudiotrackIcon,{size:"lg",className:"text-muted"}),title:jsxRuntimeExports.jsx(Trans,{message:"No tracks yet"}),description:jsxRuntimeExports.jsx(Trans,{message:"Follow :user for updates on tracks they like in the future.",values:{user:e.display_name}})})}const libraryPlaylistsQueryKey=(e,t)=>{const s=getBootstrapData().user;e===(s==null?void 0:s.id)&&(e="me");const n=["playlists","library",e];return t&&n.push(t),n};function useUserPlaylists(e,t){return useInfiniteData({queryKey:libraryPlaylistsQueryKey(e),endpoint:`users/${e}/playlists`,defaultOrderBy:"updated_at",defaultOrderDir:"desc",...t})}function ProfilePlaylistsPanel({user:e}){const t=useUserPlaylists(e.id);return t.isInitialLoading?jsxRuntimeExports.jsx(FullPageLoader,{className:"min-h-100"}):t.items.length?jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(ContentGrid,{children:t.items.map(s=>jsxRuntimeExports.jsx(PlaylistGridItem,{playlist:s},s.id))}),jsxRuntimeExports.jsx(InfiniteScrollSentinel,{query:t})]}):jsxRuntimeExports.jsx(IllustratedMessage,{imageHeight:"h-auto",imageMargin:"mb-14",image:jsxRuntimeExports.jsx(QueueMusicIcon,{size:"lg",className:"text-muted"}),title:jsxRuntimeExports.jsx(Trans,{message:"No playlists yet"}),description:jsxRuntimeExports.jsx(Trans,{message:"Follow :user for updates on playlists they create in the future.",values:{user:e.display_name}})})}function ProfileAlbumsPanel({user:e}){const t=useUserLikedAlbums(e.id,{queryParams:{with:"tracks"}});return t.isInitialLoading?jsxRuntimeExports.jsx(FullPageLoader,{className:"min-h-100"}):t.items.length?jsxRuntimeExports.jsx(AlbumList,{query:t}):jsxRuntimeExports.jsx(IllustratedMessage,{imageHeight:"h-auto",imageMargin:"mb-14",image:jsxRuntimeExports.jsx(AlbumIcon,{size:"lg",className:"text-muted"}),title:jsxRuntimeExports.jsx(Trans,{message:"No albums yet"}),description:jsxRuntimeExports.jsx(Trans,{message:"Follow :user for updates on albums they like in the future.",values:{user:e.display_name}})})}function ProfileArtistsPanel({user:e}){const t=useUserLikedArtists(e.id);return t.isInitialLoading?jsxRuntimeExports.jsx(FullPageLoader,{className:"min-h-100"}):t.items.length?jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(ContentGrid,{children:t.items.map(s=>jsxRuntimeExports.jsx(ArtistGridItem,{artist:s},s.id))}),jsxRuntimeExports.jsx(InfiniteScrollSentinel,{query:t})]}):jsxRuntimeExports.jsx(IllustratedMessage,{imageHeight:"h-auto",imageMargin:"mb-14",image:jsxRuntimeExports.jsx(MicIcon,{size:"lg",className:"text-muted"}),title:jsxRuntimeExports.jsx(Trans,{message:"No artists yet"}),description:jsxRuntimeExports.jsx(Trans,{message:"Follow :user for updates on artists they like in the future.",values:{user:e.display_name}})})}function ProfileFollowersPanel({user:e}){const t=useInfiniteData({queryKey:["users",e.id,"followers"],endpoint:`users/${e.id}/followers`});return t.isInitialLoading?jsxRuntimeExports.jsx(FullPageLoader,{className:"min-h-100"}):t.items.length?jsxRuntimeExports.jsxs("div",{children:[t.items.map(s=>jsxRuntimeExports.jsx(FollowerListItem,{follower:s},s.id)),jsxRuntimeExports.jsx(InfiniteScrollSentinel,{query:t})]}):jsxRuntimeExports.jsx(IllustratedMessage,{imageHeight:"h-auto",imageMargin:"mb-14",image:jsxRuntimeExports.jsx(BookmarkBorderIcon,{size:"lg",className:"text-muted"}),description:jsxRuntimeExports.jsx(Trans,{message:"Seems like no one is following :name yet.",values:{name:e.display_name}})})}function ProfileFollowedUsersPanel({user:e}){const t=useInfiniteData({queryKey:["users",e.id,"followed-users"],endpoint:`users/${e.id}/followed-users`});return t.isInitialLoading?jsxRuntimeExports.jsx(FullPageLoader,{className:"min-h-100"}):t.items.length?jsxRuntimeExports.jsxs("div",{children:[t.items.map(s=>jsxRuntimeExports.jsx(FollowerListItem,{follower:s},s.id)),jsxRuntimeExports.jsx(InfiniteScrollSentinel,{query:t})]}):jsxRuntimeExports.jsx(IllustratedMessage,{imageHeight:"h-auto",imageMargin:"mb-14",image:jsxRuntimeExports.jsx(BookmarkBorderIcon,{size:"lg",className:"text-muted"}),description:jsxRuntimeExports.jsx(Trans,{message:"Seems like :name is not following anyone yet.",values:{name:e.display_name}})})}function useUpdateUserProfile(e){const{user:t}=useAuth(),{trans:s}=useTrans();return useMutation(n=>updateProfile(n),{onSuccess:()=>{toast(s(message("Profile updated"))),t&&queryClient.invalidateQueries(userProfileQueryKey(t.id))},onError:n=>onFormQueryError(n,e)})}function updateProfile(e){return apiClient.put("users/profile/update",e).then(t=>t.data)}function EditProfileDialog({user:e}){var a,o,l;const{close:t,formId:s}=useDialogContext(),n=useForm({defaultValues:{user:{username:e.username,avatar:e.avatar,first_name:e.first_name,last_name:e.last_name},profile:{city:(a=e.profile)==null?void 0:a.city,country:(o=e.profile)==null?void 0:o.country,description:(l=e.profile)==null?void 0:l.description},links:e.links}}),i=useUpdateUserProfile(n);return jsxRuntimeExports.jsxs(Dialog,{size:"xl",children:[jsxRuntimeExports.jsx(DialogHeader,{children:jsxRuntimeExports.jsx(Trans,{message:"Edit your profile"})}),jsxRuntimeExports.jsx(DialogBody,{children:jsxRuntimeExports.jsx(Form,{id:s,form:n,onSubmit:u=>i.mutate(u,{onSuccess:()=>t()}),children:jsxRuntimeExports.jsxs(FileUploadProvider,{children:[jsxRuntimeExports.jsxs("div",{className:"flex items-start gap-30",children:[jsxRuntimeExports.jsx(FormImageSelector,{label:jsxRuntimeExports.jsx(Trans,{message:"Avatar"}),name:"user.avatar",diskPrefix:"avatars",variant:"square",previewSize:"w-200 h-200"}),jsxRuntimeExports.jsxs("div",{className:"flex-auto",children:[jsxRuntimeExports.jsx(FormTextField,{name:"user.username",label:jsxRuntimeExports.jsx(Trans,{message:"Username"}),className:"mb-24"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-24",children:[jsxRuntimeExports.jsx(FormTextField,{name:"user.first_name",label:jsxRuntimeExports.jsx(Trans,{message:"First name"}),className:"flex-auto mb-24"}),jsxRuntimeExports.jsx(FormTextField,{name:"user.last_name",label:jsxRuntimeExports.jsx(Trans,{message:"Last name"}),className:"flex-auto mb-24"})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-24",children:[jsxRuntimeExports.jsx(FormTextField,{name:"profile.city",label:jsxRuntimeExports.jsx(Trans,{message:"City"}),className:"flex-auto mb-24"}),jsxRuntimeExports.jsx(FormTextField,{name:"profile.country",label:jsxRuntimeExports.jsx(Trans,{message:"Country"}),className:"flex-auto mb-24"})]}),jsxRuntimeExports.jsx(FormTextField,{name:"profile.description",label:jsxRuntimeExports.jsx(Trans,{message:"Description"}),inputElementType:"textarea",rows:4})]})]}),jsxRuntimeExports.jsxs("div",{className:"mt-24",children:[jsxRuntimeExports.jsx("div",{className:"mb-16 pb-16 border-b",children:jsxRuntimeExports.jsx(Trans,{message:"Your links"})}),jsxRuntimeExports.jsx(ProfileLinksForm,{})]})]})})}),jsxRuntimeExports.jsxs(DialogFooter,{children:[jsxRuntimeExports.jsx(Button,{type:"button",onClick:()=>{t()},children:jsxRuntimeExports.jsx(Trans,{message:"Cancel"})}),jsxRuntimeExports.jsx(Button,{form:s,type:"submit",variant:"flat",color:"primary",disabled:i.isLoading,children:jsxRuntimeExports.jsx(Trans,{message:"Save"})})]})]})}function ProfileHeader({user:e,tabLink:t}){const{user:s}=useAuth();return jsxRuntimeExports.jsx(MediaPageHeaderLayout,{image:jsxRuntimeExports.jsx(UserImage,{user:e,size:"w-240 h-240",className:"rounded",showProBadge:!0}),title:e.display_name,subtitle:jsxRuntimeExports.jsxs(BulletSeparatedItems,{className:"text-sm text-muted z-20 w-max mx-auto",children:[e.followers_count&&e.followers_count>0?jsxRuntimeExports.jsx(Link,{to:t("followers"),className:"hover:underline",children:jsxRuntimeExports.jsx(Trans,{message:":count followers",values:{count:e.followers_count}})}):null,e.followed_users_count&&e.followed_users_count>0?jsxRuntimeExports.jsx(Link,{to:t("following"),className:"hover:underline",children:jsxRuntimeExports.jsx(Trans,{message:"Following :count",values:{count:e.followed_users_count}})}):null]}),actionButtons:jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-center md:justify-start",children:[jsxRuntimeExports.jsx(FollowButton,{user:e}),(s==null?void 0:s.id)===e.id&&jsxRuntimeExports.jsx(EditButton,{user:e})]}),footer:jsxRuntimeExports.jsx(ProfileDescription,{profile:e.profile,links:e.links})})}function EditButton({user:e}){return jsxRuntimeExports.jsxs(DialogTrigger,{type:"modal",children:[jsxRuntimeExports.jsx(Button,{variant:"outline",radius:"rounded-full",startIcon:jsxRuntimeExports.jsx(EditIcon,{}),className:actionButtonClassName(),children:jsxRuntimeExports.jsx(Trans,{message:"Edit"})}),jsxRuntimeExports.jsx(EditProfileDialog,{user:e})]})}function FollowButton({user:e}){const{user:t}=useAuth(),s=userFollowsStore(a=>a.isFollowing(e.id)),n=useFollowUser(),i=useUnfollowUser();return s?jsxRuntimeExports.jsx(Button,{variant:"flat",color:"primary",className:actionButtonClassName({isFirst:!0}),radius:"rounded-full",onClick:()=>i.mutate({user:e}),disabled:(t==null?void 0:t.id)===e.id||i.isLoading,children:jsxRuntimeExports.jsx(Trans,{message:"Unfollow"})}):jsxRuntimeExports.jsx(Button,{variant:"flat",color:"primary",className:actionButtonClassName({isFirst:!0}),radius:"rounded-full",onClick:()=>n.mutate({user:e}),disabled:(t==null?void 0:t.id)===e.id||n.isLoading,children:jsxRuntimeExports.jsx(Trans,{message:"Follow"})})}const profileTabs=["tracks","playlists","reposts","albums","artists","followers","following"];var C;(C=getBootstrapData().settings.player)!=null&&C.enable_repost||profileTabs.splice(2,1);function UserProfilePage(){const e=useUserProfile();return e.data?jsxRuntimeExports.jsx(PageContent$1,{user:e.data.user}):jsxRuntimeExports.jsx(PageStatus,{query:e,loaderClassName:"absolute inset-0 m-auto"})}function PageContent$1({user:e}){const{player:t}=useSettings(),{tabName:s="tracks"}=useParams(),n=profileTabs.indexOf(s)||0,i=reactExports.useCallback(a=>`/user/${e.id}/${e.display_name}/${a}`,[e]);return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(ProfileHeader,{user:e,tabLink:i}),jsxRuntimeExports.jsxs(Tabs,{className:"mt-48",isLazy:!0,selectedTab:n,children:[jsxRuntimeExports.jsxs(TabList,{children:[jsxRuntimeExports.jsx(Tab,{elementType:Link,to:i("tracks"),children:jsxRuntimeExports.jsx(Trans,{message:"Liked tracks"})}),jsxRuntimeExports.jsx(Tab,{elementType:Link,to:i("playlists"),children:jsxRuntimeExports.jsx(Trans,{message:"Public playlists"})}),(t==null?void 0:t.enable_repost)&&jsxRuntimeExports.jsx(Tab,{elementType:Link,to:i("reposts"),children:jsxRuntimeExports.jsx(Trans,{message:"Reposts"})}),jsxRuntimeExports.jsx(Tab,{elementType:Link,to:i("albums"),children:jsxRuntimeExports.jsx(Trans,{message:"Liked albums"})}),jsxRuntimeExports.jsx(Tab,{elementType:Link,to:i("artists"),children:jsxRuntimeExports.jsx(Trans,{message:"Liked artists"})}),jsxRuntimeExports.jsx(Tab,{elementType:Link,to:i("followers"),children:jsxRuntimeExports.jsx(Trans,{message:"Followers"})}),jsxRuntimeExports.jsx(Tab,{elementType:Link,to:i("following"),children:jsxRuntimeExports.jsx(Trans,{message:"Following"})})]}),jsxRuntimeExports.jsxs(TabPanels,{className:"mt-24",children:[jsxRuntimeExports.jsx(TabPanel,{children:jsxRuntimeExports.jsx(ProfileTracksPanel,{user:e})}),jsxRuntimeExports.jsx(TabPanel,{children:jsxRuntimeExports.jsx(ProfilePlaylistsPanel,{user:e})}),(t==null?void 0:t.enable_repost)&&jsxRuntimeExports.jsx(TabPanel,{children:jsxRuntimeExports.jsx(ProfileRepostsPanel,{user:e})}),jsxRuntimeExports.jsx(TabPanel,{children:jsxRuntimeExports.jsx(ProfileAlbumsPanel,{user:e})}),jsxRuntimeExports.jsx(TabPanel,{children:jsxRuntimeExports.jsx(ProfileArtistsPanel,{user:e})}),jsxRuntimeExports.jsx(TabPanel,{children:jsxRuntimeExports.jsx(ProfileFollowersPanel,{user:e})}),jsxRuntimeExports.jsx(TabPanel,{children:jsxRuntimeExports.jsx(ProfileFollowedUsersPanel,{user:e})})]})]})]})}const tagTabNames={tracks:0,albums:1};function TagMediaPage(){var a;const e=useParams(),t=e.tagName,s=((a=e["*"])==null?void 0:a.split("/").pop())||tagTabNames.tracks,[n,i]=reactExports.useState(tagTabNames[s]||0);return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx("h1",{className:"text-3xl mb-40",children:s==="albums"?jsxRuntimeExports.jsx(Trans,{message:"Most popular albums for #:tag",values:{tag:t}}):jsxRuntimeExports.jsx(Trans,{message:"Most popular tracks for #:tag",values:{tag:t}})}),jsxRuntimeExports.jsxs(Tabs,{selectedTab:n,onTabChange:i,children:[jsxRuntimeExports.jsxs(TabList,{children:[jsxRuntimeExports.jsx(Tab,{elementType:Link,to:`/tag/${t}`,children:jsxRuntimeExports.jsx(Trans,{message:"Tracks"})}),jsxRuntimeExports.jsx(Tab,{elementType:Link,to:`/tag/${t}/albums`,children:jsxRuntimeExports.jsx(Trans,{message:"Albums"})})]}),jsxRuntimeExports.jsxs(TabPanels,{className:"pt-24",children:[jsxRuntimeExports.jsx(TabPanel,{children:jsxRuntimeExports.jsx(TracksPanel,{tagName:t})}),jsxRuntimeExports.jsx(TabPanel,{children:jsxRuntimeExports.jsx(AlbumsPanel,{tagName:t})})]})]})]})}function AlbumsPanel({tagName:e}){const t=useInfiniteData({queryKey:["albums","tags",e],endpoint:`tags/${e}/albums`});return t.isInitialLoading?jsxRuntimeExports.jsx(FullPageLoader,{className:"min-h-100"}):t.items.length?jsxRuntimeExports.jsx(AlbumList,{query:t}):jsxRuntimeExports.jsx(IllustratedMessage,{imageHeight:"h-auto",imageMargin:"mb-14",image:jsxRuntimeExports.jsx(AlbumIcon,{size:"lg",className:"text-muted"}),title:jsxRuntimeExports.jsx(Trans,{message:"No albums yet"}),description:jsxRuntimeExports.jsx(Trans,{message:"This tag is not attached to any albums yet, check back later."})})}function TracksPanel({tagName:e}){const t=useInfiniteData({queryKey:["tracks","tags",e],endpoint:`tags/${e}/tracks`});return t.isInitialLoading?jsxRuntimeExports.jsx(FullPageLoader,{className:"min-h-100"}):t.items.length?jsxRuntimeExports.jsx(TrackList,{query:t}):jsxRuntimeExports.jsx(IllustratedMessage,{imageHeight:"h-auto",imageMargin:"mb-14",image:jsxRuntimeExports.jsx(AudiotrackIcon,{size:"lg",className:"text-muted"}),title:jsxRuntimeExports.jsx(Trans,{message:"No tracks yet"}),description:jsxRuntimeExports.jsx(Trans,{message:"This tag is not attached to any tracks yet, check back later."})})}function useRadioRecommendations(){const{seedType:e,seedId:t}=useParams();return useQuery(["radio",e,+t],()=>fetchRecommendations(e,t),{staleTime:1/0})}function fetchRecommendations(e,t){return apiClient.get(`radio/${e}/${t}`).then(s=>s.data)}const validSeeds=["artist","track","genre"];function RadioPage(){var o;const{seedType:e}=useParams(),t=useRadioRecommendations(),{data:s,onSortChange:n,sortDescriptor:i}=useSortableTableData((o=t.data)==null?void 0:o.recommendations),a=reactExports.useMemo(()=>s.reduce((l,u)=>l+(u.duration||0),0),[s]);if(!validSeeds.includes(e))return jsxRuntimeExports.jsx(NotFoundPage,{});if(t.data){const l=t.data.seed,u=queueGroupId(l,"radio");return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(PageMetaTags,{query:t}),jsxRuntimeExports.jsx(AdHost,{slot:"general_top",className:"mb-44"}),jsxRuntimeExports.jsx(MediaPageHeaderLayout,{image:jsxRuntimeExports.jsx(Image,{seed:l}),title:jsxRuntimeExports.jsx(Trans,{message:":name radio",values:{name:"display_name"in l&&l.display_name?l.display_name:l.name}}),subtitle:jsxRuntimeExports.jsxs(BulletSeparatedItems,{className:"text-sm text-muted justify-center md:justify-start",children:[jsxRuntimeExports.jsx(RadioType,{seed:l}),jsxRuntimeExports.jsx(Trans,{message:"[one 1 song|other :count songs]",values:{count:s.length}}),jsxRuntimeExports.jsx(FormattedDuration,{ms:a,verbose:!0})]}),actionButtons:jsxRuntimeExports.jsx("div",{className:"text-center md:text-start",children:jsxRuntimeExports.jsx(PlaybackToggleButton,{tracks:s,disabled:!s.length,buttonType:"text",queueId:u,className:actionButtonClassName({isFirst:!0})})})}),jsxRuntimeExports.jsx(TrackTable,{className:"mt-34",tracks:s,queueGroupId:u,onSortChange:n,sortDescriptor:i}),jsxRuntimeExports.jsx(AdHost,{slot:"general_bottom",className:"mt-44"})]})}return jsxRuntimeExports.jsx(PageStatus,{query:t,loaderClassName:"absolute inset-0 m-auto"})}function Image({seed:e}){switch(e.model_type){case"artist":return jsxRuntimeExports.jsx(SmallArtistImage,{artist:e,size:"w-240 h-240",className:"rounded mx-auto"});case"genre":return jsxRuntimeExports.jsx(GenreImage,{genre:e,size:"w-240 h-240 mx-auto",className:"rounded"});default:return jsxRuntimeExports.jsx(TrackImage,{track:e,size:"w-240 h-240 mx-auto",className:"rounded"})}}function RadioType({seed:e}){switch(e.model_type){case"artist":return jsxRuntimeExports.jsx(Trans,{message:"Artist radio"});case"genre":return jsxRuntimeExports.jsx(Trans,{message:"Genre radio"});default:return jsxRuntimeExports.jsx(Trans,{message:"Track radio"})}}function SearchResultsPage(){const{searchQuery:e}=useParams(),t=useSearchResults({query:e,types:mainSearchModels,limit:20});return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(MobileSearchBar,{}),jsxRuntimeExports.jsx(PageContent,{query:t})]})}function MobileSearchBar(){const e=useIsMobileMediaQuery(),{searchQuery:t=""}=useParams(),s=useNavigate(),{trans:n}=useTrans();return e?jsxRuntimeExports.jsx(TextField,{defaultValue:t,onChange:i=>{s(`/search/${i.target.value}`,{replace:!0})},autoFocus:!0,className:"w-full",placeholder:n(message("Search..."))}):null}function PageContent({query:e}){var s;const{branding:t}=useSettings();return e.data?jsxRuntimeExports.jsx(SearchResults,{results:(s=e.data)==null?void 0:s.results}):e.fetchStatus==="idle"?jsxRuntimeExports.jsx(IllustratedMessage,{className:"mt-40",image:jsxRuntimeExports.jsx(SearchIcon,{size:"xl"}),imageHeight:"h-auto",imageMargin:"mb-12",title:jsxRuntimeExports.jsx(Trans,{message:"Search :siteName",values:{siteName:t.site_name}}),description:jsxRuntimeExports.jsx(Trans,{message:"Find songs, artists, albums, playlists and more."})}):jsxRuntimeExports.jsx(PageStatus,{query:e,loaderClassName:"absolute inset-0 m-auto"})}function SearchResults({results:e}){var x,c,j,d,E,y,v,p,f,R;const{tabName:t="all",searchQuery:s}=useParams(),i=reactExports.useMemo(()=>["all",...["tracks","artists","albums","playlists","users"].filter(g=>{var b;return(b=e[g])==null?void 0:b.length})],[e]).indexOf(t),[a,o]=reactExports.useState(i>-1?i:0),l=h=>{let g=`/search/${s}`;return h&&(g+=`/${h}`),g};return Object.entries(e).some(([,h])=>h==null?void 0:h.length)?jsxRuntimeExports.jsxs(Tabs,{selectedTab:a,onTabChange:o,children:[jsxRuntimeExports.jsxs(TabList,{children:[jsxRuntimeExports.jsx(Tab,{elementType:Link,to:l(),children:jsxRuntimeExports.jsx(Trans,{message:"Top results"})}),((x=e.tracks)==null?void 0:x.length)&&jsxRuntimeExports.jsx(Tab,{elementType:Link,to:l("tracks"),children:jsxRuntimeExports.jsx(Trans,{message:"Tracks"})}),((c=e.artists)==null?void 0:c.length)&&jsxRuntimeExports.jsx(Tab,{elementType:Link,to:l("artists"),children:jsxRuntimeExports.jsx(Trans,{message:"Artists"})}),((j=e.albums)==null?void 0:j.length)&&jsxRuntimeExports.jsx(Tab,{elementType:Link,to:l("albums"),children:jsxRuntimeExports.jsx(Trans,{message:"Albums"})}),((d=e.playlists)==null?void 0:d.length)&&jsxRuntimeExports.jsx(Tab,{elementType:Link,to:l("playlists"),children:jsxRuntimeExports.jsx(Trans,{message:"Playlists"})}),((E=e.users)==null?void 0:E.length)&&jsxRuntimeExports.jsx(Tab,{elementType:Link,to:l("users"),children:jsxRuntimeExports.jsx(Trans,{message:"Profiles"})})]}),jsxRuntimeExports.jsxs(TabPanels,{className:"pt-8",children:[jsxRuntimeExports.jsx(TabPanel,{children:jsxRuntimeExports.jsx(TopResultsPanel,{results:e})}),((y=e.tracks)==null?void 0:y.length)&&jsxRuntimeExports.jsx(TabPanel,{children:jsxRuntimeExports.jsx(TrackResults,{tracks:e.tracks})}),((v=e.artists)==null?void 0:v.length)&&jsxRuntimeExports.jsx(TabPanel,{children:jsxRuntimeExports.jsx(ArtistResults,{artists:e.artists})}),((p=e.albums)==null?void 0:p.length)&&jsxRuntimeExports.jsx(TabPanel,{children:jsxRuntimeExports.jsx(AlbumResults,{albums:e.albums})}),((f=e.playlists)==null?void 0:f.length)&&jsxRuntimeExports.jsx(TabPanel,{children:jsxRuntimeExports.jsx(PlaylistResults,{playlists:e.playlists})}),((R=e.users)==null?void 0:R.length)&&jsxRuntimeExports.jsx(TabPanel,{children:jsxRuntimeExports.jsx(ProfileResults,{users:e.users})})]})]}):jsxRuntimeExports.jsx(IllustratedMessage,{className:"mt-40",image:jsxRuntimeExports.jsx(SearchIcon,{size:"xl"}),imageHeight:"h-auto",title:jsxRuntimeExports.jsx(Trans,{message:"Not results for :query",values:{query:s}}),description:jsxRuntimeExports.jsx(Trans,{message:"Please try a different search query"})})}function TopResultsPanel({results:{artists:e,albums:t,tracks:s,playlists:n,users:i}}){return jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[s!=null&&s.length?jsxRuntimeExports.jsx(TrackResults,{tracks:s.slice(0,5),showMore:!0}):null,e!=null&&e.length?jsxRuntimeExports.jsx(ArtistResults,{artists:e.slice(0,5),showMore:!0}):null,t!=null&&t.length?jsxRuntimeExports.jsx(AlbumResults,{albums:t.slice(0,5),showMore:!0}):null,n!=null&&n.length?jsxRuntimeExports.jsx(PlaylistResults,{playlists:n.slice(0,5),showMore:!0}):null,i!=null&&i.length?jsxRuntimeExports.jsx(ProfileResults,{users:i.slice(0,5),showMore:!0}):null]})}function TrackResults({tracks:e,showMore:t}){return jsxRuntimeExports.jsxs("div",{className:"py-24",children:[jsxRuntimeExports.jsx(PanelTitle,{to:t?"tracks":void 0,children:jsxRuntimeExports.jsx(Trans,{message:"Tracks"})}),jsxRuntimeExports.jsx(TrackTable,{tracks:e})]})}function ArtistResults({artists:e,showMore:t}){return jsxRuntimeExports.jsxs("div",{className:"py-24",children:[jsxRuntimeExports.jsx(PanelTitle,{to:t?"artists":void 0,children:jsxRuntimeExports.jsx(Trans,{message:"Artists"})}),jsxRuntimeExports.jsx(ContentGrid,{children:e.map(s=>jsxRuntimeExports.jsx(ArtistGridItem,{artist:s},s.id))})]})}function AlbumResults({albums:e,showMore:t}){return jsxRuntimeExports.jsxs("div",{className:"py-24",children:[jsxRuntimeExports.jsx(PanelTitle,{to:t?"albums":void 0,children:jsxRuntimeExports.jsx(Trans,{message:"Albums"})}),jsxRuntimeExports.jsx(ContentGrid,{children:e.map(s=>jsxRuntimeExports.jsx(AlbumGridItem,{album:s},s.id))})]})}function PlaylistResults({playlists:e,showMore:t}){return jsxRuntimeExports.jsxs("div",{className:"py-24",children:[jsxRuntimeExports.jsx(PanelTitle,{to:t?"playlists":void 0,children:jsxRuntimeExports.jsx(Trans,{message:"Playlists"})}),jsxRuntimeExports.jsx(ContentGrid,{children:e.map(s=>jsxRuntimeExports.jsx(PlaylistGridItem,{playlist:s},s.id))})]})}function ProfileResults({users:e,showMore:t}){return jsxRuntimeExports.jsxs("div",{className:"py-24",children:[jsxRuntimeExports.jsx(PanelTitle,{to:t?"profiles":void 0,children:jsxRuntimeExports.jsx(Trans,{message:"Profiles"})}),jsxRuntimeExports.jsx(ContentGrid,{children:e.map(s=>jsxRuntimeExports.jsx(UserGridItem,{user:s},s.id))})]})}function PanelTitle({children:e,to:t}){return jsxRuntimeExports.jsx("h2",{className:"text-2xl font-medium mb-24 w-max",children:t?jsxRuntimeExports.jsxs(Link,{to:t,className:"hover:text-primary flex items-center gap-2",children:[e,jsxRuntimeExports.jsx(KeyboardArrowRightIcon,{className:"mt-4"})]}):e})}function LibraryPage(){const e=useNavigate(),t=useAuthClickCapture(),s=useUserPlaylists("me");return useIsMobileMediaQuery()?jsxRuntimeExports.jsxs(reactExports.Fragment,{children:[jsxRuntimeExports.jsx(StaticPageTitle,{children:jsxRuntimeExports.jsx(Trans,{message:"Your tracks"})}),jsxRuntimeExports.jsx(AdHost,{slot:"general_top",className:"mb-34"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between gap-24 mb-20",children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-semibold whitespace-nowrap",children:jsxRuntimeExports.jsx(Trans,{message:"Your library"})}),jsxRuntimeExports.jsxs(DialogTrigger,{type:"modal",onClose:i=>{i&&e(getPlaylistLink(i))},children:[jsxRuntimeExports.jsx(IconButton,{className:"flex-shrink-0",onClickCapture:t,children:jsxRuntimeExports.jsx(PlaylistAddIcon,{})}),jsxRuntimeExports.jsx(CreatePlaylistDialog,{})]})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(MenuItem,{icon:jsxRuntimeExports.jsx(AudiotrackIcon,{className:"text-main"}),to:"/library/songs",children:jsxRuntimeExports.jsx(Trans,{message:"Songs"})}),jsxRuntimeExports.jsx(MenuItem,{icon:jsxRuntimeExports.jsx(PlaylistPlayIcon,{}),to:"/library/playlists",children:jsxRuntimeExports.jsx(Trans,{message:"Playlists"})}),jsxRuntimeExports.jsx(MenuItem,{icon:jsxRuntimeExports.jsx(AlbumIcon,{}),to:"/library/albums",children:jsxRuntimeExports.jsx(Trans,{message:"Albums"})}),jsxRuntimeExports.jsx(MenuItem,{icon:jsxRuntimeExports.jsx(MicIcon,{}),to:"/library/artists",children:jsxRuntimeExports.jsx(Trans,{message:"Artists"})}),jsxRuntimeExports.jsx(MenuItem,{icon:jsxRuntimeExports.jsx(HistoryIcon,{}),to:"/library/history",children:jsxRuntimeExports.jsx(Trans,{message:"Play history"})}),s.items.map(i=>jsxRuntimeExports.jsx(MenuItem,{wrapIcon:!1,icon:jsxRuntimeExports.jsx(PlaylistImage,{size:"w-42 h-42",className:"rounded",playlist:i}),to:getPlaylistLink(i),children:i.name},i.id)),jsxRuntimeExports.jsx(InfiniteScrollSentinel,{query:s})]})]}):jsxRuntimeExports.jsx(Navigate,{to:"/library/songs",replace:!0})}function MenuItem({icon:e,children:t,to:s,wrapIcon:n=!0}){return jsxRuntimeExports.jsxs(Link,{className:"flex items-center gap-14 mb-18 text-sm",to:s,children:[n?jsxRuntimeExports.jsx("div",{className:"rounded bg-chip p-8 w-42 h-42",children:e}):e,t]})}const sortItems={"updated_at:desc":message("Recently updated"),"name:asc":message("A-Z"),"views:desc":message("Most viewed"),"plays:desc":message("Most played")};function LibraryPlaylistsPage(){const e=useNavigate(),t=useAuthClickCapture(),{trans:s}=useTrans(),{data:n}=useAuthUserPlaylists(),i=n.playlists.length,a=useUserPlaylists("me",{willSortOrFilter:!0}),{isInitialLoading:o,sortDescriptor:l,setSortDescriptor:u,searchQuery:x,setSearchQuery:c,items:j,isError:d}=a;return d?jsxRuntimeExports.jsx(PageErrorMessage,{}):jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx(StaticPageTitle,{children:jsxRuntimeExports.jsx(Trans,{message:"Your playlists"})}),jsxRuntimeExports.jsx(AdHost,{slot:"general_top",className:"mb-34"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between gap-24 mb-20",children:[jsxRuntimeExports.jsx("h1",{className:"text-2xl font-semibold whitespace-nowrap",children:i?jsxRuntimeExports.jsx(Trans,{message:"[one 1 playlist|other :count playlists]",values:{count:i}}):jsxRuntimeExports.jsx(Trans,{message:"My playlists"})}),jsxRuntimeExports.jsxs(DialogTrigger,{type:"modal",onClose:E=>{E&&e(getPlaylistLink(E))},children:[jsxRuntimeExports.jsx(IconButton,{className:"flex-shrink-0",onClickCapture:t,children:jsxRuntimeExports.jsx(PlaylistAddIcon,{})}),jsxRuntimeExports.jsx(CreatePlaylistDialog,{})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-24 justify-between",children:[jsxRuntimeExports.jsx(TextField,{value:x,onChange:E=>c(E.target.value),className:"max-w-512 flex-auto",size:"sm",startAdornment:jsxRuntimeExports.jsx(SearchIcon,{}),placeholder:s(message("Search within playlists"))}),jsxRuntimeExports.jsx(LibraryPageSortDropdown,{items:sortItems,sortDescriptor:l,setSortDescriptor:u})]}),jsxRuntimeExports.jsx("div",{className:"mt-34",children:jsxRuntimeExports.jsx(AnimatePresence,{initial:!1,mode:"wait",children:o?jsxRuntimeExports.jsx(PlayableMediaGridSkeleton,{itemCount:i}):jsxRuntimeExports.jsx(m.div,{...opacityAnimation,children:jsxRuntimeExports.jsxs(ContentGrid,{children:[j.map(E=>jsxRuntimeExports.jsx(PlaylistGridItem,{playlist:E},E.id)),jsxRuntimeExports.jsx(InfiniteScrollSentinel,{query:a})]})},"media-grid")})}),!j.length&&!o&&jsxRuntimeExports.jsx(MediaPageNoResultsMessage,{className:"mt-34",searchQuery:x,description:jsxRuntimeExports.jsx(Trans,{message:"You have not added any playlists to your library yet."})})]})}function TrackEmbed(){const{data:e}=useTrack({autoUpdate:!1});return jsxRuntimeExports.jsx("div",{className:"rounded border bg-alt p-14 h-[174px]",children:e!=null&&e.track?jsxRuntimeExports.jsx(EmbedContent$1,{track:e.track}):jsxRuntimeExports.jsx(FullPageLoader,{})})}function EmbedContent$1({track:e}){const t=reactExports.useRef(null),s=reactExports.useMemo(()=>{const n=trackToMediaItem(e);return{...playerStoreOptions,ref:t,initialData:{queue:[n],cuedMediaId:n.id,state:{repeat:!1}}}},[e]);return jsxRuntimeExports.jsx(PlayerContext,{id:"web-player",options:s,children:jsxRuntimeExports.jsxs("div",{className:"flex gap-24",children:[jsxRuntimeExports.jsx("div",{className:"flex-shrink-0 rounded bg-black overflow-hidden",children:jsxRuntimeExports.jsx(PlayerContainer$1,{playerRef:t})}),jsxRuntimeExports.jsx(TrackListItem,{track:e,hideArtwork:!0,hideActions:!0,linksInNewTab:!0})]})})}const PlayerContainer$1=reactExports.memo(({playerRef:e})=>{const{getState:t}=reactExports.useContext(PlayerStoreContext);return jsxRuntimeExports.jsx("div",{className:"w-144 h-144 player-container",ref:s=>{s?(e.current=s,t().init()):t().destroy()}})});function AlbumEmbed(){const{data:e}=useAlbum({autoUpdate:!1,with:"tracks"});return jsxRuntimeExports.jsx("div",{className:"rounded border bg-alt p-14 h-384",children:e!=null&&e.album?jsxRuntimeExports.jsx(EmbedContent,{album:e.album}):jsxRuntimeExports.jsx(FullPageLoader,{})})}function EmbedContent({album:e}){const t=reactExports.useRef(null),s=reactExports.useMemo(()=>{var n,i;return{...playerStoreOptions,ref:t,initialData:{queue:(n=e.tracks)!=null&&n.length?tracksToMediaItems(e.tracks):[],cuedMediaId:(i=e.tracks)!=null&&i.length?trackToMediaItem(e.tracks[0]).id:void 0,state:{repeat:!1}}}},[e]);return jsxRuntimeExports.jsx(PlayerContext,{id:"web-player",options:s,children:jsxRuntimeExports.jsxs("div",{className:"flex gap-24 items-start h-full",children:[jsxRuntimeExports.jsx("div",{className:"flex-shrink-0 rounded bg-black overflow-hidden",children:jsxRuntimeExports.jsx(PlayerContainer,{playerRef:t})}),jsxRuntimeExports.jsx(AlbumListItem,{album:e,maxHeight:"h-full",hideArtwork:!0,hideActions:!0,linksInNewTab:!0})]})})}const PlayerContainer=reactExports.memo(({playerRef:e})=>{const{getState:t}=reactExports.useContext(PlayerStoreContext);return jsxRuntimeExports.jsx("div",{className:"w-144 h-144 player-container",ref:s=>{s?(e.current=s,t().init()):t().destroy()}})});function HomepageChannelPage(){const{homepage:e}=useSettings();let t="discover";return e.type==="channel"&&e.value&&(t=e.value),jsxRuntimeExports.jsx(ChannelPage,{slugOrId:t})}const RouteConfig=[{path:"track/:trackId/:trackName/embed",element:jsxRuntimeExports.jsx(TrackEmbed,{})},{path:"album/:albumId/:artistName/:albumName/embed",element:jsxRuntimeExports.jsx(AlbumEmbed,{})},{path:"/",element:jsxRuntimeExports.jsx(WebPlayerLayout,{}),children:[{index:!0,element:jsxRuntimeExports.jsx(HomepageChannelPage,{})},{path:":slugOrId",element:jsxRuntimeExports.jsx(ChannelPage,{})},{path:"channel/:slugOrId",element:jsxRuntimeExports.jsx(ChannelPage,{})},{path:"channel/:slugOrId/:filter",element:jsxRuntimeExports.jsx(ChannelPage,{})},{path:"artist/:artistId/:artistName",element:jsxRuntimeExports.jsx(ArtistPage,{})},{path:"artist/:artistId",element:jsxRuntimeExports.jsx(ArtistPage,{})},{path:"playlist/:playlistId/:playlistName",element:jsxRuntimeExports.jsx(PlaylistPage,{})},{path:"album/:albumId/:artistName/:albumName",element:jsxRuntimeExports.jsx(AlbumPage,{})},{path:"track/:trackId/:trackName",element:jsxRuntimeExports.jsx(TrackPage,{})},{path:"tag/:tagName",element:jsxRuntimeExports.jsx(TagMediaPage,{})},{path:"tag/:tagName/tracks",element:jsxRuntimeExports.jsx(TagMediaPage,{})},{path:"tag/:tagName/albums",element:jsxRuntimeExports.jsx(TagMediaPage,{})},{path:"user/:userId/:userName",element:jsxRuntimeExports.jsx(UserProfilePage,{})},{path:"user/:userId/:userName/:tabName",element:jsxRuntimeExports.jsx(UserProfilePage,{})},{path:"radio/:seedType/:seedId/:seeName",element:jsxRuntimeExports.jsx(RadioPage,{})},{path:"search",element:jsxRuntimeExports.jsx(SearchResultsPage,{})},{path:"search/:searchQuery",element:jsxRuntimeExports.jsx(SearchResultsPage,{})},{path:"search/:searchQuery/:tabName",element:jsxRuntimeExports.jsx(SearchResultsPage,{})},{path:"library",element:jsxRuntimeExports.jsx(AuthRoute,{children:jsxRuntimeExports.jsx(LibraryPage,{})})},{path:"library/songs",element:jsxRuntimeExports.jsx(AuthRoute,{children:jsxRuntimeExports.jsx(LibraryTracksPage,{})})},{path:"library/playlists",element:jsxRuntimeExports.jsx(AuthRoute,{children:jsxRuntimeExports.jsx(LibraryPlaylistsPage,{})})},{path:"library/albums",element:jsxRuntimeExports.jsx(AuthRoute,{children:jsxRuntimeExports.jsx(LibraryAlbumsPage,{})})},{path:"library/artists",element:jsxRuntimeExports.jsx(AuthRoute,{children:jsxRuntimeExports.jsx(LibraryArtistsPage,{})})},{path:"library/history",element:jsxRuntimeExports.jsx(AuthRoute,{children:jsxRuntimeExports.jsx(LibraryHistoryPage,{})})}]}];function WebPlayerRoutes(){return useRoutes(RouteConfig)}export{WebPlayerRoutes as default};
//# sourceMappingURL=web-player-routes-dbad0bdd.js.map
