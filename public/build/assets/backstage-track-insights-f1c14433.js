import{bn as ge,bT as Gt,bU as Gs,m as N,bV as Ve,bW as Ts,bX as $s,bY as Ms,a as se,j as s,R as Oe,c as P,l as Ks,ah as cs,aK as Qs,aL as Ys,aM as Zs,$ as ye,bZ as Kt,b_ as Qt,b$ as us,r as d,c0 as K,k as He,c1 as ss,c2 as ts,c3 as fe,c4 as be,c5 as Fe,c6 as Re,c7 as Xs,b as te,b6 as le,n as ke,c8 as X,c9 as Yt,ca as Zt,cb as Xt,cc as Jt,cd as ea,ce as sa,cf as ta,o as J,I as W,u as oe,aG as Js,cg as et,ch as aa,ci as na,T as u,aT as ra,q as ds,J as Be,B as $,t as qe,w as We,A as Ge,al as ae,Y as L,d as ms,E as H,aX as ia,i as xs,ab as fs,aS as je,L as he,a3 as st,cj as la,ck as oa,cl as ca,cm as ua,ar as hs,K as da,cn as ma,bP as xa,y as we,e as Le,D as ie,aI as Vs,P as fa,co as O,an as ha,cp as pa,aY as ga,cq as ba,M as ps,U as ce,X as ja,bR as Fs,bS as va,V as ee,cr as ya,cs as ka,ac as Ke,a6 as Qe,p as F,W as ue,aA as Ne,x as ne,au as Ce,am as de,aq as me,aZ as gs,v as tt,a5 as at,_ as nt,a0 as rt,Z as it,a1 as Z,ax as lt,G as wa,bm as Na,bl as Ca,N as ot,ct,f as Ia,at as Ye,a4 as Da,bp as Sa,aa as Aa,aH as Pa,cu as Ta,bv as $a,bh as Rs,b0 as ut,b4 as Ma,b1 as dt,Q as Va}from"./main-0832b2fb.js";import{K as Fa,a as Ra,A as bs,C as mt,_ as La,j as xt,G as js,q as za,z as ze,X as ft,B as Ue,D as Ua,b as vs,u as Ea,V as ht,M as pt,s as Ze,o as ys,E as Xe,y as _a,a0 as Oa,S as Ha,i as Ba,O as qa,T as Wa,v as ks,r as Ee,H as Ga,F as Ka,c as Qa,e as Ya,f as Ae,g as Za,h as Pe,Y as Xa,Q as gt,t as Ls,P as Ja,U as en,p as bt}from"./play-arrow-filled-4f6d7b8f.js";import{E as ws}from"./Edit-eb13cf61.js";function jt(e){return e.set({hour:0,minute:0,second:0,millisecond:0})}function _(e){return e.set({hour:24-1,minute:60-1,second:60-1,millisecond:1e3-1})}function sn(){var a;const e=ge().settings.dates.default_timezone,t=((a=ge().user)==null?void 0:a.timezone)||e||"auto";return!t||t==="auto"?Gt():t}const A=jt(Gs(sn()));var Ws;const Te=((Ws=ge().i18n)==null?void 0:Ws.language)||"en",vt=[{key:0,label:N("Today"),getRangeValue:()=>({preset:0,start:A,end:_(A)})},{key:1,label:N("Yesterday"),getRangeValue:()=>({preset:1,start:A.subtract({days:1}),end:_(A).subtract({days:1})})},{key:2,label:N("This week"),getRangeValue:()=>({preset:2,start:Ve(A,Te),end:Ts(_(A),Te)})},{key:3,label:N("Last week"),getRangeValue:()=>({preset:3,start:Ve(A,Te).subtract({weeks:1}),end:Ts(_(A),Te).add({weeks:1})})},{key:4,label:N("Last 7 days"),getRangeValue:()=>({preset:4,start:A.subtract({days:7}),end:_(A)})},{key:5,label:N("Last 14 days"),getRangeValue:()=>({preset:5,start:A.subtract({days:14}),end:_(A)})},{key:6,label:N("Last 30 days"),getRangeValue:()=>({preset:6,start:A.subtract({days:30}),end:_(A)})},{key:7,label:N("Last 3 months"),getRangeValue:()=>({preset:7,start:A.subtract({months:3}),end:_(A)})},{key:8,label:N("Last 12 months"),getRangeValue:()=>({preset:8,start:A.subtract({months:12}),end:_(A)})},{key:9,label:N("This year"),getRangeValue:()=>({preset:9,start:$s(A),end:Ms(_(A))})},{key:10,label:N("Last year"),getRangeValue:()=>({preset:10,start:$s(A).subtract({years:1}),end:Ms(_(A)).subtract({years:1})})}],yt=se(s.jsx("path",{d:"M7 11h2v2H7v-2zm14-5v14c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2l.01-14c0-1.1.88-2 1.99-2h1V2h2v2h8V2h2v2h1c1.1 0 2 .9 2 2zM5 8h14V6H5v2zm14 12V10H5v10h14zm-4-7h2v-2h-2v2zm-4 0h2v-2h-2v2z"}),"DateRangeOutlined"),kt=Oe.forwardRef((e,t)=>{const{children:a,inputProps:r,wrapperProps:n,className:i,autoFocus:o,style:l,onClick:c}=e;return s.jsx("div",{...n,onClick:c,children:s.jsx("div",{...r,role:"group",className:P(i,"flex items-center focus-within:ring focus-within:ring-primary/focus focus-within:border-primary/60"),ref:t,style:l,children:s.jsx(Ks,{autoFocus:o,children:a})})})}),wt=Oe.forwardRef(({inputRef:e,wrapperProps:t,children:a,onBlur:r,...n},i)=>{const o=cs(n),l=Qs(i),{fieldProps:c,inputProps:f}=Ys({...n,focusRef:l,labelElementType:"span"});return o.wrapper=P(o.wrapper,n.disabled&&"pointer-events-none"),s.jsx(Zs,{wrapperProps:ye(t,{onBlur:m=>{l.current.contains(m.relatedTarget)||r==null||r(m)},onClick:()=>{Kt(l).focusFirst()}}),fieldClassNames:o,ref:l,...c,children:s.jsx(kt,{inputProps:f,className:P(o.input,"gap-10"),ref:e,children:a})})});function tn(e){return e instanceof Qt?"day":"minute"}function is(e,t,a){return t!=null&&e.compare(t)<0||a!=null&&e.compare(a)>0}function Nt(e,t){const a=us(),[r,n]=d.useState(!1),i=t.closeDialogOnSelection??!0,o=t.granularity||tn(e),l=t.min?K(t.min,a):void 0,c=t.max?K(t.max,a):void 0;return{timezone:a,granularity:o,min:l,max:c,calendarIsOpen:r,setCalendarIsOpen:n,closeDialogOnSelection:i}}function Ie(){const e=us();return d.useMemo(()=>Gs(e),[e])}function an(e){var Y,w;const t=Ie(),[a,r]=d.useState({start:(!e.value||!e.value.start)&&!((Y=e.defaultValue)!=null&&Y.start),end:(!e.value||!e.value.end)&&!((w=e.defaultValue)!=null&&w.end)}),n=e.onChange,[i,o]=He(e.value?ns(e.value,t):void 0,e.value?void 0:ns(e.defaultValue,t),e.onChange),{min:l,max:c,granularity:f,timezone:m,calendarIsOpen:g,setCalendarIsOpen:h,closeDialogOnSelection:x}=Nt(i.start,e),p=d.useCallback(()=>{r({start:!0,end:!0}),o(ns(null,t)),n==null||n(null),h(!1)},[t,o,n,h]),[b,y]=d.useState(null),[k,C]=d.useState(!1),[D,S]=d.useState(i),[R,z]=d.useState(()=>zs(i,c)),j=d.useCallback(v=>{let T=v.start,V=v.end;l&&(T=ss(T,l));const q=c?ts(c,V):V;T=ts(T,q);const Wt=l?ss(l,T):T;return V=ss(V,Wt),c&&(V=ts(V,c)),{start:K(T,m),end:K(V,m)}},[l,c,m]),I=d.useCallback(v=>{const T={...j(v),preset:v.preset};o(T),S(T),z(zs(T,c)),r({start:!1,end:!1})},[o,j,c]),M=d.useCallback(v=>!a.start&&fe(v,D.start)||!a.end&&fe(v,D.end),[D,a]),U=d.useCallback(v=>(k||!a.start&&!a.end)&&v.compare(D.start)>=0&&v.compare(D.end)<=0,[D,a,k]),B=d.useCallback(v=>fe(v,D.start),[D]),G=d.useCallback(v=>fe(v,D.end),[D]),re=d.useCallback((v,T)=>({onPointerEnter:()=>{k&&T&&S(as({start:b,end:v,timezone:m}))},onClick:()=>{if(!k)C(!0),y(v),S(as({start:v,end:v,timezone:m}));else{const V=as({start:jt(K(b,m)),end:_(K(v,m)),timezone:m});C(!1),y(null),I==null||I(V),x&&(h==null||h(!1))}}}),[b,k,I,h,x,m]);return{selectedValue:i,setSelectedValue:I,calendarIsOpen:g,setCalendarIsOpen:h,dayIsActive:M,dayIsHighlighted:U,dayIsRangeStart:B,dayIsRangeEnd:G,getCellProps:re,calendarDates:R,setIsPlaceholder:r,isPlaceholder:a,clear:p,setCalendarDates:z,min:l,max:c,granularity:f,timezone:m,closeDialogOnSelection:x}}function zs(e,t){let a=be(Fe(e.start)),r=be(Re(e.end));return Xs(a,r)&&(r=Re(r.add({months:1}))),t&&r.compare(t)>0&&(r=a,a=Fe(a.subtract({months:1}))),[a,r]}function as(e){const t=K(e.start,e.timezone),a=K(e.end,e.timezone);return t.compare(a)>0?{start:a,end:t}:{start:t,end:a}}function ns(e,t){return e!=null&&e.start&&(e!=null&&e.end)?e:!(e!=null&&e.start)&&(e!=null&&e.end)?(e.start=e.end.subtract({months:1}),e):!(e!=null&&e.end)&&(e!=null&&e.start)?(e.end=e.start.add({months:1}),e):{start:t,end:t.add({months:1})}}const nn=se(s.jsx("path",{d:"M16.01 11H4v2h12.01v3L20 12l-3.99-4v3z"}),"ArrowRightAltOutlined");function rn(e,t,a,r){switch(t){case"era":case"year":case"month":case"day":return e.cycle(t,a,{round:t==="year"})}if("hour"in e)switch(t){case"dayPeriod":{const n=e.hour,i=n>=12;return e.set({hour:i?n-12:n+12})}case"hour":case"minute":case"second":return e.cycle(t,a,{round:t!=="hour",hourCycle:r.hour12?12:24})}return e}function ln(e,t,a,r){switch(t){case"day":case"month":case"year":return e.set({[t]:a})}if("hour"in e)switch(t){case"dayPeriod":{const n=e.hour,i=n>=12;return a>=12===i?e:e.set({hour:i?n-12:n+12})}case"hour":if(r.hour12){const i=e.hour>=12;!i&&a===12&&(a=0),i&&a<12&&(a+=12)}case"minute":case"second":return e.set({[t]:a})}return e}const Us={year:5,month:2,day:7,hour:2,minute:15,second:15,dayPeriod:1};function on({segment:e,domProps:t,value:a,onChange:r,isPlaceholder:n,state:{timezone:i,calendarIsOpen:o,setCalendarIsOpen:l}}){const c=te(),f=d.useRef(""),{localeCode:m}=le(),g=ke(),h=X({timeZone:i}),x=d.useMemo(()=>new Yt(m,{maximumFractionDigits:0}),[m]),p=j=>{r(ln(a,e.type,j,h.resolvedOptions()))},b=j=>{r(rn(a,e.type,j,h.resolvedOptions()))},y=()=>{if(x.isValidPartialNumber(e.text)){const j=e.text.slice(0,-1),I=x.parse(j);if(j.length===0||I===0){const M=Zt(i);e.type in M&&p(M[e.type])}else p(I);f.current=j}else e.type==="dayPeriod"&&b(-1)},k=j=>{var I;if(!(j.ctrlKey||j.metaKey||j.shiftKey||j.altKey)){switch(j.key){case"ArrowLeft":j.preventDefault(),j.stopPropagation(),g.focusPrevious();break;case"ArrowRight":j.preventDefault(),j.stopPropagation(),g.focusNext();break;case"Enter":(I=j.target.closest("form"))==null||I.requestSubmit(),l(!o);break;case"Tab":break;case"Backspace":case"Delete":{j.preventDefault(),j.stopPropagation(),y();break}case"ArrowUp":j.preventDefault(),f.current="",b(1);break;case"ArrowDown":j.preventDefault(),f.current="",b(-1);break;case"PageUp":j.preventDefault(),f.current="",b(Us[e.type]||1);break;case"PageDown":j.preventDefault(),f.current="",b(-(Us[e.type]||1));break;case"Home":j.preventDefault(),f.current="",p(e.maxValue);break;case"End":j.preventDefault(),f.current="",p(e.minValue);break}R(j.key)}},C=X({hour:"numeric",hour12:!0}),D=d.useMemo(()=>{const j=new Date;return j.setHours(0),C.formatToParts(j).find(I=>I.type==="dayPeriod").value},[C]),S=d.useMemo(()=>{const j=new Date;return j.setHours(12),C.formatToParts(j).find(I=>I.type==="dayPeriod").value},[C]),R=j=>{const I=f.current+j;switch(e.type){case"dayPeriod":if(D.toLowerCase().startsWith(j))p(0);else if(S.toLowerCase().startsWith(j))p(12);else break;g.focusNext();break;case"day":case"hour":case"minute":case"second":case"month":case"year":{if(!x.isValidPartialNumber(I))return;let M=x.parse(I),U=M,B=e.minValue===0;if(e.type==="hour"&&h.resolvedOptions().hour12){switch(h.resolvedOptions().hourCycle){case"h11":M>11&&(U=x.parse(j));break;case"h12":B=!1,M>12&&(U=x.parse(j));break}e.value>=12&&M>1&&(M+=12)}else M>e.maxValue&&(U=x.parse(j));if(Number.isNaN(M))return;const G=U!==0||B;G&&p(U),+`${M}0`>e.maxValue||I.length>=String(e.maxValue).length?(f.current="",G&&g.focusNext()):f.current=I;break}}},z=c?{}:{"aria-label":e.type,"aria-valuetext":n?void 0:`${e.value}`,"aria-valuemin":e.minValue,"aria-valuemax":e.maxValue,"aria-valuenow":n?void 0:e.value,tabIndex:0,onKeyDown:k};return s.jsx("div",{...ye(t,{...z,onFocus:j=>{f.current="",j.target.scrollIntoView({block:"nearest"})},onClick:j=>{j.preventDefault(),j.stopPropagation()}}),className:"p-2 outline-none caret-transparent cursor-default rounded focus:bg-primary focus:text-on-primary select-none whitespace-nowrap box-content tabular-nums text-center",children:e.text.padStart(e.minLength,"0")})}function cn({segment:e,domProps:t}){const a=ke();return s.jsx("div",{...t,onPointerDown:r=>{r.pointerType==="mouse"&&(r.preventDefault(),a.focusNext({from:r.target})||a.focusPrevious({from:r.target}))},"aria-hidden":!0,className:"min-w-4 cursor-default select-none",children:e.text})}function un(e,t,a){switch(t){case"year":return{value:e.year,placeholder:"yyyy",minValue:1,maxValue:e.calendar.getYearsInEra(e)};case"month":return{value:e.month,placeholder:"mm",minValue:Jt(e),maxValue:e.calendar.getMonthsInYear(e)};case"day":return{value:e.day,minValue:Xt(e),maxValue:e.calendar.getDaysInMonth(e),placeholder:"dd"}}if("hour"in e)switch(t){case"dayPeriod":return{value:e.hour>=12?12:0,minValue:0,maxValue:12,placeholder:"--"};case"hour":if(a.hour12){const r=e.hour>=12;return{value:e.hour,minValue:r?12:0,maxValue:r?23:11,placeholder:"--"}}return{value:e.hour,minValue:0,maxValue:23,placeholder:"--"};case"minute":return{value:e.minute,minValue:0,maxValue:59,placeholder:"--"}}return{}}function ls({segmentProps:e,state:t,value:a,onChange:r,isPlaceholder:n}){const{granularity:i}=t,o=d.useMemo(()=>{const m={year:"numeric",month:"numeric",day:"numeric"};return i==="minute"&&(m.hour="numeric",m.minute="numeric"),m},[i]),l=X(o),c=d.useMemo(()=>a.toDate(),[a]),f=d.useMemo(()=>l.formatToParts(c).map(m=>{const g=un(a,m.type,l.resolvedOptions()),h=n&&m.type!=="literal"?g.placeholder:m.value;return{type:m.type,text:m.value===", "?" ":h,...g,minLength:m.type!=="literal"?String(g.maxValue).length:1}}),[c,l,n,a]);return s.jsx("div",{className:"flex items-center",children:f.map((m,g)=>m.type==="literal"?s.jsx(cn,{domProps:e,segment:m},g):s.jsx(on,{isPlaceholder:n,domProps:e,state:t,value:a,onChange:r,segment:m},g))})}function dn({date:e,currentMonth:t,state:{dayIsActive:a,dayIsHighlighted:r,dayIsRangeStart:n,dayIsRangeEnd:i,getCellProps:o,timezone:l,min:c,max:f}}){const{localeCode:m}=le(),g=ea(e,m),h=a(e),x=r(e),p=n(e),b=i(e),y=sa(e,l),k=Xs(e,t),C=is(e,c,f);return s.jsxs("div",{role:"button","aria-disabled":C,className:P("w-40 h-40 text-sm relative isolate flex-shrink-0",C&&"text-disabled pointer-events-none",!k&&"invisible pointer-events-none"),...o(e,k),children:[s.jsx("span",{className:P("absolute inset-0 flex items-center justify-center rounded-full w-full h-full select-none z-10 cursor-pointer",!h&&!y&&"hover:bg-hover",h&&"bg-primary text-on-primary font-semibold",y&&!h&&"bg-chip"),children:e.day}),x&&k&&s.jsx("span",{className:P("absolute w-full h-full inset-0 bg-primary/focus",(p||g===0||e.day===1)&&"rounded-l-full",(b||g===6||e.day===t.calendar.getDaysInMonth(t))&&"rounded-r-full")})]})}function mn({startDate:e,state:t,isFirst:a,isLast:r}){const{localeCode:n}=le(),i=ta(e,n),o=Ve(e,n);return s.jsxs("div",{className:"w-280 flex-shrink-0",children:[s.jsx(xn,{isFirst:a,isLast:r,state:t,currentMonth:e}),s.jsxs("div",{className:"block",role:"grid",children:[s.jsx(fn,{state:t,startDate:e}),[...new Array(i).keys()].map(l=>s.jsx(J.div,{className:"flex mb-6",children:[...new Array(7).keys()].map(c=>s.jsx(dn,{date:o.add({weeks:l,days:c}),currentMonth:e,state:t},c))},l))]})]})}function xn({currentMonth:e,isFirst:t,isLast:a,state:{calendarDates:r,setCalendarDates:n,timezone:i,min:o,max:l}}){const c=h=>{const x=r.length;let p;h==="forward"?p=r.map(b=>Re(b.add({months:x}))):p=r.map(b=>Re(b.subtract({months:x}))),n(p)},f=X({month:"long",year:"numeric",era:e.calendar.identifier!=="gregory"?"long":void 0,calendar:e.calendar.identifier}),m=is(e.subtract({days:1}),o,l),g=is(Fe(e.add({months:1})),o,l);return s.jsxs("div",{className:"flex items-center justify-between gap-10",children:[s.jsx(W,{size:"md",className:P("text-muted",!t&&"invisible"),disabled:!t||m,"aria-hidden":!t,onClick:()=>{c("backward")},children:s.jsx(Fa,{})}),s.jsx("div",{className:"text-sm font-semibold select-none",children:f.format(e.toDate(i))}),s.jsx(W,{size:"md",className:P("text-muted",!a&&"invisible"),disabled:!a||g,"aria-hidden":!a,onClick:()=>{c("forward")},children:s.jsx(Ra,{})})]})}function fn({state:{timezone:e},startDate:t}){const{localeCode:a}=le(),r=X({weekday:"short"}),n=Ve(t,a);return s.jsx("div",{className:"flex",children:[...new Array(7).keys()].map(i=>{const l=n.add({days:i}).toDate(e),c=r.format(l);return s.jsx("div",{className:"w-40 h-40 text-sm font-semibold relative flex-shrink-0",children:s.jsx("div",{className:"absolute flex items-center justify-center w-full h-full select-none",children:c})},i)})})}function Ct({state:e,visibleMonths:t=1}){return te()&&(t=1),s.jsx(s.Fragment,{children:[...new Array(t).keys()].map(r=>{const n=be(Fe(e.calendarDates[r])),i=r===0,o=r===t-1;return s.jsx(mn,{state:e,startDate:n,isFirst:i,isLast:o},r)})})}const It=d.memo(({start:e,end:t,options:a,preset:r})=>{const{dates:n}=oe(),i=us(),o=X(a||Js[r||(n==null?void 0:n.format)]);if(!e||!t)return null;let l;try{l=o.formatRange(Es(e,i),Es(t,i))}catch{l=""}return s.jsx(d.Fragment,{children:l})},et);function Es(e,t){return typeof e=="string"?aa(e,t).toDate():"toDate"in e?e.toDate(t):e}function hn({children:e,className:t,padding:a,dataTestId:r}){return s.jsx(Ks,{children:s.jsx("ul",{"data-testid":r,className:P("text-base sm:text-sm outline-none",t,a??"py-4"),children:e})})}function pn({children:e,onSelected:t,borderRadius:a,...r}){const n=ke(),i=!!t,o=d.useRef(null),[l,c]=d.useState(!1),f=m=>{switch(m.key){case"ArrowDown":m.preventDefault(),n.focusNext();break;case"ArrowUp":m.preventDefault(),n.focusPrevious();break;case"Home":m.preventDefault(),n.focusFirst();break;case"End":m.preventDefault(),n.focusLast();break;case"Enter":case"Space":m.preventDefault(),t==null||t();break}};return s.jsx("li",{children:s.jsx(na,{className:a||"rounded",isActive:l,isDisabled:r.isDisabled,...r,onFocus:m=>{c(m.target.matches(":focus-visible"))},onBlur:()=>{c(!1)},onClick:()=>{t==null||t()},ref:o,role:i?"button":void 0,onKeyDown:i?f:void 0,tabIndex:i&&!r.isDisabled?0:void 0,children:e})})}function gn({onPresetSelected:e,selectedValue:t}){return s.jsx(hn,{className:"min-w-192",padding:"py-14",dataTestId:"date-range-preset-list",children:vt.map(a=>s.jsx(pn,{borderRadius:"rounded-none",capitalizeFirst:!0,isSelected:(t==null?void 0:t.preset)===a.key,onSelected:()=>{const r=a.getRangeValue();e(r)},children:s.jsx(u,{...a.label})},a.key))})}function bn(e){return ra("(max-width: 1024px)",e)}function jn({state:e,showInlineDatePickerField:t=!1}){const a=bn(),{close:r}=ds(),n=d.useRef(e),i=e.isPlaceholder.start||e.isPlaceholder.end,o=s.jsxs(Be,{dividerTop:!0,startAction:!i&&!a?s.jsx("div",{className:"text-xs",children:s.jsx(It,{start:e.selectedValue.start.toDate(),end:e.selectedValue.end.toDate(),options:{dateStyle:"medium"}})}):void 0,children:[s.jsx($,{variant:"text",size:"xs",onClick:()=>{e.setSelectedValue(n.current.selectedValue),e.setIsPlaceholder(n.current.isPlaceholder),r()},children:s.jsx(u,{message:"Cancel"})}),s.jsx($,{variant:"flat",color:"primary",size:"xs",onClick:()=>{r(e.selectedValue)},children:s.jsx(u,{message:"Select"})})]});return s.jsxs(qe,{size:"auto",children:[s.jsxs(We,{className:"flex",padding:"p-0",children:[!a&&s.jsx(gn,{selectedValue:e.selectedValue,onPresetSelected:l=>{e.setSelectedValue(l),e.closeDialogOnSelection&&r(l)}}),s.jsx(Ge,{initial:!1,children:s.jsx(vn,{state:e,showInlineDatePickerField:t})})]}),!e.closeDialogOnSelection&&o]})}function vn({state:e,showInlineDatePickerField:t}){return s.jsxs(J.div,{initial:{width:0,overflow:"hidden"},animate:{width:"auto"},exit:{width:0,overflow:"hidden"},transition:{type:"tween",duration:.125},className:"border-l px-20 pt-10 pb-20",children:[t&&s.jsx(yn,{state:e}),s.jsx("div",{className:"flex items-start gap-36",children:s.jsx(Ct,{state:e,visibleMonths:2})})]})}function yn({state:e}){const{selectedValue:t,setSelectedValue:a}=e;return s.jsxs(wt,{className:"mb-20 mt-10",children:[s.jsx(ls,{state:e,value:t.start,onChange:r=>{a({...t,start:r})}}),s.jsx(nn,{className:"block flex-shrink-0 text-muted",size:"md"}),s.jsx(ls,{state:e,value:t.end,onChange:r=>{a({...t,end:r})}})]})}const xe=(e,t)=>{const a=e.split("/");return t&&a.push(t),a};function di(e,t,a){return ae(xe(e,t),()=>kn(e,t),{...a,keepPreviousData:!0})}function kn(e,t){return L.get(e,{params:t}).then(a=>a.data)}const wn=(e,t="normalized-models")=>`${t}/${e}`;function Dt(e,t,a,r){const n=wn(e,r);return ae([n,t],()=>Nn(n,t),{keepPreviousData:!0,...a})}async function Nn(e,t){return L.get(e,{params:t}).then(a=>a.data)}const Cn=(e,t,a="normalized-models")=>`${a}/${e}/${t}`;function St(e,t,a,r){const n=Cn(e,t,r);return ae([n,a],()=>In(n,a),{enabled:e!=null&&t!=null})}async function In(e,t){return L.get(e,{params:t}).then(a=>a.data)}function Dn({modelType:e,label:t,className:a,value:r,defaultValue:n="",onChange:i,description:o,errorMessage:l,invalid:c,openMenuOnFocus:f,autoFocus:m,queryParams:g,customEndpoint:h,disabled:x}){var z;const p=d.useRef(null),[b,y]=d.useState(""),[k,C]=He(r,n,i),D=Dt(e,{query:b,...g},null,h),{trans:S}=H(),R=cs({size:"md"});return k?s.jsxs("div",{className:a,children:[s.jsx("div",{className:R.label,children:t}),s.jsx("div",{className:P("p-10 border rounded",c&&"border-danger"),children:s.jsx(Ge,{initial:!1,mode:"wait",children:s.jsx(Sn,{disabled:x,endpoint:h,modelType:e,modelId:k,queryParams:g,onEditClick:()=>{C(""),y(""),requestAnimationFrame(()=>{var j;(j=p.current)==null||j.focus()})}})})}),o&&!l&&s.jsx("div",{className:R.description,children:o}),l&&s.jsx("div",{className:R.error,children:l})]}):s.jsx(ia,{className:a,invalid:c,errorMessage:l,description:o,isAsync:!0,placeholder:S(N("Find item..")),label:t,isLoading:D.isFetching,items:(z=D.data)==null?void 0:z.results,inputValue:b,onInputValueChange:y,clearInputOnItemSelection:!0,selectionMode:"single",selectedValue:k,onSelectionChange:C,ref:p,openMenuOnFocus:f,autoFocus:m,disabled:x,children:j=>s.jsx(xs,{value:j.id,description:j.description,startIcon:s.jsx(bs,{src:j.image}),children:j.name},j.id)})}function Sn({modelType:e,modelId:t,onEditClick:a,endpoint:r,disabled:n,queryParams:i}){const{data:o,isLoading:l}=St(e,t,i,r);return l||!(o!=null&&o.model)?s.jsx(An,{},"skeleton"):s.jsxs(J.div,{className:P("flex items-center gap-10",n&&"text-disabled cursor-not-allowed pointer-events-none"),...fs,children:[o.model.image&&s.jsx(bs,{src:o.model.image}),s.jsxs("div",{children:[s.jsx("div",{children:o.model.name}),s.jsx("div",{className:"text-muted text-xs",children:o.model.description})]}),s.jsx(je,{label:s.jsx(u,{message:"Change item"}),children:s.jsx(W,{className:"ml-auto text-muted",size:"sm",onClick:a,disabled:n,children:s.jsx(ws,{})})})]},"preview")}function An(){return s.jsxs(J.div,{className:"flex items-center gap-10",...fs,children:[s.jsx(he,{variant:"rect",size:"w-32 h-32"}),s.jsxs("div",{className:"flex-auto max-h-[36px]",children:[s.jsx(he,{className:"text-xs"}),s.jsx(he,{className:"text-xs max-h-8"})]}),s.jsx(he,{variant:"icon",size:"w-24 h-24"})]})}function Pn({name:e,...t}){const{field:{onChange:a,value:r=""},fieldState:{invalid:n,error:i}}=ms({name:e});return s.jsx(Dn,{value:r,onChange:a,invalid:n,errorMessage:i==null?void 0:i.message,...t})}function os(e){return{id:e,name:`${e}`,description:`${e}`}}function Tn(e,t){const a=d.useRef(null),r=Qs(t),{displayWith:n=q=>q.name,validateWith:i,children:o,suggestions:l,isLoading:c,inputValue:f,onInputValueChange:m,onItemSelected:g,placeholder:h,onOpenChange:x,chipSize:p="md",openMenuOnFocus:b=!0,showEmptyMessage:y,value:k,defaultValue:C,onChange:D,valueKey:S,isAsync:R,allowCustomValue:z=!0,showDropdownArrow:j,onChipClick:I,...M}=e,U=cs({...e,flexibleHeight:!0}),[B,G]=Vn(e),[re,Y]=d.useState(!1),w=s.jsx(hs,{isIndeterminate:!0,size:"sm","aria-label":"loading..."}),v=j?s.jsx(da,{}):null,{fieldProps:T,inputProps:V}=Ys({...M,focusRef:r,endAdornment:c&&re?w:v});return s.jsx(Zs,{fieldClassNames:U,...T,children:s.jsxs(kt,{ref:a,className:P("flex items-center flex-wrap",U.input),onClick:()=>{var q;(q=r.current)==null||q.focus()},children:[s.jsx($n,{displayChipUsing:n,onChipClick:I,items:B,setItems:G,chipSize:p}),s.jsx(Mn,{showEmptyMessage:y,inputProps:V,inputValue:f,onInputValueChange:m,fieldRef:a,inputRef:r,chips:B,setChips:G,validateWith:i,isLoading:c,suggestions:l,placeholder:h,openMenuOnFocus:b,listboxIsOpen:re,setListboxIsOpen:Y,allowCustomValue:z,children:o})]})})}function $n({items:e,setItems:t,displayChipUsing:a,chipSize:r,onChipClick:n}){const i=ke(),o=d.useCallback(l=>{const c=e.findIndex(m=>m.id===l),f=[...e];return c>-1&&(f.splice(c,1),t(f)),f},[e,t]);return s.jsx(mt,{className:"flex-shrink-0 flex-wrap max-w-full my-8",size:r,selectable:!0,children:e.map(l=>s.jsx(st,{errorMessage:l.errorMessage,adornment:l.image?s.jsx(bs,{circle:!0,src:l.image}):null,onClick:()=>n==null?void 0:n(l),onRemove:()=>{o(l.id).length?i.focusPrevious({tabbable:!0}):i.focusLast()},children:a(l)},l.id))})}function Mn(e){const{inputRef:t,fieldRef:a,validateWith:r,setChips:n,chips:i,suggestions:o,inputProps:l,placeholder:c,openMenuOnFocus:f,listboxIsOpen:m,setListboxIsOpen:g,allowCustomValue:h}=e,x="outline-none text-sm mx-8 my-4 h-30 flex-auto",p=ke(),b=d.useCallback(w=>{w=(w||[]).filter(v=>{const T=!v||!v.id||!v.name;return!(i.findIndex(q=>q.id===(v==null?void 0:v.id))>-1)&&!T}),w.length&&(r&&(w=w.map(v=>r(v))),n([...i,...w]))},[i,n,r]),y=la({...e,clearInputOnItemSelection:!0,isOpen:m,onOpenChange:g,items:o,selectionMode:"none",role:"listbox",virtualFocus:!0,onItemSelected:w=>{B(w)}}),{state:{activeIndex:k,setActiveIndex:C,isOpen:D,setIsOpen:S,inputValue:R,setInputValue:z},refs:j,listboxId:I,collection:M,onInputChange:U}=y,B=w=>{const v=M.size&&k!=null?[...M.values()][k]:null;v!=null&&v.item?b([v.item]):h&&b([os(v?v.value:w)]),z(""),C(null),S(!1)};oa(()=>{a.current&&j.reference.current!==a.current&&y.reference(a.current)},[a,y,j]);const{handleTriggerKeyDown:G,handleListboxKeyboardNavigation:re}=ma(y),Y=xa(()=>{f&&!D&&S(!0)});return s.jsx(ca,{listbox:y,mobileOverlay:ua,onPointerDown:w=>{w.preventDefault()},children:s.jsx("input",{type:"text",className:P(x,"bg-transparent"),placeholder:c,...ye(l,{ref:t,value:R,onChange:U,onPaste:w=>{const T=w.clipboardData.getData("text").match(/([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9._-]+)/gi);if(T){w.preventDefault();const V=window.getSelection();V!=null&&V.rangeCount&&(V.deleteFromDocument(),b(T.map(q=>os(q))))}},"aria-autocomplete":"list","aria-controls":D?I:void 0,autoComplete:"off",autoCorrect:"off",spellCheck:"false",onKeyDown:w=>{const v=w.target;if(w.key==="Enter"){w.preventDefault(),B(v.value);return}if(w.key==="Escape"&&D&&(S(!1),z("")),w.key==="ArrowUp"&&D&&(k===0||k==null)){C(null);return}if(k!=null&&(w.key==="ArrowLeft"||w.key==="ArrowRight")){w.preventDefault();return}if((w.key==="ArrowLeft"||w.key==="Backspace"||w.key==="Delete")&&v.selectionStart===0&&k==null&&i.length){p.focusPrevious({tabbable:!0});return}G(w)||re(w)},onFocus:Y,onClick:Y})})})}function Vn({onChange:e,value:t,defaultValue:a,valueKey:r}){const n=d.useMemo(()=>_s(t),[t]),i=d.useMemo(()=>_s(a),[a]),o=d.useCallback(l=>{const c=r?l.map(f=>f[r]):l;e==null||e(c)},[e,r]);return He(n||void 0,i||[],o)}function _s(e){if(e!=null)return e.map(t=>typeof t!="object"?os(t):t)}const Fn=Oe.forwardRef(Tn);function At({children:e,...t}){const{field:{onChange:a,onBlur:r,value:n=[],ref:i},fieldState:{invalid:o,error:l}}=ms({name:t.name}),c={onChange:a,onBlur:r,value:n,invalid:o,errorMessage:l==null?void 0:l.message};return s.jsx(Fn,{ref:i,...ye(c,t),children:e})}const Rn=se(s.jsx("path",{d:"M20 9H4v2h16V9zM4 15h16v-2H4v2z"}),"DragHandleOutlined");function Ln(){const[e,t]=d.useState(!1),a=d.useRef(),r=d.useCallback(n=>{var i;if(n){const o=new IntersectionObserver(([l])=>t(l.intersectionRatio<1),{threshold:[1]});a.current=o,o.observe(n)}else a.current&&((i=a.current)==null||i.disconnect())},[]);return{isSticky:e,sentinelRef:r}}function De({onSubmit:e,form:t,title:a,children:r,isLoading:n=!1,disableSaveWhenNotDirty:i=!1,wrapInContainer:o=!0}){const{isSticky:l,sentinelRef:c}=Ln(),f=i?t.formState.isDirty:!0;return s.jsxs(we,{onSubmit:e,onBeforeSubmit:()=>{t.clearErrors()},form:t,children:[s.jsx("div",{ref:c}),s.jsx("div",{className:P("sticky top-0 my-12 md:my-24 z-10 transition-shadow",l&&"bg-paper shadow"),children:s.jsxs("div",{className:P("flex items-center md:items-start gap-24 md:gap-80 py-14",o&&"container mx-auto px-24"),children:[s.jsx("h1",{className:"text-xl md:text-3xl whitespace-nowrap overflow-hidden overflow-ellipsis",children:a}),s.jsx($,{className:"ml-auto",variant:"flat",color:"primary",type:"submit",disabled:n||!f,children:s.jsx(u,{message:"Save"})})]})}),s.jsx("div",{className:o?"container mx-auto px-24 pb-24":void 0,children:s.jsx("div",{className:"rounded",children:r})})]})}function zn(e){const t=Ie(),[a,r]=d.useState(!e.value&&!e.defaultValue),n=e.onChange,[i,o]=He(e.value||t,e.defaultValue||t,n),{min:l,max:c,granularity:f,timezone:m,calendarIsOpen:g,setCalendarIsOpen:h,closeDialogOnSelection:x}=Nt(i,e),p=d.useCallback(()=>{r(!0),o(t),n==null||n(null),h(!1)},[t,o,n,h]),[b,y]=d.useState(()=>[be(i)]),k=d.useCallback(S=>{l&&S.compare(l)<0?S=l:c&&S.compare(c)>0&&(S=c);const R=i?i.set(S):K(S,m);o(R),y([be(R)]),r(!1)},[o,l,c,i,m]),C=d.useCallback(S=>!a&&fe(i,S),[i,a]),D=d.useCallback(S=>({onClick:()=>{k==null||k(S),x&&(h==null||h(!1))}}),[k,h,x]);return{selectedValue:i,setSelectedValue:o,calendarIsOpen:g,setCalendarIsOpen:h,dayIsActive:C,dayIsHighlighted:()=>!1,dayIsRangeStart:()=>!1,dayIsRangeEnd:()=>!1,getCellProps:D,calendarDates:b,setCalendarDates:y,isPlaceholder:a,clear:p,setIsPlaceholder:r,min:l,max:c,granularity:f,timezone:m,closeDialogOnSelection:x}}function Un({showCalendarFooter:e,...t}){const a=zn(t),r=d.useRef(null),n=Ie(),i=e&&s.jsx(Be,{padding:"px-14 pb-14",startAction:s.jsx($,{disabled:a.isPlaceholder,variant:"text",color:"primary",onClick:()=>{a.clear()},children:s.jsx(u,{message:"Clear"})}),children:s.jsx($,{variant:"text",color:"primary",onClick:()=>{a.setSelectedValue(n),a.setCalendarIsOpen(!1)},children:s.jsx(u,{message:"Today"})})}),o=s.jsx(ie,{offset:8,placement:"bottom-start",isOpen:a.calendarIsOpen,onOpenChange:a.setCalendarIsOpen,type:"popover",triggerRef:r,returnFocusToTrigger:!1,moveFocusToDialog:!1,children:s.jsxs(qe,{size:"auto",children:[s.jsx(We,{className:"flex items-start gap-40",padding:e?"px-24 pt-20 pb-10":null,children:s.jsx(Ct,{state:a,visibleMonths:1})}),i]})}),l={onClick:c=>{c.stopPropagation(),c.preventDefault(),_n(c)?a.setCalendarIsOpen(!1):a.setCalendarIsOpen(!0)}};return s.jsxs(d.Fragment,{children:[s.jsx(wt,{ref:r,wrapperProps:l,endAdornment:s.jsx(yt,{className:P(t.disabled&&"text-disabled")}),...t,children:s.jsx(ls,{segmentProps:l,state:a,value:a.selectedValue,onChange:a.setSelectedValue,isPlaceholder:a.isPlaceholder})}),o]})}function En(e){const{min:t,max:a}=e,{trans:r}=H(),{format:n}=X(),{field:{onChange:i,onBlur:o,value:l=null,ref:c},fieldState:{invalid:f,error:m}}=ms({name:e.name,rules:{validate:x=>{if(!x)return;const p=Le(x);if(t&&p.compare(t)<0)return r({message:"Enter a date after :date",values:{date:n(x)}});if(a&&p.compare(a)>0)return r({message:"Enter a date before :date",values:{date:n(x)}})}}}),g=l?Le(l):null,h={onChange:x=>{i(x&&x.toAbsoluteString())},onBlur:o,value:g,invalid:f,errorMessage:m==null?void 0:m.message,inputRef:c};return s.jsx(Un,{...ye(h,e)})}function _n(e){return["hour","minute","dayPeriod"].includes(e.currentTarget.ariaLabel||"")}const On=se(s.jsx("path",{d:"M9 8a1 1 0 0 0-1-1H5.5a1 1 0 1 0 0 2H7v4a1 1 0 0 0 2 0zM4 0h8a4 4 0 0 1 4 4v8a4 4 0 0 1-4 4H4a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4zm4 5.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3z"}),"InfoDialogTrigger"),Pt=""+new URL("music-7a11c2fe.svg",import.meta.url).href;function Hn(e){return ae(["artists","search-suggestions",e],()=>Bn(e),{keepPreviousData:!0})}async function Bn(e){return L.get("search/suggestions/artist",{params:e}).then(t=>t.data)}function Tt({name:e,className:t}){const{trans:a}=H(),[r,n]=d.useState(""),{data:i,isLoading:o}=Hn({query:r});return s.jsx(At,{className:t,name:e,label:s.jsx(u,{message:"Artists"}),isAsync:!0,inputValue:r,onInputValueChange:n,suggestions:i==null?void 0:i.results,placeholder:a(N("+Add artist")),isLoading:o,allowCustomValue:!1,children:i==null?void 0:i.results.map(l=>s.jsx(xs,{value:l,startIcon:l.image?s.jsx("img",{className:"rounded-full object-cover w-24 h-24",src:l.image,alt:""}):void 0,children:l.name},l.id))})}function ve({name:e,label:t,placeholder:a,model:r,className:n,allowCustomValue:i=!1}){const[o,l]=d.useState(""),{data:c,isLoading:f}=Dt(r,{query:o});return s.jsx(At,{className:n,name:e,label:t,isAsync:!0,inputValue:o,onInputValueChange:l,suggestions:c==null?void 0:c.results,placeholder:a,isLoading:f,allowCustomValue:i,children:c==null?void 0:c.results.map(m=>s.jsx(xs,{value:m,startIcon:m.image?s.jsx("img",{className:"rounded-full object-cover w-24 h-24",src:m.image,alt:""}):void 0,children:m.name},m.id))})}const $t="tag",Mt=se(s.jsx("path",{d:"M18 15v3H6v-3H4v3c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2v-3h-2zM7 9l1.41 1.41L11 7.83V16h2V7.83l2.59 2.58L17 9l-5-5-5 5z"}),"FileUploadOutlined");function Vt({fileUpload:e,status:t,className:a}){const r=(e==null?void 0:e.bytesUploaded)||0,n=d.useMemo(()=>Vs(e.file.size),[e.file.size]),i=d.useMemo(()=>Vs(r),[r]);let o;return t==="completed"?o=s.jsx(u,{message:"Upload complete"}):t==="aborted"?o=s.jsx(u,{message:"Upload cancelled"}):t==="failed"?o=s.jsx(u,{message:"Upload failed"}):t==="processing"?o=s.jsx(u,{message:"Processing upload..."}):t==="pending"?o=s.jsx(u,{message:"Waiting to start..."}):o=s.jsx(u,{message:":bytesUploaded of :totalBytes uploaded",values:{bytesUploaded:i,totalBytes:n}}),s.jsx("div",{className:P("text-muted text-xs",a),children:o})}function Ft({fileUpload:e,status:t,onAbort:a,size:r="md",className:n}){return s.jsxs("div",{className:n,children:[s.jsxs("div",{className:"flex items-center gap-24 justify-between",children:[s.jsx(Vt,{fileUpload:e,status:t}),s.jsx(qn,{fileUpload:e,status:t,onAbort:a})]}),s.jsx(fa,{size:r==="sm"?"xs":"sm",radius:"rounded-sm",value:e.percentage,isIndeterminate:t==="processing"||t==="pending"})]})}function qn({fileUpload:e,status:t,onAbort:a}){O(i=>i.abortUpload),O(i=>i.clearInactive);const r=e.errorMessage;let n;if(t==="failed"){const i=r||N("This file could not be uploaded");n=s.jsx($e,{children:s.jsx(je,{variant:"danger",label:s.jsx(ha,{value:i}),children:s.jsx(pa,{className:"text-danger",size:"sm"})})})}else t==="aborted"?n=s.jsx($e,{children:s.jsx(ga,{className:"text-warning",size:"sm"})}):t==="completed"||t==="processing"?n=s.jsx($e,{children:s.jsx(ba,{size:"sm",className:"text-primary"})}):a?n=s.jsx($e,{children:s.jsx(W,{size:"xs",onClick:()=>a(e.file.id),children:s.jsx(ps,{})})}):n=s.jsx("div",{className:"w-30 h-30"});return s.jsx(Ge,{children:n})}function $e({children:e,...t}){return s.jsx(J.div,{className:"flex w-30 h-30 items-center justify-center",...t,initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},exit:{scale:0,opacity:0},children:e})}function Wn(){return ce(e=>Gn(e),{onError:e=>ja(e)})}function Gn(e){return L.post(`tracks/${e.fileEntryId}/extract-metadata`,e).then(t=>Kn(t.data))}function Kn(e){const t={name:e.metadata.title,duration:e.metadata.duration,genres:e.metadata.genres||[],description:e.metadata.comment,lyric:e.metadata.lyrics,release_date:e.metadata.release_date,album_name:e.metadata.album_name};return e.metadata.album&&(t.album_id=e.metadata.album.id),e.metadata.artist&&(t.artists=[e.metadata.artist]),e.metadata.image&&(t.image=e.metadata.image.url),t}function Rt(e,t){var a;!((a=e.getValues("artists"))!=null&&a.length)&&t.artists&&e.setValue("artists",t.artists),!e.getValues("image")&&t.image&&e.setValue("image",t.image),!e.getValues("release_date")&&t.release_date&&e.setValue("release_date",t.release_date),!e.getValues("name")&&t.album_name&&e.setValue("name",t.album_name)}function Je(e,t){return{...t,...e,artists:rs(t.artists,e.artists),genres:rs(t.genres,e.genres,"name"),tags:rs(t.tags,e.tags,"name")}}function rs(e=[],t=[],a="id"){return t=t.filter(r=>!e.find(n=>n[a]===r[a])),[...e,...t]}const Qn=50*1024*1024;function es(e){const{uploads:t}=oe(),a=d.useMemo(()=>({allowedFileTypes:[Fs.audio,Fs.video],maxFileSize:t.max_size||Qn}),[t.max_size]),r=Wn(),n=d.useRef(e);n.current=e;const i=O(x=>x.uploadMultiple),o=O(x=>x.updateFileUpload),l=O(x=>x.getUpload),c=d.useCallback((x,p)=>{var b;o(x,{meta:{...((b=l(x))==null?void 0:b.meta)||{},...p}})},[o,l]),f=d.useMemo(()=>({metadata:{diskPrefix:"track_media",disk:va.public},restrictions:a,onSuccess:(x,p)=>{c(p.id,{isExtractingMetadata:!0}),r.mutate({fileEntryId:x.id,autoMatchAlbum:n.current.autoMatchAlbum},{onSuccess:b=>{c(p.id,{isExtractingMetadata:!1});const y={...b,url:x.url};n.current.onMetadataChange(p,y)},onError:()=>{c(p.id,{isExtractingMetadata:!1})}})},onError:x=>{x&&ee.danger(x)}}),[r,c,a]),m=d.useCallback(x=>{const p=x.filter(b=>!ya(b,a));return x.length!==p.length&&ee.danger(N(":count of your files is not supported.",{values:{count:x.length-p.length}})),p},[a]),g=d.useCallback(async x=>{if(m(x).length){x.forEach(b=>{var y,k;(k=(y=n.current).onUploadStart)==null||k.call(y,{name:b.name,uploadId:b.id})}),i(x,f);for(const b of x){c(b.id,{isGeneratingWave:!0});const y=await La(b.native);n.current.onMetadataChange(b,{waveData:y}),c(b.id,{isGeneratingWave:!1})}}},[f,i,c,m]);return{openFilePicker:d.useCallback(async()=>{const x=await ka({multiple:!0,types:a.allowedFileTypes});await g(x)},[g,a]),uploadTracks:g,validateUploads:m}}function Ns(e){const t=O(n=>e?n.fileUploads.get(e):null);let a=!1,r;if(t){const n=t.meta,i=(n==null?void 0:n.isExtractingMetadata)||(n==null?void 0:n.isGeneratingWave);a=(t==null?void 0:t.status)==="pending"||(t==null?void 0:t.status)==="inProgress"||!!i,r=(t==null?void 0:t.status)==="completed"&&i?"processing":t==null?void 0:t.status}return{isUploading:a,status:r,activeUpload:t}}function Yn(){const[e,t]=d.useState(),{setValue:a,watch:r,getValues:n}=Ke(),{openFilePicker:i}=es({onUploadStart:({uploadId:g})=>t(g),onMetadataChange:(g,h)=>{const x=Je(h,n());Object.entries(x).forEach(([p,b])=>a(p,b,{shouldDirty:!0}))}}),{status:o,isUploading:l,activeUpload:c}=Ns(e),{abortUpload:f,clearInactive:m}=O();return s.jsxs("div",{children:[s.jsx($,{className:"w-full",variant:"flat",color:"primary",startIcon:s.jsx(Mt,{}),disabled:l,onClick:()=>i(),children:r("url")?s.jsx(u,{message:"Replace file"}):s.jsx(u,{message:"Upload file"})}),c&&s.jsx(Ft,{fileUpload:c,status:o,className:"mt-24",onAbort:g=>{f(g),m()}})]})}function Se({showExternalIdFields:e,showAlbumField:t=!0,uploadButton:a}){const{trans:r}=H(),n=te();return s.jsxs("div",{className:"md:flex gap-24",children:[s.jsxs("div",{className:"flex-shrink-0",children:[s.jsx(Qe,{name:"image",diskPrefix:"track_image",variant:n?"input":"square",label:n?s.jsx(u,{message:"Image"}):null,previewSize:n?void 0:"w-full md:w-224 aspect-square",stretchPreview:!0}),s.jsx("div",{className:"mt-24",children:a||s.jsx(Yn,{})})]}),s.jsxs("div",{className:"flex-auto mt-24 md:mt-0",children:[s.jsx(F,{name:"name",label:s.jsx(u,{message:"Name"}),className:"mb-24",required:!0,autoFocus:!0}),t&&s.jsx(Pn,{className:"mb-24",label:s.jsx(u,{message:"Album"}),name:"album_id",modelType:xt,openMenuOnFocus:!0,customEndpoint:"search/suggestions"}),s.jsx(Tt,{name:"artists",className:"mb-24"}),s.jsx(ve,{label:s.jsx(u,{message:"Genres"}),placeholder:r(N("+Add genre")),model:js,name:"genres",allowCustomValue:!0,className:"mb-24"}),s.jsx(ve,{label:s.jsx(u,{message:"Tags"}),placeholder:r(N("+Add tag")),model:$t,name:"tags",allowCustomValue:!0,className:"mb-24"}),s.jsx(F,{name:"description",label:s.jsx(u,{message:"Description"}),inputElementType:"textarea",rows:5,className:"mb-24"}),s.jsx(er,{}),e&&s.jsx(Zn,{}),e&&s.jsx(Jn,{}),e&&s.jsx(Xn,{})]})]})}function Zn(){return s.jsx(F,{name:"url",label:s.jsx(u,{message:"Audio or video URL"}),className:"mb-24",minLength:1,maxLength:230,description:s.jsx(u,{message:"Remote or local url to music or video file for this track. It will always play instead of youtube video."})})}function Xn(){const{spotify_is_setup:e}=oe();return e?s.jsx(F,{name:"spotify_id",label:s.jsx(u,{message:"Spotify ID"}),className:"mb-24",minLength:22,maxLength:22}):null}function Jn(){return s.jsx(F,{name:"youtube_id",label:s.jsx(u,{message:"Youtube video ID"}),className:"mb-24",minLength:8,maxLength:20,description:s.jsx(u,{message:"ID only. https://www.youtube.com/embed?v=<b>EPyh41zPg4Z</b>",values:{b:e=>s.jsx("strong",{children:e})}})})}function er(){const{watch:e}=Ke();return s.jsx(F,{required:!0,name:"duration",label:s.jsx(u,{message:"Duration (in milliseconds)"}),className:"mb-24",type:"number",min:1,max:864e5,description:s.jsx(u,{message:"Will appear on the site as: :preview",values:{preview:s.jsx(za,{ms:e("duration")})}})})}const Lt="tracks";function zt(e,{onSuccess:t}={}){const{trans:a}=H();return ce(r=>sr(r),{onSuccess:r=>{ee(a(N("Track created"))),ue.invalidateQueries(xe(Lt)),t==null||t(r)},onError:r=>Ne(r,e)})}function sr(e){return L.post(Lt,Cs(e)).then(t=>t.data)}function Cs(e){var t;return{...e,album_id:e.album_id?e.album_id:null,artists:(t=e.artists)==null?void 0:t.map(a=>a.id)}}function Ut({onTrackCreated:e,defaultValues:t}={}){const a=ne({defaultValues:t}),r=zt(a,{onSuccess:e});return{form:a,createTrack:r}}function mi({wrapInContainer:e}){const t=Ce(),{pathname:a}=de(),{form:r,createTrack:n}=Ut({onTrackCreated:i=>{a.includes("admin")?t(`/admin/tracks/${i.track.id}/edit`):t(ze(i.track))}});return s.jsx(De,{form:r,onSubmit:i=>{n.mutate(i)},title:s.jsx(u,{message:"Add new track"}),isLoading:n.isLoading,disableSaveWhenNotDirty:!0,wrapInContainer:e,children:s.jsx(me,{children:s.jsx(Se,{showExternalIdFields:!0})})})}const tr=e=>`tracks/${e}`;function ar(e,t={}){const{trans:a}=H();return ce(r=>nr(r),{onSuccess:r=>{var n;ee(a(N("Track updated"))),ue.invalidateQueries(xe("tracks")),(n=t.onSuccess)==null||n.call(t,r)},onError:r=>Ne(r,e)})}function nr({id:e,...t}){return L.put(tr(e),Cs(t)).then(a=>a.data)}function Et(e,t={}){var n;const a=ne({defaultValues:{...e,image:e.image||((n=e.album)==null?void 0:n.image)}}),r=ar(a,{onSuccess:t.onTrackUpdated});return{form:a,updateTrack:r}}function xi({wrapInContainer:e}){const t=ft({forEditing:!0});return t.data?s.jsx(rr,{track:t.data.track,wrapInContainer:e}):s.jsx(gs,{query:t,loaderClassName:"absolute inset-0 m-auto"})}function rr({track:e,wrapInContainer:t}){const a=Ce(),{pathname:r}=de(),{form:n,updateTrack:i}=Et(e,{onTrackUpdated:o=>{r.includes("admin")?a("/admin/tracks"):a(ze(o.track))}});return s.jsx(De,{form:n,onSubmit:o=>{i.mutate(o)},title:s.jsx(u,{message:"Edit “:name“ track",values:{name:e.name}}),isLoading:i.isLoading,disableSaveWhenNotDirty:!0,wrapInContainer:t,children:s.jsx(me,{children:s.jsx(Se,{showExternalIdFields:!0})})})}const _t="albums";function Ot(e){const{trans:t}=H();return ce(a=>ir(a),{onSuccess:()=>{ee(t(N("Album created"))),ue.invalidateQueries(xe(_t))},onError:a=>Ne(a,e)})}function ir(e){return L.post(_t,Ht(e)).then(t=>t.data)}function Ht(e){var t,a;return{...e,artists:(t=e.artists)==null?void 0:t.map(r=>r.id),tracks:(a=e.tracks)==null?void 0:a.map(r=>Cs(r))}}const lr=e=>`albums/${e}`;function or(e){const{trans:t}=H(),a=Ce(),{pathname:r}=de();return ce(n=>cr(n),{onSuccess:n=>{ee(t(N("Album updated"))),ue.invalidateQueries(xe("albums")),r.includes("admin")?a("/admin/artists"):a(Ue(n.album))},onError:n=>Ne(n,e)})}function cr({id:e,...t}){return L.put(lr(e),Ht(t)).then(a=>a.data)}function ur({track:e,hideAlbumField:t}){const{formId:a,close:r}=ds(),{form:n}=Et(e);return s.jsxs(qe,{size:"fullscreen",children:[s.jsx(tt,{children:s.jsx(u,{message:"Edit “:name“ track",values:{name:e.name}})}),s.jsx(We,{children:s.jsx(we,{id:a,form:n,onSubmit:i=>{r(i)},onBeforeSubmit:()=>{n.clearErrors()},children:s.jsx(Se,{showExternalIdFields:!0,showAlbumField:!t})})}),s.jsxs(Be,{children:[s.jsx($,{variant:"text",onClick:()=>r(),children:s.jsx(u,{message:"Cancel"})}),s.jsx($,{form:a,variant:"flat",color:"primary",type:"submit",children:s.jsx(u,{message:"Update"})})]})]})}function dr({defaultValues:e,hideAlbumField:t}){const{formId:a,close:r}=ds(),{form:n}=Ut({defaultValues:e});return s.jsxs(qe,{size:"fullscreen",children:[s.jsx(tt,{children:s.jsx(u,{message:"Add new track"})}),s.jsx(We,{children:s.jsx(we,{id:a,form:n,onSubmit:i=>{r(i)},onBeforeSubmit:()=>{n.clearErrors()},children:s.jsx(Se,{showExternalIdFields:!0,showAlbumField:!t})})}),s.jsxs(Be,{children:[s.jsx($,{variant:"text",onClick:()=>r(),children:s.jsx(u,{message:"Cancel"})}),s.jsx($,{form:a,variant:"flat",color:"primary",type:"submit",children:s.jsx(u,{message:"Create"})})]})]})}function mr(){const e=Ke(),{watch:t,setValue:a,getValues:r}=e,{fields:n,remove:i,append:o,move:l}=at({name:"tracks"}),c=(g,h)=>{var p;const x=(p=r("tracks"))==null?void 0:p.findIndex(b=>b.uploadId===g);x!=null&&a(`tracks.${x}`,Je(h,r(`tracks.${x}`)),{shouldDirty:!0})},{openFilePicker:f}=es({onUploadStart:g=>o(g),onMetadataChange:(g,h)=>{Rt(e,h),c(g.id,h)}}),m=t("tracks")||[];return s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-12",children:[s.jsx("h2",{className:"text-xl font-semibold my-24",children:s.jsx(u,{message:"Tracks"})}),s.jsx($,{variant:"outline",color:"primary",size:"xs",className:"ml-auto",startIcon:s.jsx(Mt,{}),onClick:()=>f(),children:s.jsx(u,{message:"Upload tracks"})}),s.jsxs(ie,{type:"modal",onClose:g=>{g&&o(g)},children:[s.jsx(je,{label:s.jsx(u,{message:"Create track"}),children:s.jsx(W,{variant:"outline",color:"primary",size:"xs",radius:"rounded",children:s.jsx(vs,{})})}),s.jsx(dr,{hideAlbumField:!0,defaultValues:{artists:t("artists"),tags:t("tags"),genres:t("genres")}})]})]}),n.map((g,h)=>{const x=m[h];return s.jsx(xr,{track:x,onRemove:()=>i(h),onSort:(p,b)=>l(p,b),tracks:m,onUpdate:p=>{c(x.uploadId,p)}},g.id)}),n.length?null:s.jsx(nt,{className:"mt-40",image:s.jsx(rt,{src:Pt}),title:s.jsx(u,{message:"This album does not have any tracks yet"})})]})}function xr({track:e,tracks:t,onRemove:a,onUpdate:r,onSort:n}){const i=d.useRef(null),o=d.useRef(null),l=O(h=>h.abortUpload),c=O(h=>e.uploadId?h.fileUploads.get(e.uploadId):null),{isUploading:f,status:m}=Ns(e.uploadId),{sortableProps:g}=Ea({disabled:f,ref:i,item:e,items:t,type:"albumFormTrack",preview:o,previewVariant:"line",onSortEnd:(h,x)=>{n(h,x)}});return s.jsxs("div",{className:"border-b border-t border-t-transparent py-4",ref:i,...g,children:[s.jsxs("div",{className:"flex items-center text-sm",children:[s.jsx(W,{className:"flex-shrink-0 mr-14",disabled:f,children:s.jsx(Rn,{})}),s.jsx("div",{className:"flex-auto whitespace-nowrap overflow-hidden overflow-ellipsis",children:e.name}),c&&s.jsxs("div",{className:"flex items-center mr-10",children:[s.jsx(Vt,{fileUpload:c,status:m,className:"mr-10"}),s.jsx(hs,{isIndeterminate:m==="processing",value:c.percentage,size:"sm"})]}),s.jsxs(ie,{type:"modal",onClose:h=>{h&&r(h)},children:[s.jsx(je,{label:s.jsx(u,{message:"Edit track"}),children:s.jsx(W,{className:"flex-shrink-0 ml-auto text-muted",disabled:f,children:s.jsx(ws,{})})}),s.jsx(ur,{track:e,hideAlbumField:!0})]}),s.jsxs(ie,{type:"modal",onClose:h=>{h&&(e.uploadId&&l(e.uploadId),a())},children:[s.jsx(je,{label:s.jsx(u,{message:"Remove track"}),children:s.jsx(W,{className:"flex-shrink-0 text-muted",children:s.jsx(ps,{})})}),s.jsx(it,{isDanger:!0,title:s.jsx(u,{message:"Remove track"}),body:s.jsx(u,{message:"Are you sure you want to remove this track from the album?"}),confirm:s.jsx(u,{message:"Remove"})})]})]}),s.jsx(fr,{track:e,ref:o})]})}const fr=Oe.forwardRef(({track:e},t)=>{var r,n;let a=e.name;return(r=e.artists)!=null&&r.length&&(a+=`- ${(n=e.artists)==null?void 0:n[0].name}`),s.jsx(Ua,{ref:t,children:()=>s.jsx("div",{className:"p-8 rounded shadow bg-chip text-sm",children:a})})});function Is({showExternalIdFields:e}){const{trans:t}=H(),a=te();return s.jsxs(d.Fragment,{children:[s.jsxs("div",{className:"md:flex gap-24",children:[s.jsx("div",{className:"flex-shrink-0",children:s.jsx(Qe,{name:"image",diskPrefix:"album_images",label:a?s.jsx(u,{message:"Image"}):null,variant:a?"input":"square",previewSize:a?void 0:"w-full md:w-224 aspect-square",stretchPreview:!0})}),s.jsxs("div",{className:"flex-auto mt-24 md:mt-0",children:[s.jsx(F,{name:"name",label:s.jsx(u,{message:"Name"}),className:"mb-24",required:!0,autoFocus:!0}),s.jsx(En,{name:"release_date",label:s.jsx(u,{message:"Release date"}),className:"mb-24",granularity:"day"}),s.jsx(Tt,{name:"artists",className:"mb-24"}),s.jsx(ve,{label:s.jsx(u,{message:"Genres"}),placeholder:t(N("+Add genre")),model:js,name:"genres",allowCustomValue:!0,className:"mb-24"}),s.jsx(ve,{label:s.jsx(u,{message:"Tags"}),placeholder:t(N("+Add tag")),model:$t,name:"tags",allowCustomValue:!0,className:"mb-24"}),s.jsx(F,{name:"description",label:s.jsx(u,{message:"Description"}),inputElementType:"textarea",rows:5,className:"mb-24"}),e&&s.jsx(hr,{})]})]}),s.jsx(mr,{})]})}function hr(){const{spotify_is_setup:e}=oe();return e?s.jsx(F,{name:"spotify_id",label:s.jsx(u,{message:"Spotify ID"}),className:"mb-24",minLength:22,maxLength:22}):null}function fi({wrapInContainer:e}){const t=ht({forEditing:!0,with:"tags,genres,artists,fullTracks"});return t.data?s.jsx(pr,{album:t.data.album,wrapInContainer:e}):s.jsx(gs,{query:t,loaderClassName:"absolute inset-0 m-auto"})}function pr({album:e,wrapInContainer:t}){const a=ne({defaultValues:{...e}}),r=or(a);return s.jsx(De,{form:a,onSubmit:n=>{r.mutate(n)},title:s.jsx(u,{message:"Edit “:name“ album",values:{name:e.name}}),isLoading:r.isLoading,disableSaveWhenNotDirty:!0,wrapInContainer:t,children:s.jsx(me,{children:s.jsx(Is,{showExternalIdFields:!0})})})}const gr=d.forwardRef(({onUploadStart:e,onCancel:t,onCreate:a},r)=>{const n=pt(),i=Ie(),[o,l]=d.useState(!1),c=ne({defaultValues:{tracks:[],artists:n?[n]:[],release_date:i.toAbsoluteString()}}),f=c.watch("tracks")||[],m=O(b=>b.abortUpload),{openFilePicker:g,uploadTracks:h,validateUploads:x}=es({onUploadStart:b=>{l(!0),c.setValue("tracks",[...c.getValues("tracks"),b]),e()},onMetadataChange:(b,y)=>{Rt(c,y),c.setValue("tracks",c.getValues("tracks").map(k=>k.uploadId===b.id?Je(y,k):k))}});d.useImperativeHandle(r,()=>({openFilePicker:g,uploadTracks:h,validateUploads:x}),[g,h,x]);const p=Ot(c);return o?s.jsxs(we,{className:"rounded border p-14 md:p-24 mb-30 bg-paper",form:c,onSubmit:b=>p.mutate(b,{onSuccess:y=>{l(!1),c.reset(),a(y.album)}}),children:[s.jsx(Is,{showExternalIdFields:!1}),s.jsxs("div",{className:"mt-24",children:[s.jsx($,{variant:"text",onClick:()=>{f.forEach(b=>{m(b.uploadId)}),c.reset(),l(!1),t()},className:"mr-10",children:s.jsx(u,{message:"Cancel"})}),s.jsx($,{type:"submit",variant:"flat",color:"primary",disabled:p.isLoading,children:s.jsx(u,{message:"Save"})})]})]}):null}),br=d.forwardRef(({onUploadStart:e,onCancel:t,onCreate:a},r)=>{const n=pt(),i=O(g=>g.abortUpload),[o,l]=d.useState([]),{openFilePicker:c,uploadTracks:f,validateUploads:m}=es({onUploadStart:g=>{l(h=>n?[...h,{...g,artists:[n]}]:[...h,g]),e()},onMetadataChange:(g,h)=>{l(x=>x.map(p=>p.uploadId===g.id?Je(h,p):p))}});return d.useImperativeHandle(r,()=>({openFilePicker:c,uploadTracks:f,validateUploads:m}),[c,f,m]),s.jsx("div",{className:"w-full",children:o.map(g=>s.jsx(jr,{track:g,onCreate:h=>{l(x=>x.filter(p=>p.uploadId!==g.uploadId)),a(h)},onRemove:()=>{l(h=>{const x=h.filter(p=>p.uploadId!==g.uploadId);return x.length||t(),x}),i(g.uploadId)}},g.uploadId))})}),jr=d.memo(({track:e,onRemove:t,onCreate:a})=>{const r=ne({defaultValues:e}),n=zt(r),i=O(f=>f.fileUploads.get(e.uploadId)),{isUploading:o,status:l}=Ns(e.uploadId);d.useEffect(()=>{r.reset(e)},[e,r]);const c=o&&i?s.jsx(Ft,{fileUpload:i,status:l}):null;return s.jsxs(we,{form:r,onSubmit:f=>{n.mutate(f,{onSuccess:m=>a(m.track)})},className:"rounded border p-14 md:p-24 mb-30 bg-paper",children:[s.jsx(Se,{uploadButton:c,showExternalIdFields:!1}),s.jsx($,{variant:"text",onClick:()=>t(),className:"mr-10",children:s.jsx(u,{message:"Cancel"})}),s.jsx($,{type:"submit",variant:"flat",color:"primary",disabled:n.isLoading||!r.watch("url"),children:s.jsx(u,{message:"Save"})})]})}),vr=""+new URL("album-border-b5dd7d9f.png",import.meta.url).href;function yr({media:e}){var r,n;const t=e.model_type===xt,a=t?Ue(e,{absolute:!0}):ze(e,{absolute:!0});return s.jsxs("div",{className:"flex items-center gap-28 border rounded bg-paper p-20 my-20 mx-auto w-780 max-w-full",children:[s.jsxs("div",{className:P(t&&"relative isolate my-14 mx-18"),children:[t?s.jsx(Ze,{album:e,className:"rounded flex-shrink-0 z-20 relative",size:"w-132 h-132"}):s.jsx(ys,{track:e,className:"rounded flex-shrink-0 z-20 relative",size:"w-132 h-132"}),t&&s.jsx("img",{className:"absolute block w-160 h-160 max-w-160 -top-14 -left-14 z-10",src:vr,alt:""})]}),s.jsxs("div",{className:"flex-auto",children:[s.jsx("div",{className:"text-base font-bold",children:e.name}),s.jsx("div",{className:"text-muted text-sm mb-14",children:s.jsx(Xe,{artists:e.artists})}),(r=e.genres)!=null&&r.length?s.jsx(mt,{selectable:!1,size:"sm",className:"mb-14",children:(n=e.genres)==null?void 0:n.map(i=>s.jsx(st,{children:i.display_name||i.name},i.id))}):null,s.jsx("div",{className:"text-sm",children:s.jsx(u,{message:"Upload complete. <a>Go to your track</a>",values:{a:i=>s.jsx(Z,{className:lt,to:t?Ue(e):ze(e),children:i})}})})]}),s.jsx("div",{className:"ml-auto flex-auto max-w-300",children:s.jsxs("div",{className:"text-muted text-sm",children:[s.jsx(u,{message:"Share your new track"}),s.jsx(_a,{name:e.name,image:e.image,link:a}),s.jsx(wa,{value:a,readOnly:!0,className:"mt-24 w-full",size:"sm",onClick:i=>{i.target.select()}})]})})]})}function kr({isVisible:e}){const t=s.jsx(J.div,{...fs,transition:{duration:.3},className:"absolute inset-0 w-full min-h-full bg-primary-light/30 border-2 border-dashed border-primary pointer-events-none",children:s.jsx(J.div,{initial:{y:"100%",opacity:0},animate:{y:"-10px",opacity:1},exit:{y:"100%",opacity:0},className:"p-10 bg-primary text-on-primary fixed bottom-0 left-0 right-0 max-w-max mx-auto rounded",children:s.jsx(u,{message:"Drop your files anywhere on the page to upload"})})},"dragTargetMask");return s.jsx(Ge,{children:e?t:null})}function wr(){const{user:e}=ge();e!=null&&e.id&&ue.resetQueries(["minutesLimit",e.id])}function Nr(){const{user:e}=Na(),t=e==null?void 0:e.id;return ae(["minutesLimit",t],()=>Cr(t),{enabled:t!=null})}function Cr(e){return L.get(`users/${e}/minutes-left`).then(t=>t.data)}const Ir=""+new URL("light-bg-8c37cb47.svg",import.meta.url).href,Dr=""+new URL("dark-bg-38ecc414.svg",import.meta.url).href;function Sr({children:e,...t}){const a=Ca();return s.jsxs("div",{className:"h-full flex flex-col",...t,children:[s.jsx(ot,{className:"flex-shrink-0",color:"bg",darkModeColor:"bg"}),s.jsx("div",{className:"overflow-y-auto flex-auto bg-cover relative",style:{backgroundImage:`url(${a?Dr:Ir})`},children:s.jsxs("div",{className:"container mx-auto p-14 md:p-24 min-h-full flex flex-col",children:[s.jsx("div",{className:"flex-auto",children:e}),s.jsx(ct,{})]})})]})}function hi({backstageLayout:e=!0}){return s.jsx(me,{children:s.jsx(Ar,{backstageLayout:e})})}function Ar({backstageLayout:e}){const[t,a]=d.useState("tracks"),[r,n]=d.useState(!1),i=d.useRef(null),o=t==="tracks"?br:gr,[l,c]=d.useState([]),f=d.useRef(null),[m,g]=d.useState(!1),{droppableProps:h}=Oa({id:"uploadPageRoot",ref:f,types:["nativeFile"],onDragEnter:()=>g(!0),onDragLeave:()=>g(!1),onDrop:async p=>{var b,y;if(p.type==="nativeFile"){const k=await p.getData(),C=(b=i.current)==null?void 0:b.validateUploads(k);C!=null&&C.length&&((y=i.current)==null||y.uploadTracks(C))}}}),x=e?Sr:Tr;return s.jsxs(x,{...h,children:[!r&&s.jsx(Pr,{onUpload:()=>{var p;return(p=i.current)==null?void 0:p.openFilePicker()},uploadMode:t,onUploadModeChange:a}),l.map(p=>s.jsx(yr,{media:p},p.id)),s.jsx(o,{ref:i,onUploadStart:()=>n(!0),onCreate:p=>{c(b=>[...b,p]),wr()},onCancel:()=>{n(!1)}}),s.jsx(kr,{isVisible:m})]})}function Pr({onUpload:e,uploadMode:t,onUploadModeChange:a}){const{data:r}=Nr();return s.jsxs("div",{className:"pt-40",children:[s.jsxs("div",{className:"border rounded p-20 md:p-48 flex flex-col items-center max-w-580 mx-auto bg-paper",children:[s.jsx("h1",{className:"text-base md:text-[22px] md:font-light",children:s.jsx(u,{message:"Drag and drop your tracks, videos & albums here."})}),s.jsx($,{variant:"flat",color:"primary",className:"mt-20 w-min",onClick:()=>e(),children:s.jsx(u,{message:"Or choose files to upload"})}),s.jsx("div",{className:"border-t pt-20 mt-20",children:s.jsx(Ha,{checked:t==="album",onChange:n=>a(n.target.checked?"album":"tracks"),children:s.jsx(u,{message:"Make an album when multiple files are selected"})})})]}),s.jsx("div",{className:"text-muted mt-20 text-sm text-center min-h-20",children:(r==null?void 0:r.minutesLeft)!=null&&s.jsx(u,{message:"You have :count minutes left. Try <a>Pro accounts</a> to get more time and access to advanced features.",values:{count:r.minutesLeft,a:n=>s.jsx(Z,{className:lt,to:"/pricing",children:n})}})})]})}function Tr({children:e,...t}){return s.jsx("div",{...t,className:"min-h-full relative",children:s.jsx("div",{className:"container mx-auto p-14 md:p-24",children:e})})}function pi({wrapInContainer:e}){const t=Ie(),a=Ce(),{pathname:r}=de(),[n]=Ia(),{data:i}=St(Ba,n.get("artistId")),o=i==null?void 0:i.model,l=ne({defaultValues:{release_date:t.toAbsoluteString()}}),c=Ot(l);return d.useEffect(()=>{o&&l.reset({artists:[o]})},[o,l]),s.jsx(De,{form:l,onSubmit:f=>{c.mutate(f,{onSuccess:m=>{r.includes("admin")?a(o?`/admin/artists/${o.id}/edit`:"/admin/albums"):a(Ue(m.album))}})},title:s.jsx(u,{message:"Add new album"}),isLoading:c.isLoading,disableSaveWhenNotDirty:!0,wrapInContainer:e,children:s.jsx(me,{children:s.jsx(Is,{showExternalIdFields:!0})})})}function gi(){const{requestId:e}=Ye();return ae(["backstage-request",+e],()=>$r(e))}function $r(e){return L.get(`backstage-request/${e}`).then(t=>t.data)}const bi=se(s.jsx("path",{d:"M7 3H4v3H2V1h5v2zm15 3V1h-5v2h3v3h2zM7 21H4v-3H2v5h5v-2zm13-3v3h-3v2h5v-5h-2zM17 6H7v12h10V6zm2 12c0 1.1-.9 2-2 2H7c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2v12zM15 8H9v2h6V8zm0 3H9v2h6v-2zm0 3H9v2h6v-2z"}),"DocumentScannerOutlined"),Mr=[{key:"name",allowsSorting:!0,header:()=>s.jsx(u,{message:"Name"}),width:"w-5/6 max-w-200",padding:"pl-8 pr-16",body:e=>s.jsxs("div",{className:"flex items-center gap-12 w-max",children:[s.jsx(Ze,{album:e,className:"flex-shrink-0",size:"w-34 h-34 rounded"}),s.jsx(ks,{album:e,target:"_blank"})]})},{key:"release_date",allowsSorting:!0,header:()=>s.jsx(u,{message:"Release date"}),body:e=>e.release_date?s.jsx(Da,{date:e.release_date}):null},{key:"track_count",allowsSorting:!1,header:()=>s.jsx(u,{message:"Track count"}),body:e=>e.tracks_count?s.jsx(Ee,{value:e.tracks_count}):null},{key:"plays",allowsSorting:!0,header:()=>s.jsx(u,{message:"Plays"}),body:e=>e.plays?s.jsx(Ee,{value:e.plays}):null},{key:"actions",header:()=>s.jsx(u,{message:"Actions"}),hideHeader:!0,align:"end",padding:"pl-16",body:e=>s.jsx(Fr,{album:e})}];function Vr({albums:e=[]}){const{watch:t}=Ke(),a=t("id"),{data:r,sortDescriptor:n,onSortChange:i}=qa(e);return s.jsxs("div",{children:[s.jsxs("div",{className:"my-24",children:[s.jsxs("div",{className:"flex items-center gap-12",children:[s.jsx("h2",{className:"text-xl font-semibold",children:s.jsx(u,{message:"Albums"})}),s.jsx($,{variant:"outline",color:"primary",size:"xs",className:"ml-auto",startIcon:s.jsx(vs,{}),elementType:a?Z:void 0,to:`/admin/albums/new?artistId=${a}`,disabled:!a,children:s.jsx(u,{message:"Add album"})})]}),!a&&s.jsxs("div",{className:"flex items-center gap-6 text-sm",children:[s.jsx(On,{viewBox:"0 0 16 16",size:"xs",className:"text-muted"}),s.jsx(u,{message:"Save changes to enable album creation."})]})]}),s.jsx(Wa,{columns:Mr,data:e,sortDescriptor:n,onSortChange:i,enableSelection:!1}),r.length?null:s.jsx(nt,{className:"mt-40",image:s.jsx(rt,{src:Pt}),title:s.jsx(u,{message:"This artist does not have any albums yet"})})]})}function Fr({album:e}){const t=Ga();return s.jsxs("div",{className:"text-muted",children:[s.jsx(Z,{to:`../../../albums/${e.id}/edit`,relative:"path",children:s.jsx(W,{size:"md",children:s.jsx(ws,{})})}),s.jsxs(ie,{type:"modal",onClose:a=>{a&&t.mutate({albumId:e.id})},children:[s.jsx(W,{size:"md",disabled:t.isLoading,children:s.jsx(ps,{})}),s.jsx(it,{isDanger:!0,title:s.jsx(u,{message:"Delete album"}),body:s.jsx(u,{message:"Are you sure you want to delete this album?"}),confirm:s.jsx(u,{message:"Delete"})})]})]})}function Rr({albums:e,showExternalFields:t}){const a=te();return s.jsxs(me,{children:[s.jsxs("div",{className:"md:flex gap-24",children:[s.jsxs("div",{className:"flex-shrink-0",children:[s.jsx(Qe,{name:"image_small",diskPrefix:"artist_images",label:a?s.jsx(u,{message:"Image"}):null,variant:a?"input":"square",previewSize:a?void 0:"w-full md:w-224 aspect-square",stretchPreview:!0}),t&&s.jsx(Ka,{name:"verified",className:"mt-14",children:s.jsx(u,{message:"Verified"})})]}),s.jsx("div",{className:"flex-auto mt-24 md:mt-0",children:s.jsxs(Qa,{isLazy:!0,children:[s.jsxs(Ya,{children:[s.jsx(Ae,{children:s.jsx(u,{message:"Details"})}),s.jsx(Ae,{children:s.jsx(u,{message:"Links"})}),s.jsx(Ae,{children:s.jsx(u,{message:"Biography"})}),s.jsx(Ae,{children:s.jsx(u,{message:"Images"})})]}),s.jsxs(Za,{className:"pt-20",children:[s.jsx(Pe,{children:s.jsx(Lr,{showExternalFields:t})}),s.jsx(Pe,{children:s.jsx(Xa,{})}),s.jsx(Pe,{children:s.jsx(zr,{})}),s.jsx(Pe,{children:s.jsx(Ur,{})})]})]})})]}),s.jsx(Vr,{albums:e})]})}function Lr({showExternalFields:e}){const{trans:t}=H();return s.jsxs(d.Fragment,{children:[s.jsx(F,{name:"name",label:s.jsx(u,{message:"Name"}),className:"mb-24",required:!0,autoFocus:!0,disabled:!e}),s.jsx(ve,{label:s.jsx(u,{message:"Genres"}),placeholder:t(N("+Add genre")),model:js,name:"genres",allowCustomValue:!0,className:"mb-24"}),e&&s.jsx(Er,{})]})}function zr(){return s.jsxs(d.Fragment,{children:[s.jsx(F,{name:"profile.country",label:s.jsx(u,{message:"Country"}),className:"mb-24"}),s.jsx(F,{name:"profile.city",label:s.jsx(u,{message:"City"}),className:"mb-24"}),s.jsx(F,{inputElementType:"textarea",rows:5,name:"profile.description",label:s.jsx(u,{message:"Description"}),className:"mb-24"})]})}function Ur(){const{fields:e,append:t,remove:a}=at({name:"profile_images"});return s.jsxs("div",{children:[s.jsx("div",{className:"flex gap-12 flex-wrap mb-24",children:e.map((r,n)=>s.jsx(Qe,{name:`profile_images.${n}.url`,diskPrefix:"artist_images",variant:"square",previewSize:"w-160 h-160",stretchPreview:!0,showRemoveButton:!0,onChange:i=>{i||a(n)}},r.id))}),s.jsx($,{variant:"outline",color:"primary",startIcon:s.jsx(vs,{}),onClick:()=>{t({url:""})},children:s.jsx(u,{message:"Add another image"})})]})}function Er(){const{spotify_is_setup:e}=oe();return e?s.jsx(F,{name:"spotify_id",label:s.jsx(u,{message:"Spotify ID"}),className:"mb-24",minLength:22,maxLength:22}):null}const _r=e=>`artists/${e}`;function Or(e){const{trans:t}=H(),a=Ce(),{pathname:r}=de();return ce(n=>Hr(n),{onSuccess:n=>{ee(t(N("Artist updated"))),ue.invalidateQueries(xe("artists")),r.includes("admin")?a("/admin/artists"):a(Sa(n.artist))},onError:n=>Ne(n,e)})}function Hr({id:e,...t}){return L.put(_r(e),t).then(a=>a.data)}function ji({wrapInContainer:e,showExternalFields:t}){const a=gt({forEditing:!0,with:"albums,genres,profile",albumsPerPage:50});return a.data?s.jsx(Br,{response:a.data,wrapInContainer:e,showExternalFields:t}):s.jsx(gs,{query:a,loaderClassName:"absolute inset-0 m-auto"})}function Br({response:e,wrapInContainer:t,showExternalFields:a}){var i;const r=ne({defaultValues:{id:e.artist.id,name:e.artist.name,verified:e.artist.verified,spotify_id:e.artist.spotify_id,genres:e.artist.genres,image_small:e.artist.image_small,links:e.artist.links,profile:e.artist.profile,profile_images:e.artist.profile_images}}),n=Or(r);return s.jsx(De,{form:r,onSubmit:o=>{n.mutate(o)},title:s.jsx(u,{message:"Edit “:name“ artist",values:{name:e.artist.name}}),isLoading:n.isLoading,disableSaveWhenNotDirty:!0,wrapInContainer:t,children:s.jsx(Rr,{albums:(i=e.albums)==null?void 0:i.data,showExternalFields:a})})}const qr={month:"short",day:"2-digit"};function Wr({value:e,onChange:t,compactOnMobile:a=!0}){const r=te();return s.jsxs(ie,{type:"popover",onClose:n=>{n&&t(n)},children:[s.jsx($,{variant:"outline",color:"chip",endIcon:s.jsx(yt,{}),children:s.jsx(It,{start:e.start,end:e.end,options:r&&a?qr:Js.short})}),s.jsx(Gr,{value:e})]})}function Gr({value:e}){const t=te(),a=an({defaultValue:e,closeDialogOnSelection:!1});return s.jsx(jn,{state:a,showInlineDatePickerField:!t})}function Ds(e){const{title:t,description:a,children:r,className:n,contentIsFlex:i=!0,contentClassName:o,contentRef:l,minHeight:c="min-h-440"}=e;return s.jsxs("div",{className:P("bg border rounded h-full flex flex-col flex-auto",c,n),children:[s.jsxs("div",{className:"text-xs p-14 flex-shrink-0 flex justify-between",children:[s.jsx("div",{className:"font-semibold text-sm",children:t}),a&&s.jsx("div",{className:"text-muted",children:a})]}),s.jsx("div",{ref:l,className:P("p-14 relative",i&&"flex-auto flex items-center justify-center",o),children:r})]})}function _e(){return s.jsxs("div",{className:"flex items-center gap-10 text-sm absolute mx-auto",children:[s.jsx(hs,{isIndeterminate:!0,size:"sm"}),s.jsx(u,{message:"Chart loading"})]})}const Kr=d.lazy(()=>Aa(()=>import("./lazy-chart-4b457944.js"),["./lazy-chart-4b457944.js","./main-0832b2fb.js","./main-d1e86a48.css"],import.meta.url));function Bt(e){const{title:t,description:a,className:r,contentRef:n,isLoading:i}=e;return s.jsx(Ds,{title:t,description:a,className:r,contentRef:n,children:s.jsxs(d.Suspense,{fallback:s.jsx(_e,{}),children:[s.jsx(Kr,{...e}),i&&s.jsx(_e,{})]})})}function qt(e,{localeCode:t="en",shareFirstDatasetLabels:a=!0}){if(!e)return{datasets:[]};const r=[];return{...e,datasets:e.datasets.map((n,i)=>{const o=n.data.map((l,c)=>{let f;return i===0||!a?(f=Qr(l,e.granularity,t),r[c]=f):f=r[c],{...f,value:l.value}});return{...n,data:o}})}}function Qr(e,t,a){return e.label!=null?{label:e.label}:e.date?Yr(e,t,a):{label:""}}function Yr({date:e,endDate:t,value:a},r="day",n){const i=Le(e).toDate(),o=t?Le(t).toDate():null;switch(r){case"minute":return{label:E(n,{second:"2-digit"}).format(i),tooltipTitle:E(n,{day:"2-digit",hour:"numeric",minute:"numeric",second:"2-digit"}).format(i)};case"hour":return{label:E(n,{hour:"numeric",minute:"numeric"}).format(i),tooltipTitle:E(n,{month:"short",day:"2-digit",hour:"numeric",minute:"numeric"}).format(i)};case"day":return{label:E(n,{day:"2-digit",weekday:"short"}).format(i),tooltipTitle:E(n,{day:"2-digit",weekday:"short",month:"short"}).format(i)};case"week":return{label:E(n,{month:"short",day:"2-digit"}).format(i),tooltipTitle:E(n,{day:"2-digit",month:"long",year:"numeric"}).formatRange(i,o)};case"month":return{label:E(n,{month:"short",year:"numeric"}).format(i),tooltipTitle:E(n,{month:"long",year:"numeric"}).format(i)};case"year":return{label:E(n,{year:"numeric"}).format(i),tooltipTitle:E(n,{year:"numeric"}).format(i)}}}const E=Pa((e,t)=>new Ta(e,t),{equals:(e,t)=>et(e,t),callTimeout:void 0}),Os=ge().themes.all[0].colors["--be-primary"],pe=[[`rgb(${Os.replaceAll(" ",",")})`,`rgba(${Os.replaceAll(" ",",")},0.2)`],["rgb(255,112,67)","rgb(255,112,67,0.2)"],["rgb(255,167,38)","rgb(255,167,38,0.2)"],["rgb(141,110,99)","rgb(141,110,99,0.2)"],["rgb(102,187,106)","rgba(102,187,106,0.2)"],["rgb(92,107,192)","rgb(92,107,192,0.2)"]],Zr={parsing:{xAxisKey:"label",yAxisKey:"value"},datasets:{line:{fill:"origin",tension:.1,pointBorderWidth:4,pointHitRadius:10}},plugins:{tooltip:{intersect:!1,mode:"index"}}};function Xr({data:e,className:t,...a}){const{localeCode:r}=le(),n=d.useMemo(()=>{const i=qt(e,{localeCode:r});return i.datasets=i.datasets.map((o,l)=>({...o,backgroundColor:pe[l][1],borderColor:pe[l][0],pointBackgroundColor:pe[l][0]})),i},[e,r]);return s.jsx(Bt,{...a,className:P(t,"min-w-500"),data:n,type:"line",options:Zr})}const Jr={parsing:{key:"value"},plugins:{tooltip:{intersect:!0}}};function Hs({data:e,className:t,...a}){const{localeCode:r}=le(),n=d.useMemo(()=>{var o;const i=qt(e,{localeCode:r});return i.labels=(o=i.datasets[0])==null?void 0:o.data.map(l=>l.label),i.datasets=i.datasets.map((l,c)=>({...l,backgroundColor:pe.map(f=>f[1]),borderColor:pe.map(f=>f[0]),borderWidth:2})),i},[e,r]);return s.jsx(Bt,{type:"polarArea",data:n,options:Jr,className:P(t,"min-w-500"),...a})}const Bs="https://www.gstatic.com/charts/loader.js";function ei({placeholderRef:e,data:t}){const{trans:a}=H(),{analytics:r}=oe(),n=r==null?void 0:r.gchart_api_key,{selectedTheme:i}=$a(),o=d.useRef(),l=d.useCallback(()=>{var x,p;if(typeof google>"u")return;const f=t.map(b=>[b.label,b.value]);f.unshift([a(N("Country")),a(N("Clicks"))]);const m=`${Ls(i.colors["--be-paper"])}`,h={colorAxis:{colors:[`${Ls(i.colors["--be-primary"])}`]},backgroundColor:m};!o.current&&e.current&&((x=google==null?void 0:google.visualization)!=null&&x.GeoChart)&&(o.current=new google.visualization.GeoChart(e.current)),(p=o.current)==null||p.draw(google.visualization.arrayToDataTable(f),h)},[i,t,e]),c=d.useCallback(()=>{Rs.alreadyLoading(Bs)||Rs.loadAsset(Bs,{type:"js"}).then(()=>{google.charts.load("current",{packages:["geochart"],mapsApiKey:n}),google.charts.setOnLoadCallback(()=>{l()})})},[n,l]);return d.useEffect(()=>{c()},[c]),d.useEffect(()=>{l()},[i,l,t]),{drawGoogleChart:l}}function si({data:e,isLoading:t,...a}){const r=d.useRef(null),n=e==null?void 0:e.datasets[0].data,i=d.useMemo(()=>n||[],[n]);return ei({placeholderRef:r,data:i}),s.jsxs(Ds,{...a,className:"min-w-500",title:s.jsx(u,{message:"Top Locations"}),contentIsFlex:t,children:[t&&s.jsx(_e,{}),s.jsxs("div",{className:"flex",children:[s.jsx("div",{ref:r,className:"flex-auto w-[480px] min-h-[340px]"}),s.jsx("div",{className:"text-sm max-h-[370px] w-[170px] flex-initial overflow-y-auto",children:i.map(o=>s.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[s.jsx("div",{className:"max-w-110 whitespace-nowrap overflow-hidden overflow-ellipsis",children:o.label}),s.jsxs("div",{children:["(",o.percentage,")%"]})]},o.label))})]})]})}const qs="reports/insights";function ti(e,t){return ae([qs,e],()=>ai(qs,e),{keepPreviousData:!0,enabled:t.isEnabled})}function ai(e,t){var r;const a={model:t.model,metrics:(r=t.metrics)==null?void 0:r.join(",")};return a.startDate=t.dateRange.start.toAbsoluteString(),a.endDate=t.dateRange.end.toAbsoluteString(),a.timezone=t.dateRange.start.timeZone,L.get(e,{params:a}).then(n=>n.data)}const ni=se(s.jsx("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"InfoOutlined");function Me({data:e,isLoading:t,...a}){const r=(e==null?void 0:e.datasets[0].data)||[];return s.jsxs(Ds,{...a,className:"min-w-500 md:min-w-0 w-1/2",contentIsFlex:t,contentClassName:"max-h-[370px] overflow-y-auto compact-scrollbar",children:[t&&s.jsx(_e,{}),r.map(n=>s.jsxs("div",{className:"mb-20 text-sm flex items-center justify-between gap-24",children:[s.jsxs("div",{className:"flex items-center gap-8",children:[s.jsx(ri,{model:n.model,size:"w-42 h-42",className:"rounded flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("div",{className:"text-sm",children:s.jsx(ii,{model:n.model})}),s.jsx("div",{className:"text-xs text-muted",children:s.jsx(li,{model:n.model})})]})]}),s.jsxs("div",{className:"flex items-center gap-4 flex-shrink-0",children:[s.jsx(Ja,{className:"text-muted",size:"sm"}),s.jsx(u,{message:":count plays",values:{count:s.jsx(Ee,{value:n.value})}})]})]},n.model.id)),!t&&!r.length&&s.jsxs("div",{className:"flex items-center gap-8 text-muted",children:[s.jsx(ni,{size:"sm"}),s.jsx(u,{message:"No plays in selected timeframe."})]})]})}function ri({model:e,size:t,className:a}){const{pathname:r}=de(),i=r.includes("/admin")?`/admin/${e.model_type}s/${e.id}/insights`:`/backstage/${e.model_type}s/${e.id}/insights`;switch(e.model_type){case"artist":return s.jsx(Z,{to:i,children:s.jsx(ut,{artist:e,size:t,className:a})});case"album":return s.jsx(Z,{to:i,children:s.jsx(Ze,{album:e,size:t,className:a})});case"track":return s.jsx(Z,{to:i,children:s.jsx(ys,{track:e,size:t,className:a})});case"user":return s.jsx(en,{user:e,size:t,className:a})}}function ii({model:e}){switch(e.model_type){case"artist":return s.jsx(dt,{artist:e,target:"_blank"});case"album":return s.jsx(ks,{album:e,target:"_blank"});case"track":return s.jsx(bt,{track:e,target:"_blank"});case"user":return e.id?s.jsx(Ma,{user:e,target:"_blank"}):s.jsx(d.Fragment,{children:e.display_name})}}function li({model:e}){switch(e.model_type){case"artist":case"user":return null;case"album":case"track":return s.jsx(Xe,{artists:e.artists,target:"_blank"})}}function Ss(e){const a="flex flex-col lg:flex-row lg:items-center overflow-x-auto gap-12 md:gap-24 mb-12 md:mb-24",r=e.model,n=e.dateRange;return s.jsxs(d.Fragment,{children:[s.jsxs("div",{className:a,children:[s.jsx(Q,{metric:"plays",model:r,dateRange:n,children:({data:i})=>s.jsx(Xr,{className:"flex-auto",title:s.jsx(u,{message:"Plays"}),hideLegend:!0,description:s.jsx(u,{message:":count total plays",values:{count:s.jsx(Ee,{value:(i==null?void 0:i.report.plays.total)||0})}})})}),s.jsx(Q,{metric:"devices",model:r,dateRange:n,children:s.jsx(Hs,{title:s.jsx(u,{message:"Top devices"})})})]}),s.jsxs("div",{className:a,children:[e.showTracks&&s.jsx(Q,{metric:"tracks",model:r,dateRange:n,children:s.jsx(Me,{title:s.jsx(u,{message:"Most played tracks"})})}),s.jsx(Q,{metric:"users",model:r,dateRange:n,children:s.jsx(Me,{title:s.jsx(u,{message:"Top listeners"})})})]}),e.showArtistsAndAlbums&&s.jsxs("div",{className:a,children:[s.jsx(Q,{metric:"artists",model:r,dateRange:n,children:s.jsx(Me,{title:s.jsx(u,{message:"Most played artists"})})}),s.jsx(Q,{metric:"albums",model:r,dateRange:n,children:s.jsx(Me,{title:s.jsx(u,{message:"Most played albums"})})})]}),s.jsxs("div",{className:a,children:[s.jsx(Q,{metric:"locations",model:r,dateRange:n,children:s.jsx(si,{className:"flex-auto w-1/2 lg:max-w-[740px]"})}),s.jsx(Q,{metric:"platforms",model:r,dateRange:n,children:s.jsx(Hs,{className:"max-w-500",title:s.jsx(u,{message:"Top platforms"})})})]})]})}function Q({children:e,metric:t,model:a,dateRange:r}){var m,g;const[n,i]=d.useState(!1),o=ti({metrics:[t],model:a,dateRange:r},{isEnabled:n}),l=typeof e=="function"?e(o):e,c=d.useRef(),f=d.useCallback(h=>{var x;if(h){const p=new IntersectionObserver(([b])=>{var y;b.isIntersecting&&(i(!0),(y=c.current)==null||y.disconnect(),c.current=void 0)},{threshold:.1});c.current=p,p.observe(h)}else c.current&&((x=c.current)==null||x.disconnect())},[]);return d.cloneElement(l,{data:(g=(m=o.data)==null?void 0:m.report)==null?void 0:g[t],isLoading:o.isLoading,contentRef:f})}function As({children:e,reportModel:t,title:a,isNested:r}){const[n,i]=d.useState(()=>vt[2].getRangeValue());return s.jsxs(d.Fragment,{children:[s.jsx(Va,{children:s.jsx(u,{message:"Insights"})}),s.jsxs("div",{className:"h-full flex flex-col",children:[!r&&s.jsx(ot,{className:"flex-shrink-0",color:"bg",darkModeColor:"bg"}),s.jsx("div",{className:"overflow-y-auto flex-auto bg-cover relative",children:s.jsxs("div",{className:"min-h-full p-12 md:p-24 overflow-x-hidden max-w-[1600px] mx-auto flex flex-col",children:[s.jsxs("div",{className:"flex-auto",children:[s.jsxs("div",{className:"md:flex items-center justify-between gap-24 h-48 mt-14 mb-38",children:[a||s.jsx(he,{className:"max-w-320"}),s.jsx("div",{className:"flex-shrink-0 flex items-center justify-between gap-10 md:gap-24",children:s.jsx(Wr,{value:n,onChange:i})})]}),d.cloneElement(e,{dateRange:n,model:t})]}),!r&&s.jsx(ct,{})]})})]})]})}function Ps({image:e,name:t,description:a}){return s.jsxs("div",{className:"flex items-center gap-10",children:[d.cloneElement(e,{size:"w-48 h-48",className:"rounded"}),s.jsxs("div",{children:[s.jsxs("h1",{className:"text-base whitespace-nowrap overflow-hidden overflow-ellipsis",children:["“",t,"“ ",s.jsx(u,{message:"insights"})]}),a&&s.jsx("div",{className:"text-muted text-sm",children:a})]})]})}function vi({isNested:e}){const{artistId:t}=Ye(),{data:a}=gt({});return s.jsx(As,{reportModel:`artist=${t}`,title:(a==null?void 0:a.artist)&&s.jsx(Ps,{image:s.jsx(ut,{artist:a.artist}),name:s.jsx(dt,{artist:a.artist})}),isNested:e,children:s.jsx(Ss,{showTracks:!0})})}function yi({isNested:e}){const{albumId:t}=Ye(),{data:a}=ht({});return s.jsx(As,{reportModel:`album=${t}`,title:(a==null?void 0:a.album)&&s.jsx(Ps,{image:s.jsx(Ze,{album:a.album}),name:s.jsx(ks,{album:a.album}),description:s.jsx(Xe,{artists:a.album.artists})}),isNested:e,children:s.jsx(Ss,{showTracks:!0})})}function ki({isNested:e}){const{trackId:t}=Ye(),{data:a}=ft({});return s.jsx(As,{reportModel:`track=${t}`,title:(a==null?void 0:a.track)&&s.jsx(Ps,{image:s.jsx(ys,{track:a.track}),name:s.jsx(bt,{track:a.track}),description:s.jsx(Xe,{artists:a.track.artists})}),isNested:e,children:s.jsx(Ss,{})})}export{nn as A,Bt as B,Fn as C,jn as D,pi as E,Pn as F,si as G,fi as H,On as I,yi as J,ji as K,hn as L,vi as M,hi as N,Sr as O,Hs as P,Ln as Q,Wr as R,Mt as S,ni as T,xi as U,wt as a,yt as b,ls as c,vt as d,It as e,St as f,di as g,xe as h,pn as i,At as j,Rn as k,Ie as l,De as m,Dt as n,En as o,Pt as p,gi as q,bi as r,Rr as s,qt as t,an as u,pe as v,Xr as w,Ss as x,mi as y,ki as z};
//# sourceMappingURL=backstage-track-insights-f1c14433.js.map
