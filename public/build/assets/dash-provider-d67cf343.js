import{r as zt,j as cn}from"./main-1406e08c.js";import{P as dn,u as gn,a as En,b as _n,c as mn}from"./web-player-routes-bb2f14ca.js";import"./TrendingUp-bcf21998.js";import"./play-arrow-filled-8e87b0ae.js";import"./MoreHoriz-16b2a1fa.js";import"./History-20a46571.js";import"./linkify.es-861b0b2d.js";import"./Edit-4fa321e0.js";var ir={},hn={get exports(){return ir},set exports(wt){ir=wt}};(function(wt,Wt){(function(tr,bt){wt.exports=bt()})(self,()=>(()=>{var er={"./externals/base64.js":(ce,N)=>{var e={};e.encode=function(g){for(var d=[],f=0;f<g.length;++f){var y=g.charCodeAt(f);y<128?d.push(y):y<2048?(d.push(192|y>>6),d.push(128|63&y)):y<65536?(d.push(224|y>>12),d.push(128|63&y>>6),d.push(128|63&y)):(d.push(240|y>>18),d.push(128|63&y>>12),d.push(128|63&y>>6),d.push(128|63&y))}return d},e.decode=function(g){for(var d=[],f=0;f<g.length;){var y=g[f++];y<128||(y<224?(y=(31&y)<<6,y|=63&g[f++]):y<240?(y=(15&y)<<12,y|=(63&g[f++])<<6,y|=63&g[f++]):(y=(7&y)<<18,y|=(63&g[f++])<<12,y|=(63&g[f++])<<6,y|=63&g[f++])),d.push(String.fromCharCode(y))}return d.join("")};var I={};(function(g){var d=function(T){for(var M=0,p=[],C=0|T.length/3;0<C--;){var v=(T[M]<<16)+(T[M+1]<<8)+T[M+2];M+=3,p.push(g.charAt(63&v>>18)),p.push(g.charAt(63&v>>12)),p.push(g.charAt(63&v>>6)),p.push(g.charAt(63&v))}if(T.length-M==2){var v=(T[M]<<16)+(T[M+1]<<8);p.push(g.charAt(63&v>>18)),p.push(g.charAt(63&v>>12)),p.push(g.charAt(63&v>>6)),p.push("=")}else if(T.length-M==1){var v=T[M]<<16;p.push(g.charAt(63&v>>18)),p.push(g.charAt(63&v>>12)),p.push("==")}return p.join("")},f=function(){for(var r=[],T=0;T<g.length;++T)r[g.charCodeAt(T)]=T;return r["=".charCodeAt(0)]=0,r}(),y=function(T){for(var M=0,p=[],C=0|T.length/4;0<C--;){var v=(f[T.charCodeAt(M)]<<18)+(f[T.charCodeAt(M+1)]<<12)+(f[T.charCodeAt(M+2)]<<6)+f[T.charCodeAt(M+3)];p.push(255&v>>16),p.push(255&v>>8),p.push(255&v),M+=4}return p&&(T.charAt(M-2)=="="?(p.pop(),p.pop()):T.charAt(M-1)=="="&&p.pop()),p},_={};_.encode=function(r){for(var T=[],M=0;M<r.length;++M)T.push(r.charCodeAt(M));return T},_.decode=function(r){for(var T=0;T<s.length;++T)a[T]=String.fromCharCode(a[T]);return a.join("")},I.decodeArray=function(r){var T=y(r);return new Uint8Array(T)},I.encodeASCII=function(r){var T=_.encode(r);return d(T)},I.decodeASCII=function(r){var T=y(r);return _.decode(T)},I.encode=function(r){var T=e.encode(r);return d(T)},I.decode=function(r){var T=y(r);return e.decode(T)}})("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),N.decode=I.decode,N.decodeArray=I.decodeArray,N.encode=I.encode,N.encodeASCII=I.encodeASCII},"./externals/cea608-parser.js":(ce,N)=>{(function(e){var I={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},g=function(l){var A=l;return I.hasOwnProperty(l)&&(A=I[l]),String.fromCharCode(A)},d=15,f=32,y={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},_={17:2,18:4,21:6,22:8,23:10,19:13,20:15},r={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},T={25:2,26:4,29:6,30:8,31:10,27:13,28:15},M=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],p={verboseFilter:{DATA:3,DEBUG:3,INFO:2,WARNING:2,TEXT:1,ERROR:0},time:null,verboseLevel:0,setTime:function(l){this.time=l},log:function(l,A){var S=this.verboseFilter[l];this.verboseLevel>=S&&console.log(this.time+" ["+l+"] "+A)}},C=function(l){for(var A=[],S=0;S<l.length;S++)A.push(l[S].toString(16));return A},v=function(l,A,S,L,U){this.foreground=l||"white",this.underline=A||!1,this.italics=S||!1,this.background=L||"black",this.flash=U||!1};v.prototype={reset:function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},setStyles:function(l){for(var A=["foreground","underline","italics","background","flash"],S=0;S<A.length;S++){var L=A[S];l.hasOwnProperty(L)&&(this[L]=l[L])}},isDefault:function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},equals:function(l){return this.foreground===l.foreground&&this.underline===l.underline&&this.italics===l.italics&&this.background===l.background&&this.flash===l.flash},copy:function(l){this.foreground=l.foreground,this.underline=l.underline,this.italics=l.italics,this.background=l.background,this.flash=l.flash},toString:function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash}};var E=function(l,A,S,L,U,k){this.uchar=l||" ",this.penState=new v(A,S,L,U,k)};E.prototype={reset:function(){this.uchar=" ",this.penState.reset()},setChar:function(l,A){this.uchar=l,this.penState.copy(A)},setPenState:function(l){this.penState.copy(l)},equals:function(l){return this.uchar===l.uchar&&this.penState.equals(l.penState)},copy:function(l){this.uchar=l.uchar,this.penState.copy(l.penState)},isEmpty:function(){return this.uchar===" "&&this.penState.isDefault()}};var i=function(){this.chars=[];for(var l=0;l<f;l++)this.chars.push(new E);this.pos=0,this.currPenState=new v};i.prototype={equals:function(l){for(var A=!0,S=0;S<f;S++)if(!this.chars[S].equals(l.chars[S])){A=!1;break}return A},copy:function(l){for(var A=0;A<f;A++)this.chars[A].copy(l.chars[A])},isEmpty:function(){for(var l=!0,A=0;A<f;A++)if(!this.chars[A].isEmpty()){l=!1;break}return l},setCursor:function(l){this.pos!==l&&(this.pos=l),this.pos<0?(p.log("ERROR","Negative cursor position "+this.pos),this.pos=0):this.pos>f&&(p.log("ERROR","Too large cursor position "+this.pos),this.pos=f)},moveCursor:function(l){var A=this.pos+l;if(l>1)for(var S=this.pos+1;S<A+1;S++)this.chars[S].setPenState(this.currPenState);this.setCursor(A)},backSpace:function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},insertChar:function(l){l>=144&&this.backSpace();var A=g(l);if(this.pos>=f){p.log("ERROR","Cannot insert "+l.toString(16)+" ("+A+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(A,this.currPenState),this.moveCursor(1)},clearFromPos:function(l){var A;for(A=l;A<f;A++)this.chars[A].reset()},clear:function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},clearToEndOfRow:function(){this.clearFromPos(this.pos)},getTextString:function(){for(var l=[],A=!0,S=0;S<f;S++){var L=this.chars[S].uchar;L!==" "&&(A=!1),l.push(L)}return A?"":l.join("")},setPenStyles:function(l){this.currPenState.setStyles(l);var A=this.chars[this.pos];A.setPenState(this.currPenState)}};var t=function(){this.rows=[];for(var l=0;l<d;l++)this.rows.push(new i);this.currRow=d-1,this.nrRollUpRows=null,this.reset()};t.prototype={reset:function(){for(var l=0;l<d;l++)this.rows[l].clear();this.currRow=d-1},equals:function(l){for(var A=!0,S=0;S<d;S++)if(!this.rows[S].equals(l.rows[S])){A=!1;break}return A},copy:function(l){for(var A=0;A<d;A++)this.rows[A].copy(l.rows[A])},isEmpty:function(){for(var l=!0,A=0;A<d;A++)if(!this.rows[A].isEmpty()){l=!1;break}return l},backSpace:function(){var l=this.rows[this.currRow];l.backSpace()},clearToEndOfRow:function(){var l=this.rows[this.currRow];l.clearToEndOfRow()},insertChar:function(l){var A=this.rows[this.currRow];A.insertChar(l)},setPen:function(l){var A=this.rows[this.currRow];A.setPenStyles(l)},moveCursor:function(l){var A=this.rows[this.currRow];A.moveCursor(l)},setCursor:function(l){p.log("INFO","setCursor: "+l);var A=this.rows[this.currRow];A.setCursor(l)},setPAC:function(l){p.log("INFO","pacData = "+JSON.stringify(l));var A=l.row-1;this.nrRollUpRows&&A<this.nrRollUpRows-1&&(A=this.nrRollUpRows-1),this.currRow=A;var S=this.rows[this.currRow];if(l.indent!==null){var L=l.indent,U=Math.max(L-1,0);S.setCursor(l.indent),l.color=S.chars[U].penState.foreground}var k={foreground:l.color,underline:l.underline,italics:l.italics,background:"black",flash:!1};this.setPen(k)},setBkgData:function(l){p.log("INFO","bkgData = "+JSON.stringify(l)),this.backSpace(),this.setPen(l),this.insertChar(32)},setRollUpRows:function(l){this.nrRollUpRows=l},rollUp:function(){if(this.nrRollUpRows===null){p.log("DEBUG","roll_up but nrRollUpRows not set yet");return}p.log("TEXT",this.getDisplayText());var l=this.currRow+1-this.nrRollUpRows,A=this.rows.splice(l,1)[0];A.clear(),this.rows.splice(this.currRow,0,A),p.log("INFO","Rolling up")},getDisplayText:function(l){l=l||!1;for(var A=[],S="",L=-1,U=0;U<d;U++){var k=this.rows[U].getTextString();k&&(L=U+1,l?A.push("Row "+L+': "'+k+'"'):A.push(k.trim()))}return A.length>0&&(l?S="["+A.join(" | ")+"]":S=A.join(`
`)),S},getTextAndFormat:function(){return this.rows}};var m=function(l,A){this.chNr=l,this.outputFilter=A,this.mode=null,this.verbose=0,this.displayedMemory=new t,this.nonDisplayedMemory=new t,this.lastOutputScreen=new t,this.currRollUpRow=this.displayedMemory.rows[d-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null};m.prototype={modes:["MODE_ROLL-UP","MODE_POP-ON","MODE_PAINT-ON","MODE_TEXT"],reset:function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.currRollUpRow=this.displayedMemory.rows[d-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.lastCueEndTime=null},getHandler:function(){return this.outputFilter},setHandler:function(l){this.outputFilter=l},setPAC:function(l){this.writeScreen.setPAC(l)},setBkgData:function(l){this.writeScreen.setBkgData(l)},setMode:function(l){l!==this.mode&&(this.mode=l,p.log("INFO","MODE="+l),this.mode=="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=l)},insertChars:function(l){for(var A=0;A<l.length;A++)this.writeScreen.insertChar(l[A]);var S=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";p.log("INFO",S+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(p.log("TEXT","DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},cc_RCL:function(){p.log("INFO","RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},cc_BS:function(){p.log("INFO","BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},cc_AOF:function(){},cc_AON:function(){},cc_DER:function(){p.log("INFO","DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},cc_RU:function(l){p.log("INFO","RU("+l+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(l)},cc_FON:function(){p.log("INFO","FON - Flash On"),this.writeScreen.setPen({flash:!0})},cc_RDC:function(){p.log("INFO","RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},cc_TR:function(){p.log("INFO","TR"),this.setMode("MODE_TEXT")},cc_RTD:function(){p.log("INFO","RTD"),this.setMode("MODE_TEXT")},cc_EDM:function(){p.log("INFO","EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate()},cc_CR:function(){p.log("CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate()},cc_ENM:function(){p.log("INFO","ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},cc_EOC:function(){if(p.log("INFO","EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var l=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=l,this.writeScreen=this.nonDisplayedMemory,p.log("TEXT","DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate()},cc_TO:function(l){p.log("INFO","TO("+l+") - Tab Offset"),this.writeScreen.moveCursor(l)},cc_MIDROW:function(l){var A={flash:!1};if(A.underline=l%2===1,A.italics=l>=46,A.italics)A.foreground="white";else{var S=Math.floor(l/2)-16,L=["white","green","blue","cyan","red","yellow","magenta"];A.foreground=L[S]}p.log("INFO","MIDROW: "+JSON.stringify(A)),this.writeScreen.setPen(A)},outputDataUpdate:function(){var l=p.time;l!==null&&this.outputFilter&&(this.outputFilter.updateData&&this.outputFilter.updateData(l,this.displayedMemory),this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=l:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,l,this.lastOutputScreen),this.cueStartTime=this.displayedMemory.isEmpty()?null:l),this.lastOutputScreen.copy(this.displayedMemory))},cueSplitAtTime:function(l){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,l,this.displayedMemory),this.cueStartTime=l))}};var n=function(l,A,S){this.field=l||1,this.outputs=[A,S],this.channels=[new m(1,A),new m(2,S)],this.currChNr=-1,this.lastCmdA=null,this.lastCmdB=null,this.bufferedData=[],this.startTime=null,this.lastTime=null,this.dataCounters={padding:0,char:0,cmd:0,other:0}};n.prototype={getHandler:function(l){return this.channels[l].getHandler()},setHandler:function(l,A){this.channels[l].setHandler(A)},addData:function(l,A){var S,L,U,k=!1;this.lastTime=l,p.setTime(l);for(var X=0;X<A.length;X+=2){if(L=A[X]&127,U=A[X+1]&127,L>=16&&L<=31&&L===this.lastCmdA&&U===this.lastCmdB){this.lastCmdA=null,this.lastCmdB=null,p.log("DEBUG","Repeated command ("+C([L,U])+") is dropped");continue}if(L===0&&U===0){this.dataCounters.padding+=2;continue}else p.log("DATA","["+C([A[X],A[X+1]])+"] -> ("+C([L,U])+")");if(S=this.parseCmd(L,U),S||(S=this.parseMidrow(L,U)),S||(S=this.parsePAC(L,U)),S||(S=this.parseBackgroundAttributes(L,U)),!S&&(k=this.parseChars(L,U),k))if(this.currChNr&&this.currChNr>=0){var W=this.channels[this.currChNr-1];W.insertChars(k)}else p.log("WARNING","No channel found yet. TEXT-MODE?");S?this.dataCounters.cmd+=2:k?this.dataCounters.char+=2:(this.dataCounters.other+=2,p.log("WARNING","Couldn't parse cleaned data "+C([L,U])+" orig: "+C([A[X],A[X+1]])))}},parseCmd:function(l,A){var S=null,L=(l===20||l===21||l===28||l===29)&&32<=A&&A<=47,U=(l===23||l===31)&&33<=A&&A<=35;if(!(L||U))return!1;l===20||l===21||l===23?S=1:S=2;var k=this.channels[S-1];return l===20||l===21||l===28||l===29?A===32?k.cc_RCL():A===33?k.cc_BS():A===34?k.cc_AOF():A===35?k.cc_AON():A===36?k.cc_DER():A===37?k.cc_RU(2):A===38?k.cc_RU(3):A===39?k.cc_RU(4):A===40?k.cc_FON():A===41?k.cc_RDC():A===42?k.cc_TR():A===43?k.cc_RTD():A===44?k.cc_EDM():A===45?k.cc_CR():A===46?k.cc_ENM():A===47&&k.cc_EOC():k.cc_TO(A-32),this.lastCmdA=l,this.lastCmdB=A,this.currChNr=S,!0},parseMidrow:function(l,A){var S=null;if((l===17||l===25)&&32<=A&&A<=47){if(l===17?S=1:S=2,S!==this.currChNr)return p.log("ERROR","Mismatch channel in midrow parsing"),!1;var L=this.channels[S-1];return L.insertChars([32]),L.cc_MIDROW(A),p.log("DEBUG","MIDROW ("+C([l,A])+")"),this.lastCmdA=l,this.lastCmdB=A,!0}return!1},parsePAC:function(l,A){var S=null,L=null,U=(17<=l&&l<=23||25<=l&&l<=31)&&64<=A&&A<=127,k=(l===16||l===24)&&64<=A&&A<=95;if(!(U||k))return!1;S=l<=23?1:2,64<=A&&A<=95?L=S===1?y[l]:r[l]:L=S===1?_[l]:T[l];var X=this.interpretPAC(L,A),W=this.channels[S-1];return W.setPAC(X),this.lastCmdA=l,this.lastCmdB=A,this.currChNr=S,!0},interpretPAC:function(l,A){var S=A,L={color:null,italics:!1,indent:null,underline:!1,row:l};return A>95?S=A-96:S=A-64,L.underline=(S&1)===1,S<=13?L.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(S/2)]:S<=15?(L.italics=!0,L.color="white"):L.indent=Math.floor((S-16)/2)*4,L},parseChars:function(l,A){var S=null,L=null,U=null;if(l>=25?(S=2,U=l-8):(S=1,U=l),17<=U&&U<=19){var k=A;U===17?k=A+80:U===18?k=A+112:k=A+144,p.log("INFO","Special char '"+g(k)+"' in channel "+S),L=[k],this.lastCmdA=l,this.lastCmdB=A}else 32<=l&&l<=127&&(L=A===0?[l]:[l,A],this.lastCmdA=null,this.lastCmdB=null);if(L){var X=C(L);p.log("DEBUG","Char codes =  "+X.join(","))}return L},parseBackgroundAttributes:function(l,A){var S,L,U,k,X=(l===16||l===24)&&32<=A&&A<=47,W=(l===23||l===31)&&45<=A&&A<=47;return X||W?(S={},l===16||l===24?(L=Math.floor((A-32)/2),S.background=M[L],A%2===1&&(S.background=S.background+"_semi")):A===45?S.background="transparent":(S.foreground="black",A===47&&(S.underline=!0)),U=l<24?1:2,k=this.channels[U-1],k.setBkgData(S),this.lastCmdA=l,this.lastCmdB=A,!0):!1},reset:function(){for(var l=0;l<this.channels.length;l++)this.channels[l]&&this.channels[l].reset();this.lastCmdA=null,this.lastCmdB=null},cueSplitAtTime:function(l){for(var A=0;A<this.channels.length;A++)this.channels[A]&&this.channels[A].cueSplitAtTime(l)}};var h=function(l,A,S){for(var L=0,U=A,k=0,X=[],W=function(J,$,ae,K){if(J!==4||$<8)return null;var ee=ae.getUint8(K),se=ae.getUint16(K+1),ue=ae.getUint32(K+3),oe=ae.getUint8(K+7);return ee==181&&se==49&&ue==1195456820&&oe==3};U<A+S;){if(L=l.getUint32(U),k=l.getUint8(U+4)&31,k===6)for(var b=U+5,j=-1;b<U+4+L-1;){j=0;for(var Q=255;Q===255;)Q=l.getUint8(b),j+=Q,b++;var q=0;for(Q=255;Q===255;)Q=l.getUint8(b),q+=Q,b++;W(j,q,l,b)&&X.push([b,q]),b+=q}U+=L+4}return X},c=function(l,A){var S=A[0],L=[[],[]];S+=8;var U=l.getUint8(S)&31;S+=2;for(var k=0;k<U;k++){var X=l.getUint8(S),W=X&4,b=X&3;S++;var j=l.getUint8(S);S++;var Q=l.getUint8(S);S++,W&&(j&127)+(Q&127)!==0&&(b===0?(L[0].push(j),L[0].push(Q)):b===1&&(L[1].push(j),L[1].push(Q)))}return L};e.logger=p,e.PenState=v,e.CaptionScreen=t,e.Cea608Parser=n,e.findCea608Nalus=h,e.extractCea608DataFromRange=c})(N)},"./externals/xml2json.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>g});function I(d){var f="1.2.0";d=d||{},y();function y(){d.escapeMode===void 0&&(d.escapeMode=!0),d.attributePrefix===void 0&&(d.attributePrefix="_"),d.arrayAccessForm=d.arrayAccessForm||"none",d.emptyNodeForm=d.emptyNodeForm||"text",d.enableToStringFunc===void 0&&(d.enableToStringFunc=!0),d.arrayAccessFormPaths=d.arrayAccessFormPaths||[],d.skipEmptyTextNodesForObj===void 0&&(d.skipEmptyTextNodesForObj=!0),d.stripWhitespaces===void 0&&(d.stripWhitespaces=!0),d.datetimeAccessFormPaths=d.datetimeAccessFormPaths||[],d.useDoubleQuotes===void 0&&(d.useDoubleQuotes=!1),d.xmlElementsFilter=d.xmlElementsFilter||[],d.jsonPropertiesFilter=d.jsonPropertiesFilter||[],d.keepCData===void 0&&(d.keepCData=!1),d.ignoreRoot===void 0&&(d.ignoreRoot=!1)}var _={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};function r(W){var b=W.localName;return b==null&&(b=W.baseName),(b==null||b=="")&&(b=W.nodeName),b}function T(W){return W.prefix}function M(W){return typeof W=="string"?W.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):W}function p(W,b,j,Q){for(var q=0;q<W.length;q++){var Y=W[q];if(typeof Y=="string"){if(Y==Q)break}else if(Y instanceof RegExp){if(Y.test(Q))break}else if(typeof Y=="function"&&Y(b,j,Q))break}return q!=W.length}function C(W,b,j){switch(d.arrayAccessForm){case"property":W[b]instanceof Array?W[b+"_asArray"]=W[b]:W[b+"_asArray"]=[W[b]];break}!(W[b]instanceof Array)&&d.arrayAccessFormPaths.length>0&&p(d.arrayAccessFormPaths,W,b,j)&&(W[b]=[W[b]])}function v(W){var b=W.split(/[-T:+Z]/g),j=new Date(b[0],b[1]-1,b[2]),Q=b[5].split(".");if(j.setHours(b[3],b[4],Q[0]),Q.length>1&&j.setMilliseconds(Q[1]),b[6]&&b[7]){var q=b[6]*60+Number(b[7]),Y=/\d\d-\d\d:\d\d$/.test(W)?"-":"+";q=0+(Y=="-"?-1*q:q),j.setMinutes(j.getMinutes()-q-j.getTimezoneOffset())}else W.indexOf("Z",W.length-1)!==-1&&(j=new Date(Date.UTC(j.getFullYear(),j.getMonth(),j.getDate(),j.getHours(),j.getMinutes(),j.getSeconds(),j.getMilliseconds())));return j}function E(W,b,j){if(d.datetimeAccessFormPaths.length>0){var Q=j.split(".#")[0];return p(d.datetimeAccessFormPaths,W,b,Q)?v(W):W}else return W}function i(W,b,j,Q){return b==_.ELEMENT_NODE&&d.xmlElementsFilter.length>0?p(d.xmlElementsFilter,W,j,Q):!0}function t(W,b){if(W.nodeType==_.DOCUMENT_NODE){for(var j=new Object,Q=W.childNodes,q=0;q<Q.length;q++){var Y=Q[q];if(Y.nodeType==_.ELEMENT_NODE)if(d.ignoreRoot)j=t(Y);else{j={};var J=r(Y);j[J]=t(Y)}}return j}else if(W.nodeType==_.ELEMENT_NODE){var j=new Object;j.__cnt=0;for(var $=[],Q=W.childNodes,q=0;q<Q.length;q++){var Y=Q[q],J=r(Y);if(Y.nodeType!=_.COMMENT_NODE){var ae=b+"."+J;if(i(j,Y.nodeType,J,ae))if(j.__cnt++,j[J]==null){var K=t(Y,ae);if(J!="#text"||/[^\s]/.test(K)){var ee={};ee[J]=K,$.push(ee)}j[J]=K,C(j,J,ae)}else{j[J]!=null&&(j[J]instanceof Array||(j[J]=[j[J]],C(j,J,ae)));var K=t(Y,ae);if(J!="#text"||/[^\s]/.test(K)){var ee={};ee[J]=K,$.push(ee)}j[J][j[J].length]=K}}}j.__children=$;for(var se=r(W),ue=0;ue<W.attributes.length;ue++){var oe=W.attributes[ue];j.__cnt++;for(var Z=oe.value,H=0,V=d.matchers.length;H<V;H++){var te=d.matchers[H];te.test(oe,se)&&(Z=te.converter(oe.value))}j[d.attributePrefix+oe.name]=Z}var z=T(W);return z!=null&&z!=""&&(j.__cnt++,j.__prefix=z),j["#text"]!=null&&(j.__text=j["#text"],j.__text instanceof Array&&(j.__text=j.__text.join(`
`)),d.stripWhitespaces&&(j.__text=j.__text.trim()),delete j["#text"],d.arrayAccessForm=="property"&&delete j["#text_asArray"],j.__text=E(j.__text,J,b+"."+J)),j["#cdata-section"]!=null&&(j.__cdata=j["#cdata-section"],delete j["#cdata-section"],d.arrayAccessForm=="property"&&delete j["#cdata-section_asArray"]),j.__cnt==0&&d.emptyNodeForm=="text"?j="":j.__cnt==1&&j.__text!=null?j=j.__text:j.__cnt==1&&j.__cdata!=null&&!d.keepCData?j=j.__cdata:j.__cnt>1&&j.__text!=null&&d.skipEmptyTextNodesForObj&&(d.stripWhitespaces&&j.__text==""||j.__text.trim()=="")&&delete j.__text,delete j.__cnt,d.enableToStringFunc&&(j.__text!=null||j.__cdata!=null)&&(j.toString=function(){return(this.__text!=null?this.__text:"")+(this.__cdata!=null?this.__cdata:"")}),j}else if(W.nodeType==_.TEXT_NODE||W.nodeType==_.CDATA_SECTION_NODE)return W.nodeValue}function m(W,b,j,Q){var q="<"+(W!=null&&W.__prefix!=null?W.__prefix+":":"")+b;if(j!=null)for(var Y=0;Y<j.length;Y++){var J=j[Y],$=W[J];d.escapeMode&&($=M($)),q+=" "+J.substr(d.attributePrefix.length)+"=",d.useDoubleQuotes?q+='"'+$+'"':q+="'"+$+"'"}return Q?q+="/>":q+=">",q}function n(W,b){return"</"+(W.__prefix!=null?W.__prefix+":":"")+b+">"}function h(W,b){return W.indexOf(b,W.length-b.length)!==-1}function c(W,b){return!!(d.arrayAccessForm=="property"&&h(b.toString(),"_asArray")||b.toString().indexOf(d.attributePrefix)==0||b.toString().indexOf("__")==0||W[b]instanceof Function)}function o(W){var b=0;if(W instanceof Object)for(var j in W)c(W,j)||b++;return b}function l(W,b,j){return d.jsonPropertiesFilter.length==0||j==""||p(d.jsonPropertiesFilter,W,b,j)}function A(W){var b=[];if(W instanceof Object)for(var j in W)j.toString().indexOf("__")==-1&&j.toString().indexOf(d.attributePrefix)==0&&b.push(j);return b}function S(W){var b="";return W.__cdata!=null&&(b+="<![CDATA["+W.__cdata+"]]>"),W.__text!=null&&(d.escapeMode?b+=M(W.__text):b+=W.__text),b}function L(W){var b="";return W instanceof Object?b+=S(W):W!=null&&(d.escapeMode?b+=M(W):b+=W),b}function U(W,b){return W===""?b:W+"."+b}function k(W,b,j,Q){var q="";if(W.length==0)q+=m(W,b,j,!0);else for(var Y=0;Y<W.length;Y++)q+=m(W[Y],b,A(W[Y]),!1),q+=X(W[Y],U(Q,b)),q+=n(W[Y],b);return q}function X(W,b){var j="",Q=o(W);if(Q>0){for(var q in W)if(!(c(W,q)||b!=""&&!l(W,q,U(b,q)))){var Y=W[q],J=A(Y);if(Y==null||Y==null)j+=m(Y,q,J,!0);else if(Y instanceof Object)if(Y instanceof Array)j+=k(Y,q,J,b);else if(Y instanceof Date)j+=m(Y,q,J,!1),j+=Y.toISOString(),j+=n(Y,q);else{var $=o(Y);$>0||Y.__text!=null||Y.__cdata!=null?(j+=m(Y,q,J,!1),j+=X(Y,U(b,q)),j+=n(Y,q)):j+=m(Y,q,J,!0)}else j+=m(Y,q,J,!1),j+=L(Y),j+=n(Y,q)}}return j+=L(W),j}this.parseXmlString=function(W){if(W===void 0)return null;var b;if(window.DOMParser){var j=new window.DOMParser;try{b=j.parseFromString(W,"text/xml"),b.getElementsByTagNameNS("*","parsererror").length>0&&(b=null)}catch{b=null}}else W.indexOf("<?")==0&&(W=W.substr(W.indexOf("?>")+2)),b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(W);return b},this.asArray=function(W){return W===void 0||W==null?[]:W instanceof Array?W:[W]},this.toXmlDateTime=function(W){return W instanceof Date?W.toISOString():typeof W=="number"?new Date(W).toISOString():null},this.asDateTime=function(W){return typeof W=="string"?v(W):W},this.xml2json=function(W){return t(W)},this.xml_str2json=function(W){var b=this.parseXmlString(W);return b!=null?this.xml2json(b):null},this.json2xml_str=function(W){return X(W,"")},this.json2xml=function(W){var b=this.json2xml_str(W);return this.parseXmlString(b)},this.getVersion=function(){return f}}const g=I},"./index_mediaplayerOnly.js":(ce,N,e)=>{e.r(N),e.d(N,{Debug:()=>d.default,FactoryMaker:()=>g.default,MediaPlayer:()=>I.default,default:()=>r});var I=e("./src/streaming/MediaPlayer.js"),g=e("./src/core/FactoryMaker.js"),d=e("./src/core/Debug.js"),f=e("./src/core/Version.js");e("./node_modules/es6-promise/auto.js");var y=typeof window<"u"&&window||e.g,_=y.dashjs;_||(_=y.dashjs={}),_.MediaPlayer=I.default,_.FactoryMaker=g.default,_.Debug=d.default,_.Version=(0,f.getVersionString)();const r=_},"./src/core/Debug.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>v});var I=e("./src/core/EventBus.js"),g=e("./src/core/events/Events.js"),d=e("./src/core/FactoryMaker.js"),f=0,y=1,_=2,r=3,T=4,M=5;function p(E){E=E||{};var i=this.context,t=(0,I.default)(i).getInstance(),m=E.settings,n=[],h,c,o,l;function A(){c=!0,o=!0,l=new Date().getTime(),typeof window<"u"&&window.console&&(n[y]=S(window.console.error),n[_]=S(window.console.error),n[r]=S(window.console.warn),n[T]=S(window.console.info),n[M]=S(window.console.debug))}function S(Y){return Y&&Y.bind?Y.bind(window.console):window.console.log.bind(window.console)}function L(Y){return{fatal:X.bind(Y),error:W.bind(Y),warn:b.bind(Y),info:j.bind(Y),debug:Q.bind(Y)}}function U(Y){c=Y}function k(Y){o=Y}function X(){for(var Y=arguments.length,J=new Array(Y),$=0;$<Y;$++)J[$]=arguments[$];q.apply(void 0,[y,this].concat(J))}function W(){for(var Y=arguments.length,J=new Array(Y),$=0;$<Y;$++)J[$]=arguments[$];q.apply(void 0,[_,this].concat(J))}function b(){for(var Y=arguments.length,J=new Array(Y),$=0;$<Y;$++)J[$]=arguments[$];q.apply(void 0,[r,this].concat(J))}function j(){for(var Y=arguments.length,J=new Array(Y),$=0;$<Y;$++)J[$]=arguments[$];q.apply(void 0,[T,this].concat(J))}function Q(){for(var Y=arguments.length,J=new Array(Y),$=0;$<Y;$++)J[$]=arguments[$];q.apply(void 0,[M,this].concat(J))}function q(Y,J){var $="",ae=null;c&&(ae=new Date().getTime(),$+="["+(ae-l)+"]"),o&&J&&J.getClassName&&($+="["+J.getClassName()+"]",J.getType&&($+="["+J.getType()+"]")),$.length>0&&($+=" ");for(var K=arguments.length,ee=new Array(K>2?K-2:0),se=2;se<K;se++)ee[se-2]=arguments[se];Array.apply(null,ee).forEach(function(ue){$+=ue+" "}),n[Y]&&m&&m.get().debug.logLevel>=Y&&n[Y]($),m&&m.get().debug.dispatchEvent&&t.trigger(g.default.LOG,{message:$,level:Y})}return h={getLogger:L,setLogTimestampVisible:U,setCalleeNameVisible:k},A(),h}p.__dashjs_factory_name="Debug";var C=d.default.getSingletonFactory(p);C.LOG_LEVEL_NONE=f,C.LOG_LEVEL_FATAL=y,C.LOG_LEVEL_ERROR=_,C.LOG_LEVEL_WARNING=r,C.LOG_LEVEL_INFO=T,C.LOG_LEVEL_DEBUG=M,d.default.updateSingletonFactory(p.__dashjs_factory_name,C);const v=C},"./src/core/EventBus.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>r});var I=e("./src/core/FactoryMaker.js"),g=e("./src/streaming/MediaPlayerEvents.js"),d=0,f=5e3;function y(){var T={};function M(t,m,n){var h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};if(!t)throw new Error("event type cannot be null or undefined");if(!m||typeof m!="function")throw new Error("listener must be a function: "+m);var c=h.priority||d;if(!(v(t,m,n)>=0)){T[t]=T[t]||[];var o={callback:m,scope:n,priority:c};n&&n.getStreamId&&(o.streamId=n.getStreamId()),n&&n.getType&&(o.mediaType=n.getType()),h&&h.mode&&(o.mode=h.mode);var l=T[t].some(function(A,S){if(A&&c>A.priority)return T[t].splice(S,0,o),!0});l||T[t].push(o)}}function p(t,m,n){if(!(!t||!m||!T[t])){var h=v(t,m,n);h<0||(T[t][h]=null)}}function C(t){var m=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!(!t||!T[t])){if(m=m||{},m.hasOwnProperty("type"))throw new Error("'type' is a reserved word for event dispatching");m.type=t,n.streamId&&(m.streamId=n.streamId),n.mediaType&&(m.mediaType=n.mediaType),T[t].filter(function(h){return!(!h||n.streamId&&h.streamId&&h.streamId!==n.streamId||n.mediaType&&h.mediaType&&h.mediaType!==n.mediaType||n.mode&&h.mode&&h.mode!==n.mode||!h.mode&&n.mode&&n.mode===g.default.EVENT_MODE_ON_RECEIVE)}).forEach(function(h){return h&&h.callback.call(h.scope,m)})}}function v(t,m,n){var h=-1;return T[t]&&T[t].some(function(c,o){if(c&&c.callback===m&&(!n||n===c.scope))return h=o,!0}),h}function E(){T={}}var i={on:M,off:p,trigger:C,reset:E};return i}y.__dashjs_factory_name="EventBus";var _=I.default.getSingletonFactory(y);_.EVENT_PRIORITY_LOW=d,_.EVENT_PRIORITY_HIGH=f,I.default.updateSingletonFactory(y.__dashjs_factory_name,_);const r=_},"./src/core/FactoryMaker.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>g});var I=function(){var d,f=[],y={},_={};function r(o,l,A,S){!S[o]&&l&&(S[o]={instance:l,override:A})}function T(o,l){for(var A in f){var S=f[A];if(S.context===o&&S.name===l)return S.instance}return null}function M(o,l,A){for(var S in f){var L=f[S];if(L.context===o&&L.name===l){f[S].instance=A;return}}f.push({name:l,context:o,instance:A})}function p(o){f=f.filter(function(l){return l.context!==o})}function C(o,l){return l[o]}function v(o,l,A){o in A&&(A[o]=l)}function E(o,l){v(o,l,_)}function i(o){return C(o,_)}function t(o){var l=C(o.__dashjs_factory_name,_);return l||(l=function(S){return S===void 0&&(S={}),{create:function(){return c(o,S,arguments)}}},_[o.__dashjs_factory_name]=l),l}function m(o,l){v(o,l,y)}function n(o){return C(o,y)}function h(o){var l=C(o.__dashjs_factory_name,y);return l||(l=function(S){var L;return S===void 0&&(S={}),{getInstance:function(){return L||(L=T(S,o.__dashjs_factory_name)),L||(L=c(o,S,arguments),f.push({name:o.__dashjs_factory_name,context:S,instance:L})),L}}},y[o.__dashjs_factory_name]=l),l}function c(o,l,A){var S,L=o.__dashjs_factory_name,U=l[L];if(U){var k=U.instance;if(U.override){S=o.apply({context:l},A),k=k.apply({context:l,factory:d,parent:S},A);for(var X in k)S.hasOwnProperty(X)&&(S[X]=k[X])}else return k.apply({context:l,factory:d},A)}else S=o.apply({context:l},A);return S.getClassName=function(){return L},S}return d={extend:r,getSingletonInstance:T,setSingletonInstance:M,deleteSingletonInstances:p,getSingletonFactory:h,getSingletonFactoryByName:n,updateSingletonFactory:m,getClassFactory:t,getClassFactoryByName:i,updateClassFactory:E},d}();const g=I},"./src/core/Settings.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>v});var I=e("./src/core/FactoryMaker.js"),g=e("./src/core/Utils.js"),d=e("./src/core/Debug.js"),f=e("./src/streaming/constants/Constants.js"),y=e("./src/streaming/vo/metrics/HTTPRequest.js"),_=e("./src/core/EventBus.js"),r=e("./src/core/events/Events.js");function T(E){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?T=function(t){return typeof t}:T=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},T(E)}function M(E,i,t){return i in E?Object.defineProperty(E,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):E[i]=t,E}function p(){var E,i,t,m=this.context,n=(0,_.default)(m).getInstance(),h={"streaming.delay.liveDelay":r.default.SETTING_UPDATED_LIVE_DELAY,"streaming.delay.liveDelayFragmentCount":r.default.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,"streaming.liveCatchup.enabled":r.default.SETTING_UPDATED_CATCHUP_ENABLED,"streaming.liveCatchup.playbackRate.min":r.default.SETTING_UPDATED_PLAYBACK_RATE_MIN,"streaming.liveCatchup.playbackRate.max":r.default.SETTING_UPDATED_PLAYBACK_RATE_MAX},c={debug:{logLevel:d.default.LOG_LEVEL_WARNING,dispatchEvent:!1},streaming:{abandonLoadTimeout:1e4,wallclockTimeUpdateInterval:100,manifestUpdateRetryInterval:100,cacheInitSegments:!1,applyServiceDescription:!0,applyProducerReferenceTime:!0,applyContentSteering:!0,eventControllerRefreshDelay:100,enableManifestDurationMismatchFix:!0,enableManifestTimescaleMismatchFix:!1,capabilities:{filterUnsupportedEssentialProperties:!0,useMediaCapabilitiesApi:!1},timeShiftBuffer:{calcFromSegmentTimeline:!1,fallbackToSegmentTimeline:!0},metrics:{maxListDepth:100},delay:{liveDelayFragmentCount:NaN,liveDelay:NaN,useSuggestedPresentationDelay:!0},protection:{keepProtectionMediaKeys:!1,ignoreEmeEncryptedEvent:!1,detectPlayreadyMessageFormat:!0},buffer:{enableSeekDecorrelationFix:!1,fastSwitchEnabled:!0,flushBufferAtTrackSwitch:!1,reuseExistingSourceBuffers:!0,bufferPruningInterval:10,bufferToKeep:20,bufferTimeAtTopQuality:30,bufferTimeAtTopQualityLongForm:60,initialBufferLevel:NaN,stableBufferTime:12,longFormContentDurationThreshold:600,stallThreshold:.3,useAppendWindow:!0,setStallState:!0,avoidCurrentTimeRangePruning:!1,useChangeTypeForTrackSwitch:!0},gaps:{jumpGaps:!0,jumpLargeGaps:!0,smallGapLimit:1.5,threshold:.3,enableSeekFix:!0,enableStallFix:!1,stallSeek:.1},utcSynchronization:{enabled:!0,useManifestDateHeaderTimeSource:!0,backgroundAttempts:2,timeBetweenSyncAttempts:30,maximumTimeBetweenSyncAttempts:600,minimumTimeBetweenSyncAttempts:2,timeBetweenSyncAttemptsAdjustmentFactor:2,maximumAllowedDrift:100,enableBackgroundSyncAfterSegmentDownloadError:!0,defaultTimingSource:{scheme:"urn:mpeg:dash:utc:http-xsdate:2014",value:"https://time.akamai.com/?iso&ms"}},scheduling:{defaultTimeout:500,lowLatencyTimeout:0,scheduleWhilePaused:!0},text:{defaultEnabled:!0,extendSegmentedCues:!0,webvtt:{customRenderingEnabled:!1}},liveCatchup:{maxDrift:NaN,playbackRate:{min:NaN,max:NaN},playbackBufferMin:.5,enabled:null,mode:f.default.LIVE_CATCHUP_MODE_DEFAULT},lastBitrateCachingInfo:{enabled:!0,ttl:36e4},lastMediaSettingsCachingInfo:{enabled:!0,ttl:36e4},cacheLoadThresholds:{video:50,audio:5},trackSwitchMode:{audio:f.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE,video:f.default.TRACK_SWITCH_MODE_NEVER_REPLACE},selectionModeForInitialTrack:f.default.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY,fragmentRequestTimeout:2e4,manifestRequestTimeout:1e4,retryIntervals:(E={},M(E,y.HTTPRequest.MPD_TYPE,500),M(E,y.HTTPRequest.XLINK_EXPANSION_TYPE,500),M(E,y.HTTPRequest.MEDIA_SEGMENT_TYPE,1e3),M(E,y.HTTPRequest.INIT_SEGMENT_TYPE,1e3),M(E,y.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,1e3),M(E,y.HTTPRequest.INDEX_SEGMENT_TYPE,1e3),M(E,y.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE,1e3),M(E,y.HTTPRequest.LICENSE,1e3),M(E,y.HTTPRequest.OTHER_TYPE,1e3),M(E,"lowLatencyReductionFactor",10),E),retryAttempts:(i={},M(i,y.HTTPRequest.MPD_TYPE,3),M(i,y.HTTPRequest.XLINK_EXPANSION_TYPE,1),M(i,y.HTTPRequest.MEDIA_SEGMENT_TYPE,3),M(i,y.HTTPRequest.INIT_SEGMENT_TYPE,3),M(i,y.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,3),M(i,y.HTTPRequest.INDEX_SEGMENT_TYPE,3),M(i,y.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE,3),M(i,y.HTTPRequest.LICENSE,3),M(i,y.HTTPRequest.OTHER_TYPE,3),M(i,"lowLatencyMultiplyFactor",5),i),abr:{movingAverageMethod:f.default.MOVING_AVERAGE_SLIDING_WINDOW,ABRStrategy:f.default.ABR_STRATEGY_DYNAMIC,additionalAbrRules:{insufficientBufferRule:!0,switchHistoryRule:!0,droppedFramesRule:!0,abandonRequestsRule:!0},bandwidthSafetyFactor:.9,useDefaultABRRules:!0,useDeadTimeLatency:!0,limitBitrateByPortal:!1,usePixelRatioInLimitBitrateByPortal:!1,maxBitrate:{audio:-1,video:-1},minBitrate:{audio:-1,video:-1},maxRepresentationRatio:{audio:1,video:1},initialBitrate:{audio:-1,video:-1},initialRepresentationRatio:{audio:-1,video:-1},autoSwitchBitrate:{audio:!0,video:!0},fetchThroughputCalculationMode:f.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING},cmcd:{enabled:!1,sid:null,cid:null,rtp:null,rtpSafetyFactor:5,mode:f.default.CMCD_MODE_QUERY,enabledKeys:["br","d","ot","tb","bl","dl","mtp","nor","nrr","su","bs","rtp","cid","pr","sf","sid","st","v"]},cmsd:{enabled:!1,abr:{applyMb:!1,etpWeightRatio:0}}},errors:{recoverAttempts:{mediaErrorDecode:5}}},o=g.default.clone(c);function l(U,k,X){for(var W in U)U.hasOwnProperty(W)&&(k.hasOwnProperty(W)?T(U[W])==="object"&&!(U[W]instanceof Array)&&U[W]!==null?l(U[W],k[W],X.slice()+W+"."):(k[W]=g.default.clone(U[W]),h[X+W]&&n.trigger(h[X+W])):console.error("Settings parameter "+X+W+" is not supported"))}function A(){return o}function S(U){T(U)==="object"&&l(U,o,"")}function L(){o=g.default.clone(c)}return t={get:A,update:S,reset:L},t}p.__dashjs_factory_name="Settings";var C=I.default.getSingletonFactory(p);const v=C},"./src/core/Utils.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>M});var I=e("./node_modules/path-browserify/index.js"),g=e.n(I),d=e("./node_modules/ua-parser-js/src/ua-parser.js");function f(p){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?f=function(v){return typeof v}:f=function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},f(p)}function y(p,C){if(!(p instanceof C))throw new TypeError("Cannot call a class as a function")}function _(p,C){for(var v=0;v<C.length;v++){var E=C[v];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(p,E.key,E)}}function r(p,C,v){return C&&_(p.prototype,C),v&&_(p,v),p}var T=function(){function p(){y(this,p)}return r(p,null,[{key:"mixin",value:function(v,E,i){var t,m={};if(v)for(var n in E)E.hasOwnProperty(n)&&(t=E[n],(!(n in v)||v[n]!==t&&(!(n in m)||m[n]!==t))&&(f(v[n])==="object"&&v[n]!==null?v[n]=p.mixin(v[n],t,i):v[n]=i(t)));return v}},{key:"clone",value:function(v){if(!v||f(v)!=="object")return v;var E;if(v instanceof Array){E=[];for(var i=0,t=v.length;i<t;++i)i in v&&E.push(p.clone(v[i]))}else E={};return p.mixin(E,v,p.clone)}},{key:"addAditionalQueryParameterToUrl",value:function(v,E){try{if(!E||E.length===0)return v;var i=new URL(v);return E.forEach(function(t){t.key&&t.value&&i.searchParams.set(t.key,t.value)}),i.href}catch{return v}}},{key:"parseHttpHeaders",value:function(v){var E={};if(!v)return E;for(var i=v.trim().split(`\r
`),t=0,m=i.length;t<m;t++){var n=i[t],h=n.indexOf(": ");h>0&&(E[n.substring(0,h)]=n.substring(h+2))}return E}},{key:"generateUuid",value:function(){var v=new Date().getTime(),E="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){var t=(v+Math.random()*16)%16|0;return v=Math.floor(v/16),(i=="x"?t:t&3|8).toString(16)});return E}},{key:"generateHashCode",value:function(v){var E=0;if(v.length===0)return E;for(var i=0;i<v.length;i++){var t=v.charCodeAt(i);E=(E<<5)-E+t,E|=0}return E}},{key:"getRelativeUrl",value:function(v,E){try{var i=new URL(v),t=new URL(E);if(i.protocol=t.protocol,i.origin!==t.origin)return E;var m=g().relative(i.pathname.substr(0,i.pathname.lastIndexOf("/")),t.pathname.substr(0,t.pathname.lastIndexOf("/"))),n=m.length===0?1:0;return m+=t.pathname.substr(t.pathname.lastIndexOf("/")+n,t.pathname.length-1),t.pathname.length<m.length?t.pathname:m}catch{return E}}},{key:"parseUserAgent",value:function(){var v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;try{var E=v===null&&typeof navigator<"u"?navigator.userAgent.toLowerCase():"";return(0,d.UAParser)(E)}catch{return{}}}}]),p}();const M=T},"./src/core/Version.js":(ce,N,e)=>{e.r(N),e.d(N,{getVersionString:()=>g});var I="4.6.0";function g(){return I}},"./src/core/errors/Errors.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>E});var I=e("./src/core/errors/ErrorsBase.js");function g(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(m){return typeof m}:g=function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},g(i)}function d(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function f(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),t&&y(i,t)}function y(i,t){return y=Object.setPrototypeOf||function(n,h){return n.__proto__=h,n},y(i,t)}function _(i){var t=M();return function(){var n=p(i),h;if(t){var c=p(this).constructor;h=Reflect.construct(n,arguments,c)}else h=n.apply(this,arguments);return r(this,h)}}function r(i,t){return t&&(g(t)==="object"||typeof t=="function")?t:T(i)}function T(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function M(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function p(i){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)},p(i)}var C=function(i){f(m,i);var t=_(m);function m(){var n;return d(this,m),n=t.call(this),n.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE=10,n.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE=11,n.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE=12,n.SEGMENT_BASE_LOADER_ERROR_CODE=15,n.TIME_SYNC_FAILED_ERROR_CODE=16,n.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE=17,n.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE=18,n.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE=19,n.APPEND_ERROR_CODE=20,n.REMOVE_ERROR_CODE=21,n.DATA_UPDATE_FAILED_ERROR_CODE=22,n.CAPABILITY_MEDIASOURCE_ERROR_CODE=23,n.CAPABILITY_MEDIAKEYS_ERROR_CODE=24,n.DOWNLOAD_ERROR_ID_MANIFEST_CODE=25,n.DOWNLOAD_ERROR_ID_SIDX_CODE=26,n.DOWNLOAD_ERROR_ID_CONTENT_CODE=27,n.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE=28,n.DOWNLOAD_ERROR_ID_XLINK_CODE=29,n.MANIFEST_ERROR_ID_PARSE_CODE=31,n.MANIFEST_ERROR_ID_NOSTREAMS_CODE=32,n.TIMED_TEXT_ERROR_ID_PARSE_CODE=33,n.MANIFEST_ERROR_ID_MULTIPLEXED_CODE=34,n.MEDIASOURCE_TYPE_UNSUPPORTED_CODE=35,n.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE="parsing failed for ",n.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading manifest: ",n.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE="Failed loading Xlink element: ",n.SEGMENTS_UPDATE_FAILED_ERROR_MESSAGE="Segments update failed",n.SEGMENTS_UNAVAILABLE_ERROR_MESSAGE="no segments are available yet",n.SEGMENT_BASE_LOADER_ERROR_MESSAGE="error loading segment ranges from sidx",n.TIME_SYNC_FAILED_ERROR_MESSAGE="Failed to synchronize client and server time",n.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE="request is null",n.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE="Failed to resolve a valid URL",n.APPEND_ERROR_MESSAGE="chunk is not defined",n.REMOVE_ERROR_MESSAGE="Removing data from the SourceBuffer",n.DATA_UPDATE_FAILED_ERROR_MESSAGE="Data update failed",n.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE="mediasource is not supported",n.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE="mediakeys is not supported",n.TIMED_TEXT_ERROR_MESSAGE_PARSE="parsing error :",n.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE="Error creating source buffer of type : ",n}return m}(I.default),v=new C;const E=v},"./src/core/errors/ErrorsBase.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});function I(_,r){if(!(_ instanceof r))throw new TypeError("Cannot call a class as a function")}function g(_,r){for(var T=0;T<r.length;T++){var M=r[T];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(_,M.key,M)}}function d(_,r,T){return r&&g(_.prototype,r),T&&g(_,T),_}var f=function(){function _(){I(this,_)}return d(_,[{key:"extend",value:function(T,M){if(T){var p=M?M.override:!1,C=M?M.publicOnly:!1;for(var v in T)!T.hasOwnProperty(v)||this[v]&&!p||C&&T[v].indexOf("public_")===-1||(this[v]=T[v])}}}]),_}();const y=f},"./src/core/events/CoreEvents.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>v});var I=e("./src/core/events/EventsBase.js");function g(E){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(t){return typeof t}:g=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(E)}function d(E,i){if(!(E instanceof i))throw new TypeError("Cannot call a class as a function")}function f(E,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");E.prototype=Object.create(i&&i.prototype,{constructor:{value:E,writable:!0,configurable:!0}}),i&&y(E,i)}function y(E,i){return y=Object.setPrototypeOf||function(m,n){return m.__proto__=n,m},y(E,i)}function _(E){var i=M();return function(){var m=p(E),n;if(i){var h=p(this).constructor;n=Reflect.construct(m,arguments,h)}else n=m.apply(this,arguments);return r(this,n)}}function r(E,i){return i&&(g(i)==="object"||typeof i=="function")?i:T(E)}function T(E){if(E===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E}function M(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function p(E){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},p(E)}var C=function(E){f(t,E);var i=_(t);function t(){var m;return d(this,t),m=i.call(this),m.ATTEMPT_BACKGROUND_SYNC="attemptBackgroundSync",m.BUFFERING_COMPLETED="bufferingCompleted",m.BUFFER_CLEARED="bufferCleared",m.BYTES_APPENDED_END_FRAGMENT="bytesAppendedEndFragment",m.BUFFER_REPLACEMENT_STARTED="bufferReplacementStarted",m.CHECK_FOR_EXISTENCE_COMPLETED="checkForExistenceCompleted",m.CMSD_STATIC_HEADER="cmsdStaticHeader",m.CURRENT_TRACK_CHANGED="currentTrackChanged",m.DATA_UPDATE_COMPLETED="dataUpdateCompleted",m.INBAND_EVENTS="inbandEvents",m.INITIAL_STREAM_SWITCH="initialStreamSwitch",m.INIT_FRAGMENT_LOADED="initFragmentLoaded",m.INIT_FRAGMENT_NEEDED="initFragmentNeeded",m.INTERNAL_MANIFEST_LOADED="internalManifestLoaded",m.ORIGINAL_MANIFEST_LOADED="originalManifestLoaded",m.LOADING_COMPLETED="loadingCompleted",m.LOADING_PROGRESS="loadingProgress",m.LOADING_DATA_PROGRESS="loadingDataProgress",m.LOADING_ABANDONED="loadingAborted",m.MANIFEST_UPDATED="manifestUpdated",m.MEDIA_FRAGMENT_LOADED="mediaFragmentLoaded",m.MEDIA_FRAGMENT_NEEDED="mediaFragmentNeeded",m.QUOTA_EXCEEDED="quotaExceeded",m.SEGMENT_LOCATION_BLACKLIST_ADD="segmentLocationBlacklistAdd",m.SEGMENT_LOCATION_BLACKLIST_CHANGED="segmentLocationBlacklistChanged",m.SERVICE_LOCATION_BLACKLIST_ADD="serviceLocationBlacklistAdd",m.SERVICE_LOCATION_BLACKLIST_CHANGED="serviceLocationBlacklistChanged",m.SET_FRAGMENTED_TEXT_AFTER_DISABLED="setFragmentedTextAfterDisabled",m.SET_NON_FRAGMENTED_TEXT="setNonFragmentedText",m.SOURCE_BUFFER_ERROR="sourceBufferError",m.STREAMS_COMPOSED="streamsComposed",m.STREAM_BUFFERING_COMPLETED="streamBufferingCompleted",m.STREAM_REQUESTING_COMPLETED="streamRequestingCompleted",m.TEXT_TRACKS_QUEUE_INITIALIZED="textTracksQueueInitialized",m.TIME_SYNCHRONIZATION_COMPLETED="timeSynchronizationComplete",m.UPDATE_TIME_SYNC_OFFSET="updateTimeSyncOffset",m.URL_RESOLUTION_FAILED="urlResolutionFailed",m.VIDEO_CHUNK_RECEIVED="videoChunkReceived",m.WALLCLOCK_TIME_UPDATED="wallclockTimeUpdated",m.XLINK_ELEMENT_LOADED="xlinkElementLoaded",m.XLINK_READY="xlinkReady",m.SEEK_TARGET="seekTarget",m.SETTING_UPDATED_LIVE_DELAY="settingUpdatedLiveDelay",m.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT="settingUpdatedLiveDelayFragmentCount",m.SETTING_UPDATED_CATCHUP_ENABLED="settingUpdatedCatchupEnabled",m.SETTING_UPDATED_PLAYBACK_RATE_MIN="settingUpdatedPlaybackRateMin",m.SETTING_UPDATED_PLAYBACK_RATE_MAX="settingUpdatedPlaybackRateMax",m}return t}(I.default);const v=C},"./src/core/events/Events.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>E});var I=e("./src/core/events/CoreEvents.js");function g(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(m){return typeof m}:g=function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},g(i)}function d(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function f(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),t&&y(i,t)}function y(i,t){return y=Object.setPrototypeOf||function(n,h){return n.__proto__=h,n},y(i,t)}function _(i){var t=M();return function(){var n=p(i),h;if(t){var c=p(this).constructor;h=Reflect.construct(n,arguments,c)}else h=n.apply(this,arguments);return r(this,h)}}function r(i,t){return t&&(g(t)==="object"||typeof t=="function")?t:T(i)}function T(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function M(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function p(i){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)},p(i)}var C=function(i){f(m,i);var t=_(m);function m(){return d(this,m),t.apply(this,arguments)}return m}(I.default),v=new C;const E=v},"./src/core/events/EventsBase.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});function I(_,r){if(!(_ instanceof r))throw new TypeError("Cannot call a class as a function")}function g(_,r){for(var T=0;T<r.length;T++){var M=r[T];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(_,M.key,M)}}function d(_,r,T){return r&&g(_.prototype,r),T&&g(_,T),_}var f=function(){function _(){I(this,_)}return d(_,[{key:"extend",value:function(T,M){if(T){var p=M?M.override:!1,C=M?M.publicOnly:!1;for(var v in T)!T.hasOwnProperty(v)||this[v]&&!p||C&&T[v].indexOf("public_")===-1||(this[v]=T[v])}}}]),_}();const y=f},"./src/dash/DashAdapter.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>E});var I=e("./src/dash/constants/DashConstants.js"),g=e("./src/dash/vo/RepresentationInfo.js"),d=e("./src/dash/vo/MediaInfo.js"),f=e("./src/dash/vo/StreamInfo.js"),y=e("./src/dash/vo/ManifestInfo.js"),_=e("./src/dash/vo/Event.js"),r=e("./src/core/FactoryMaker.js"),T=e("./src/dash/models/DashManifestModel.js"),M=e("./src/dash/models/PatchManifestModel.js"),p=e("./node_modules/bcp-47-normalize/index.js"),C=e.n(p);function v(){var i,t,m,n,h,c,o,l=this.context,A="urn:dvb:dash:profile:dvb-dash:2014";function S(){t=(0,T.default)(l).getInstance(),m=(0,M.default)(l).getInstance(),xe()}function L(ge){ge&&(ge.constants&&(c=ge.constants),ge.cea608parser&&(o=ge.cea608parser),ge.errHandler&&t.setConfig({errHandler:ge.errHandler}),ge.BASE64&&t.setConfig({BASE64:ge.BASE64}))}function U(ge){if(ge){var ie=new g.default,he=ge.adaptation.period.mpd.manifest.Period_asArray[ge.adaptation.period.index].AdaptationSet_asArray[ge.adaptation.index],De=t.getRepresentationFor(ge.index,he);return ie.id=ge.id,ie.quality=ge.index,ie.bandwidth=t.getBandwidth(De),ie.fragmentDuration=ge.segmentDuration||(ge.segments&&ge.segments.length>0?ge.segments[0].duration:NaN),ie.MSETimeOffset=ge.MSETimeOffset,ie.mediaInfo=Je(ge.adaptation),ie}else return null}function k(ge,ie){if(n.length===0||!ge)return null;var he=Qe(ge,n);if(!he)return null;var De=t.getAdaptationsForPeriod(he),Ce=W(ge.index,ie,ge);if(!Ce)return null;var We=t.getIndexForAdaptation(Ce,n[0].mpd.manifest,ge.index);return Je(De[We])}function X(ge){return t.getRolesForAdaptation(ge).filter(function(ie){return ie.value===I.default.MAIN})[0]}function W(ge,ie,he){var De=t.getAdaptationsForType(n[0].mpd.manifest,ge,ie);if(!De||De.length===0)return null;if(De.length>1&&he){var Ce=Q(he,ie);if(h[he.id]&&h[he.id][ie]){for(var We=0,Xe=De.length;We<Xe;We++)if(b(h[he.id][ie],Ce[We]))return De[We]}for(var Ve=0,rt=De.length;Ve<rt;Ve++)if(X(De[Ve]))return De[Ve]}return De[0]}function b(ge,ie){if(!ge||!ie)return!1;var he=ge.id===ie.id,De=ge.codec===ie.codec,Ce=ge.viewpoint===ie.viewpoint,We=ge.lang===ie.lang,Xe=ge.roles.toString()===ie.roles.toString(),Ve=ge.accessibility.toString()===ie.accessibility.toString(),rt=ge.audioChannelConfiguration.toString()===ie.audioChannelConfiguration.toString();return he&&De&&Ce&&We&&Xe&&Ve&&rt}function j(ge,ie,he,De,Ce,We){var Xe=[],Ve,rt,ut,mt,ve,Le;if(!De||De.length===0)return[];var Ge=t.getAdaptationsForPeriod(ie);for(mt=0,Le=De.length;mt<Le;mt++)if(Ve=De[mt],ut=t.getIndexForAdaptation(Ve,ge,he.index),rt=Je(Ge[ut]),We){var at=rt.accessibility.length;for(ve=0;ve<at;ve++)if(rt){var et=rt.accessibility[ve];if(et.indexOf("cea-608:")===0){var lt=et.substring(8),vt=lt.split(";");if(vt[0].substring(0,2)==="CC")for(ve=0;ve<vt.length;ve++)rt||(rt=Je.call(this,Ge[ut])),ye(rt,vt[ve].substring(0,3),vt[ve].substring(4)),Xe.push(rt),rt=null;else for(ve=0;ve<vt.length;ve++)rt||(rt=Je.call(this,Ge[ut])),ye(rt,"CC"+(ve+1),vt[ve]),Xe.push(rt),rt=null}else et.indexOf("cea-608")===0&&(ye(rt,c.CC1,"eng"),Xe.push(rt),rt=null)}}else Ce===c.IMAGE?(Fe(rt),Xe.push(rt),rt=null):rt&&Xe.push(rt);return Xe}function Q(ge,ie,he){var De=n,Ce=he,We=[];if(Ce)Ze(),De=u(Ce);else if(n.length>0)Ce=n[0].mpd.manifest;else return We;var Xe=Qe(ge,De),Ve=t.getAdaptationsForType(Ce,ge?ge.index:null,ie);return We=j(Ce,Xe,ge,Ve,ie),ie===c.TEXT&&(Ve=t.getAdaptationsForType(Ce,ge?ge.index:null,c.VIDEO),We=We.concat(j(Ce,Xe,ge,Ve,ie,!0))),We}function q(ge){if(!ge)return null;Ze(),n=u(ge)}function Y(ge,ie){var he=[],De=n;if(ge&&(Ze(),De=u(ge)),De.length>0){(!ie||ie>De.length)&&(ie=De.length);for(var Ce=0;Ce<ie;Ce++)he.push(Be(De[Ce]))}return he}function J(ge,ie){var he,De,Ce=Qe(ge,n);return he=ie?ie.id:null,n.length>0&&Ce&&(De=he?t.getAdaptationForId(he,n[0].mpd.manifest,Ce.index):t.getAdaptationForIndex(ie?ie.index:null,n[0].mpd.manifest,Ce.index)),De}function $(ge,ie){var he,De,Ce=Qe(ge,n);return he=ie?ie.id:null,n.length>0&&Ce&&(De=he?t.getAdaptationForId(he,n[0].mpd.manifest,Ce.index):t.getAdaptationForIndex(ie?ie.index:null,n[0].mpd.manifest,Ce.index)),De?t.getProducerReferenceTimesForAdaptation(De):[]}function ae(ge){try{return t.getEssentialPropertiesForRepresentation(ge)}catch{return[]}}function K(ge){return t.getRealPeriodForIndex(ge,n[0].mpd.manifest)}function ee(ge){var ie,he=He(ge);return ie=t.getRepresentationsForAdaptation(he),ie}function se(ge,ie,he,De){try{if(!ge||!ie||isNaN(he)||!De)return null;var Ce=ge.scheme_id_uri,We=ge.value;if(!ie[Ce+"/"+We])return null;var Xe=new _.default,Ve=ge.timescale||1,rt=De.adaptation.period.start,ut=ie[Ce+"/"+We],mt=isNaN(De.presentationTimeOffset)?isNaN(ut.presentationTimeOffset)?0:ut.presentationTimeOffset:De.presentationTimeOffset,ve=ge.presentation_time_delta/Ve,Le;ge.version===0?Le=rt+he-mt+ve:Le=rt-mt+ve;var Ge=ge.event_duration/Ve,at=ge.id,et=ge.message_data;return Xe.eventStream=ut,Xe.eventStream.value=We,Xe.eventStream.timescale=Ve,Xe.duration=Ge,Xe.id=at,Xe.calculatedPresentationTime=Le,Xe.messageData=et,Xe.presentationTimeDelta=ve,Xe}catch{return null}}function ue(ge,ie,he){var De=[];if(n.length>0){var Ce=n[0].mpd.manifest;if(ge instanceof f.default){var We=Qe(ge,n);De=t.getEventsForPeriod(We)}else if(ge instanceof d.default){var Xe=Qe(he,n);De=t.getEventStreamForAdaptationSet(Ce,He(ge),Xe)}else if(ge instanceof g.default){var Ve=Qe(he,n);De=t.getEventStreamForRepresentation(Ce,ie,Ve)}}return De}function oe(ge,ie,he){h[ge]=h[ge]||{},h[ge][ie]=h[ge][ie]||{},h[ge][ie]=he}function Z(ge){return t.getIsText(ge)}function H(){var ge=Ae();return t.getUTCTimingSources(ge)}function V(){var ge=n.length>0?n[0].mpd:null;return t.getSuggestedPresentationDelay(ge)}function te(ge){var ie=D(ge);return t.getAvailabilityStartTime(ie)}function z(ge){var ie=Ae(ge);return t.getIsDynamic(ie)}function R(ge){var ie=Ae(ge);return t.getDuration(ie)}function u(ge){var ie=D(ge);return t.getRegularPeriods(ie)}function D(ge){var ie=Ae(ge);return t.getMpd(ie)}function F(ge){return t.getContentSteering(ge)}function w(ge){return t.getLocation(ge)}function O(ge){var ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return t.getManifestUpdatePeriod(ge,ie)}function P(ge){return t.getPublishTime(ge)}function B(ge){var ie=t.getPatchLocation(ge),he=t.getPublishTime(ge);if(!ie||!he)return null;if(ie.hasOwnProperty("ttl")&&he){var De=parseFloat(ie.ttl)*1e3;if(he.getTime()+De<=new Date().getTime())return null}return ie.__text}function x(ge){return t.hasProfile(ge,A)}function ne(ge){return m.getIsPatch(ge)}function re(ge){return t.getBaseURLsFromElement(ge)}function G(){return t.getRepresentationSortFunction()}function fe(ge,ie,he){return t.getCodec(ge,ie,he)}function le(ge,ie){var he,De=tt(ie);return he=ht(De,ge),he?he.bandwidth:null}function _e(ge,ie){var he=tt(ie);return nt(he,ge)}function Me(ge,ie){var he=tt(ie);return je(he,ge)}function Oe(ge){if(!ge||n.length===0)return null;var ie=n.filter(function(he){return he.id===ge});return ie&&ie.length>0?ie[0]:null}function Ne(ge,ie){return t.getIsTypeOf(ge,ie)}function xe(){n=[],h={}}function Se(ge,ie){var he=t.getId(ge),De=m.getMpdId(ie),Ce=t.getPublishTime(ge),We=m.getPublishTime(ie),Xe=m.getOriginalPublishTime(ie);return!!(he&&De&&he==De&&Ce&&Xe&&Ce.getTime()==Xe.getTime()&&We&&Ce.getTime()<We.getTime())}function me(ge,ie){m.getPatchOperations(ie).forEach(function(he){var De=he.getMpdTarget(ge);if(De!==null){var Ce=De.name,We=De.target,Xe=De.leaf;if(he.xpath.findsAttribute()){switch(he.action){case"add":case"replace":We[Ce]=he.value;break;case"remove":delete We[Ce];break}return}var Ve=(We[Ce+"_asArray"]||[]).indexOf(Xe),rt=he.position==="prepend"||he.position==="before";if((he.action==="remove"||he.action==="replace")&&(delete We[Ce],Ve!=-1)){var ut=We[Ce+"_asArray"];ut.splice(Ve,1),ut.length>1?We[Ce]=ut:ut.length==1?We[Ce]=ut[0]:delete We[Ce+"_asArray"]}(he.action==="add"||he.action==="replace")&&Object.keys(he.value).forEach(function(mt){var ve=he.value[mt],Le=We[mt+"_asArray"]||[];if(Le.length===0&&We[mt]&&Le.push(We[mt]),Le.length===0)Le=ve;else{var Ge=Le.length;mt==Ce&&Ve!=-1?Ge=Ve+(rt?0:1)+(he.action=="replace"?-1:0):Ge=rt?0:Le.length,Le.splice.apply(Le,[Ge,0].concat(ve))}We[mt+"_asArray"]=Le,We[mt]=Le.length==1?Le[0]:Le})}})}function Ae(ge){return ge||(n.length>0?n[0].mpd.manifest:null)}function He(ge){try{var ie=Qe(ge.streamInfo,n),he=t.getAdaptationsForPeriod(ie);return!ge||!ge.streamInfo||ge.streamInfo.id===void 0||!he?null:he[ge.index]}catch{return null}}function Qe(ge,ie){for(var he=ie.length,De=0;De<he;De++){var Ce=ie[De];if(ge&&ge.id===Ce.id)return Ce}return null}function Je(ge){if(!ge)return null;var ie=new d.default,he=ge.period.mpd.manifest.Period_asArray[ge.period.index].AdaptationSet_asArray[ge.index],De;if(ie.id=ge.id,ie.index=ge.index,ie.type=ge.type,ie.streamInfo=Be(ge.period),ie.representationCount=t.getRepresentationCount(he),ie.labels=t.getLabelsForAdaptation(he),ie.lang=t.getLanguageForAdaptation(he),De=t.getViewpointForAdaptation(he),ie.viewpoint=De?De.value:void 0,ie.accessibility=t.getAccessibilityForAdaptation(he).map(function(Xe){var Ve=Xe.value,rt=Ve;return Xe.schemeIdUri&&Xe.schemeIdUri.search("cea-608")>=0&&typeof o<"u"&&(Ve?rt="cea-608:"+Ve:rt="cea-608",ie.embeddedCaptions=!0),rt}),ie.audioChannelConfiguration=t.getAudioChannelConfigurationForAdaptation(he).map(function(Xe){return Xe.value}),ie.audioChannelConfiguration.length===0&&Array.isArray(he.Representation_asArray)&&he.Representation_asArray.length>0&&(ie.audioChannelConfiguration=t.getAudioChannelConfigurationForRepresentation(he.Representation_asArray[0]).map(function(Xe){return Xe.value})),ie.roles=t.getRolesForAdaptation(he).map(function(Xe){return Xe.value}),ie.codec=t.getCodec(he),ie.mimeType=t.getMimeType(he),ie.contentProtection=t.getContentProtectionData(he),ie.bitrateList=t.getBitrateListForAdaptation(he),ie.selectionPriority=t.getSelectionPriority(he),ie.contentProtection){var Ce=ie.contentProtection.map(function(Xe){return t.getKID(Xe)}).filter(function(Xe){return Xe!==null});if(Ce.length){var We=Ce[0];ie.contentProtection.forEach(function(Xe){Xe.keyId=We})}}return ie.isText=t.getIsText(he),ie.supplementalProperties=t.getSupplementalProperties(he),ie.isFragmented=t.getIsFragmented(he),ie.isEmbedded=!1,ie}function ye(ge,ie,he){ge.id=ie,ge.index=100+parseInt(ie.substring(2,3)),ge.type=c.TEXT,ge.codec="cea-608-in-SEI",ge.isEmbedded=!0,ge.isFragmented=!1,ge.lang=C()(he),ge.roles=["caption"]}function Fe(ge){ge.type=c.IMAGE}function Be(ge){var ie=new f.default,he=1;return ie.id=ge.id,ie.index=ge.index,ie.start=ge.start,ie.duration=ge.duration,ie.manifestInfo=Ye(ge.mpd),ie.isLast=ge.mpd.manifest.Period_asArray.length===1||Math.abs(ie.start+ie.duration-ie.manifestInfo.duration)<he,ie}function Ye(ge){var ie=new y.default;return ie.dvrWindowSize=ge.timeShiftBufferDepth,ie.loadedTime=ge.manifest.loadedTime,ie.availableFrom=ge.availabilityStartTime,ie.minBufferTime=ge.manifest.minBufferTime,ie.maxFragmentDuration=ge.maxSegmentDuration,ie.duration=t.getDuration(ge.manifest),ie.isDynamic=t.getIsDynamic(ge.manifest),ie.serviceDescriptions=t.getServiceDescriptions(ge.manifest),ie.protocol=ge.manifest.protocol,ie}function Ze(){if(!c)throw new Error("setConfig function has to be called previously")}function tt(ge){return n.length>0?n[0].mpd.manifest.Period_asArray[ge]:null}function nt(ge,ie){var he=ht(ge,ie,!0);return he!==null?he:-1}function ht(ge,ie,he){var De,Ce,We,Xe,Ve,rt;if(ge){for(Ce=ge.AdaptationSet_asArray,Ve=0;Ve<Ce.length;Ve=Ve+1)for(De=Ce[Ve],Xe=De.Representation_asArray,rt=0;rt<Xe.length;rt=rt+1)if(We=Xe[rt],ie===We.id)return he?rt:We}return null}function je(ge,ie){var he,De,Ce,We;if(!ge||!ie)return-1;for(De=ge.AdaptationSet_asArray,We=0;We<De.length;We=We+1)if(he=De[We],Ce=he.Representation_asArray,t.getIsTypeOf(he,ie))return Ce.length;return-1}return i={getBandwidthForRepresentation:le,getIndexForRepresentation:_e,getMaxIndexForBufferType:Me,convertRepresentationToRepresentationInfo:U,getStreamsInfo:Y,getMediaInfoForType:k,getAllMediaInfoForType:Q,getAdaptationForType:W,getRealAdaptation:J,getProducerReferenceTimes:$,getRealPeriodByIndex:K,getEssentialPropertiesForRepresentation:ae,getVoRepresentations:ee,getEventsFor:ue,getEvent:se,getMpd:D,setConfig:L,updatePeriods:q,getIsTextTrack:Z,getUTCTimingSources:H,getSuggestedPresentationDelay:V,getAvailabilityStartTime:te,getIsTypeOf:Ne,getIsDynamic:z,getDuration:R,getRegularPeriods:u,getContentSteering:F,getLocation:w,getPatchLocation:B,getManifestUpdatePeriod:O,getPublishTime:P,getIsDVB:x,getIsPatch:ne,getBaseURLsFromElement:re,getRepresentationSortFunction:G,getCodec:fe,getPeriodById:Oe,setCurrentMediaInfo:oe,isPatchValid:Se,applyPatchToManifest:me,areMediaInfosEqual:b,reset:xe},S(),i}v.__dashjs_factory_name="DashAdapter";const E=r.default.getSingletonFactory(v)},"./src/dash/DashHandler.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>p});var I=e("./src/streaming/vo/FragmentRequest.js"),g=e("./src/streaming/vo/metrics/HTTPRequest.js"),d=e("./src/core/FactoryMaker.js"),f=e("./src/streaming/MediaPlayerEvents.js"),y=e("./src/dash/utils/SegmentsUtils.js"),_=e("./src/dash/constants/DashConstants.js"),r=.5,T=.001;function M(C){C=C||{};var v=C.eventBus,E=C.debug,i=C.urlUtils,t=C.type,m=C.streamInfo,n=C.segmentsController,h=C.timelineConverter,c=C.baseURLController,o,l,A,S,L;function U(){l=E.getLogger(o),j(),v.on(f.default.DYNAMIC_TO_STATIC,Z,o)}function k(H){S=H,L=!1,n.initialize(H)}function X(){return m.id}function W(){return t}function b(){return m}function j(){A=null}function Q(){j(),v.off(f.default.DYNAMIC_TO_STATIC,Z,o)}function q(H,V,te){var z=c.resolve(te.path),R,u;return!z||V===z.url||!i.isRelative(V)?R=V:(R=z.url,u=z.serviceLocation,V&&(R=i.resolve(V,R))),i.isRelative(R)?!1:(H.url=R,H.serviceLocation=u,!0)}function Y(H,V){return V?J(H,V,W()):null}function J(H,V,te){var z=new I.default,R=V.adaptation.period,u=R.start;if(z.mediaType=te,z.type=g.HTTPRequest.INIT_SEGMENT_TYPE,z.range=V.range,z.availabilityStartTime=h.calcAvailabilityStartTimeFromPresentationTime(u,V,S),z.availabilityEndTime=h.calcAvailabilityEndTimeFromPresentationTime(u+R.duration,V,S),z.quality=V.index,z.mediaInfo=H,z.representationId=V.id,q(z,V.initialization,V))return z.url=(0,y.replaceTokenForTemplate)(z.url,"Bandwidth",V.bandwidth),z}function $(H,V){if(V==null)return null;var te=new I.default,z=V.representation,R=z.adaptation.period.mpd.manifest.Period_asArray[z.adaptation.period.index].AdaptationSet_asArray[z.adaptation.index].Representation_asArray[z.index].bandwidth,u=V.media;if(u=(0,y.replaceTokenForTemplate)(u,"Number",V.replacementNumber),u=(0,y.replaceTokenForTemplate)(u,"Time",V.replacementTime),u=(0,y.replaceTokenForTemplate)(u,"Bandwidth",R),u=(0,y.replaceIDForTemplate)(u,z.id),u=(0,y.unescapeDollarsInTemplate)(u),te.mediaType=W(),te.type=g.HTTPRequest.MEDIA_SEGMENT_TYPE,te.range=V.mediaRange,te.startTime=V.presentationStartTime,te.mediaStartTime=V.mediaStartTime,te.duration=V.duration,te.timescale=z.timescale,te.availabilityStartTime=V.availabilityStartTime,te.availabilityEndTime=V.availabilityEndTime,te.availabilityTimeComplete=z.availabilityTimeComplete,te.wallStartTime=V.wallStartTime,te.quality=z.index,te.index=V.index,te.mediaInfo=H,te.adaptationIndex=z.adaptation.index,te.representationId=z.id,q(te,u,z))return te}function ae(H,V){if(!H||!A)return!1;if(L)return!0;if(!isFinite(H.adaptation.period.duration)||A.presentationStartTime+A.duration>V)return!1;if(H.mediaFinishedInformation&&!isNaN(H.mediaFinishedInformation.numberOfSegments)&&!isNaN(A.index)&&A.index>=H.mediaFinishedInformation.numberOfSegments-1){if(!S||H.segmentInfoType===_.default.SEGMENT_TEMPLATE)return!0;if(S&&H.segmentInfoType===_.default.SEGMENT_LIST&&H.adaptation.period.nextPeriodId)return!0}return!!(S&&H.adaptation.period.nextPeriodId&&H.segmentInfoType===_.default.SEGMENT_TIMELINE&&H.mediaFinishedInformation&&!isNaN(H.mediaFinishedInformation.mediaTimeOfLastSignaledSegment)&&A&&!isNaN(A.mediaStartTime)&&!isNaN(A.duration)&&A.mediaStartTime+A.duration>=H.mediaFinishedInformation.mediaTimeOfLastSignaledSegment-.05)}function K(H,V,te){var z=null;if(!V||!V.segmentInfoType)return z;var R=n.getSegmentByTime(V,te);return R&&(A=R,l.debug("Index for time "+te+" is "+R.index),z=$(H,R)),z}function ee(H,V){var te=null,z=A?A.index+1:0,R=n.getSegmentByIndex(V,z,A?A.mediaStartTime:-1);return R?(te=$(H,R),te):null}function se(H,V){var te=null;if(!V||!V.segmentInfoType)return null;var z=A?A.index+1:0,R=n.getSegmentByIndex(V,z,A?A.mediaStartTime:-1);if(R)te=$(H,R),A=R;else{if(S&&!L)return l.debug(W()+" No segment found at index: "+z+". Wait for next loop"),null;L=!0}return te}function ue(H,V,te,z){try{if(isNaN(H)||!V||!te)return NaN;if(H<0&&(H=0),isNaN(z)&&(z=r),K(V,te,H))return H;if(te.adaptation.period.start+te.adaptation.period.duration<H)return NaN;for(var R=isFinite(te.adaptation.period.duration)?te.adaptation.period.start+te.adaptation.period.duration:H+30,u=Math.min(H+z,R),D=NaN,F=null;u<=R;){var w=null;if(u<=R&&(w=K(V,te,u)),w){D=u,F=w;break}u+=z}if(F){var O=F.startTime+F.duration;return H>F.startTime&&O-H>z?H:!isNaN(F.startTime)&&H<F.startTime&&D>F.startTime?F.startTime+T:Math.min(O-z,D)}return D}catch{return NaN}}function oe(){return A?A.index:-1}function Z(){l.debug("Dynamic stream complete"),L=!0}return o={initialize:k,getStreamId:X,getType:W,getStreamInfo:b,getInitRequest:Y,getSegmentRequestForTime:K,getCurrentIndex:oe,getNextSegmentRequest:se,isLastSegmentRequested:ae,reset:Q,getNextSegmentRequestIdempotent:ee,getValidTimeAheadOfTargetTime:ue},U(),o}M.__dashjs_factory_name="DashHandler";const p=d.default.getClassFactory(M)},"./src/dash/DashMetrics.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>p});var I=e("./src/streaming/constants/Constants.js"),g=e("./src/streaming/vo/metrics/HTTPRequest.js"),d=e("./src/core/FactoryMaker.js"),f=e("./src/streaming/constants/MetricsConstants.js"),y=e("./src/dash/utils/Round10.js"),_=e("./src/streaming/models/MetricsModel.js"),r=e("./src/core/Utils.js"),T=e("./src/streaming/vo/metrics/PlayList.js");function M(C){C=C||{};var v=this.context,E,i,t,m,n=C.metricsModel;function h(){n=n||(0,_.default)(v).getInstance({settings:C.settings}),c()}function c(){i=!0,t=null,m=null}function o(w){var O=n.getMetricsFor(w,!0);return j(O,f.default.TRACK_SWITCH)}function l(w,O,P,B,x){n.addRepresentationSwitch(w,O,P,B,x)}function A(w){var O=n.getMetricsFor(w,!0);return j(O,f.default.BUFFER_STATE)}function S(w){var O=n.getMetricsFor(w,!0),P=j(O,f.default.BUFFER_LEVEL);return P?y.default.round10(P.level/1e3,-3):0}function L(w,O,P){n.addBufferLevel(w,O,P)}function U(w,O,P){n.addBufferState(w,O,P)}function k(){n.clearAllCurrentMetrics()}function X(w){var O=n.getMetricsFor(w,!0);if(!O)return null;var P=O.HttpList,B=null,x;if(!P||P.length<=0)return null;for(x=P.length-1;x>=0;){if(P[x].responsecode){B=P[x];break}x--}return B}function W(w){var O=n.getMetricsFor(w,!0);return O?O.HttpList?O.HttpList:[]:[]}function b(w,O,P){n.addRequestsQueue(w,O,P)}function j(w,O){if(!w)return null;var P=w[O];return!P||P.length===0?null:P[P.length-1]}function Q(){var w=n.getMetricsFor(I.default.VIDEO,!0);return j(w,f.default.DROPPED_FRAMES)}function q(w){n.addDroppedFrames(I.default.VIDEO,w)}function Y(w){var O=n.getMetricsFor(w,!0);return j(O,f.default.SCHEDULING_INFO)}function J(w,O){n.addSchedulingInfo(w.mediaType,new Date,w.type,w.startTime,w.availabilityStartTime,w.duration,w.quality,w.range,O)}function $(){var w=n.getMetricsFor(I.default.STREAM);return j(w,f.default.MANIFEST_UPDATE)}function ae(w){var O=this.getCurrentManifestUpdate();n.updateManifestUpdateInfo(O,w)}function K(w){if(w){var O=this.getCurrentManifestUpdate();n.addManifestUpdateStreamInfo(O,w.id,w.index,w.start,w.duration)}}function ee(w){n.addManifestUpdate(I.default.STREAM,w.type,w.requestStartDate,w.requestEndDate)}function se(w,O,P,B,x,ne){n.addHttpRequest(w.mediaType,null,w.type,w.url,w.quality,O,w.serviceLocation||null,w.range||null,w.requestStartDate,w.firstByteDate,w.requestEndDate,P,w.duration,B,x,w.fileLoaderType,ne)}function ue(w,O){if(w){var P=this.getCurrentManifestUpdate();n.addManifestUpdateRepresentationInfo(P,w.id,w.index,w.streamIndex,O,w.presentationTimeOffset,w.startNumber,w.fragmentInfoType)}}function oe(w){var O=w?n.getMetricsFor(w,!0):n.getMetricsFor(I.default.VIDEO,!0)||n.getMetricsFor(I.default.AUDIO,!0);return j(O,f.default.DVR_INFO)}function Z(w,O,P,B){n.addDVRInfo(w,O,P,B)}function H(w){if(!w)return null;var O={},P,B,x;for(P=W(I.default.STREAM),x=P.length-1;x>=0;x--)if(B=P[x],B.type===g.HTTPRequest.MPD_TYPE){O=r.default.parseHttpHeaders(B._responseHeaders);break}var ne=O[w.toLowerCase()];return ne===void 0?null:ne}function V(w,O){if(!O)return null;var P={},B=X(w);B&&(P=r.default.parseHttpHeaders(B._responseHeaders));var x=P[O.toLowerCase()];return x===void 0?null:x}function te(){m&&(n.addPlayList(m),m=null)}function z(w,O){m=new T.PlayList,m.start=new Date,m.mstart=w,m.starttype=O}function R(w,O,P){i===!0&&(i=!1,t=new T.PlayListTrace,t.representationid=w,t.start=new Date,t.mstart=O,t.playbackspeed=P!==null?P.toString():null)}function u(w){if(t)for(var O in t)t[O]=w[O]}function D(w,O){if(i===!1&&m&&t&&t.start){var P=t.start,B=w.getTime()-P.getTime();t.duration=B,t.stopreason=O,m.trace.push(t),i=!0}}function F(w){n.addDVBErrors(w)}return E={getCurrentRepresentationSwitch:o,getCurrentBufferState:A,getCurrentBufferLevel:S,getCurrentHttpRequest:X,getHttpRequests:W,getCurrentDroppedFrames:Q,getCurrentSchedulingInfo:Y,getCurrentDVRInfo:oe,getCurrentManifestUpdate:$,getLatestFragmentRequestHeaderValueByID:V,getLatestMPDRequestHeaderValueByID:H,addRepresentationSwitch:l,addDVRInfo:Z,updateManifestUpdateInfo:ae,addManifestUpdateStreamInfo:K,addManifestUpdateRepresentationInfo:ue,addManifestUpdate:ee,addHttpRequest:se,addSchedulingInfo:J,addRequestsQueue:b,addBufferLevel:L,addBufferState:U,addDroppedFrames:q,addPlayList:te,addDVBErrors:F,createPlaylistMetrics:z,createPlaylistTraceMetrics:R,updatePlayListTraceMetrics:u,pushPlayListTraceMetrics:D,clearAllCurrentMetrics:k},h(),E}M.__dashjs_factory_name="DashMetrics";const p=d.default.getSingletonFactory(M)},"./src/dash/SegmentBaseLoader.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>r});var I=e("./src/dash/vo/Segment.js"),g=e("./src/streaming/vo/DashJSError.js"),d=e("./src/core/FactoryMaker.js"),f=e("./src/streaming/vo/FragmentRequest.js"),y=e("./src/streaming/net/URLLoader.js");function _(){var T=this.context,M,p,C,v,E,i,t,m,n,h,c,o,l;function A(){m=(0,y.default)(T).create({errHandler:C,dashMetrics:i,mediaPlayerModel:t,requestModifier:E,boxParser:v,errors:n,urlUtils:o,constants:h,dashConstants:c})}function S(q){q.baseURLController&&(l=q.baseURLController),q.dashMetrics&&(i=q.dashMetrics),q.mediaPlayerModel&&(t=q.mediaPlayerModel),q.errHandler&&(C=q.errHandler),q.boxParser&&(v=q.boxParser),q.debug&&(p=q.debug.getLogger(M)),q.requestModifier&&(E=q.requestModifier),q.errors&&(n=q.errors),q.urlUtils&&(o=q.urlUtils),q.constants&&(h=q.constants),q.dashConstants&&(c=q.dashConstants)}function L(q,Y){return new Promise(function(J){U(q,Y,J)})}function U(q,Y,J,$){var ae=null,K=q?l.resolve(q.path):null,ee=$||{init:!0,url:K?K.url:void 0,range:{start:0,end:1500},searching:!1,bytesLoaded:0,bytesToLoad:1500,mediaType:Y};p.debug("Start searching for initialization.");var se=Q(ee),ue=function(H){if(ee.bytesLoaded=ee.range.end,ae=v.findInitRange(H),ae)q.range=ae,J(q);else return ee.range.end=ee.bytesLoaded+ee.bytesToLoad,U(q,Y,J,ee)},oe=function(){J(q)};m.load({request:se,success:ue,error:oe}),p.debug("Perform init search: "+ee.url)}function k(q,Y,J){return new Promise(function($){X(q,Y,J,$)})}function X(q,Y,J,$,ae,K){if(J&&(J.start===void 0||J.end===void 0)){var ee=J?J.toString().split("-"):null;J=ee?{start:parseFloat(ee[0]),end:parseFloat(ee[1])}:null}ae=ae||W;var se=null,ue=null,oe=!!J,Z=q?l.resolve(q.path):null,H={init:!1,url:Z?Z.url:void 0,range:oe?J:{start:0,end:1500},searching:!oe,bytesLoaded:K?K.bytesLoaded:0,bytesToLoad:1500,mediaType:Y},V=Q(H),te=function(u){var D=H.bytesToLoad,F=u.byteLength;if(H.bytesLoaded=H.range.end-H.range.start,se=v.parse(u),ue=se.getBox("sidx"),!ue||!ue.isComplete){if(ue)H.range.start=ue.offset||H.range.start,H.range.end=H.range.start+(ue.size||D);else if(F<H.bytesLoaded){ae(null,q,$);return}else{var w=se.getLastBox();w&&w.size?(H.range.start=w.offset+w.size,H.range.end=H.range.start+D):H.range.end+=D}X(q,Y,H.range,$,null,H)}else{var O=ue.references,P,B;if(O!=null&&O.length>0&&(P=O[0].reference_type===1),P){p.debug("Initiate multiple SIDX load."),H.range.end=H.range.start+ue.size;var x,ne,re,G,fe,le=[],_e=0,Me=(ue.offset||H.range.start)+ue.size,Oe=function(xe){xe?(le=le.concat(xe),_e++,_e>=ne&&(le.sort(function(Se,me){return Se.startTime-me.startTime<0?-1:0}),ae(le,q,$))):ae(null,q,$)};for(x=0,ne=O.length;x<ne;x++)re=Me,G=Me+O[x].referenced_size-1,Me=Me+O[x].referenced_size,fe={start:re,end:G},X(q,Y,fe,$,Oe,H)}else p.debug("Parsing segments from SIDX. representation "+Y+" - id: "+q.id+" for range : "+H.range.start+" - "+H.range.end),B=j(ue,H),ae(B,q,$)}},z=function(){ae(null,q,$)};m.load({request:V,success:te,error:z}),p.debug("Perform SIDX load for type ".concat(Y," : ").concat(H.url," with range ").concat(H.range.start," - ").concat(H.range.end))}function W(q,Y,J){J({segments:q,representation:Y,error:q?void 0:new g.default(n.SEGMENT_BASE_LOADER_ERROR_CODE,n.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})}function b(){m&&(m.abort(),m=null)}function j(q,Y){for(var J=q.references,$=J.length,ae=q.timescale,K=q.earliest_presentation_time,ee=Y.range.start+q.offset+q.first_offset+q.size,se=[],ue,oe,Z,H,V=0;V<$;V++)Z=J[V].subsegment_duration,H=J[V].referenced_size,ue=new I.default,ue.duration=Z,ue.startTime=K,ue.timescale=ae,oe=ee+H-1,ue.mediaRange=ee+"-"+oe,se.push(ue),K+=Z,ee+=H;return se}function Q(q){if(q.url){var Y=new f.default;return Y.setInfo(q),Y}}return M={setConfig:S,initialize:A,loadInitialization:L,loadSegments:k,reset:b},M}_.__dashjs_factory_name="SegmentBaseLoader";const r=d.default.getSingletonFactory(_)},"./src/dash/WebmSegmentBaseLoader.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>M});var I=e("./src/streaming/utils/EBMLParser.js"),g=e("./src/streaming/constants/Constants.js"),d=e("./src/core/FactoryMaker.js"),f=e("./src/dash/vo/Segment.js"),y=e("./src/streaming/vo/FragmentRequest.js"),_=e("./src/streaming/net/URLLoader.js"),r=e("./src/streaming/vo/DashJSError.js");function T(){var p=this.context,C,v,E,i,t,m,n,h,c,o;function l(){E={EBML:{tag:440786851,required:!0},Segment:{tag:408125543,required:!0,SeekHead:{tag:290298740,required:!0},Info:{tag:357149030,required:!0,TimecodeScale:{tag:2807729,required:!0,parse:"getMatroskaUint"},Duration:{tag:17545,required:!0,parse:"getMatroskaFloat"}},Tracks:{tag:374648427,required:!0},Cues:{tag:475249515,required:!0,CuePoint:{tag:187,required:!0,CueTime:{tag:179,required:!0,parse:"getMatroskaUint"},CueTrackPositions:{tag:183,required:!0,CueTrack:{tag:247,required:!0,parse:"getMatroskaUint"},CueClusterPosition:{tag:241,required:!0,parse:"getMatroskaUint"}}}}},Void:{tag:236,required:!0}}}function A(){h=(0,_.default)(p).create({errHandler:i,dashMetrics:m,mediaPlayerModel:n,requestModifier:t,errors:c})}function S(Q){if(!Q.baseURLController||!Q.dashMetrics||!Q.mediaPlayerModel||!Q.errHandler)throw new Error(g.default.MISSING_CONFIG_ERROR);o=Q.baseURLController,m=Q.dashMetrics,n=Q.mediaPlayerModel,i=Q.errHandler,c=Q.errors,v=Q.debug.getLogger(C),t=Q.requestModifier}function L(Q){var q=[],Y=(0,I.default)(p).create({data:Q}),J,$;for(Y.consumeTagAndSize(E.Segment.Cues);Y.moreData()&&Y.consumeTagAndSize(E.Segment.Cues.CuePoint,!0);){for(J={},J.CueTime=Y.parseTag(E.Segment.Cues.CuePoint.CueTime),J.CueTracks=[];Y.moreData()&&Y.consumeTag(E.Segment.Cues.CuePoint.CueTrackPositions,!0);){var ae=Y.getMatroskaCodedNum(),K=Y.getPos();if($={},$.Track=Y.parseTag(E.Segment.Cues.CuePoint.CueTrackPositions.CueTrack),$.Track===0)throw new Error("Cue track cannot be 0");$.ClusterPosition=Y.parseTag(E.Segment.Cues.CuePoint.CueTrackPositions.CueClusterPosition),J.CueTracks.push($),Y.setPos(K+ae)}if(J.CueTracks.length===0)throw new Error("Mandatory cuetrack not found");q.push(J)}if(q.length===0)throw new Error("mandatory cuepoint not found");return q}function U(Q,q,Y,J){var $,ae,K,ee,se,ue,oe,Z;for(ae=L(Q),K=[],se=0,ue=ae.length;se<ue;se+=1)ee=new f.default,$=0,se<ae.length-1?$=ae[se+1].CueTime-ae[se].CueTime:$=J-ae[se].CueTime,ee.duration=$,ee.startTime=ae[se].CueTime,ee.timescale=1e3,oe=ae[se].CueTracks[0].ClusterPosition+q,se<ae.length-1?Z=ae[se+1].CueTracks[0].ClusterPosition+q-1:Z=Y-1,ee.mediaRange=oe+"-"+Z,K.push(ee);return v.debug("Parsed cues: "+K.length+" cues."),K}function k(Q,q,Y,J){if(!Q||Q.byteLength===0){J(null);return}var $=(0,I.default)(p).create({data:Q}),ae,K,ee,se,ue=Y?Y.split("-"):null,oe=null,Z={url:q,range:{start:ue?parseFloat(ue[0]):null,end:ue?parseFloat(ue[1]):null},request:oe};for(v.debug("Parse EBML header: "+Z.url),$.skipOverElement(E.EBML),$.consumeTag(E.Segment),ee=$.getMatroskaCodedNum(),ee+=$.getPos(),se=$.getPos();$.moreData()&&!$.consumeTagAndSize(E.Segment.Info,!0);)if(!($.skipOverElement(E.Segment.SeekHead,!0)||$.skipOverElement(E.Segment.Tracks,!0)||$.skipOverElement(E.Segment.Cues,!0)||$.skipOverElement(E.Void,!0)))throw new Error("no valid top level element found");for(;ae===void 0;){var H=$.getMatroskaCodedNum(!0),V=$.getMatroskaCodedNum();switch(H){case E.Segment.Info.Duration.tag:ae=$[E.Segment.Info.Duration.parse](V);break;default:$.setPos($.getPos()+V);break}}oe=b(Z);var te=function(u){K=U(u,se,ee,ae),J(K)},z=function(){v.error("Download Error: Cues "+Z.url),J(null)};h.load({request:oe,success:te,error:z}),v.debug("Perform cues load: "+Z.url+" bytes="+Z.range.start+"-"+Z.range.end)}function X(Q,q){return new Promise(function(Y){var J=null,$=Q?o.resolve(Q.path):null,ae=Q?Q.range.split("-"):null,K={range:{start:ae?parseFloat(ae[0]):null,end:ae?parseFloat(ae[1]):null},request:J,url:$?$.url:void 0,init:!0,mediaType:q};v.info("Start loading initialization."),J=b(K);var ee=function(){Y(Q)},se=function(){Y(Q)};h.load({request:J,success:ee,error:se}),v.debug("Perform init load: "+K.url)})}function W(Q,q,Y){return new Promise(function(J){var $=null,ae=Q?o.resolve(Q.path):null,K=ae?ae.url:void 0,ee=8192,se={bytesLoaded:0,bytesToLoad:ee,range:{start:0,end:ee},request:$,url:K,init:!1,mediaType:q};$=b(se),v.debug("Parsing ebml header");var ue=function(H){k(H,K,Y,function(V){J({segments:V,representation:Q,error:V?void 0:new r.default(c.SEGMENT_BASE_LOADER_ERROR_CODE,c.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})})},oe=function(){J({representation:Q,error:new r.default(c.SEGMENT_BASE_LOADER_ERROR_CODE,c.SEGMENT_BASE_LOADER_ERROR_MESSAGE)})};h.load({request:$,success:ue,error:oe})})}function b(Q){var q=new y.default;return q.setInfo(Q),q}function j(){h&&(h.abort(),h=null)}return C={setConfig:S,initialize:A,loadInitialization:X,loadSegments:W,reset:j},l(),C}T.__dashjs_factory_name="WebmSegmentBaseLoader";const M=d.default.getSingletonFactory(T)},"./src/dash/constants/DashConstants.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>_});function I(r,T){if(!(r instanceof T))throw new TypeError("Cannot call a class as a function")}function g(r,T){for(var M=0;M<T.length;M++){var p=T[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(r,p.key,p)}}function d(r,T,M){return T&&g(r.prototype,T),M&&g(r,M),r}var f=function(){function r(){I(this,r),this.init()}return d(r,[{key:"init",value:function(){this.BASE_URL="BaseURL",this.SEGMENT_BASE="SegmentBase",this.SEGMENT_TEMPLATE="SegmentTemplate",this.SEGMENT_LIST="SegmentList",this.SEGMENT_URL="SegmentURL",this.SEGMENT_TIMELINE="SegmentTimeline",this.SEGMENT_PROFILES="segmentProfiles",this.ADAPTATION_SET="AdaptationSet",this.REPRESENTATION="Representation",this.REPRESENTATION_INDEX="RepresentationIndex",this.SUB_REPRESENTATION="SubRepresentation",this.INITIALIZATION="Initialization",this.INITIALIZATION_MINUS="initialization",this.MPD="MPD",this.PERIOD="Period",this.ASSET_IDENTIFIER="AssetIdentifier",this.EVENT_STREAM="EventStream",this.ID="id",this.PROFILES="profiles",this.SERVICE_LOCATION="serviceLocation",this.RANGE="range",this.INDEX="index",this.MEDIA="media",this.BYTE_RANGE="byteRange",this.INDEX_RANGE="indexRange",this.MEDIA_RANGE="mediaRange",this.VALUE="value",this.CONTENT_TYPE="contentType",this.MIME_TYPE="mimeType",this.BITSTREAM_SWITCHING="BitstreamSwitching",this.BITSTREAM_SWITCHING_MINUS="bitstreamSwitching",this.CODECS="codecs",this.DEPENDENCY_ID="dependencyId",this.MEDIA_STREAM_STRUCTURE_ID="mediaStreamStructureId",this.METRICS="Metrics",this.METRICS_MINUS="metrics",this.REPORTING="Reporting",this.WIDTH="width",this.HEIGHT="height",this.SAR="sar",this.FRAMERATE="frameRate",this.AUDIO_SAMPLING_RATE="audioSamplingRate",this.MAXIMUM_SAP_PERIOD="maximumSAPPeriod",this.START_WITH_SAP="startWithSAP",this.MAX_PLAYOUT_RATE="maxPlayoutRate",this.CODING_DEPENDENCY="codingDependency",this.SCAN_TYPE="scanType",this.FRAME_PACKING="FramePacking",this.AUDIO_CHANNEL_CONFIGURATION="AudioChannelConfiguration",this.CONTENT_PROTECTION="ContentProtection",this.ESSENTIAL_PROPERTY="EssentialProperty",this.SUPPLEMENTAL_PROPERTY="SupplementalProperty",this.INBAND_EVENT_STREAM="InbandEventStream",this.PRODUCER_REFERENCE_TIME="ProducerReferenceTime",this.ACCESSIBILITY="Accessibility",this.ROLE="Role",this.RATING="Rating",this.CONTENT_COMPONENT="ContentComponent",this.SUBSET="Subset",this.LANG="lang",this.VIEWPOINT="Viewpoint",this.ROLE_ASARRAY="Role_asArray",this.REPRESENTATION_ASARRAY="Representation_asArray",this.PRODUCERREFERENCETIME_ASARRAY="ProducerReferenceTime_asArray",this.ACCESSIBILITY_ASARRAY="Accessibility_asArray",this.AUDIOCHANNELCONFIGURATION_ASARRAY="AudioChannelConfiguration_asArray",this.CONTENTPROTECTION_ASARRAY="ContentProtection_asArray",this.MAIN="main",this.DYNAMIC="dynamic",this.STATIC="static",this.MEDIA_PRESENTATION_DURATION="mediaPresentationDuration",this.MINIMUM_UPDATE_PERIOD="minimumUpdatePeriod",this.CODEC_PRIVATE_DATA="codecPrivateData",this.BANDWITH="bandwidth",this.SOURCE_URL="sourceURL",this.TIMESCALE="timescale",this.DURATION="duration",this.START_NUMBER="startNumber",this.PRESENTATION_TIME_OFFSET="presentationTimeOffset",this.AVAILABILITY_START_TIME="availabilityStartTime",this.AVAILABILITY_END_TIME="availabilityEndTime",this.TIMESHIFT_BUFFER_DEPTH="timeShiftBufferDepth",this.MAX_SEGMENT_DURATION="maxSegmentDuration",this.PRESENTATION_TIME="presentationTime",this.MIN_BUFFER_TIME="minBufferTime",this.MAX_SUBSEGMENT_DURATION="maxSubsegmentDuration",this.START="start",this.AVAILABILITY_TIME_OFFSET="availabilityTimeOffset",this.AVAILABILITY_TIME_COMPLETE="availabilityTimeComplete",this.CENC_DEFAULT_KID="cenc:default_KID",this.DVB_PRIORITY="dvb:priority",this.DVB_WEIGHT="dvb:weight",this.SUGGESTED_PRESENTATION_DELAY="suggestedPresentationDelay",this.SERVICE_DESCRIPTION="ServiceDescription",this.SERVICE_DESCRIPTION_SCOPE="Scope",this.SERVICE_DESCRIPTION_LATENCY="Latency",this.SERVICE_DESCRIPTION_PLAYBACK_RATE="PlaybackRate",this.SERVICE_DESCRIPTION_OPERATING_QUALITY="OperatingQuality",this.SERVICE_DESCRIPTION_OPERATING_BANDWIDTH="OperatingBandwidth",this.PATCH_LOCATION="PatchLocation",this.PUBLISH_TIME="publishTime",this.ORIGINAL_PUBLISH_TIME="originalPublishTime",this.ORIGINAL_MPD_ID="mpdId",this.WALL_CLOCK_TIME="wallClockTime",this.PRESENTATION_TIME="presentationTime",this.LABEL="Label",this.GROUP_LABEL="GroupLabel",this.CONTENT_STEERING="ContentSteering",this.CONTENT_STEERING_AS_ARRAY="ContentSteering_asArray",this.DEFAULT_SERVICE_LOCATION="defaultServiceLocation",this.QUERY_BEFORE_START="queryBeforeStart",this.PROXY_SERVER_URL="proxyServerURL",this.CONTENT_STEERING_RESPONSE={VERSION:"VERSION",TTL:"TTL",RELOAD_URI:"RELOAD-URI",SERVICE_LOCATION_PRIORITY:"SERVICE-LOCATION-PRIORITY"}}}]),r}(),y=new f;const _=y},"./src/dash/controllers/ContentSteeringController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>t});var I=e("./src/core/FactoryMaker.js"),g=e("./src/core/Debug.js"),d=e("./src/streaming/net/URLLoader.js"),f=e("./src/core/errors/Errors.js"),y=e("./src/dash/vo/ContentSteeringRequest.js"),_=e("./src/dash/vo/ContentSteeringResponse.js"),r=e("./src/dash/constants/DashConstants.js"),T=e("./src/streaming/MediaPlayerEvents.js"),M=e("./src/core/events/Events.js"),p=e("./src/streaming/constants/Constants.js"),C=e("./src/core/Utils.js"),v=e("./src/streaming/utils/URLUtils.js"),E={THROUGHPUT:"_DASH_throughput",PATHWAY:"_DASH_pathway",URL:"url"};function i(){var m=this.context,n=(0,v.default)(m).getInstance(),h,c,o,l,A,S,L,U,k,X,W,b,j,Q,q;function Y(){c=(0,g.default)(m).getInstance().getLogger(h),u()}function J(D){D&&(D.adapter&&(q=D.adapter),D.errHandler&&(U=D.errHandler),D.dashMetrics&&(k=D.dashMetrics),D.mediaPlayerModel&&(X=D.mediaPlayerModel),D.requestModifier&&(b=D.requestModifier),D.manifestModel&&(W=D.manifestModel),D.abrController&&(j=D.abrController),D.eventBus&&(Q=D.eventBus))}function $(){L=(0,d.default)(m).create({errHandler:U,dashMetrics:k,mediaPlayerModel:X,requestModifier:b,errors:f.default}),Q.on(T.default.PERIOD_SWITCH_COMPLETED,ae,h),Q.on(M.default.FRAGMENT_LOADING_STARTED,K,h)}function ae(D){D&&D.toStreamInfo&&(l=D.toStreamInfo)}function K(D){D&&D.request&&D.request.serviceLocation&&(A=D.request.serviceLocation)}function ee(){var D=W.getValue();return q.getContentSteering(D)}function se(){var D=ee();return D&&D.queryBeforeStart}function ue(){return new Promise(function(D){try{var F=ee();if(!F||!F.serverUrl){D();return}var w=oe(F),O=new y.default(w);L.load({request:O,success:function(B){Z(B),Q.trigger(T.default.CONTENT_STEERING_REQUEST_COMPLETED,{currentSteeringResponseData:o,url:w}),D()},error:function(B){te(B),D(B)}})}catch(P){D(P)}})}function oe(D){var F=D.proxyServerUrl?D.proxyServerUrl:D.serverUrl;o&&o.reloadUri&&(n.isRelative(o.reloadUri)?F=n.resolve(o.reloadUri,D.serverUrl):F=o.reloadUri);var w=[];if(l){var O=q.getIsDynamic(),P=q.getAllMediaInfoForType(l,p.default.VIDEO).length>0?p.default.VIDEO:p.default.AUDIO,B=j.getThroughputHistory(),x=B?B.getAverageThroughput(P,O):NaN;isNaN(x)||w.push({key:E.THROUGHPUT,value:x*1e3})}return A&&w.push({key:E.PATHWAY,value:A}),D.proxyServerUrl&&D.proxyServerUrl===F&&D.serverUrl&&w.push({key:E.URL,value:encodeURI(D.serverUrl)}),F=C.default.addAditionalQueryParameterToUrl(F,w),F}function Z(D){!D||!D[r.default.CONTENT_STEERING_RESPONSE.VERSION]||parseInt(D[r.default.CONTENT_STEERING_RESPONSE.VERSION])!==1||(o=new _.default,o.version=D[r.default.CONTENT_STEERING_RESPONSE.VERSION],D[r.default.CONTENT_STEERING_RESPONSE.TTL]&&!isNaN(D[r.default.CONTENT_STEERING_RESPONSE.TTL])&&(o.ttl=D[r.default.CONTENT_STEERING_RESPONSE.TTL]),D[r.default.CONTENT_STEERING_RESPONSE.RELOAD_URI]&&(o.reloadUri=D[r.default.CONTENT_STEERING_RESPONSE.RELOAD_URI]),D[r.default.CONTENT_STEERING_RESPONSE.SERVICE_LOCATION_PRIORITY]&&(o.serviceLocationPriority=D[r.default.CONTENT_STEERING_RESPONSE.SERVICE_LOCATION_PRIORITY]),H())}function H(){o&&o.ttl&&!isNaN(o.ttl)&&(S&&clearTimeout(S),S=setTimeout(function(){ue()},o.ttl*1e3))}function V(){S&&clearTimeout(S),S=null}function te(D){c.warn("Error fetching data from content steering server",D),H()}function z(){return o}function R(){u(),Q.off(T.default.PERIOD_SWITCH_COMPLETED,ae,h),Q.off(M.default.FRAGMENT_LOADING_STARTED,K,h)}function u(){o=null,l=null,A=null,V()}return h={reset:R,setConfig:J,loadSteeringData:ue,getCurrentSteeringResponseData:z,shouldQueryBeforeStart:se,getSteeringDataFromManifest:ee,stopSteeringRequestTimer:V,initialize:$},Y(),h}i.__dashjs_factory_name="ContentSteeringController";const t=I.default.getSingletonFactory(i)},"./src/dash/controllers/RepresentationController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>_});var I=e("./src/streaming/constants/Constants.js"),g=e("./src/core/FactoryMaker.js"),d=e("./src/streaming/MediaPlayerEvents.js"),f=e("./src/dash/utils/SegmentsUtils.js");function y(r){r=r||{};var T=r.eventBus,M=r.events,p=r.abrController,C=r.dashMetrics,v=r.playbackController,E=r.timelineConverter,i=r.type,t=r.streamInfo,m=r.dashConstants,n=r.segmentsController,h=r.isDynamic,c,o,l,A,S;function L(){Q(),T.on(d.default.MANIFEST_VALIDITY_CHANGED,z,c)}function U(){return t.id}function k(){return i}function X(){if(!p||!C||!v||!E)throw new Error(I.default.MISSING_CONFIG_ERROR)}function W(){return o}function b(){return l}function j(){return S}function Q(){o=null,l=!0,A=[]}function q(){T.off(d.default.MANIFEST_VALIDITY_CHANGED,z,c),Q()}function Y(R,u,D,F,w){X(),l=!0,A=u;var O=se(w);if(te(O),o=R,D!==I.default.VIDEO&&D!==I.default.AUDIO&&(D!==I.default.TEXT||!F))return Z(),Promise.resolve();for(var P=[],B=0,x=A.length;B<x;B++){var ne=A[B];P.push(J(ne))}return Promise.all(P)}function J(R){return new Promise(function(u,D){var F=R.hasInitialization(),w=R.hasSegments(),O=[];O.push(n.updateInitData(R,F)),O.push(n.updateSegmentData(R,w)),Promise.all(O).then(function(P){P[0]&&!P[0].error&&(R=ae(R,P[0])),P[1]&&!P[1].error&&(R=K(R,P[1])),$(R),H(R),u()}).catch(function(P){D(P)})})}function $(R){R.mediaFinishedInformation=n.getMediaFinishedInformation(R)}function ae(R,u){return!u||u.error||!u.representation?R:u.representation}function K(R,u){if(!(!u||u.error)){var D=u.segments,F=[],w=0,O,P,B,x;for(O=0,P=D?D.length:0;O<P;O++)B=D[O],x=(0,f.getTimeBasedSegment)(E,h,R,B.startTime,B.duration,B.timescale,B.media,B.mediaRange,w),x&&(F.push(x),x=null,w++);return F.length>0&&(R.segments=F),R}}function ee(){X();var R=new Date,u=j(),D=v.getTime()*1e3;u&&C.addRepresentationSwitch(u.adaptation.type,R,D,u.id),T.trigger(d.default.REPRESENTATION_SWITCH,{mediaType:i,streamId:t.id,currentRepresentation:u,numberOfRepresentations:A.length},{streamId:t.id,mediaType:i})}function se(R){return R==null||R>=A.length?null:A[R]}function ue(R){return A.indexOf(R)}function oe(){for(var R=0,u=A.length;R<u;R++){var D=A[R].segmentInfoType;if(!A[R].hasInitialization()||(D===m.SEGMENT_BASE||D===m.BASE_URL)&&!A[R].segments)return!1}return!0}function Z(R){l=!1,T.trigger(M.DATA_UPDATE_COMPLETED,{data:o,currentRepresentation:S,error:R},{streamId:t.id,mediaType:i})}function H(R){if(b()){var u=C.getCurrentManifestUpdate(),D=!1,F,w;if(u){for(var O=0;O<u.representationInfo.length;O++)if(F=u.representationInfo[O],F.index===R.index&&F.mediaType===k()){D=!0;break}D||C.addManifestUpdateRepresentationInfo(R,k())}if(oe()){p.setPlaybackQuality(i,t,ue(S));var P=C.getCurrentDVRInfo(i);P&&C.updateManifestUpdateInfo({latency:P.range.end-v.getTime()}),w=C.getCurrentRepresentationSwitch(j().adaptation.type),w||ee(),Z()}}}function V(R){var u=se(R);te(u),ee()}function te(R){S=R}function z(R){if(R.newDuration){var u=j();if(u&&u.adaptation.period){var D=u.adaptation.period;D.duration=R.newDuration}}}return c={getStreamId:U,getType:k,getData:W,isUpdating:b,updateData:Y,getCurrentRepresentation:j,getRepresentationForQuality:se,prepareQualityChange:V,reset:q},L(),c}y.__dashjs_factory_name="RepresentationController";const _=g.default.getClassFactory(y)},"./src/dash/controllers/SegmentBaseController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>_});var I=e("./src/core/FactoryMaker.js"),g=e("./src/dash/SegmentBaseLoader.js"),d=e("./src/dash/WebmSegmentBaseLoader.js");function f(r){r=r||{};var T=this.context,M=r.eventBus,p=r.events,C=r.dashMetrics,v=r.mediaPlayerModel,E=r.errHandler,i=r.baseURLController,t=r.debug,m=r.boxParser,n=r.requestModifier,h=r.errors,c,o,l;function A(){o=(0,g.default)(T).getInstance(),l=(0,d.default)(T).getInstance(),o.setConfig({baseURLController:i,dashMetrics:C,mediaPlayerModel:v,errHandler:E,eventBus:M,events:p,errors:h,debug:t,boxParser:m,requestModifier:n}),l.setConfig({baseURLController:i,dashMetrics:C,mediaPlayerModel:v,errHandler:E,eventBus:M,events:p,errors:h,debug:t,requestModifier:n})}function S(W){var b=W?W.split("/")[1]:"";return b.toLowerCase()==="webm"}function L(){o.initialize(),l.initialize()}function U(W){return S(W.representation.mimeType)?l.loadInitialization(W.representation,W.mediaType):o.loadInitialization(W.representation,W.mediaType)}function k(W){return S(W.mimeType)?l.loadSegments(W.representation,W.mediaType,W.representation?W.representation.indexRange:null):o.loadSegments(W.representation,W.mediaType,W.representation?W.representation.indexRange:null)}function X(){o.reset(),l.reset()}return c={initialize:L,getSegmentBaseInitSegment:U,getSegmentList:k,reset:X},A(),c}f.__dashjs_factory_name="SegmentBaseController";var y=I.default.getSingletonFactory(f);const _=y},"./src/dash/controllers/SegmentsController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>T});var I=e("./src/core/FactoryMaker.js"),g=e("./src/dash/utils/TimelineSegmentsGetter.js"),d=e("./src/dash/utils/TemplateSegmentsGetter.js"),f=e("./src/dash/utils/ListSegmentsGetter.js"),y=e("./src/dash/utils/SegmentBaseGetter.js");function _(M){M=M||{};var p=this.context,C=M.dashConstants,v=M.type,E=M.segmentBaseController,i,t;function m(){t={}}function n(L){t[C.SEGMENT_TIMELINE]=(0,g.default)(p).create(M,L),t[C.SEGMENT_TEMPLATE]=(0,d.default)(p).create(M,L),t[C.SEGMENT_LIST]=(0,f.default)(p).create(M,L),t[C.SEGMENT_BASE]=(0,y.default)(p).create(M,L)}function h(L,U){return U?Promise.resolve():E.getSegmentBaseInitSegment({representation:L,mediaType:v})}function c(L,U){return U?Promise.resolve():E.getSegmentList({mimeType:L.mimeType,representation:L,mediaType:v})}function o(L){return L?L.segments?t[C.SEGMENT_BASE]:t[L.segmentInfoType]:null}function l(L,U,k){var X=o(L);return X?X.getSegmentByIndex(L,U,k):null}function A(L,U){var k=o(L);return k?k.getSegmentByTime(L,U):null}function S(L){var U=o(L);return U?U.getMediaFinishedInformation(L):{numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN}}return i={initialize:n,updateInitData:h,updateSegmentData:c,getSegmentByIndex:l,getSegmentByTime:A,getMediaFinishedInformation:S},m(),i}_.__dashjs_factory_name="SegmentsController";var r=I.default.getClassFactory(_);const T=r},"./src/dash/controllers/ServiceDescriptionController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>T});var I=e("./src/core/FactoryMaker.js"),g=e("./src/core/Debug.js"),d=e("./src/streaming/constants/Constants.js"),f=e("./src/dash/constants/DashConstants.js"),y=[d.default.SERVICE_DESCRIPTION_DVB_LL_SCHEME],_={VIDEO:"video",AUDIO:"audio",ANY:"any",ALL:"all"};function r(){var M=this.context,p,C,v,E,i;function t(){E=(0,g.default)(M).getInstance().getLogger(p),h()}function m(j){j&&j.adapter&&(i=j.adapter)}function n(){h()}function h(){C={liveDelay:NaN,liveCatchup:{maxDrift:NaN,playbackRate:{min:NaN,max:NaN}},minBitrate:{},maxBitrate:{},initialBitrate:{}},v=[]}function c(){return C}function o(j){if(!(!j||!j.serviceDescriptions)){var Q=j.serviceDescriptions.filter(function(J){return y.includes(J.schemeIdUri)}),q=j.serviceDescriptions.filter(function(J){return J.schemeIdUri==null}),Y=Q.length>0?Q[Q.length-1]:q[q.length-1];Y&&(Y.latency&&Y.latency.target>0&&l(Y),Y.playbackRate&&L(Y),Y.operatingQuality,Y.operatingBandwidth&&U(Y))}}function l(j){var Q;if(j.schemeIdUri===d.default.SERVICE_DESCRIPTION_DVB_LL_SCHEME?Q=S(j):Q=A(j),v.length>0){var q=b(Q),Y=q.to,J=q.id;C.liveDelay=Q.liveDelay-Y,C.liveCatchup.maxDrift=Q.maxDrift,E.debug(`
                Found latency properties coming from service description. Applied time offset of `.concat(Y," from ProducerReferenceTime element with id ").concat(J,`.
                Live Delay: `).concat(Q.liveDelay-Y,", Live catchup max drift: ").concat(Q.maxDrift,`
            `))}else C.liveDelay=Q.liveDelay,C.liveCatchup.maxDrift=Q.maxDrift,E.debug("Found latency properties coming from service description: Live Delay: ".concat(Q.liveDelay,", Live catchup max drift: ").concat(Q.maxDrift))}function A(j){var Q=j.latency.target/1e3,q=!isNaN(j.latency.max)&&j.latency.max>j.latency.target?(j.latency.max-j.latency.target+500)/1e3:NaN,Y=j.latency.referenceId||NaN;return{liveDelay:Q,maxDrift:q,referenceId:Y}}function S(j){var Q=j.latency.target/1e3,q=!isNaN(j.latency.max)&&j.latency.max>j.latency.target?(j.latency.max-j.latency.target+500)/1e3:NaN,Y=j.latency.referenceId||NaN;return{liveDelay:Q,maxDrift:q,referenceId:Y}}function L(j){var Q=j.playbackRate.min?Math.round((j.playbackRate.min-1)*1e3)/1e3:NaN,q=j.playbackRate.max?Math.round((j.playbackRate.max-1)*1e3)/1e3:NaN;C.liveCatchup.playbackRate.min=Q,C.liveCatchup.playbackRate.max=q,E.debug("Found latency properties coming from service description: Live catchup min playback rate: ".concat(Q)),E.debug("Found latency properties coming from service description: Live catchup max playback rate: ".concat(q))}function U(j){if(!(!j||!j.operatingBandwidth||!j.operatingBandwidth.mediaType||j.operatingBandwidth.mediaType===_.ALL)){var Q={};Q.minBandwidth=j.operatingBandwidth.min,Q.maxBandwidth=j.operatingBandwidth.max,Q.targetBandwidth=j.operatingBandwidth.target;var q=[];j.operatingBandwidth.mediaType===_.VIDEO||j.operatingBandwidth.mediaType===_.AUDIO?q.push(j.operatingBandwidth.mediaType):j.operatingBandwidth.mediaType===_.ANY&&(q.push(_.AUDIO),q.push(_.VIDEO)),q.forEach(function(Y){isNaN(Q.minBandwidth)||k("minBitrate",Y,Q.minBandwidth),isNaN(Q.maxBandwidth)||k("maxBitrate",Y,Q.maxBandwidth),isNaN(Q.targetBandwidth)||k("initialBitrate",Y,Q.targetBandwidth)})}}function k(j,Q,q){try{C[j][Q]=q/1e3}catch(Y){E.error(Y)}}function X(){return v}function W(j){try{var Q=[];if(j&&j.length>0){var q=[d.default.VIDEO,d.default.AUDIO,d.default.TEXT],Y=i.getAvailabilityStartTime()/1e3;j.forEach(function(J){var $=q.reduce(function(ae,K){return ae=ae.concat(i.getAllMediaInfoForType(J,K)),ae},[]).reduce(function(ae,K){var ee=i.getProducerReferenceTimes(J,K);return ee.forEach(function(se){var ue=i.getVoRepresentations(K);if(ue&&ue.length>0&&ue[0].adaptation&&ue[0].segmentInfoType===f.default.SEGMENT_TEMPLATE){var oe=ue[0],Z=new Date(se[f.default.WALL_CLOCK_TIME]),H=Z.getTime()/1e3,V=H-(se[f.default.PRESENTATION_TIME]/oe[f.default.TIMESCALE]-oe[f.default.PRESENTATION_TIME_OFFSET]+J.start),te=Y-V;ae.push({id:se[f.default.ID],to:te})}}),ae},[]);Q=Q.concat($)})}v=Q}catch(J){E.error(J),v=[]}}function b(j){var Q=0,q,Y=v.filter(function(J){return J.id===j.referenceId});return Y.length===0?(Q=v.length>0?v[0].to:0,q=v[0].id||NaN):(Q=Y[0].to||0,q=Y[0].id||NaN),{to:Q,id:q}}return p={getServiceDescriptionSettings:c,getProducerReferenceTimeOffsets:X,calculateProducerReferenceTimeOffsets:W,applyServiceDescription:o,reset:n,setConfig:m},t(),p}r.__dashjs_factory_name="ServiceDescriptionController";const T=I.default.getSingletonFactory(r)},"./src/dash/models/DashManifestModel.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>W});var I=e("./src/streaming/constants/Constants.js"),g=e("./src/dash/constants/DashConstants.js"),d=e("./src/dash/vo/Representation.js"),f=e("./src/dash/vo/AdaptationSet.js"),y=e("./src/dash/vo/Period.js"),_=e("./src/dash/vo/Mpd.js"),r=e("./src/dash/vo/UTCTiming.js"),T=e("./src/dash/vo/Event.js"),M=e("./src/dash/vo/BaseURL.js"),p=e("./src/dash/vo/EventStream.js"),C=e("./src/dash/vo/ProducerReferenceTime.js"),v=e("./src/dash/vo/ContentSteering.js"),E=e("./src/streaming/utils/ObjectUtils.js"),i=e("./src/streaming/utils/URLUtils.js"),t=e("./src/core/FactoryMaker.js"),m=e("./src/core/Debug.js"),n=e("./src/streaming/vo/DashJSError.js"),h=e("./src/core/errors/Errors.js"),c=e("./src/streaming/thumbnail/ThumbnailTracks.js");function o(b,j){var Q;if(typeof Symbol>"u"||b[Symbol.iterator]==null){if(Array.isArray(b)||(Q=S(b))||j&&b&&typeof b.length=="number"){Q&&(b=Q);var q=0,Y=function(){};return{s:Y,n:function(){return q>=b.length?{done:!0}:{done:!1,value:b[q++]}},e:function(ee){throw ee},f:Y}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var J=!0,$=!1,ae;return{s:function(){Q=b[Symbol.iterator]()},n:function(){var ee=Q.next();return J=ee.done,ee},e:function(ee){$=!0,ae=ee},f:function(){try{!J&&Q.return!=null&&Q.return()}finally{if($)throw ae}}}}function l(b){return U(b)||L(b)||S(b)||A()}function A(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function S(b,j){if(b){if(typeof b=="string")return k(b,j);var Q=Object.prototype.toString.call(b).slice(8,-1);if(Q==="Object"&&b.constructor&&(Q=b.constructor.name),Q==="Map"||Q==="Set")return Array.from(b);if(Q==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(Q))return k(b,j)}}function L(b){if(typeof Symbol<"u"&&Symbol.iterator in Object(b))return Array.from(b)}function U(b){if(Array.isArray(b))return k(b)}function k(b,j){(j==null||j>b.length)&&(j=b.length);for(var Q=0,q=new Array(j);Q<j;Q++)q[Q]=b[Q];return q}function X(){var b,j,Q,q,Y=this.context,J=(0,i.default)(Y).getInstance(),$=Number.isInteger||function(de){return typeof de=="number"&&isFinite(de)&&Math.floor(de)===de};function ae(){j=(0,m.default)(Y).getInstance().getLogger(b)}function K(de,we){if(!de)throw new Error("adaptation is not defined");if(!we)throw new Error("type is not defined");if(de.Representation_asArray&&de.Representation_asArray.length){var qe=Ye(de.Representation_asArray[0]);if(qe&&qe.length>0&&c.THUMBNAILS_SCHEME_ID_URIS.indexOf(qe[0].schemeIdUri)>=0)return we===I.default.IMAGE}if(de.ContentComponent_asArray&&de.ContentComponent_asArray.length>0){if(de.ContentComponent_asArray.length>1)return we===I.default.MUXED;if(de.ContentComponent_asArray[0].contentType===we)return!0}var Te=we===I.default.TEXT?new RegExp("(ttml|vtt|wvtt|stpp)"):new RegExp(we);if(de.Representation_asArray&&de.Representation_asArray.length){var Ie=de.Representation_asArray[0].codecs;if(Te.test(Ie))return!0}if(de.hasOwnProperty(g.default.MIME_TYPE))return Te.test(de.mimeType);if(de.Representation_asArray){for(var Ke,it=0;it<de.Representation_asArray.length;it++)if(Ke=de.Representation_asArray[it],Ke.hasOwnProperty(g.default.MIME_TYPE))return Te.test(Ke.mimeType)}return!1}function ee(de){if(!de)throw new Error("adaptation is not defined");if(de.hasOwnProperty(g.default.SEGMENT_TEMPLATE)||de.hasOwnProperty(g.default.SEGMENT_TIMELINE)||de.hasOwnProperty(g.default.SEGMENT_LIST)||de.hasOwnProperty(g.default.SEGMENT_BASE))return!0;if(de.Representation_asArray&&de.Representation_asArray.length>0){var we=de.Representation_asArray[0];if(we.hasOwnProperty(g.default.SEGMENT_TEMPLATE)||we.hasOwnProperty(g.default.SEGMENT_TIMELINE)||we.hasOwnProperty(g.default.SEGMENT_LIST)||we.hasOwnProperty(g.default.SEGMENT_BASE))return!0}return!1}function se(de){return K(de,I.default.AUDIO)}function ue(de){return K(de,I.default.VIDEO)}function oe(de){return K(de,I.default.TEXT)}function Z(de){return K(de,I.default.MUXED)}function H(de){return K(de,I.default.IMAGE)}function V(de){var we=de&&de.hasOwnProperty(g.default.PRODUCERREFERENCETIME_ASARRAY)?de[g.default.PRODUCERREFERENCETIME_ASARRAY]:[],qe=de&&de.hasOwnProperty(g.default.REPRESENTATION_ASARRAY)?de[g.default.REPRESENTATION_ASARRAY]:[];qe.forEach(function(Ie){Ie.hasOwnProperty(g.default.PRODUCERREFERENCETIME_ASARRAY)&&we.push.apply(we,l(Ie[g.default.PRODUCERREFERENCETIME_ASARRAY]))});var Te=[];return we.forEach(function(Ie){var Ke=new C.default;if(Ie.hasOwnProperty(g.default.ID))Ke[g.default.ID]=Ie[g.default.ID];else return;if(Ie.hasOwnProperty(g.default.WALL_CLOCK_TIME))Ke[g.default.WALL_CLOCK_TIME]=Ie[g.default.WALL_CLOCK_TIME];else return;if(Ie.hasOwnProperty(g.default.PRESENTATION_TIME))Ke[g.default.PRESENTATION_TIME]=Ie[g.default.PRESENTATION_TIME];else return;Te.push(Ke)}),Te}function te(de){var we="";return de&&de.hasOwnProperty(g.default.LANG)&&(we=de.lang),we}function z(de){return de&&de.hasOwnProperty(g.default.VIEWPOINT)?de.Viewpoint:null}function R(de){return de&&de.hasOwnProperty(g.default.ROLE_ASARRAY)?de.Role_asArray:[]}function u(de){return de&&de.hasOwnProperty(g.default.ACCESSIBILITY_ASARRAY)?de.Accessibility_asArray:[]}function D(de){return de&&de.hasOwnProperty(g.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?de.AudioChannelConfiguration_asArray:[]}function F(de){return de&&de.hasOwnProperty(g.default.AUDIOCHANNELCONFIGURATION_ASARRAY)?de.AudioChannelConfiguration_asArray:[]}function w(){return function(de,we){return de.bandwidth-we.bandwidth}}function O(de){return de&&Array.isArray(de.Representation_asArray)&&de.Representation_asArray.sort(w()),de}function P(de,we){return de&&de.Period_asArray&&$(we)?de.Period_asArray[we]?de.Period_asArray[we].AdaptationSet_asArray:[]:[]}function B(de){return de&&de.Period_asArray?de.Period_asArray:[]}function x(de,we){var qe=B(we);return qe.length>0&&$(de)?qe[de]:null}function ne(de,we,qe){var Te=P(we,qe),Ie,Ke;for(Ie=0,Ke=Te.length;Ie<Ke;Ie++)if(Te[Ie].hasOwnProperty(g.default.ID)&&Te[Ie].id===de)return Te[Ie];return null}function re(de,we,qe){var Te=P(we,qe);return Te.length>0&&$(de)?Te[de]:null}function G(de,we,qe){if(!de)return-1;for(var Te=P(we,qe),Ie=0;Ie<Te.length;Ie++){var Ke=(0,E.default)(Y).getInstance();if(Ke.areEqual(Te[Ie],de))return Ie}return-1}function fe(de,we,qe){var Te=P(de,we),Ie,Ke,it=[];for(Ie=0,Ke=Te.length;Ie<Ke;Ie++)K(Te[Ie],qe)&&it.push(O(Te[Ie]));return it}function le(de,we,qe){var Te=null;if(de&&de.Representation_asArray&&de.Representation_asArray.length>0){var Ie=$(we)&&we>=0&&we<de.Representation_asArray.length?de.Representation_asArray[we]:de.Representation_asArray[0];Ie&&(Te=Ie.mimeType+';codecs="'+Ie.codecs+'"',qe&&Ie.width!==void 0&&(Te+=';width="'+Ie.width+'";height="'+Ie.height+'"'))}return Te&&(Te=Te.replace(/\sprofiles=[^;]*/g,"")),Te}function _e(de){return de&&de.Representation_asArray&&de.Representation_asArray.length>0?de.Representation_asArray[0].mimeType:null}function Me(de){return!de||!de.hasOwnProperty(g.default.CENC_DEFAULT_KID)?null:de[g.default.CENC_DEFAULT_KID]}function Oe(de){if(!de||!Array.isArray(de.Label_asArray))return[];for(var we=[],qe=0;qe<de.Label_asArray.length;qe++)we.push({lang:de.Label_asArray[qe].lang,text:de.Label_asArray[qe].__text||de.Label_asArray[qe]});return we}function Ne(de){return!de||!de.hasOwnProperty(g.default.CONTENTPROTECTION_ASARRAY)||de.ContentProtection_asArray.length===0?null:de.ContentProtection_asArray}function xe(de){var we=!1;return de&&de.hasOwnProperty("type")&&(we=de.type===g.default.DYNAMIC),we}function Se(de){return de&&de[g.default.ID]||null}function me(de,we){var qe=!1;return de&&de.profiles&&de.profiles.length>0&&(qe=de.profiles.indexOf(we)!==-1),qe}function Ae(de){var we;return de&&de.hasOwnProperty(g.default.MEDIA_PRESENTATION_DURATION)?we=de.mediaPresentationDuration:de&&de.type=="dynamic"?we=Number.POSITIVE_INFINITY:we=Number.MAX_SAFE_INTEGER||Number.MAX_VALUE,we}function He(de){return de&&de.bandwidth?de.bandwidth:NaN}function Qe(de){var we=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,qe=NaN;return de&&de.hasOwnProperty(g.default.MINIMUM_UPDATE_PERIOD)&&(qe=de.minimumUpdatePeriod),isNaN(qe)?qe:Math.max(qe-we,1)}function Je(de){return de&&de.hasOwnProperty(g.default.PUBLISH_TIME)?new Date(de[g.default.PUBLISH_TIME]):null}function ye(de){return de&&Array.isArray(de.Representation_asArray)?de.Representation_asArray.length:0}function Fe(de){var we=O(de),qe=we&&Array.isArray(we.Representation_asArray)?we.Representation_asArray:[];return qe.map(function(Te){return{bandwidth:Te.bandwidth,width:Te.width||0,height:Te.height||0,scanType:Te.scanType||null,id:Te.id||null}})}function Be(de){try{var we=de&&typeof de.selectionPriority<"u"?parseInt(de.selectionPriority):1;return isNaN(we)?1:we}catch{return 1}}function Ye(de){return!de||!de.EssentialProperty_asArray||!de.EssentialProperty_asArray.length?null:de.EssentialProperty_asArray.map(function(we){return{schemeIdUri:we.schemeIdUri,value:we.value}})}function Ze(de,we){return we&&we.Representation_asArray&&we.Representation_asArray.length>0&&$(de)?we.Representation_asArray[de]:null}function tt(de){if(de&&de.period&&$(de.period.index)){var we=de.period.mpd.manifest.Period_asArray[de.period.index];if(we&&we.AdaptationSet_asArray&&$(de.index))return O(we.AdaptationSet_asArray[de.index])}}function nt(de){var we=[],qe=tt(de),Te,Ie;if(qe&&qe.Representation_asArray){if(de&&de.period&&$(de.period.index)){var Ke=ve(de.period.mpd.manifest);Ke&&(Ie=Ke[0])}for(var it=0,pt=qe.Representation_asArray.length;it<pt;++it){var Et=qe.Representation_asArray[it],gt=new d.default;if(gt.index=it,gt.adaptation=de,Et.hasOwnProperty(g.default.ID)&&(gt.id=Et.id),Et.hasOwnProperty(g.default.CODECS)&&(gt.codecs=Et.codecs),Et.hasOwnProperty(g.default.MIME_TYPE)&&(gt.mimeType=Et[g.default.MIME_TYPE]),Et.hasOwnProperty(g.default.CODEC_PRIVATE_DATA)&&(gt.codecPrivateData=Et.codecPrivateData),Et.hasOwnProperty(g.default.BANDWITH)&&(gt.bandwidth=Et.bandwidth),Et.hasOwnProperty(g.default.WIDTH)&&(gt.width=Et.width),Et.hasOwnProperty(g.default.HEIGHT)&&(gt.height=Et.height),Et.hasOwnProperty(g.default.SCAN_TYPE)&&(gt.scanType=Et.scanType),Et.hasOwnProperty(g.default.MAX_PLAYOUT_RATE)&&(gt.maxPlayoutRate=Et.maxPlayoutRate),Et.hasOwnProperty(g.default.SEGMENT_BASE)?(Te=Et.SegmentBase,gt.segmentInfoType=g.default.SEGMENT_BASE):Et.hasOwnProperty(g.default.SEGMENT_LIST)?(Te=Et.SegmentList,Te.hasOwnProperty(g.default.SEGMENT_TIMELINE)?gt.segmentInfoType=g.default.SEGMENT_TIMELINE:gt.segmentInfoType=g.default.SEGMENT_LIST):Et.hasOwnProperty(g.default.SEGMENT_TEMPLATE)?(Te=Et.SegmentTemplate,Te.hasOwnProperty(g.default.SEGMENT_TIMELINE)?gt.segmentInfoType=g.default.SEGMENT_TIMELINE:gt.segmentInfoType=g.default.SEGMENT_TEMPLATE,Te.hasOwnProperty(g.default.INITIALIZATION_MINUS)&&(gt.initialization=Te.initialization.split("$Bandwidth$").join(Et.bandwidth).split("$RepresentationID$").join(Et.id))):gt.segmentInfoType=g.default.BASE_URL,gt.essentialProperties=Ye(Et),Te){if(Te.hasOwnProperty(g.default.INITIALIZATION)){var Nt=Te.Initialization;Nt.hasOwnProperty(g.default.SOURCE_URL)&&(gt.initialization=Nt.sourceURL),Nt.hasOwnProperty(g.default.RANGE)&&(gt.range=Nt.range)}else oe(qe)&&ee(qe)&&qe.mimeType&&qe.mimeType.indexOf("application/mp4")===-1&&(gt.range=0);Te.hasOwnProperty(g.default.TIMESCALE)&&(gt.timescale=Te.timescale),Te.hasOwnProperty(g.default.DURATION)?gt.segmentDuration=Te.duration/gt.timescale:Et.hasOwnProperty(g.default.SEGMENT_TEMPLATE)&&(Te=Et.SegmentTemplate,Te.hasOwnProperty(g.default.SEGMENT_TIMELINE)&&(gt.segmentDuration=ht(Te.SegmentTimeline)/gt.timescale)),Te.hasOwnProperty(g.default.MEDIA)&&(gt.media=Te.media),Te.hasOwnProperty(g.default.START_NUMBER)&&(gt.startNumber=Te.startNumber),Te.hasOwnProperty(g.default.INDEX_RANGE)&&(gt.indexRange=Te.indexRange),Te.hasOwnProperty(g.default.PRESENTATION_TIME_OFFSET)&&(gt.presentationTimeOffset=Te.presentationTimeOffset/gt.timescale),Te.hasOwnProperty(g.default.AVAILABILITY_TIME_OFFSET)?gt.availabilityTimeOffset=Te.availabilityTimeOffset:Ie&&Ie.availabilityTimeOffset!==void 0&&(gt.availabilityTimeOffset=Ie.availabilityTimeOffset),Te.hasOwnProperty(g.default.AVAILABILITY_TIME_COMPLETE)?gt.availabilityTimeComplete=Te.availabilityTimeComplete!=="false":Ie&&Ie.availabilityTimeComplete!==void 0&&(gt.availabilityTimeComplete=Ie.availabilityTimeComplete)}gt.MSETimeOffset=je(gt),gt.path=[de.period.index,de.index,it],we.push(gt)}}return we}function ht(de){if(!de||!de.S_asArray)return NaN;var we=de.S_asArray[0],qe=de.S_asArray[1];return we.hasOwnProperty("d")?we.d:qe.t-we.t}function je(de){var we=de.presentationTimeOffset,qe=de.adaptation.period.start;return qe-we}function ge(de){var we=de&&$(de.index)?de.mpd.manifest.Period_asArray[de.index]:null,qe=[],Te,Ie,Ke;if(we&&we.AdaptationSet_asArray)for(Ke=0;Ke<we.AdaptationSet_asArray.length;Ke++)Ie=we.AdaptationSet_asArray[Ke],Te=new f.default,Ie.hasOwnProperty(g.default.ID)&&(Te.id=Ie.id),Te.index=Ke,Te.period=de,Z(Ie)?Te.type=I.default.MUXED:se(Ie)?Te.type=I.default.AUDIO:ue(Ie)?Te.type=I.default.VIDEO:oe(Ie)?Te.type=I.default.TEXT:H(Ie)?Te.type=I.default.IMAGE:j.warn("Unknown Adaptation stream type"),qe.push(Te);return qe}function ie(de){var we=de?xe(de.manifest):!1,qe=[],Te=null,Ie=null,Ke=null,it=null,pt,Et;for(Et=0,pt=de&&de.manifest&&de.manifest.Period_asArray?de.manifest.Period_asArray.length:0;Et<pt;Et++)Ie=de.manifest.Period_asArray[Et],Ie.hasOwnProperty(g.default.START)?(it=new y.default,it.start=Ie.start):Te!==null&&Te.hasOwnProperty(g.default.DURATION)&&Ke!==null?(it=new y.default,it.start=parseFloat((Ke.start+Ke.duration).toFixed(5))):Et===0&&!we&&(it=new y.default,it.start=0),Ke!==null&&isNaN(Ke.duration)&&(it!==null?Ke.duration=parseFloat((it.start-Ke.start).toFixed(5)):j.warn("First period duration could not be calculated because lack of start and duration period properties. This will cause timing issues during playback")),it!==null&&(it.id=he(Ie,Et),it.index=Et,it.mpd=de,Ie.hasOwnProperty(g.default.DURATION)&&(it.duration=Ie.duration),Ke&&(Ke.nextPeriodId=it.id),qe.push(it),Te=Ie,Ke=it),Ie=null,it=null;return qe.length===0||Ke!==null&&isNaN(Ke.duration)&&(Ke.duration=parseFloat((We(Ke)-Ke.start).toFixed(5))),qe}function he(de,we){if(!de)throw new Error("Period cannot be null or undefined");var qe=y.default.DEFAULT_ID+"_"+we;return de.hasOwnProperty(g.default.ID)&&de.id.length>0&&de.id!=="__proto__"&&(qe=de.id),qe}function De(de){var we=new _.default;return de&&(we.manifest=de,de.hasOwnProperty(g.default.AVAILABILITY_START_TIME)?we.availabilityStartTime=new Date(de.availabilityStartTime.getTime()):de.loadedTime&&(we.availabilityStartTime=new Date(de.loadedTime.getTime())),de.hasOwnProperty(g.default.AVAILABILITY_END_TIME)&&(we.availabilityEndTime=new Date(de.availabilityEndTime.getTime())),de.hasOwnProperty(g.default.MINIMUM_UPDATE_PERIOD)&&(we.minimumUpdatePeriod=de.minimumUpdatePeriod),de.hasOwnProperty(g.default.MEDIA_PRESENTATION_DURATION)&&(we.mediaPresentationDuration=de.mediaPresentationDuration),de.hasOwnProperty(g.default.SUGGESTED_PRESENTATION_DELAY)&&(we.suggestedPresentationDelay=de.suggestedPresentationDelay),de.hasOwnProperty(g.default.TIMESHIFT_BUFFER_DEPTH)&&(we.timeShiftBufferDepth=de.timeShiftBufferDepth),de.hasOwnProperty(g.default.MAX_SEGMENT_DURATION)&&(we.maxSegmentDuration=de.maxSegmentDuration),de.hasOwnProperty(g.default.PUBLISH_TIME)&&(we.publishTime=new Date(de.publishTime))),we}function Ce(){if(!Q||!Q.hasOwnProperty("error"))throw new Error(I.default.MISSING_CONFIG_ERROR)}function We(de){Ce();var we=xe(de.mpd.manifest),qe;return de.mpd.manifest.mediaPresentationDuration?qe=de.mpd.manifest.mediaPresentationDuration:de.duration?qe=de.duration:we?qe=Number.POSITIVE_INFINITY:Q.error(new n.default(h.default.MANIFEST_ERROR_ID_PARSE_CODE,"Must have @mediaPresentationDuration on MPD or an explicit @duration on the last period.",de)),qe}function Xe(de){var we=de&&de.mpd&&de.mpd.manifest?de.mpd.manifest:null,qe=we?we.Period_asArray:null,Te=qe&&de&&$(de.index)?qe[de.index].EventStream_asArray:null,Ie=[],Ke,it;if(Te)for(Ke=0;Ke<Te.length;Ke++){var pt=new p.default;if(pt.period=de,pt.timescale=1,Te[Ke].hasOwnProperty(I.default.SCHEME_ID_URI))pt.schemeIdUri=Te[Ke][I.default.SCHEME_ID_URI];else throw new Error("Invalid EventStream. SchemeIdUri has to be set");for(Te[Ke].hasOwnProperty(g.default.TIMESCALE)&&(pt.timescale=Te[Ke][g.default.TIMESCALE]),Te[Ke].hasOwnProperty(g.default.VALUE)&&(pt.value=Te[Ke][g.default.VALUE]),Te[Ke].hasOwnProperty(g.default.PRESENTATION_TIME_OFFSET)&&(pt.presentationTimeOffset=Te[Ke][g.default.PRESENTATION_TIME_OFFSET]),it=0;Te[Ke].Event_asArray&&it<Te[Ke].Event_asArray.length;it++){var Et=Te[Ke].Event_asArray[it],gt=new T.default;gt.presentationTime=0,gt.eventStream=pt,Et.hasOwnProperty(g.default.PRESENTATION_TIME)&&(gt.presentationTime=Et.presentationTime);var Nt=pt.presentationTimeOffset?pt.presentationTimeOffset/pt.timescale:0;gt.calculatedPresentationTime=gt.presentationTime/pt.timescale+de.start-Nt,Et.hasOwnProperty(g.default.DURATION)&&(gt.duration=Et.duration/pt.timescale),Et.hasOwnProperty(g.default.ID)?gt.id=Et.id:gt.id=null,Et.Signal&&Et.Signal.Binary?gt.messageData=q.decodeArray(Et.Signal.Binary.toString()):gt.messageData=Et.messageData||Et.__cdata||Et.__text,Ie.push(gt)}}return Ie}function Ve(de,we,qe){var Te=[],Ie;if(!de)return Te;for(Ie=0;Ie<de.length;Ie++){var Ke=new p.default;if(Ke.timescale=1,Ke.representation=we,de[Ie].hasOwnProperty(I.default.SCHEME_ID_URI))Ke.schemeIdUri=de[Ie].schemeIdUri;else throw new Error("Invalid EventStream. SchemeIdUri has to be set");de[Ie].hasOwnProperty(g.default.TIMESCALE)&&(Ke.timescale=de[Ie].timescale),de[Ie].hasOwnProperty(g.default.VALUE)&&(Ke.value=de[Ie].value),Te.push(Ke),Ke.period=qe}return Te}function rt(de,we,qe){var Te,Ie,Ke;return de&&de.Period_asArray&&we&&we.period&&$(we.period.index)&&(Ie=de.Period_asArray[we.period.index],Ie&&Ie.AdaptationSet_asArray&&$(we.index)&&(Ke=Ie.AdaptationSet_asArray[we.index],Ke&&(Te=Ke.InbandEventStream_asArray))),Ve(Te,null,qe)}function ut(de,we,qe){var Te,Ie,Ke,it;return de&&de.Period_asArray&&we&&we.adaptation&&we.adaptation.period&&$(we.adaptation.period.index)&&(Ie=de.Period_asArray[we.adaptation.period.index],Ie&&Ie.AdaptationSet_asArray&&$(we.adaptation.index)&&(Ke=Ie.AdaptationSet_asArray[we.adaptation.index],Ke&&Ke.Representation_asArray&&$(we.index)&&(it=Ke.Representation_asArray[we.index],it&&(Te=it.InbandEventStream_asArray)))),Ve(Te,we,qe)}function mt(de){var we=xe(de),qe=de?de.hasOwnProperty(g.default.AVAILABILITY_START_TIME):!1,Te=de?de.UTCTiming_asArray:null,Ie=[];return(we||qe)&&Te&&Te.forEach(function(Ke){var it=new r.default;if(Ke.hasOwnProperty(I.default.SCHEME_ID_URI))it.schemeIdUri=Ke.schemeIdUri;else return;if(Ke.hasOwnProperty(g.default.VALUE))it.value=Ke.value.toString();else return;Ie.push(it)}),Ie}function ve(de){var we=[],qe=de.BaseURL_asArray||[de.baseUri],Te=!1;return qe.some(function(Ie){if(Ie){var Ke=new M.default,it=Ie.__text||Ie;return J.isRelative(it)&&(Te=!0,de.baseUri&&(it=J.resolve(it,de.baseUri))),Ke.url=it,Ie.hasOwnProperty(g.default.SERVICE_LOCATION)&&Ie.serviceLocation.length?Ke.serviceLocation=Ie.serviceLocation:Ke.serviceLocation=it,Ie.hasOwnProperty(g.default.DVB_PRIORITY)&&(Ke.dvb_priority=Ie[g.default.DVB_PRIORITY]),Ie.hasOwnProperty(g.default.DVB_WEIGHT)&&(Ke.dvb_weight=Ie[g.default.DVB_WEIGHT]),Ie.hasOwnProperty(g.default.AVAILABILITY_TIME_OFFSET)&&(Ke.availabilityTimeOffset=Ie[g.default.AVAILABILITY_TIME_OFFSET]),Ie.hasOwnProperty(g.default.AVAILABILITY_TIME_COMPLETE)&&(Ke.availabilityTimeComplete=Ie[g.default.AVAILABILITY_TIME_COMPLETE]!=="false"),we.push(Ke),Te}}),we}function Le(de){if(de&&de.hasOwnProperty(g.default.CONTENT_STEERING_AS_ARRAY)){var we=de[g.default.CONTENT_STEERING_AS_ARRAY][0],qe=new v.default;return qe.serverUrl=we.__text,we.hasOwnProperty(g.default.DEFAULT_SERVICE_LOCATION)&&(qe.defaultServiceLocation=we[g.default.DEFAULT_SERVICE_LOCATION]),we.hasOwnProperty(g.default.QUERY_BEFORE_START)&&(qe.queryBeforeStart=we[g.default.QUERY_BEFORE_START].toLowerCase()==="true"),we.hasOwnProperty(g.default.PROXY_SERVER_URL)&&(qe.proxyServerUrl=we[g.default.PROXY_SERVER_URL]),qe}}function Ge(de){if(de&&de.hasOwnProperty(I.default.LOCATION))return de.Location=de.Location_asArray[0],de.Location}function at(de){if(de&&de.hasOwnProperty(g.default.PATCH_LOCATION))return de.PatchLocation=de.PatchLocation_asArray[0],de.PatchLocation}function et(de){return de&&de.hasOwnProperty(g.default.SUGGESTED_PRESENTATION_DELAY)?de.suggestedPresentationDelay:null}function lt(de){return de&&de.hasOwnProperty(g.default.AVAILABILITY_START_TIME)&&de.availabilityStartTime!==null?de.availabilityStartTime.getTime():null}function vt(de){var we=[];if(de&&de.hasOwnProperty(g.default.SERVICE_DESCRIPTION)){var qe=o(de.ServiceDescription_asArray),Te;try{for(qe.s();!(Te=qe.n()).done;){var Ie=Te.value,Ke=null,it=null,pt=null,Et=null,gt=null,Nt=null;for(var Dt in Ie)Ie.hasOwnProperty(Dt)&&(Dt===g.default.ID?Ke=Ie[Dt]:Dt===g.default.SERVICE_DESCRIPTION_SCOPE?it=Ie[Dt].schemeIdUri:Dt===g.default.SERVICE_DESCRIPTION_LATENCY?pt={target:parseInt(Ie[Dt].target),max:parseInt(Ie[Dt].max),min:parseInt(Ie[Dt].min),referenceId:parseInt(Ie[Dt].referenceId)}:Dt===g.default.SERVICE_DESCRIPTION_PLAYBACK_RATE?Et={max:parseFloat(Ie[Dt].max),min:parseFloat(Ie[Dt].min)}:Dt===g.default.SERVICE_DESCRIPTION_OPERATING_QUALITY?gt={mediaType:Ie[Dt].mediaType,max:parseInt(Ie[Dt].max),min:parseInt(Ie[Dt].min),target:parseInt(Ie[Dt].target),type:Ie[Dt].type,maxQualityDifference:parseInt(Ie[Dt].maxQualityDifference)}:Dt===g.default.SERVICE_DESCRIPTION_OPERATING_BANDWIDTH&&(Nt={mediaType:Ie[Dt].mediaType,max:parseInt(Ie[Dt].max),min:parseInt(Ie[Dt].min),target:parseInt(Ie[Dt].target)}));we.push({id:Ke,schemeIdUri:it,latency:pt,playbackRate:Et,operatingQuality:gt,operatingBandwidth:Nt})}}catch(ke){qe.e(ke)}finally{qe.f()}}return we}function Mt(de){var we={};if(de&&de.hasOwnProperty(g.default.SUPPLEMENTAL_PROPERTY)){var qe=o(de.SupplementalProperty_asArray),Te;try{for(qe.s();!(Te=qe.n()).done;){var Ie=Te.value;Ie.hasOwnProperty(I.default.SCHEME_ID_URI)&&Ie.hasOwnProperty(g.default.VALUE)&&(we[Ie[I.default.SCHEME_ID_URI]]=Ie[g.default.VALUE])}}catch(Ke){qe.e(Ke)}finally{qe.f()}}return we}function Ct(de){de&&(de.errHandler&&(Q=de.errHandler),de.BASE64&&(q=de.BASE64))}return b={getIsTypeOf:K,getIsText:oe,getIsFragmented:ee,getProducerReferenceTimesForAdaptation:V,getLanguageForAdaptation:te,getViewpointForAdaptation:z,getRolesForAdaptation:R,getAccessibilityForAdaptation:u,getAudioChannelConfigurationForAdaptation:D,getAudioChannelConfigurationForRepresentation:F,getAdaptationForIndex:re,getIndexForAdaptation:G,getAdaptationForId:ne,getAdaptationsForType:fe,getRealPeriods:B,getRealPeriodForIndex:x,getCodec:le,getSelectionPriority:Be,getMimeType:_e,getKID:Me,getLabelsForAdaptation:Oe,getContentProtectionData:Ne,getIsDynamic:xe,getId:Se,hasProfile:me,getDuration:Ae,getBandwidth:He,getManifestUpdatePeriod:Qe,getPublishTime:Je,getRepresentationCount:ye,getBitrateListForAdaptation:Fe,getRepresentationFor:Ze,getRepresentationsForAdaptation:nt,getAdaptationsForPeriod:ge,getRegularPeriods:ie,getMpd:De,getEventsForPeriod:Xe,getEssentialPropertiesForRepresentation:Ye,getEventStreamForAdaptationSet:rt,getEventStreamForRepresentation:ut,getUTCTimingSources:mt,getBaseURLsFromElement:ve,getRepresentationSortFunction:w,getContentSteering:Le,getLocation:Ge,getPatchLocation:at,getSuggestedPresentationDelay:et,getAvailabilityStartTime:lt,getServiceDescriptions:vt,getSupplementalProperties:Mt,setConfig:Ct},ae(),b}X.__dashjs_factory_name="DashManifestModel";const W=t.default.getSingletonFactory(X)},"./src/dash/models/PatchManifestModel.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>r});var I=e("./src/dash/constants/DashConstants.js"),g=e("./src/core/FactoryMaker.js"),d=e("./src/core/Debug.js"),f=e("./src/dash/vo/SimpleXPath.js"),y=e("./src/dash/vo/PatchOperation.js");function _(){var T,M,p=this.context;function C(){M=(0,d.default)(p).getInstance().getLogger(T)}function v(n){return n&&n.hasOwnProperty(I.default.ORIGINAL_MPD_ID)||!1}function E(n){return n&&n.hasOwnProperty(I.default.PUBLISH_TIME)?new Date(n[I.default.PUBLISH_TIME]):null}function i(n){return n&&n.hasOwnProperty(I.default.ORIGINAL_PUBLISH_TIME)?new Date(n[I.default.ORIGINAL_PUBLISH_TIME]):null}function t(n){return n&&n[I.default.ORIGINAL_MPD_ID]||null}function m(n){return n?(n.__children||[]).map(function(h){var c=Object.keys(h)[0];if(c!=="add"&&c!=="remove"&&c!=="replace")return M.warn("Ignoring node of invalid action: ".concat(c)),null;var o=h[c],l=o.sel;if(c==="add"&&o.type){if(!o.type.startsWith("@"))return M.warn("Ignoring add action for prefixed namespace declaration: ".concat(o.type,"=").concat(o.__text)),null;l="".concat(l,"/").concat(o.type)}var A=new f.default(l);if(!A.isValid())return M.warn("Ignoring action with invalid selector: ".concat(c," - ").concat(l)),null;var S=null;A.findsAttribute()?S=o.__text||"":c!=="remove"&&(S=o.__children.reduce(function(U,k){var X=Object.keys(k)[0];return X!=="#text"&&(U[X]=U[X]||[],U[X].push(k[X])),U},{}));var L=new y.default(c,A,S);return c==="add"&&(L.position=o.pos),L}).filter(function(h){return!!h}):[]}return T={getIsPatch:v,getPublishTime:E,getOriginalPublishTime:i,getMpdId:t,getPatchOperations:m},C(),T}_.__dashjs_factory_name="PatchManifestModel";const r=g.default.getSingletonFactory(_)},"./src/dash/parser/DashParser.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>v});var I=e("./src/core/FactoryMaker.js"),g=e("./src/dash/parser/objectiron.js"),d=e("./externals/xml2json.js"),f=e("./src/dash/parser/matchers/StringMatcher.js"),y=e("./src/dash/parser/matchers/DurationMatcher.js"),_=e("./src/dash/parser/matchers/DateTimeMatcher.js"),r=e("./src/dash/parser/matchers/NumericMatcher.js"),T=e("./src/dash/parser/matchers/LangMatcher.js"),M=e("./src/dash/parser/maps/RepresentationBaseValuesMap.js"),p=e("./src/dash/parser/maps/SegmentValuesMap.js");function C(E){E=E||{};var i=this.context,t=E.debug,m,n,h,c,o;function l(){n=t.getLogger(m),h=[new y.default,new _.default,new r.default,new T.default,new f.default],c=new d.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!0,ignoreRoot:!1,matchers:h}),o=(0,g.default)(i).create({adaptationset:new M.default,period:new p.default})}function A(){return h}function S(){return o}function L(U){var k,X=window.performance.now();if(k=c.xml_str2json(U),!k)throw new Error("parsing the manifest failed");var W=window.performance.now();k.Patch?(k=k.Patch,k.add_asArray&&k.add_asArray.forEach(function(j){return o.run(j)}),k.replace_asArray&&k.replace_asArray.forEach(function(j){return o.run(j)})):(k=k.MPD,o.run(k));var b=window.performance.now();return n.info("Parsing complete: ( xml2json: "+(W-X).toPrecision(3)+"ms, objectiron: "+(b-W).toPrecision(3)+"ms, total: "+((b-X)/1e3).toPrecision(3)+"s)"),k.protocol="DASH",k}return m={parse:L,getMatchers:A,getIron:S},l(),m}C.__dashjs_factory_name="DashParser";const v=I.default.getClassFactory(C)},"./src/dash/parser/maps/CommonProperty.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});function I(_,r){if(!(_ instanceof r))throw new TypeError("Cannot call a class as a function")}function g(_,r){for(var T=0;T<r.length;T++){var M=r[T];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(_,M.key,M)}}function d(_,r,T){return r&&g(_.prototype,r),T&&g(_,T),_}var f=function(){function _(r){I(this,_);var T=function(p){return p&&p.length&&p.charAt(0)===p.charAt(0).toUpperCase()};this._name=r,this._merge=T(r)}return d(_,[{key:"name",get:function(){return this._name}},{key:"merge",get:function(){return this._merge}}]),_}();const y=f},"./src/dash/parser/maps/MapNode.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>_});var I=e("./src/dash/parser/maps/CommonProperty.js");function g(r,T){if(!(r instanceof T))throw new TypeError("Cannot call a class as a function")}function d(r,T){for(var M=0;M<T.length;M++){var p=T[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(r,p.key,p)}}function f(r,T,M){return T&&d(r.prototype,T),M&&d(r,M),r}var y=function(){function r(T,M,p){var C=this;g(this,r),this._name=T||"",this._properties=[],this._children=p||[],Array.isArray(M)&&M.forEach(function(v){C._properties.push(new I.default(v))})}return f(r,[{key:"name",get:function(){return this._name}},{key:"children",get:function(){return this._children}},{key:"properties",get:function(){return this._properties}}]),r}();const _=y},"./src/dash/parser/maps/RepresentationBaseValuesMap.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>E});var I=e("./src/dash/parser/maps/MapNode.js"),g=e("./src/dash/constants/DashConstants.js");function d(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?d=function(m){return typeof m}:d=function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},d(i)}function f(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function y(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),t&&_(i,t)}function _(i,t){return _=Object.setPrototypeOf||function(n,h){return n.__proto__=h,n},_(i,t)}function r(i){var t=p();return function(){var n=C(i),h;if(t){var c=C(this).constructor;h=Reflect.construct(n,arguments,c)}else h=n.apply(this,arguments);return T(this,h)}}function T(i,t){return t&&(d(t)==="object"||typeof t=="function")?t:M(i)}function M(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function p(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function C(i){return C=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)},C(i)}var v=function(i){y(m,i);var t=r(m);function m(){f(this,m);var n=[g.default.PROFILES,g.default.WIDTH,g.default.HEIGHT,g.default.SAR,g.default.FRAMERATE,g.default.AUDIO_SAMPLING_RATE,g.default.MIME_TYPE,g.default.SEGMENT_PROFILES,g.default.CODECS,g.default.MAXIMUM_SAP_PERIOD,g.default.START_WITH_SAP,g.default.MAX_PLAYOUT_RATE,g.default.CODING_DEPENDENCY,g.default.SCAN_TYPE,g.default.FRAME_PACKING,g.default.AUDIO_CHANNEL_CONFIGURATION,g.default.CONTENT_PROTECTION,g.default.ESSENTIAL_PROPERTY,g.default.SUPPLEMENTAL_PROPERTY,g.default.INBAND_EVENT_STREAM];return t.call(this,g.default.ADAPTATION_SET,n,[new I.default(g.default.REPRESENTATION,n,[new I.default(g.default.SUB_REPRESENTATION,n)])])}return m}(I.default);const E=v},"./src/dash/parser/maps/SegmentValuesMap.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>E});var I=e("./src/dash/parser/maps/MapNode.js"),g=e("./src/dash/constants/DashConstants.js");function d(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?d=function(m){return typeof m}:d=function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},d(i)}function f(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function y(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),t&&_(i,t)}function _(i,t){return _=Object.setPrototypeOf||function(n,h){return n.__proto__=h,n},_(i,t)}function r(i){var t=p();return function(){var n=C(i),h;if(t){var c=C(this).constructor;h=Reflect.construct(n,arguments,c)}else h=n.apply(this,arguments);return T(this,h)}}function T(i,t){return t&&(d(t)==="object"||typeof t=="function")?t:M(i)}function M(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function p(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function C(i){return C=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)},C(i)}var v=function(i){y(m,i);var t=r(m);function m(){f(this,m);var n=[g.default.SEGMENT_BASE,g.default.SEGMENT_TEMPLATE,g.default.SEGMENT_LIST];return t.call(this,g.default.PERIOD,n,[new I.default(g.default.ADAPTATION_SET,n,[new I.default(g.default.REPRESENTATION,n)])])}return m}(I.default);const E=v},"./src/dash/parser/matchers/BaseMatcher.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});function I(_,r){if(!(_ instanceof r))throw new TypeError("Cannot call a class as a function")}function g(_,r){for(var T=0;T<r.length;T++){var M=r[T];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(_,M.key,M)}}function d(_,r,T){return r&&g(_.prototype,r),T&&g(_,T),_}var f=function(){function _(r,T){I(this,_),this._test=r,this._converter=T}return d(_,[{key:"test",get:function(){return this._test}},{key:"converter",get:function(){return this._converter}}]),_}();const y=f},"./src/dash/parser/matchers/DateTimeMatcher.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>m});var I=e("./src/dash/parser/matchers/BaseMatcher.js");function g(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(c){return typeof c}:g=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},g(n)}function d(n,h){if(!(n instanceof h))throw new TypeError("Cannot call a class as a function")}function f(n,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(h&&h.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),h&&y(n,h)}function y(n,h){return y=Object.setPrototypeOf||function(o,l){return o.__proto__=l,o},y(n,h)}function _(n){var h=M();return function(){var o=p(n),l;if(h){var A=p(this).constructor;l=Reflect.construct(o,arguments,A)}else l=o.apply(this,arguments);return r(this,l)}}function r(n,h){return h&&(g(h)==="object"||typeof h=="function")?h:T(n)}function T(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function M(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function p(n){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)},p(n)}var C=60,v=60,E=1e3,i=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+-])([0-9]{2})(?::?)([0-9]{2}))?/,t=function(n){f(c,n);var h=_(c);function c(){return d(this,c),h.call(this,function(o){return i.test(o.value)},function(o){var l=i.exec(o),A;if(A=Date.UTC(parseInt(l[1],10),parseInt(l[2],10)-1,parseInt(l[3],10),parseInt(l[4],10),parseInt(l[5],10),l[6]&&parseInt(l[6],10)||0,l[7]&&parseFloat(l[7])*E||0),l[9]&&l[10]){var S=parseInt(l[9],10)*v+parseInt(l[10],10);A+=(l[8]==="+"?-1:1)*S*C*E}return new Date(A)})}return c}(I.default);const m=t},"./src/dash/parser/matchers/DurationMatcher.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>o});var I=e("./src/dash/parser/matchers/BaseMatcher.js"),g=e("./src/streaming/constants/Constants.js"),d=e("./src/dash/constants/DashConstants.js");function f(l){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?f=function(S){return typeof S}:f=function(S){return S&&typeof Symbol=="function"&&S.constructor===Symbol&&S!==Symbol.prototype?"symbol":typeof S},f(l)}function y(l,A){if(!(l instanceof A))throw new TypeError("Cannot call a class as a function")}function _(l,A){if(typeof A!="function"&&A!==null)throw new TypeError("Super expression must either be null or a function");l.prototype=Object.create(A&&A.prototype,{constructor:{value:l,writable:!0,configurable:!0}}),A&&r(l,A)}function r(l,A){return r=Object.setPrototypeOf||function(L,U){return L.__proto__=U,L},r(l,A)}function T(l){var A=C();return function(){var L=v(l),U;if(A){var k=v(this).constructor;U=Reflect.construct(L,arguments,k)}else U=L.apply(this,arguments);return M(this,U)}}function M(l,A){return A&&(f(A)==="object"||typeof A=="function")?A:p(l)}function p(l){if(l===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return l}function C(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function v(l){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(S){return S.__proto__||Object.getPrototypeOf(S)},v(l)}var E=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/,i=365*24*60*60,t=30*24*60*60,m=24*60*60,n=60*60,h=60,c=function(l){_(S,l);var A=T(S);function S(){return y(this,S),A.call(this,function(L){for(var U=[d.default.MIN_BUFFER_TIME,d.default.MEDIA_PRESENTATION_DURATION,d.default.MINIMUM_UPDATE_PERIOD,d.default.TIMESHIFT_BUFFER_DEPTH,d.default.MAX_SEGMENT_DURATION,d.default.MAX_SUBSEGMENT_DURATION,d.default.SUGGESTED_PRESENTATION_DELAY,d.default.START,g.default.START_TIME,d.default.DURATION],k=U.length,X=0;X<k;X++)if(L.nodeName===U[X])return E.test(L.value);return!1},function(L){var U=E.exec(L),k=parseFloat(U[3]||0)*i+parseFloat(U[5]||0)*t+parseFloat(U[7]||0)*m+parseFloat(U[9]||0)*n+parseFloat(U[11]||0)*h+parseFloat(U[13]||0);return U[1]!==void 0&&(k=-k),k})}return S}(I.default);const o=c},"./src/dash/parser/matchers/LangMatcher.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>m});var I=e("./src/dash/parser/matchers/BaseMatcher.js"),g=e("./src/dash/constants/DashConstants.js"),d=e("./node_modules/bcp-47-normalize/index.js"),f=e.n(d);function y(n){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?y=function(c){return typeof c}:y=function(c){return c&&typeof Symbol=="function"&&c.constructor===Symbol&&c!==Symbol.prototype?"symbol":typeof c},y(n)}function _(n,h,c){return h in n?Object.defineProperty(n,h,{value:c,enumerable:!0,configurable:!0,writable:!0}):n[h]=c,n}function r(n,h){if(!(n instanceof h))throw new TypeError("Cannot call a class as a function")}function T(n,h){if(typeof h!="function"&&h!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(h&&h.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),h&&M(n,h)}function M(n,h){return M=Object.setPrototypeOf||function(o,l){return o.__proto__=l,o},M(n,h)}function p(n){var h=E();return function(){var o=i(n),l;if(h){var A=i(this).constructor;l=Reflect.construct(o,arguments,A)}else l=o.apply(this,arguments);return C(this,l)}}function C(n,h){return h&&(y(h)==="object"||typeof h=="function")?h:v(n)}function v(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function E(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function i(n){return i=Object.setPrototypeOf?Object.getPrototypeOf:function(c){return c.__proto__||Object.getPrototypeOf(c)},i(n)}var t=function(n){T(c,n);var h=p(c);function c(){return r(this,c),h.call(this,function(o,l){var A,S=(A={},_(A,g.default.ADAPTATION_SET,[g.default.LANG]),_(A,g.default.REPRESENTATION,[g.default.LANG]),_(A,g.default.CONTENT_COMPONENT,[g.default.LANG]),_(A,g.default.LABEL,[g.default.LANG]),_(A,g.default.GROUP_LABEL,[g.default.LANG]),A);if(S.hasOwnProperty(l)){var L=S[l];return L!==void 0?L.indexOf(o.name)>=0:!1}return!1},function(o){var l=f()(o);return l!==void 0?l:String(o)})}return c}(I.default);const m=t},"./src/dash/parser/matchers/NumericMatcher.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>E});var I=e("./src/dash/parser/matchers/BaseMatcher.js");function g(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(m){return typeof m}:g=function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},g(i)}function d(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function f(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),t&&y(i,t)}function y(i,t){return y=Object.setPrototypeOf||function(n,h){return n.__proto__=h,n},y(i,t)}function _(i){var t=M();return function(){var n=p(i),h;if(t){var c=p(this).constructor;h=Reflect.construct(n,arguments,c)}else h=n.apply(this,arguments);return r(this,h)}}function r(i,t){return t&&(g(t)==="object"||typeof t=="function")?t:T(i)}function T(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function M(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function p(i){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)},p(i)}var C=/^[-+]?[0-9]+[.]?[0-9]*([eE][-+]?[0-9]+)?$/,v=function(i){f(m,i);var t=_(m);function m(){return d(this,m),t.call(this,function(n){return C.test(n.value)},function(n){return parseFloat(n)})}return m}(I.default);const E=v},"./src/dash/parser/matchers/StringMatcher.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>i});var I=e("./src/dash/parser/matchers/BaseMatcher.js"),g=e("./src/dash/constants/DashConstants.js");function d(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?d=function(n){return typeof n}:d=function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},d(t)}function f(t,m,n){return m in t?Object.defineProperty(t,m,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[m]=n,t}function y(t,m){if(!(t instanceof m))throw new TypeError("Cannot call a class as a function")}function _(t,m){if(typeof m!="function"&&m!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(m&&m.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),m&&r(t,m)}function r(t,m){return r=Object.setPrototypeOf||function(h,c){return h.__proto__=c,h},r(t,m)}function T(t){var m=C();return function(){var h=v(t),c;if(m){var o=v(this).constructor;c=Reflect.construct(h,arguments,o)}else c=h.apply(this,arguments);return M(this,c)}}function M(t,m){return m&&(d(m)==="object"||typeof m=="function")?m:p(t)}function p(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function C(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function v(t){return v=Object.setPrototypeOf?Object.getPrototypeOf:function(n){return n.__proto__||Object.getPrototypeOf(n)},v(t)}var E=function(t){_(n,t);var m=T(n);function n(){return y(this,n),m.call(this,function(h,c){var o,l=(o={},f(o,g.default.MPD,[g.default.ID,g.default.PROFILES]),f(o,g.default.PERIOD,[g.default.ID]),f(o,g.default.BASE_URL,[g.default.SERVICE_LOCATION,g.default.BYTE_RANGE]),f(o,g.default.SEGMENT_BASE,[g.default.INDEX_RANGE]),f(o,g.default.INITIALIZATION,[g.default.RANGE]),f(o,g.default.REPRESENTATION_INDEX,[g.default.RANGE]),f(o,g.default.SEGMENT_LIST,[g.default.INDEX_RANGE]),f(o,g.default.BITSTREAM_SWITCHING,[g.default.RANGE]),f(o,g.default.SEGMENT_URL,[g.default.MEDIA_RANGE,g.default.INDEX_RANGE]),f(o,g.default.SEGMENT_TEMPLATE,[g.default.INDEX_RANGE,g.default.MEDIA,g.default.INDEX,g.default.INITIALIZATION_MINUS,g.default.BITSTREAM_SWITCHING_MINUS]),f(o,g.default.ASSET_IDENTIFIER,[g.default.VALUE,g.default.ID]),f(o,g.default.EVENT_STREAM,[g.default.VALUE]),f(o,g.default.ADAPTATION_SET,[g.default.PROFILES,g.default.MIME_TYPE,g.default.SEGMENT_PROFILES,g.default.CODECS,g.default.CONTENT_TYPE]),f(o,g.default.FRAME_PACKING,[g.default.VALUE,g.default.ID]),f(o,g.default.AUDIO_CHANNEL_CONFIGURATION,[g.default.VALUE,g.default.ID]),f(o,g.default.CONTENT_PROTECTION,[g.default.VALUE,g.default.ID]),f(o,g.default.ESSENTIAL_PROPERTY,[g.default.VALUE,g.default.ID]),f(o,g.default.SUPPLEMENTAL_PROPERTY,[g.default.VALUE,g.default.ID]),f(o,g.default.INBAND_EVENT_STREAM,[g.default.VALUE,g.default.ID]),f(o,g.default.ACCESSIBILITY,[g.default.VALUE,g.default.ID]),f(o,g.default.ROLE,[g.default.VALUE,g.default.ID]),f(o,g.default.RATING,[g.default.VALUE,g.default.ID]),f(o,g.default.VIEWPOINT,[g.default.VALUE,g.default.ID]),f(o,g.default.CONTENT_COMPONENT,[g.default.CONTENT_TYPE]),f(o,g.default.REPRESENTATION,[g.default.ID,g.default.DEPENDENCY_ID,g.default.MEDIA_STREAM_STRUCTURE_ID]),f(o,g.default.SUBSET,[g.default.ID]),f(o,g.default.METRICS,[g.default.METRICS_MINUS]),f(o,g.default.REPORTING,[g.default.VALUE,g.default.ID]),o);if(l.hasOwnProperty(c)){var A=l[c];return A!==void 0?A.indexOf(h.name)>=0:!1}return!1},function(h){return String(h)})}return n}(I.default);const i=E},"./src/dash/parser/objectiron.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});var I=e("./src/core/FactoryMaker.js");function g(_){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(T){return typeof T}:g=function(T){return T&&typeof Symbol=="function"&&T.constructor===Symbol&&T!==Symbol.prototype?"symbol":typeof T},g(_)}function d(_){function r(C,v){for(var E in C)v.hasOwnProperty(E)||(v[E]=C[E])}function T(C,v,E){for(var i=0,t=C.length;i<t;++i){var m=C[i];if(v[m.name])if(E[m.name]){if(m.merge){var n=v[m.name],h=E[m.name];g(n)==="object"&&g(h)==="object"?r(n,h):E[m.name]=n+h}}else E[m.name]=v[m.name]}}function M(C,v){for(var E=0,i=C.children.length;E<i;++E){var t=C.children[E],m=v[t.name+"_asArray"];if(m)for(var n=0,h=m.length;n<h;++n){var c=m[n];T(C.properties,v,c),M(t,c)}}}function p(C){if(C===null||g(C)!=="object")return C;if(C.Period_asArray&&"period"in _)for(var v=_.period,E=C.Period_asArray,i=0,t=E.length;i<t;++i){var m=E[i];if(M(v,m),"adaptationset"in _){var n=m.AdaptationSet_asArray;if(n)for(var h=_.adaptationset,c=0,o=n.length;c<o;++c)M(h,n[c])}}return C}return{run:p}}d.__dashjs_factory_name="ObjectIron";var f=I.default.getClassFactory(d);const y=f},"./src/dash/utils/ListSegmentsGetter.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>_});var I=e("./src/core/FactoryMaker.js"),g=e("./src/streaming/constants/Constants.js"),d=e("./src/dash/utils/SegmentsUtils.js");function f(r,T){r=r||{};var M=r.timelineConverter,p;function C(){if(!M||!M.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(g.default.MISSING_CONFIG_ERROR)}function v(t){var m={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};if(!t)return m;var n=t.adaptation.period.mpd.manifest.Period_asArray[t.adaptation.period.index].AdaptationSet_asArray[t.adaptation.index].Representation_asArray[t.index].SegmentList,h=t&&!isNaN(t.startNumber)?t.startNumber:1,c=Math.max(h-1,0);return m.numberOfSegments=c+n.SegmentURL_asArray.length,m}function E(t,m){if(C(),!t)return null;var n=t.adaptation.period.mpd.manifest.Period_asArray[t.adaptation.period.index].AdaptationSet_asArray[t.adaptation.index].Representation_asArray[t.index].SegmentList,h=n.SegmentURL_asArray.length,c=t&&!isNaN(t.startNumber)?t.startNumber:1,o=Math.max(c-1,0),l=Math.max(m-o,0),A=null;if(l<h){var S=n.SegmentURL_asArray[l];A=(0,d.getIndexBasedSegment)(M,T,t,m),A&&(A.replacementTime=(c+m-1)*t.segmentDuration,A.media=S.media?S.media:"",A.mediaRange=S.mediaRange,A.indexRange=S.indexRange)}return A}function i(t,m){if(C(),!t)return null;var n=t.segmentDuration;if(isNaN(n))return null;var h=M.calcPeriodRelativeTimeFromMpdRelativeTime(t,m),c=Math.floor(h/n);return E(t,c)}return p={getSegmentByIndex:E,getSegmentByTime:i,getMediaFinishedInformation:v},p}f.__dashjs_factory_name="ListSegmentsGetter";var y=I.default.getClassFactory(f);const _=y},"./src/dash/utils/Round10.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>f});function I(_,r){if(!(_ instanceof r))throw new TypeError("Cannot call a class as a function")}function g(_,r){for(var T=0;T<r.length;T++){var M=r[T];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(_,M.key,M)}}function d(_,r,T){return r&&g(_.prototype,r),T&&g(_,T),_}var f=function(){function _(){I(this,_)}return d(_,null,[{key:"round10",value:function(T,M){return y("round",T,M)}}]),_}();function y(_,r,T){return typeof T>"u"||+T==0?Math[_](r):(r=+r,T=+T,r===null||isNaN(r)||!(typeof T=="number"&&T%1===0)?NaN:(r=r.toString().split("e"),r=Math[_](+(r[0]+"e"+(r[1]?+r[1]-T:-T))),r=r.toString().split("e"),+(r[0]+"e"+(r[1]?+r[1]+T:T))))}},"./src/dash/utils/SegmentBaseGetter.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});var I=e("./src/core/FactoryMaker.js"),g=e("./src/streaming/constants/Constants.js");function d(_){_=_||{};var r=_.timelineConverter,T;function M(){if(!r||!r.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(g.default.MISSING_CONFIG_ERROR)}function p(i){var t={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};return!i||!i.segments||(t.numberOfSegments=i.segments.length),t}function C(i,t){if(M(),!i)return null;var m=i.segments?i.segments.length:-1,n;if(t<m&&(n=i.segments[t],n&&n.index===t))return n;for(var h=0;h<m;h++)if(n=i.segments[h],n&&n.index===t)return n;return null}function v(i,t){M();var m=E(i,t);return C(i,m)}function E(i,t){if(!i)return-1;var m=i.segments,n=m?m.length:null,h=-1,c,o,l,A,S;if(m&&n>0){for(S=0;S<n;S++)if(o=m[S],l=o.presentationStartTime,A=o.duration,c=A/2,t+c>=l&&t-c<l+A){h=o.index;break}}return h}return T={getSegmentByIndex:C,getSegmentByTime:v,getMediaFinishedInformation:p},T}d.__dashjs_factory_name="SegmentBaseGetter";var f=I.default.getClassFactory(d);const y=f},"./src/dash/utils/SegmentsUtils.js":(ce,N,e)=>{e.r(N),e.d(N,{getIndexBasedSegment:()=>M,getTimeBasedSegment:()=>p,replaceIDForTemplate:()=>y,replaceTokenForTemplate:()=>_,unescapeDollarsInTemplate:()=>f});var I=e("./src/dash/vo/Segment.js");function g(C,v){for(;C.length<v;)C="0"+C;return C}function d(C,v){return C.representation.startNumber+v}function f(C){return C&&C.split("$$").join("$")}function y(C,v){if(!v||!C||C.indexOf("$RepresentationID$")===-1)return C;var E=v.toString();return C.split("$RepresentationID$").join(E)}function _(C,v,E){var i="%0",t,m,n,h,c,o,l=v.length,A=i.length;if(!C)return C;for(;;){if(t=C.indexOf("$"+v),t<0||(m=C.indexOf("$",t+l),m<0))return C;if(n=C.indexOf(i,t+l),n>t&&n<m)switch(h=C.charAt(m-1),c=parseInt(C.substring(n+A,m-1),10),h){case"d":case"i":case"u":o=g(E.toString(),c);break;case"x":o=g(E.toString(16),c);break;case"X":o=g(E.toString(16),c).toUpperCase();break;case"o":o=g(E.toString(8),c);break;default:return C}else o=E;C=C.substring(0,t)+o+C.substring(m+1)}}function r(C,v,E,i,t,m,n,h){var c=new I.default;return c.representation=C,c.duration=v,c.presentationStartTime=E,c.mediaStartTime=i,c.availabilityStartTime=t.calcAvailabilityStartTimeFromPresentationTime(m,C,n),c.availabilityEndTime=t.calcAvailabilityEndTimeFromPresentationTime(m+v,C,n),c.wallStartTime=t.calcWallTimeForSegment(c,n),c.replacementNumber=d(c,h),c.index=h,c}function T(C,v,E,i){var t=v.adaptation.period;if(isFinite(t.duration)&&t.start+t.duration<=E.presentationStartTime)return!1;if(i){if(v.availabilityTimeOffset==="INF")return!0;var m=C.getClientReferenceTime();return E.availabilityStartTime.getTime()<=m&&(!isFinite(E.availabilityEndTime)||E.availabilityEndTime.getTime()>=m)}return!0}function M(C,v,E,i){var t,m,n;t=E.segmentDuration,isNaN(t)&&(t=E.adaptation.period.duration),m=parseFloat((E.adaptation.period.start+i*t).toFixed(5)),n=parseFloat((m+t).toFixed(5));var h=C.calcMediaTimeFromPresentationTime(m,E),c=r(E,t,m,h,C,n,v,i);return T(C,E,c,v)?c:null}function p(C,v,E,i,t,m,n,h,c,o){var l=i/m,A=t/m,S,L,U;return S=C.calcPresentationTimeFromMediaTime(l,E),L=S+A,U=r(E,A,S,l,C,L,v,c),T(C,E,U,v)?(U.replacementTime=o||i,n=_(n,"Number",U.replacementNumber),n=_(n,"Time",U.replacementTime),U.media=n,U.mediaRange=h,U):null}},"./src/dash/utils/TemplateSegmentsGetter.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>_});var I=e("./src/core/FactoryMaker.js"),g=e("./src/streaming/constants/Constants.js"),d=e("./src/dash/utils/SegmentsUtils.js");function f(r,T){r=r||{};var M=r.timelineConverter,p;function C(){if(!M||!M.hasOwnProperty("calcPeriodRelativeTimeFromMpdRelativeTime"))throw new Error(g.default.MISSING_CONFIG_ERROR)}function v(t){var m={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN};if(!t)return m;var n=t.segmentDuration;return isNaN(n)?m.numberOfSegments=1:m.numberOfSegments=Math.ceil(t.adaptation.period.duration/n),m}function E(t,m){if(C(),!t)return null;var n=t.adaptation.period.mpd.manifest.Period_asArray[t.adaptation.period.index].AdaptationSet_asArray[t.adaptation.index].Representation_asArray[t.index].SegmentTemplate;m=Math.max(m,0);var h=(0,d.getIndexBasedSegment)(M,T,t,m);if(h){h.replacementTime=Math.round((m-1)*t.segmentDuration*t.timescale,10);var c=n.media;c=(0,d.replaceTokenForTemplate)(c,"Number",h.replacementNumber),c=(0,d.replaceTokenForTemplate)(c,"Time",h.replacementTime),h.media=c}return h}function i(t,m){if(C(),!t)return null;var n=t.segmentDuration;if(isNaN(n))return null;var h=M.calcPeriodRelativeTimeFromMpdRelativeTime(t,m),c=Math.floor(h/n);return E(t,c)}return p={getSegmentByIndex:E,getSegmentByTime:i,getMediaFinishedInformation:v},p}f.__dashjs_factory_name="TemplateSegmentsGetter";var y=I.default.getClassFactory(f);const _=y},"./src/dash/utils/TimelineConverter.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>C});var I=e("./src/core/EventBus.js"),g=e("./src/core/events/Events.js"),d=e("./src/core/FactoryMaker.js"),f=e("./src/dash/constants/DashConstants.js"),y=e("./src/dash/models/DashManifestModel.js"),_=e("./src/core/Settings.js"),r=e("./src/streaming/constants/Constants.js"),T=e("./src/streaming/MediaPlayerEvents.js"),M=e("./src/streaming/constants/ConformanceViolationConstants.js");function p(){var v=this.context,E=(0,I.default)(v).getInstance(),i=(0,_.default)(v).getInstance(),t,m,n,h;function c(){m=(0,y.default)(v).getInstance(),oe()}function o(){ue(),E.on(g.default.UPDATE_TIME_SYNC_OFFSET,se,this)}function l(){return h}function A(Z){h=Z}function S(){return Date.now()-n*1e3+h*1e3}function L(Z,H,V,te){var z,R=H.adaptation.period.mpd,u=R.availabilityStartTime;if(te)V&&R.timeShiftBufferDepth!==Number.POSITIVE_INFINITY?z=new Date(u.getTime()+(Z+R.timeShiftBufferDepth)*1e3):z=R.availabilityEndTime;else if(V){var D=H.availabilityTimeOffset;z=new Date(u.getTime()+(Z-D)*1e3)}else z=u;return z}function U(Z,H,V){return L(Z,H,V)}function k(Z,H,V){return L(Z,H,V,!0)}function X(Z,H){return(Z.getTime()-H.mpd.availabilityStartTime.getTime()+h*1e3)/1e3}function W(Z,H){var V=H.adaptation.period.start,te=H.presentationTimeOffset;return Z+(V-te)}function b(Z,H){var V=H.adaptation.period.start,te=H.presentationTimeOffset;return Z-V+te}function j(Z,H){var V,te,z;return H&&(V=Z.representation.adaptation.period.mpd.suggestedPresentationDelay,te=Z.presentationStartTime+V,z=new Date(Z.availabilityStartTime.getTime()+te*1e3)),z}function Q(Z,H){if(!H)return q(Z);if(i.get().streaming.timeShiftBuffer.calcFromSegmentTimeline){var V=J(Z);return $(V.now,V.range),V.range}return Y(Z)}function q(Z){var H={start:NaN,end:NaN},V=0,te=NaN;return Z.forEach(function(z){var R=z.getStreamInfo();V+=R.duration,(isNaN(te)||R.start<te)&&(te=R.start)}),H.start=te,H.end=te+V,H}function Y(Z){var H={start:NaN,end:NaN};if(!Z||Z.length===0)return H;var V=Z[0].getAdapter().getRegularPeriods()[0],te=X(new Date,V),z=V.mpd.timeShiftBufferDepth,R=isNaN(z)?0:te-z;if(H.start=ae(Z,R),H.end=!isNaN(H.start)&&te<H.start?te:ae(Z,te,!0),!isNaN(z)&&H.end<te-z&&(H.end=NaN),i.get().streaming.timeShiftBuffer.fallbackToSegmentTimeline){var u=J(Z);if(u.range.end<H.start)return E.trigger(T.default.CONFORMANCE_VIOLATION,{level:M.default.LEVELS.WARNING,event:M.default.EVENTS.INVALID_DVR_WINDOW}),$(u.now,u.range),u.range}return H}function J(Z){var H={start:NaN,end:NaN},V=Z[0].getAdapter().getRegularPeriods()[0],te=X(new Date,V);if(!Z||Z.length===0)return{range:H,now:te};Z.forEach(function(R){var u=R.getAdapter(),D=u.getMediaInfoForType(R.getStreamInfo(),r.default.VIDEO)||u.getMediaInfoForType(R.getStreamInfo(),r.default.AUDIO),F=u.getVoRepresentations(D),w=F[0],O={start:NaN,end:NaN};if(w)if(w.segmentInfoType===f.default.SEGMENT_TIMELINE)O=K(w);else{var P=w.adaptation.period;O.start=P.start,O.end=Math.max(te,P.start+P.duration)}!isNaN(O.start)&&(isNaN(H.start)||H.start>O.start)&&(H.start=O.start),!isNaN(O.end)&&(isNaN(H.end)||H.end<O.end)&&(H.end=O.end)}),H.end=Math.min(te,H.end);var z=ae(Z,H.end,!0);return H.end=isNaN(z)?H.end:z,H.start=V&&V.mpd&&V.mpd.timeShiftBufferDepth&&!isNaN(V.mpd.timeShiftBufferDepth)&&!isNaN(H.end)?Math.max(H.end-V.mpd.timeShiftBufferDepth,H.start):H.start,H.start=ae(Z,H.start),{range:H,now:te}}function $(Z,H){n=Z-H.end}function ae(Z,H){var V=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;try{for(var te=0,z=!1,R=NaN;!z&&te<Z.length;){var u=Z[te].getStreamInfo();u.start<=H&&(!isFinite(u.duration)||u.start+u.duration>=H)?(R=H,z=!0):!V&&u.start>H&&(isNaN(R)||u.start<R)?R=u.start:V&&u.start+u.duration<H&&(isNaN(R)||u.start+u.duration>R)&&(R=u.start+u.duration),te+=1}return R}catch{return H}}function K(Z){var H=Z.adaptation.period.mpd.manifest.Period_asArray[Z.adaptation.period.index].AdaptationSet_asArray[Z.adaptation.index],V=m.getRepresentationFor(Z.index,H),te=V.SegmentTemplate.SegmentTimeline,z=V.SegmentTemplate.timescale,R=te.S_asArray,u={start:0,end:0},D=0,F,w,O,P;for(u.start=W(R[0].t/z,Z),O=0,P=R.length;O<P;O++)F=R[O],w=0,F.hasOwnProperty("r")&&(w=F.r),D+=F.d*(1+w);return u.end=W((R[0].t+D)/z,Z),u}function ee(Z,H){var V=Z.adaptation.period.start;return H-V}function se(Z){Z.offset!==void 0&&!isNaN(Z.offset)&&A(Z.offset/1e3)}function ue(){h=0,n=0}function oe(){E.off(g.default.UPDATE_TIME_SYNC_OFFSET,se,this),ue()}return t={initialize:o,getClientTimeOffset:l,setClientTimeOffset:A,getClientReferenceTime:S,calcAvailabilityStartTimeFromPresentationTime:U,calcAvailabilityEndTimeFromPresentationTime:k,calcPresentationTimeFromWallTime:X,calcPresentationTimeFromMediaTime:W,calcPeriodRelativeTimeFromMpdRelativeTime:ee,calcMediaTimeFromPresentationTime:b,calcWallTimeForSegment:j,calcTimeShiftBufferWindow:Q,reset:oe},c(),t}p.__dashjs_factory_name="TimelineConverter";const C=d.default.getSingletonFactory(p)},"./src/dash/utils/TimelineSegmentsGetter.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>_});var I=e("./src/core/FactoryMaker.js"),g=e("./src/streaming/constants/Constants.js"),d=e("./src/dash/utils/SegmentsUtils.js");function f(r,T){r=r||{};var M=r.timelineConverter,p=r.dashMetrics,C;function v(){if(!M)throw new Error(g.default.MISSING_CONFIG_ERROR)}function E(c){if(!c)return 0;var o=c.adaptation.period.mpd.manifest.Period_asArray[c.adaptation.period.index].AdaptationSet_asArray[c.adaptation.index].Representation_asArray[c.index].SegmentTemplate||c.adaptation.period.mpd.manifest.Period_asArray[c.adaptation.period.index].AdaptationSet_asArray[c.adaptation.index].Representation_asArray[c.index].SegmentList,l=o.SegmentTimeline,A=0,S=0,L=0,U,k,X,W,b,j,Q;for(Q=c.timescale,U=l.S_asArray,W=U.length,X=0;X<W;X++){if(k=U[X],j=0,k.hasOwnProperty("r")&&(j=k.r),k.hasOwnProperty("t")&&(A=k.t,S=A/Q),j<0){var q=U[X+1];j=t(c,q,k,Q,S)}for(b=0;b<=j;b++)L++,A+=k.d,S=A/Q}return{numberOfSegments:L,mediaTimeOfLastSignaledSegment:S}}function i(c,o){var l=c.adaptation.period.mpd.manifest.Period_asArray[c.adaptation.period.index].AdaptationSet_asArray[c.adaptation.index].Representation_asArray[c.index].SegmentTemplate||c.adaptation.period.mpd.manifest.Period_asArray[c.adaptation.period.index].AdaptationSet_asArray[c.adaptation.index].Representation_asArray[c.index].SegmentList,A=l.SegmentTimeline,S=l.SegmentURL_asArray,L=0,U=-1,k,X,W,b,j,Q,q;q=c.timescale,k=A.S_asArray;var Y=!1;for(W=0,b=k.length;W<b&&!Y;W++){if(X=k[W],Q=0,X.hasOwnProperty("r")&&(Q=X.r),X.hasOwnProperty("t")&&(L=X.t),Q<0){var J=k[W+1];Q=t(c,J,X,q,L/q)}for(j=0;j<=Q&&!Y;j++)U++,Y=o(L,l,S,X,q,U,W),Y&&(c.segmentDuration=X.d/q),L+=X.d}}function t(c,o,l,A,S){var L;if(o&&o.hasOwnProperty("t"))L=o.t/A;else try{var U=0;if(!isNaN(c.adaptation.period.start)&&!isNaN(c.adaptation.period.duration)&&isFinite(c.adaptation.period.duration))U=c.adaptation.period.start+c.adaptation.period.duration;else{var k=p.getCurrentDVRInfo();U=isNaN(k.end)?0:k.end}L=M.calcMediaTimeFromPresentationTime(U,c),c.segmentDuration=l.d/A}catch{L=0}return Math.max(Math.ceil((L-S)/(l.d/A))-1,0)}function m(c,o,l){if(v(),!c)return null;var A=null,S=!1;return i(c,function(L,U,k,X,W,b,j){if(S||l<0){var Q=U.media,q=X.mediaRange;return k&&(Q=k[j].media||"",q=k[j].mediaRange),A=(0,d.getTimeBasedSegment)(M,T,c,L,X.d,W,Q,q,b,X.tManifest),!0}else L>=l*W-X.d*.5&&(S=!0);return!1}),A}function n(c,o){if(v(),!c)return null;o===void 0&&(o=null);var l=null,A=M.calcMediaTimeFromPresentationTime(o,c);return i(c,function(S,L,U,k,X,W,b){var j=h(A*X);if(j<S+k.d&&j>=S){var Q=L.media,q=k.mediaRange;return U&&(Q=U[b].media||"",q=U[b].mediaRange),l=(0,d.getTimeBasedSegment)(M,T,c,S,k.d,X,Q,q,W,k.tManifest),!0}return!1}),l}function h(c){return parseFloat(c.toPrecision(15))}return C={getSegmentByIndex:m,getSegmentByTime:n,getMediaFinishedInformation:E},C}f.__dashjs_factory_name="TimelineSegmentsGetter";var y=I.default.getClassFactory(f);const _=y},"./src/dash/vo/AdaptationSet.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.period=null,this.index=-1,this.type=null};const d=g},"./src/dash/vo/BaseURL.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});function I(_,r){if(!(_ instanceof r))throw new TypeError("Cannot call a class as a function")}var g=1,d=1,f=function _(r,T,M,p){I(this,_),this.url=r||"",this.serviceLocation=T||r||"",this.dvb_priority=M||g,this.dvb_weight=p||d,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0};f.DEFAULT_DVB_PRIORITY=g,f.DEFAULT_DVB_WEIGHT=d;const y=f},"./src/dash/vo/ContentSteering.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.defaultServiceLocation=null,this.queryBeforeStart=!1,this.proxyServerUrl=null,this.serverUrl=null};const d=g},"./src/dash/vo/ContentSteeringRequest.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>f});var I=e("./src/streaming/vo/metrics/HTTPRequest.js");function g(y,_){if(!(y instanceof _))throw new TypeError("Cannot call a class as a function")}var d=function y(_){g(this,y),this.url=_||null,this.type=I.HTTPRequest.CONTENT_STEERING_TYPE,this.responseType="json"};const f=d},"./src/dash/vo/ContentSteeringResponse.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.version=null,this.ttl=300,this.reloadUri=null,this.serviceLocationPriority=[]};const d=g},"./src/dash/vo/Event.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.duration=NaN,this.presentationTime=NaN,this.id=NaN,this.messageData="",this.eventStream=null,this.presentationTimeDelta=NaN};const d=g},"./src/dash/vo/EventStream.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.adaptionSet=null,this.representation=null,this.period=null,this.timescale=1,this.value="",this.schemeIdUri="",this.presentationTimeOffset=0};const d=g},"./src/dash/vo/ManifestInfo.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.dvrWindowSize=NaN,this.loadedTime=null,this.availableFrom=null,this.minBufferTime=NaN,this.duration=NaN,this.isDynamic=!1,this.maxFragmentDuration=null};const d=g},"./src/dash/vo/MediaInfo.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.id=null,this.index=null,this.type=null,this.streamInfo=null,this.representationCount=0,this.labels=null,this.lang=null,this.viewpoint=null,this.accessibility=null,this.audioChannelConfiguration=null,this.roles=null,this.codec=null,this.mimeType=null,this.contentProtection=null,this.KID=null,this.bitrateList=null,this.isFragmented=null,this.isEmbedded=null,this.selectionPriority=1,this.supplementalProperties={}};const d=g},"./src/dash/vo/Mpd.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.manifest=null,this.suggestedPresentationDelay=0,this.availabilityStartTime=null,this.availabilityEndTime=Number.POSITIVE_INFINITY,this.timeShiftBufferDepth=Number.POSITIVE_INFINITY,this.maxSegmentDuration=Number.POSITIVE_INFINITY,this.publishTime=null,this.minimumUpdatePeriod=NaN,this.mediaPresentationDuration=NaN};const d=g},"./src/dash/vo/PatchOperation.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});function I(_,r){if(!(_ instanceof r))throw new TypeError("Cannot call a class as a function")}function g(_,r){for(var T=0;T<r.length;T++){var M=r[T];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(_,M.key,M)}}function d(_,r,T){return r&&g(_.prototype,r),T&&g(_,T),_}var f=function(){function _(r,T,M){I(this,_),this.action=r,this.xpath=T,this.value=M,this.position=null}return d(_,[{key:"getMpdTarget",value:function(T){var M=this.action==="remove"||this.action==="replace"||this.position==="before"||this.position==="after";return this.xpath.getMpdTarget(T,M)}}]),_}();const y=f},"./src/dash/vo/Period.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.id=null,this.index=-1,this.duration=NaN,this.start=NaN,this.mpd=null,this.nextPeriodId=null};g.DEFAULT_ID="defaultId";const d=g},"./src/dash/vo/ProducerReferenceTime.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.id=null,this.inband=!1,this.type="encoder",this.applicationScheme=null,this.wallClockTime=null,this.presentationTime=NaN,this.UTCTiming=null};const d=g},"./src/dash/vo/Representation.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>_});var I=e("./src/dash/constants/DashConstants.js");function g(r,T){if(!(r instanceof T))throw new TypeError("Cannot call a class as a function")}function d(r,T){for(var M=0;M<T.length;M++){var p=T[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(r,p.key,p)}}function f(r,T,M){return T&&d(r.prototype,T),M&&d(r,M),r}var y=function(){function r(){g(this,r),this.id=null,this.index=-1,this.adaptation=null,this.segmentInfoType=null,this.initialization=null,this.codecs=null,this.mimeType=null,this.codecPrivateData=null,this.segmentDuration=NaN,this.timescale=1,this.startNumber=1,this.indexRange=null,this.range=null,this.presentationTimeOffset=0,this.MSETimeOffset=NaN,this.mediaFinishedInformation={numberOfSegments:0,mediaTimeOfLastSignaledSegment:NaN},this.bandwidth=NaN,this.width=NaN,this.height=NaN,this.scanType=null,this.maxPlayoutRate=NaN,this.availabilityTimeOffset=0,this.availabilityTimeComplete=!0}return f(r,[{key:"hasInitialization",value:function(){return this.initialization!==null||this.range!==null}},{key:"hasSegments",value:function(){return this.segmentInfoType!==I.default.BASE_URL&&this.segmentInfoType!==I.default.SEGMENT_BASE&&!this.indexRange}}]),r}();const _=y},"./src/dash/vo/RepresentationInfo.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.id=null,this.quality=null,this.fragmentDuration=null,this.mediaInfo=null,this.MSETimeOffset=null};const d=g},"./src/dash/vo/Segment.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.indexRange=null,this.index=null,this.mediaRange=null,this.media=null,this.duration=NaN,this.replacementTime=null,this.replacementNumber=NaN,this.mediaStartTime=NaN,this.presentationStartTime=NaN,this.availabilityStartTime=NaN,this.availabilityEndTime=NaN,this.wallStartTime=NaN,this.representation=null};const d=g},"./src/dash/vo/SimpleXPath.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});function I(_,r){if(!(_ instanceof r))throw new TypeError("Cannot call a class as a function")}function g(_,r){for(var T=0;T<r.length;T++){var M=r[T];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(_,M.key,M)}}function d(_,r,T){return r&&g(_.prototype,r),T&&g(_,T),_}var f=function(){function _(r){var T=this;I(this,_),this.valid=r[0]=="/",this.path=r.split("/").filter(function(M){return M.length!==0}).map(function(M){var p={name:M},C=M.indexOf("[");if(C!=-1){p.name=M.substring(0,C);var v=M.substring(C+1,M.length-1);T.valid=T.valid&&v.indexOf("[")==-1;var E=v.indexOf("=");E!=-1?(p.attribute={name:v.substring(1,E),value:v.substring(E+1)},["'",'"'].indexOf(p.attribute.value[0])!=-1&&(p.attribute.value=p.attribute.value.substring(1,p.attribute.value.length-1))):p.position=parseInt(v,10)-1}return p})}return d(_,[{key:"isValid",value:function(){return this.valid}},{key:"findsElement",value:function(){return!this.findsAttribute()}},{key:"findsAttribute",value:function(){return this.path[this.path.length-1].name.startsWith("@")}},{key:"getMpdTarget",value:function(T,M){for(var p=null,C=T,v=1,E="MPD";v<this.path.length&&C!==null;){p=C;var i=this.path[v];if(E=i.name,v!==this.path.length-1||!E.startsWith("@")){var t=p[E+"_asArray"]||[];t.length===0&&p[E]&&t.push(p[E]),i.position?C=t[i.position]||null:i.attribute?function(){var m=i.attribute;C=t.filter(function(n){return n[m.name]==m.value})[0]||null}():C=t[0]||null}v++}return C===null?null:E.startsWith("@")?{name:E.substring(1),leaf:C,target:C}:{name:E,leaf:C,target:M?p:C}}}]),_}();const y=f},"./src/dash/vo/StreamInfo.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.id=null,this.index=null,this.start=NaN,this.duration=NaN,this.manifestInfo=null,this.isLast=!0};const d=g},"./src/dash/vo/UTCTiming.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.schemeIdUri="",this.value=""};const d=g},"./src/streaming/FragmentLoader.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>r});var I=e("./src/streaming/constants/Constants.js"),g=e("./src/streaming/net/URLLoader.js"),d=e("./src/streaming/vo/HeadRequest.js"),f=e("./src/streaming/vo/DashJSError.js"),y=e("./src/core/FactoryMaker.js");function _(T){T=T||{};var M=this.context,p=T.eventBus,C=T.events,v=T.urlUtils,E=T.errors,i=T.streamId,t,m;function n(){m=(0,g.default)(M).create({errHandler:T.errHandler,errors:E,dashMetrics:T.dashMetrics,mediaPlayerModel:T.mediaPlayerModel,requestModifier:T.requestModifier,urlUtils:v,constants:I.default,boxParser:T.boxParser,dashConstants:T.dashConstants,requestTimeout:T.settings.get().streaming.fragmentRequestTimeout})}function h(A){var S=function(k){p.trigger(C.CHECK_FOR_EXISTENCE_COMPLETED,{request:A,exists:k})};if(A){var L=new d.default(A.url);m.load({request:L,success:function(){S(!0)},error:function(){S(!1)}})}else S(!1)}function c(A){var S=function(U,k){p.trigger(C.LOADING_COMPLETED,{request:A,response:U||null,error:k||null,sender:t})};A?m.load({request:A,progress:function(U){p.trigger(C.LOADING_PROGRESS,{request:A,stream:U.stream,streamId:i}),U.data&&p.trigger(C.LOADING_DATA_PROGRESS,{request:A,response:U.data||null,error:null,sender:t})},success:function(U){S(U)},error:function(U,k,X){S(void 0,new f.default(E.FRAGMENT_LOADER_LOADING_FAILURE_ERROR_CODE,X,k))},abort:function(U){U&&p.trigger(C.LOADING_ABANDONED,{mediaType:U.mediaType,request:U,sender:t})}}):S(void 0,new f.default(E.FRAGMENT_LOADER_NULL_REQUEST_ERROR_CODE,E.FRAGMENT_LOADER_NULL_REQUEST_ERROR_MESSAGE))}function o(){m&&m.abort()}function l(){m&&(m.abort(),m=null)}return t={checkForExistence:h,load:c,abort:o,reset:l},n(),t}_.__dashjs_factory_name="FragmentLoader";const r=y.default.getClassFactory(_)},"./src/streaming/ManifestLoader.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>m});var I=e("./src/streaming/constants/Constants.js"),g=e("./src/dash/constants/DashConstants.js"),d=e("./src/streaming/controllers/XlinkController.js"),f=e("./src/streaming/net/URLLoader.js"),y=e("./src/streaming/utils/URLUtils.js"),_=e("./src/streaming/vo/TextRequest.js"),r=e("./src/streaming/vo/DashJSError.js"),T=e("./src/streaming/vo/metrics/HTTPRequest.js"),M=e("./src/core/EventBus.js"),p=e("./src/core/events/Events.js"),C=e("./src/core/errors/Errors.js"),v=e("./src/core/FactoryMaker.js"),E=e("./src/dash/parser/DashParser.js");function i(n){n=n||{};var h=this.context,c=n.debug,o=n.settings,l=(0,M.default)(h).getInstance(),A=(0,y.default)(h).getInstance(),S,L,U,k,X,W=n.mssHandler,b=n.errHandler;function j(){L=c.getLogger(S),l.on(p.default.XLINK_READY,Q,S),U=(0,f.default)(h).create({errHandler:n.errHandler,dashMetrics:n.dashMetrics,mediaPlayerModel:n.mediaPlayerModel,requestModifier:n.requestModifier,urlUtils:A,constants:I.default,dashConstants:g.default,errors:C.default,requestTimeout:n.settings.get().streaming.manifestRequestTimeout}),k=(0,d.default)(h).create({errHandler:b,dashMetrics:n.dashMetrics,mediaPlayerModel:n.mediaPlayerModel,requestModifier:n.requestModifier,settings:n.settings}),X=null}function Q($){l.trigger(p.default.INTERNAL_MANIFEST_LOADED,{manifest:$.manifest})}function q($){var ae=null;return $.indexOf("SmoothStreamingMedia")>-1?(W&&(ae=W.createMssParser(),W.registerEvents()),ae):$.indexOf("MPD")>-1||$.indexOf("Patch")>-1?(0,E.default)(h).create({debug:c}):ae}function Y($){var ae=new _.default($,T.HTTPRequest.MPD_TYPE);U.load({request:ae,success:function(ee,se,ue){if(k){var oe,Z,H;if(ue&&ue!==$?(Z=A.parseBaseUrl(ue),oe=ue):(A.isRelative($)&&($=A.resolve($,window.location.href)),Z=A.parseBaseUrl($)),se=="No Content"){l.trigger(p.default.INTERNAL_MANIFEST_LOADED,{manifest:null});return}if(X===null&&(X=q(ee)),X===null){l.trigger(p.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new r.default(C.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,C.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat($))});return}k.setMatchers(X.getMatchers()),k.setIron(X.getIron());try{H=X.parse(ee)}catch{l.trigger(p.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new r.default(C.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,C.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat($))});return}if(H){if(H.url=oe||$,H.originalUrl||(H.originalUrl=H.url),H.hasOwnProperty(I.default.LOCATION)&&(Z=A.parseBaseUrl(H.Location_asArray[0]),L.debug("BaseURI set by Location to: "+Z)),o&&o.get().streaming.enableManifestDurationMismatchFix&&H.mediaPresentationDuration&&H.Period_asArray.length>1){var V=H.Period_asArray.reduce(function(te,z){return te+z.duration},0);!isNaN(V)&&H.mediaPresentationDuration>V&&(L.warn("Media presentation duration greater than duration of all periods. Setting duration to total period duration"),H.mediaPresentationDuration=V)}H.baseUri=Z,H.loadedTime=new Date,k.resolveManifestOnLoad(H),l.trigger(p.default.ORIGINAL_MANIFEST_LOADED,{originalManifest:ee})}else l.trigger(p.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new r.default(C.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE,C.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_MESSAGE+"".concat($))})}},error:function(ee,se,ue){l.trigger(p.default.INTERNAL_MANIFEST_LOADED,{manifest:null,error:new r.default(C.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE,C.default.MANIFEST_LOADER_LOADING_FAILURE_ERROR_MESSAGE+"".concat($,", ").concat(ue))})}})}function J(){l.off(p.default.XLINK_READY,Q,S),W&&W.reset(),k&&(k.reset(),k=null),U&&(U.abort(),U=null)}return S={load:Y,reset:J},j(),S}i.__dashjs_factory_name="ManifestLoader";var t=v.default.getClassFactory(i);const m=t},"./src/streaming/ManifestUpdater.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>p});var I=e("./src/core/EventBus.js"),g=e("./src/core/events/Events.js"),d=e("./src/streaming/MediaPlayerEvents.js"),f=e("./src/core/FactoryMaker.js"),y=e("./src/core/Debug.js"),_=e("./src/core/errors/Errors.js"),r=e("./src/dash/constants/DashConstants.js"),T=e("./src/streaming/utils/URLUtils.js");function M(){var C=this.context,v=(0,I.default)(C).getInstance(),E=(0,T.default)(C).getInstance(),i,t,m,n,h,c,o,l,A,S,L,U;function k(){t=(0,y.default)(C).getInstance().getLogger(i)}function X(Z){Z&&(Z.manifestModel&&(A=Z.manifestModel),Z.adapter&&(S=Z.adapter),Z.manifestLoader&&(l=Z.manifestLoader),Z.errHandler&&(L=Z.errHandler),Z.settings&&(U=Z.settings))}function W(){j(),v.on(g.default.STREAMS_COMPOSED,ue,this),v.on(d.default.PLAYBACK_STARTED,ee,this),v.on(d.default.PLAYBACK_PAUSED,se,this),v.on(g.default.INTERNAL_MANIFEST_LOADED,K,this)}function b(Z){$(Z)}function j(){m=NaN,o=!1,h=!0,c=!1,q()}function Q(){v.off(d.default.PLAYBACK_STARTED,ee,this),v.off(d.default.PLAYBACK_PAUSED,se,this),v.off(g.default.STREAMS_COMPOSED,ue,this),v.off(g.default.INTERNAL_MANIFEST_LOADED,K,this),j()}function q(){n!==null&&(clearTimeout(n),n=null)}function Y(Z){q(),!c&&(isNaN(Z)&&!isNaN(m)&&(Z=m*1e3),isNaN(Z)||(t.debug("Refresh manifest in "+Z+" milliseconds."),n=setTimeout(ae,Z)))}function J(){var Z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;o=!0;var H=A.getValue(),V=H.url,te=S.getPatchLocation(H),z=S.getLocation(H);te&&!Z?V=te:z&&(V=z),E.isRelative(V)&&(V=E.resolve(V,H.url)),l.load(V)}function $(Z){if(!Z)Z=A.getValue(),Z.loadedTime=new Date;else if(S.getIsPatch(Z)){var H=Z;Z=A.getValue();var V=S.isPatchValid(Z,H),te=V;if(V){var z=S.getPublishTime(Z);te=S.applyPatchToManifest(Z,H);var R=S.getPublishTime(Z);te=z.getTime()!=R.getTime()}if(!te){t.debug("Patch provided is invalid, performing full manifest refresh"),J(!0);return}Z.loadedTime=new Date}if(A.getValue()&&A.getValue().type===r.default.DYNAMIC&&Z.type===r.default.STATIC){v.trigger(g.default.DYNAMIC_TO_STATIC),o=!1,c=!0;return}A.setValue(Z);var u=new Date,D=(u.getTime()-Z.loadedTime.getTime())/1e3;m=S.getManifestUpdatePeriod(Z,D),m*1e3>2147483647&&(m=2147483647e-3),v.trigger(g.default.MANIFEST_UPDATED,{manifest:Z}),t.info("Manifest has been refreshed at "+u+"["+u.getTime()/1e3+"] "),h||Y()}function ae(){if(!h){if(o){Y(U.get().streaming.manifestUpdateRetryInterval);return}J()}}function K(Z){Z.error?Z.error.code===_.default.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE&&L.error(Z.error):$(Z.manifest)}function ee(){h=!1,Y()}function se(){h=!U.get().streaming.scheduling.scheduleWhilePaused,h&&q()}function ue(){o=!1}function oe(){return o}return i={initialize:W,setManifest:b,refreshManifest:J,getIsUpdating:oe,setConfig:X,reset:Q},k(),i}M.__dashjs_factory_name="ManifestUpdater";const p=f.default.getClassFactory(M)},"./src/streaming/MediaPlayer.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>O});var I=e("./externals/cea608-parser.js"),g=e.n(I),d=e("./src/streaming/constants/Constants.js"),f=e("./src/dash/constants/DashConstants.js"),y=e("./src/streaming/constants/MetricsConstants.js"),_=e("./src/streaming/controllers/PlaybackController.js"),r=e("./src/streaming/controllers/StreamController.js"),T=e("./src/streaming/controllers/GapController.js"),M=e("./src/streaming/controllers/CatchupController.js"),p=e("./src/dash/controllers/ServiceDescriptionController.js"),C=e("./src/dash/controllers/ContentSteeringController.js"),v=e("./src/streaming/controllers/MediaController.js"),E=e("./src/streaming/controllers/BaseURLController.js"),i=e("./src/streaming/ManifestLoader.js"),t=e("./src/streaming/utils/ErrorHandler.js"),m=e("./src/streaming/utils/Capabilities.js"),n=e("./src/streaming/utils/CapabilitiesFilter.js"),h=e("./src/streaming/utils/RequestModifier.js"),c=e("./src/streaming/models/URIFragmentModel.js"),o=e("./src/streaming/models/ManifestModel.js"),l=e("./src/streaming/models/MediaPlayerModel.js"),A=e("./src/streaming/controllers/AbrController.js"),S=e("./src/streaming/net/SchemeLoaderFactory.js"),L=e("./src/streaming/models/VideoModel.js"),U=e("./src/streaming/models/CmcdModel.js"),k=e("./src/streaming/models/CmsdModel.js"),X=e("./src/streaming/utils/DOMStorage.js"),W=e("./src/core/Debug.js"),b=e("./src/core/errors/Errors.js"),j=e("./src/core/EventBus.js"),Q=e("./src/core/events/Events.js"),q=e("./src/streaming/MediaPlayerEvents.js"),Y=e("./src/core/FactoryMaker.js"),J=e("./src/core/Settings.js"),$=e("./src/core/Version.js"),ae=e("./src/dash/controllers/SegmentBaseController.js"),K=e("./src/dash/DashAdapter.js"),ee=e("./src/dash/DashMetrics.js"),se=e("./src/dash/utils/TimelineConverter.js"),ue=e("./src/streaming/vo/metrics/HTTPRequest.js"),oe=e("./externals/base64.js"),Z=e("./node_modules/codem-isoboxer/dist/iso_boxer.js"),H=e("./src/streaming/vo/DashJSError.js"),V=e("./src/streaming/utils/SupervisorTools.js"),te=e("./src/streaming/ManifestUpdater.js"),z=e("./src/streaming/utils/URLUtils.js"),R=e("./src/streaming/utils/BoxParser.js"),u=e("./src/streaming/text/TextController.js"),D=e("./src/streaming/models/CustomParametersModel.js");function F(){var P="You must first call initialize() and set a source before calling this method",B="You must first call initialize() and set a valid source and view before calling this method",x="You must first call attachView() to set the video element before calling this method",ne="You must first call attachSource() with a valid source before calling this method",re="MediaPlayer not initialized!",G=this.context,fe=(0,j.default)(G).getInstance(),le=(0,J.default)(G).getInstance(),_e=(0,W.default)(G).getInstance({settings:le}),Me,Oe,Ne,xe,Se,me,Ae,He,Qe,Je,ye,Fe,Be,Ye,Ze,tt,nt,ht,je,ge,ie,he,De,Ce,We,Xe,Ve,rt,ut,mt,ve,Le,Ge,at,et,lt,vt,Mt;function Ct(){Oe=_e.getLogger(Me),Se=!1,Ae=!1,me=!1,He=!0,Be=null,tt=null,xe=null,nt=null,Mt=null,Q.default.extend(q.default),ht=(0,l.default)(G).getInstance(),je=(0,D.default)(G).getInstance(),et=(0,L.default)(G).getInstance(),lt=(0,c.default)(G).getInstance()}function de(Pe){Pe&&(Pe.capabilities&&(he=Pe.capabilities),Pe.capabilitiesFilter&&(De=Pe.capabilitiesFilter),Pe.streamController&&(Ce=Pe.streamController),Pe.textController&&(We=Pe.textController),Pe.gapController&&(Xe=Pe.gapController),Pe.playbackController&&(Ve=Pe.playbackController),Pe.serviceDescriptionController&&(rt=Pe.serviceDescriptionController),Pe.contentSteeringController&&(ut=Pe.contentSteeringController),Pe.catchupController&&(mt=Pe.catchupController),Pe.mediaPlayerModel&&(ht=Pe.mediaPlayerModel),Pe.customParametersModel&&(je=Pe.customParametersModel),Pe.abrController&&(Qe=Pe.abrController),Pe.schemeLoaderFactory&&(Je=Pe.schemeLoaderFactory),Pe.mediaController&&(Fe=Pe.mediaController),Pe.settings&&(le=Pe.settings))}function we(Pe,ot,Tt){var Lt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:NaN;if(he||(he=(0,m.default)(G).getInstance(),he.setConfig({settings:le})),ge||(ge=(0,t.default)(G).getInstance()),!he.supportsMediaSource()){ge.error(new H.default(b.default.CAPABILITY_MEDIASOURCE_ERROR_CODE,b.default.CAPABILITY_MEDIASOURCE_ERROR_MESSAGE));return}Se||(Se=!0,ye=(0,se.default)(G).getInstance(),Qe||(Qe=(0,A.default)(G).getInstance(),Qe.setConfig({settings:le})),Je||(Je=(0,S.default)(G).getInstance()),Ve||(Ve=(0,_.default)(G).getInstance()),Fe||(Fe=(0,v.default)(G).getInstance()),Ce||(Ce=(0,r.default)(G).getInstance()),Xe||(Xe=(0,T.default)(G).getInstance()),mt||(mt=(0,M.default)(G).getInstance()),rt||(rt=(0,p.default)(G).getInstance()),ut||(ut=(0,C.default)(G).getInstance()),De||(De=(0,n.default)(G).getInstance()),nt=(0,K.default)(G).getInstance(),Le=(0,o.default)(G).getInstance(),Ge=(0,U.default)(G).getInstance(),at=(0,k.default)(G).getInstance(),ve=(0,ee.default)(G).getInstance({settings:le}),vt=(0,X.default)(G).getInstance({settings:le}),nt.setConfig({constants:d.default,cea608parser:g(),errHandler:ge,BASE64:oe}),ie||(ie=(0,E.default)(G).create()),ie.setConfig({adapter:nt}),rt.setConfig({adapter:nt}),Mt||(Mt=(0,ae.default)(G).getInstance({dashMetrics:ve,mediaPlayerModel:ht,errHandler:ge,baseURLController:ie,events:Q.default,eventBus:fe,debug:_e,boxParser:(0,R.default)(G).getInstance(),requestModifier:(0,h.default)(G).getInstance(),errors:b.default})),Fe.setConfig({domStorage:vt,settings:le,customParametersModel:je}),ht.setConfig({playbackController:Ve,serviceDescriptionController:rt}),ut.setConfig({adapter:nt,errHandler:ge,dashMetrics:ve,mediaPlayerModel:ht,manifestModel:Le,abrController:Qe,eventBus:fe,requestModifier:(0,h.default)(G).getInstance()}),$t(),Yt(Tt!==void 0?Tt:!0),Sr()),Pe&&qt(Pe),ot&&vr(ot,Lt),Oe.info("[dash.js "+pt()+"] MediaPlayer has been initialized")}function qe(){vr(null),qt(null),xe=null,Be&&(Be.reset(),Be=null),Ye&&(Ye.reset(),Ye=null),je&&je.reset(),le.reset(),tt&&(tt.reset(),tt=null)}function Te(){qe(),Y.default.deleteSingletonInstances(G)}function Ie(){return!!Ne&&!!et.getElement()}function Ke(Pe,ot,Tt,Lt){fe.on(Pe,ot,Tt,Lt)}function it(Pe,ot,Tt){fe.off(Pe,ot,Tt)}function pt(){return(0,$.getVersionString)()}function Et(){return _e}function gt(){if(et.getElement()||me)return!1;if(Ne)pr();else throw ne}function Nt(){if(!Ae)throw B;(!He||ke()&&Ae)&&Ve.play(!0)}function Dt(){if(!Ae)throw B;Ve.pause()}function ke(){if(!Ae)throw B;return Ve.isPaused()}function ct(Pe){if(!Ae)throw B;if((0,V.checkParameterType)(Pe,"number"),isNaN(Pe))throw d.default.BAD_ARGUMENT_ERROR;Pe<0&&(Pe=0);var ot=Ve.getIsDynamic()?kt(Pe):Pe,Tt=xt();!Ve.getIsDynamic()&&Tt.duration&&(ot=Math.min(Tt.duration,ot)),Ve.seek(ot,!1,!1,!0)}function ft(){!Ae||!be()||Ve.seekToOriginalLive()}function pe(){if(!Ae)throw B;return Ve.isSeeking()}function be(){if(!Ae)throw B;return Ve.getIsDynamic()}function Ee(){if(!Ae)throw B;return Ve.getLowLatencyModeEnabled()}function Ue(Pe){xt().playbackRate=Pe}function $e(){return xt().playbackRate}function dt(Pe){(0,V.checkParameterType)(Pe,"boolean"),xt().muted=Pe}function _t(){return xt().muted}function St(Pe){if(typeof Pe!="number"||isNaN(Pe)||Pe<0||Pe>1)throw d.default.BAD_ARGUMENT_ERROR;xt().volume=Pe}function Pt(){return xt().volume}function Rt(Pe){var ot=[d.default.VIDEO,d.default.AUDIO,d.default.TEXT];if(Pe)if(ot.indexOf(Pe)!==-1){var Lt=At().getCurrentBufferLevel(Pe);return Lt||NaN}else return Oe.warn("getBufferLength requested for invalid type"),NaN;else{var Tt=ot.map(function(Ft){return Ar(Ft).length>0?At().getCurrentBufferLevel(Ft):Number.MAX_VALUE}).reduce(function(Ft,lr){return Math.min(Ft,lr)});return Tt===Number.MAX_VALUE?NaN:Tt}}function Ut(){var Pe=Ce&&Ce.hasVideoTrack()?d.default.VIDEO:d.default.AUDIO,ot=ve.getCurrentDVRInfo(Pe);return ot?ot.manifestInfo.dvrWindowSize:0}function kt(Pe){var ot=Ce&&Ce.hasVideoTrack()?d.default.VIDEO:d.default.AUDIO,Tt=ve.getCurrentDVRInfo(ot);if(!Tt)return 0;var Lt=Ve.getOriginalLiveDelay(),Ft=Tt.range.start+Pe;return Ft>Tt.range.end-Lt&&(Ft=Tt.range.end-Lt),Ft}function Vt(){if(!Ae)throw B;return Ve.getOriginalLiveDelay()}function jt(Pe){if(!Ae)throw B;var ot=xt().currentTime;if(Pe!==void 0)ot=Ce.getTimeRelativeToStreamId(ot,Pe);else if(Ve.getIsDynamic()){var Tt=Ce&&Ce.hasVideoTrack()?d.default.VIDEO:d.default.AUDIO,Lt=ve.getCurrentDVRInfo(Tt);ot=Lt===null||ot===0?0:Math.max(0,ot-Lt.range.start)}return ot}function Qt(){if(!Ae)throw B;var Pe=xt().duration;if(Ve.getIsDynamic()){var ot=Ce&&Ce.hasVideoTrack()?d.default.VIDEO:d.default.AUDIO,Tt=ve.getCurrentDVRInfo(ot);Pe=Tt?Tt.range.end-Tt.range.start:0}return Pe}function rr(){if(!Ae)throw B;return jt()<0?NaN:Mr(jt())}function or(){if(!Ae)throw B;return Mr(Qt())}function Gt(Pe){if(!me)throw P;return Qe.getTopBitrateInfoFor(Pe)}function Jt(Pe){if(!me)throw P;if(Pe===d.default.IMAGE){var ot=gr();if(!ot)return-1;var Tt=ot.getThumbnailController();return Tt?Tt.getCurrentTrackIndex():-1}return Qe.getQualityFor(Pe)}function Zt(Pe,ot){var Tt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!me)throw P;if(Pe===d.default.IMAGE){var Lt=gr();if(!Lt)return;var Ft=Lt.getThumbnailController();Ft&&Ft.setTrackByIndex(ot)}Qe.setPlaybackQuality(Pe,Ce.getActiveStreamInfo(),ot,{forceReplace:Tt})}function ur(){Qe.setElementSize(),Qe.setWindowResizeEventCalled(!0)}function Yt(Pe){(0,V.checkParameterType)(Pe,"boolean"),He=Pe}function Er(){return He}function _r(){if(!Se)throw re;return Ae?Ve.getCurrentLiveLatency():NaN}function sr(Pe,ot,Tt){je.addAbrCustomRule(Pe,ot,Tt)}function fr(Pe){je.removeAbrCustomRule(Pe)}function mr(){je.removeAllAbrCustomRule()}function hr(){return je.getAbrCustomRules()}function cr(Pe,ot){je.addUTCTimingSource(Pe,ot)}function nr(Pe,ot){je.removeUTCTimingSource(Pe,ot)}function dr(){je.clearDefaultUTCTimingSources()}function $t(){je.restoreDefaultUTCTimingSources()}function Re(Pe){var ot=Qe.getThroughputHistory(),Tt=Ve.getIsDynamic();return ot?ot.getAverageThroughput(Pe,Tt):0}function ze(Pe,ot){je.setXHRWithCredentialsForType(Pe,ot)}function st(Pe){return je.getXHRWithCredentialsForType(Pe)}function yt(){return Sr()}function At(){return ve}function It(Pe){var ot=Ce.getActiveStreamInfo();return!ot||!We?!1:We.enableText(ot.id,Pe)}function Ot(Pe){var ot=Ce.getActiveStreamInfo();return!ot||!We?!1:We.enableForcedTextStreaming(Pe)}function Kt(){var Pe=Ce.getActiveStreamInfo();return!Pe||!We?!1:We.isTextEnabled(Pe)}function Bt(Pe){if(!Ae)throw B;var ot=Ce.getActiveStreamInfo();!ot||!We||We.setTextTrack(ot.id,Pe)}function Ht(){var Pe=NaN,ot=Ce.getActiveStreamInfo();if(!(!ot||!We))return Pe=We.getCurrentTrackIdx(ot.id),Pe}function xt(){if(!et.getElement())throw x;return et.getElement()}function qt(Pe){if(!Se)throw re;et.setElement(Pe),Pe&&(yr(),un(),fn(),Ce&&Ce.switchToVideoElement()),Ae&&Rr(),pr()}function Cr(){return et?et.getTTMLRenderingDiv():null}function Pr(Pe){if(!et.getElement())throw x;et.setTTMLRenderingDiv(Pe)}function Ir(Pe){if(!et.getElement())throw x;et.setVttRenderingDiv(Pe)}function Or(Pe){if(!me)throw P;var ot=gr();return ot?ot.getBitrateListFor(Pe):[]}function Lr(Pe){if(!me)throw P;return nt.getStreamsInfo(Pe)}function Ar(Pe){if(!me)throw P;var ot=Ce.getActiveStreamInfo();return ot?Fe.getTracksFor(Pe,ot.id):[]}function Nr(Pe,ot,Tt){if(!me)throw P;return Tt=Tt||nt.getStreamsInfo(ot,1)[0],Tt?nt.getAllMediaInfoForType(Tt,Pe,ot):[]}function br(Pe){if(!me)throw P;var ot=Ce.getActiveStreamInfo();return Fe.getCurrentTrackFor(Pe,ot.id)}function Fr(Pe,ot){if(!Se)throw re;Fe.setInitialSettings(Pe,ot)}function Br(Pe){if(!Se)throw re;return Fe.getInitialSettings(Pe)}function Ur(Pe){if(!me)throw P;Fe.setTrack(Pe)}function wr(Pe){je.registerCustomCapabilitiesFilter(Pe)}function xr(Pe){je.unregisterCustomCapabilitiesFilter(Pe)}function Kr(Pe){je.setCustomInitialTrackSelectionFunction(Pe)}function jr(){je.resetCustomInitialTrackSelectionFunction(null)}function Wr(Pe){je.registerLicenseRequestFilter(Pe)}function kr(Pe){je.registerLicenseResponseFilter(Pe)}function Gr(Pe){je.unregisterLicenseRequestFilter(Pe)}function Hr(Pe){je.unregisterLicenseResponseFilter(Pe)}function Vr(){return yr()}function Yr(Pe){Be=Pe}function zr(Pe){xe=Pe,Ce&&Ce.setProtectionData(xe)}function Xr(Pe,ot){if(typeof ot=="function"){if(Pe<0){ot(null);return}var Tt=Ve.getIsDynamic()?kt(Pe):Pe,Lt=Ce.getStreamForTime(Tt);if(Lt===null){ot(null);return}var Ft=Lt.getThumbnailController();if(!Ft){ot(null);return}return Ft.provide(Tt,ot)}}function Qr(Pe,ot){var Tt=Tr(),Lt=this,Ft=function lr(ar){ar.error?ot(null,ar.error):ot(ar.manifest),fe.off(Q.default.INTERNAL_MANIFEST_LOADED,lr,Lt),Tt.reset()};fe.on(Q.default.INTERNAL_MANIFEST_LOADED,Ft,Lt),lt.initialize(Pe),Tt.load(Pe)}function Jr(){if(!Ne)throw ne;return Ne}function Zr(Pe){Ne=Pe,Ce.load(Ne)}function vr(Pe){var ot=arguments.length>1&&arguments[1]!==void 0?arguments[1]:NaN;if(!Se)throw re;typeof Pe=="string"&&lt.initialize(Pe),ot==null&&(ot=NaN),isNaN(ot)||(ot=Math.max(0,ot)),Ne=Pe,(me||Ae)&&Rr(),Ie()&&pr(ot)}function $r(){return le.get()}function qr(Pe){le.update(Pe)}function en(){le.reset()}function tn(Pe,ot,Tt){var Lt=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,Ft=new Date(Pe*1e3),lr=Ft.toLocaleDateString(ot),ar=Ft.toLocaleTimeString(ot,{hour12:Tt});return Lt?ar+" "+lr:ar}function rn(Pe){Pe=Math.max(Pe,0);var ot=Math.floor(Pe/3600),Tt=Math.floor(Pe%3600/60),Lt=Math.floor(Pe%3600%60);return(ot===0?"":ot<10?"0"+ot.toString()+":":ot.toString()+":")+(Tt<10?"0"+Tt.toString():Tt.toString())+":"+(Lt<10?"0"+Lt.toString():Lt.toString())}function nn(Pe,ot,Tt){Y.default.extend(Pe,ot,Tt,G)}function gr(){if(!me)throw P;var Pe=Ce.getActiveStreamInfo();return Pe?Ce.getStreamById(Pe.id):null}function an(){return nt}function on(){if(ut)return ut.loadSteeringData()}function sn(){if(ut)return ut.getCurrentSteeringResponseData()}function Rr(){Ae=!1,me=!1,nt.reset(),Ce.reset(),Xe.reset(),mt.reset(),Ve.reset(),rt.reset(),ut.reset(),Qe.reset(),Fe.reset(),Mt.reset(),Be&&(le.get().streaming.protection.keepProtectionMediaKeys?Be.stop():(Be.reset(),Be=null,yr())),We.reset(),Ge.reset(),at.reset()}function ln(){var Pe=Tr();Ce||(Ce=(0,r.default)(G).getInstance()),We||(We=(0,u.default)(G).create({errHandler:ge,manifestModel:Le,adapter:nt,mediaController:Fe,videoModel:et,settings:le})),De.setConfig({capabilities:he,customParametersModel:je,adapter:nt,settings:le,manifestModel:Le,errHandler:ge}),Ce.setConfig({capabilities:he,capabilitiesFilter:De,manifestLoader:Pe,manifestModel:Le,mediaPlayerModel:ht,customParametersModel:je,protectionController:Be,textController:We,adapter:nt,dashMetrics:ve,errHandler:ge,timelineConverter:ye,videoModel:et,playbackController:Ve,serviceDescriptionController:rt,contentSteeringController:ut,abrController:Qe,mediaController:Fe,settings:le,baseURLController:ie,uriFragmentModel:lt,segmentBaseController:Mt}),Xe.setConfig({settings:le,playbackController:Ve,streamController:Ce,videoModel:et,timelineConverter:ye,adapter:nt}),Ve.setConfig({streamController:Ce,serviceDescriptionController:rt,dashMetrics:ve,adapter:nt,videoModel:et,timelineConverter:ye,settings:le}),mt.setConfig({streamController:Ce,playbackController:Ve,mediaPlayerModel:ht,videoModel:et,settings:le}),Qe.setConfig({streamController:Ce,domStorage:vt,mediaPlayerModel:ht,customParametersModel:je,cmsdModel:at,dashMetrics:ve,adapter:nt,videoModel:et,settings:le}),Ge.setConfig({abrController:Qe,dashMetrics:ve,playbackController:Ve}),at.setConfig({}),Qe.initialize(),Ce.initialize(He,xe),We.initialize(),Xe.initialize(),mt.initialize(),Ge.initialize(),at.initialize(),ut.initialize(),Mt.initialize()}function Tr(){return(0,i.default)(G).create({debug:_e,errHandler:ge,dashMetrics:ve,mediaPlayerModel:ht,requestModifier:(0,h.default)(G).getInstance(),mssHandler:Ze,settings:le})}function yr(){if(Be)return Be;var Pe=dashjs.Protection;if(typeof Pe=="function"){var ot=Pe(G).create();return Q.default.extend(Pe.events),q.default.extend(Pe.events,{publicOnly:!0}),b.default.extend(Pe.errors),he||(he=(0,m.default)(G).getInstance()),Be=ot.createProtectionSystem({debug:_e,errHandler:ge,videoModel:et,customParametersModel:je,capabilities:he,eventBus:fe,events:Q.default,BASE64:oe,constants:d.default,cmcdModel:Ge,settings:le}),Be}return null}function un(){if(!Ye){var Pe=dashjs.MetricsReporting;if(typeof Pe=="function"){var ot=Pe(G).create();Ye=ot.createMetricsReporting({debug:_e,eventBus:fe,mediaElement:xt(),adapter:nt,dashMetrics:ve,mediaPlayerModel:ht,events:Q.default,constants:d.default,metricsConstants:y.default})}}}function fn(){if(!Ze){var Pe=dashjs.MssHandler;typeof Pe=="function"&&(b.default.extend(Pe.errors),Ze=Pe(G).create({eventBus:fe,mediaPlayerModel:ht,dashMetrics:ve,manifestModel:Le,playbackController:Ve,streamController:Ce,protectionController:Be,baseURLController:ie,errHandler:ge,events:Q.default,constants:d.default,debug:_e,initSegmentType:ue.HTTPRequest.INIT_SEGMENT_TYPE,BASE64:oe,ISOBoxer:Z,settings:le}))}}function Sr(){if(!Se)throw re;if(tt)return tt;var Pe=dashjs.OfflineController;if(typeof Pe=="function"){Q.default.extend(Pe.events),q.default.extend(Pe.events,{publicOnly:!0}),b.default.extend(Pe.errors);var ot=Tr(),Tt=(0,te.default)(G).create();return Tt.setConfig({manifestModel:Le,adapter:nt,manifestLoader:ot,errHandler:ge}),tt=Pe(G).create({debug:_e,manifestUpdater:Tt,baseURLController:ie,manifestLoader:ot,manifestModel:Le,mediaPlayerModel:ht,abrController:Qe,playbackController:Ve,adapter:nt,errHandler:ge,dashMetrics:ve,timelineConverter:ye,segmentBaseController:Mt,schemeLoaderFactory:Je,eventBus:fe,events:Q.default,errors:b.default,constants:d.default,settings:le,dashConstants:f.default,urlUtils:(0,z.default)(G).getInstance()}),tt}return null}function Mr(Pe){var ot=Ce&&Ce.hasVideoTrack()?d.default.VIDEO:d.default.AUDIO,Tt=ve.getCurrentDVRInfo(ot),Lt,Ft;return Tt?(Lt=Tt.manifestInfo.availableFrom.getTime()/1e3,Ft=Pe+(Lt+Tt.range.start),Ft):0}function pr(){var Pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:NaN;tt&&tt.resetRecords(),!me&&Ne&&(me=!0,Oe.info("Streaming Initialized"),ln(),typeof Ne=="string"?Ce.load(Ne,Pe):Ce.loadWithManifest(Ne,Pe)),!Ae&&Ie()&&(Ae=!0,Oe.info("Playback Initialized"))}return Me={initialize:we,setConfig:de,on:Ke,off:it,extend:nn,attachView:qt,attachSource:vr,isReady:Ie,preload:gt,play:Nt,isPaused:ke,pause:Dt,isSeeking:pe,isDynamic:be,getLowLatencyModeEnabled:Ee,seek:ct,seekToOriginalLive:ft,setPlaybackRate:Ue,getPlaybackRate:$e,setMute:dt,isMuted:_t,setVolume:St,getVolume:Pt,time:jt,duration:Qt,timeAsUTC:rr,durationAsUTC:or,getActiveStream:gr,getDVRWindowSize:Ut,getDVRSeekOffset:kt,getTargetLiveDelay:Vt,convertToTimeCode:rn,formatUTC:tn,getVersion:pt,getDebug:Et,getBufferLength:Rt,getTTMLRenderingDiv:Cr,getVideoElement:xt,getSource:Jr,updateSource:Zr,getCurrentLiveLatency:_r,getTopBitrateInfoFor:Gt,setAutoPlay:Yt,getAutoPlay:Er,getDashMetrics:At,getQualityFor:Jt,setQualityFor:Zt,updatePortalSize:ur,enableText:It,enableForcedTextStreaming:Ot,isTextEnabled:Kt,setTextTrack:Bt,getBitrateInfoListFor:Or,getStreamsFromManifest:Lr,getTracksFor:Ar,getTracksForTypeFromManifest:Nr,getCurrentTrackFor:br,setInitialMediaSettingsFor:Fr,getInitialMediaSettingsFor:Br,setCurrentTrack:Ur,addABRCustomRule:sr,removeABRCustomRule:fr,removeAllABRCustomRule:mr,getABRCustomRules:hr,getAverageThroughput:Re,retrieveManifest:Qr,addUTCTimingSource:cr,removeUTCTimingSource:nr,clearDefaultUTCTimingSources:dr,restoreDefaultUTCTimingSources:$t,setXHRWithCredentialsForType:ze,getXHRWithCredentialsForType:st,getProtectionController:Vr,attachProtectionController:Yr,setProtectionData:zr,registerLicenseRequestFilter:Wr,registerLicenseResponseFilter:kr,unregisterLicenseRequestFilter:Gr,unregisterLicenseResponseFilter:Hr,registerCustomCapabilitiesFilter:wr,unregisterCustomCapabilitiesFilter:xr,setCustomInitialTrackSelectionFunction:Kr,resetCustomInitialTrackSelectionFunction:jr,attachTTMLRenderingDiv:Pr,attachVttRenderingDiv:Ir,getCurrentTextTrackIndex:Ht,provideThumbnail:Xr,getDashAdapter:an,getOfflineController:yt,triggerSteeringRequest:on,getCurrentSteeringResponseData:sn,getSettings:$r,updateSettings:qr,resetSettings:en,reset:qe,destroy:Te},Ct(),Me}F.__dashjs_factory_name="MediaPlayer";var w=Y.default.getClassFactory(F);w.events=q.default,w.errors=b.default,Y.default.updateClassFactory(F.__dashjs_factory_name,w);const O=w},"./src/streaming/MediaPlayerEvents.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>E});var I=e("./src/core/events/EventsBase.js");function g(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(m){return typeof m}:g=function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},g(i)}function d(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function f(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),t&&y(i,t)}function y(i,t){return y=Object.setPrototypeOf||function(n,h){return n.__proto__=h,n},y(i,t)}function _(i){var t=M();return function(){var n=p(i),h;if(t){var c=p(this).constructor;h=Reflect.construct(n,arguments,c)}else h=n.apply(this,arguments);return r(this,h)}}function r(i,t){return t&&(g(t)==="object"||typeof t=="function")?t:T(i)}function T(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function M(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function p(i){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)},p(i)}var C=function(i){f(m,i);var t=_(m);function m(){var n;return d(this,m),n=t.call(this),n.AST_IN_FUTURE="astInFuture",n.BUFFER_EMPTY="bufferStalled",n.BUFFER_LOADED="bufferLoaded",n.BUFFER_LEVEL_STATE_CHANGED="bufferStateChanged",n.BUFFER_LEVEL_UPDATED="bufferLevelUpdated",n.DYNAMIC_TO_STATIC="dynamicToStatic",n.ERROR="error",n.FRAGMENT_LOADING_COMPLETED="fragmentLoadingCompleted",n.FRAGMENT_LOADING_PROGRESS="fragmentLoadingProgress",n.FRAGMENT_LOADING_STARTED="fragmentLoadingStarted",n.FRAGMENT_LOADING_ABANDONED="fragmentLoadingAbandoned",n.LOG="log",n.MANIFEST_LOADED="manifestLoaded",n.METRICS_CHANGED="metricsChanged",n.METRIC_CHANGED="metricChanged",n.METRIC_ADDED="metricAdded",n.METRIC_UPDATED="metricUpdated",n.PERIOD_SWITCH_STARTED="periodSwitchStarted",n.PERIOD_SWITCH_COMPLETED="periodSwitchCompleted",n.QUALITY_CHANGE_REQUESTED="qualityChangeRequested",n.QUALITY_CHANGE_RENDERED="qualityChangeRendered",n.TRACK_CHANGE_RENDERED="trackChangeRendered",n.STREAM_INITIALIZING="streamInitializing",n.STREAM_UPDATED="streamUpdated",n.STREAM_ACTIVATED="streamActivated",n.STREAM_DEACTIVATED="streamDeactivated",n.STREAM_INITIALIZED="streamInitialized",n.STREAM_TEARDOWN_COMPLETE="streamTeardownComplete",n.TEXT_TRACKS_ADDED="allTextTracksAdded",n.TEXT_TRACK_ADDED="textTrackAdded",n.TTML_PARSED="ttmlParsed",n.TTML_TO_PARSE="ttmlToParse",n.CAPTION_RENDERED="captionRendered",n.CAPTION_CONTAINER_RESIZE="captionContainerResize",n.CAN_PLAY="canPlay",n.CAN_PLAY_THROUGH="canPlayThrough",n.PLAYBACK_ENDED="playbackEnded",n.PLAYBACK_ERROR="playbackError",n.PLAYBACK_NOT_ALLOWED="playbackNotAllowed",n.PLAYBACK_METADATA_LOADED="playbackMetaDataLoaded",n.PLAYBACK_LOADED_DATA="playbackLoadedData",n.PLAYBACK_PAUSED="playbackPaused",n.PLAYBACK_PLAYING="playbackPlaying",n.PLAYBACK_PROGRESS="playbackProgress",n.PLAYBACK_RATE_CHANGED="playbackRateChanged",n.PLAYBACK_SEEKED="playbackSeeked",n.PLAYBACK_SEEKING="playbackSeeking",n.PLAYBACK_STALLED="playbackStalled",n.PLAYBACK_STARTED="playbackStarted",n.PLAYBACK_TIME_UPDATED="playbackTimeUpdated",n.PLAYBACK_VOLUME_CHANGED="playbackVolumeChanged",n.PLAYBACK_WAITING="playbackWaiting",n.MANIFEST_VALIDITY_CHANGED="manifestValidityChanged",n.EVENT_MODE_ON_START="eventModeOnStart",n.EVENT_MODE_ON_RECEIVE="eventModeOnReceive",n.CONFORMANCE_VIOLATION="conformanceViolation",n.REPRESENTATION_SWITCH="representationSwitch",n.ADAPTATION_SET_REMOVED_NO_CAPABILITIES="adaptationSetRemovedNoCapabilities",n.CONTENT_STEERING_REQUEST_COMPLETED="contentSteeringRequestCompleted",n}return m}(I.default),v=new C;const E=v},"./src/streaming/MediaPlayerFactory.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>T});var I=e("./src/streaming/MediaPlayer.js");function g(){var M="application/dash+xml",p;function C(i,t,m){if(!i||!/^VIDEO$/i.test(i.nodeName))return null;if(i._dashjs_player)return i._dashjs_player;var n,h=i.id||i.name||"video element";if(t=t||[].slice.call(i.querySelectorAll("source")).filter(function(c){return c.type==M})[0],!t&&i.src)t=document.createElement("source"),t.src=i.src;else if(!t&&!i.src)return null;return m=m||{},n=(0,I.default)(m).create(),n.initialize(i,t.src,i.autoplay),p||(p=n.getDebug().getLogger()),p.debug("Converted "+h+" to dash.js player and added content: "+t.src),i._dashjs_player=n,n}function v(i,t){var m=[];i=i||"[data-dashjs-player]",t=t||document;for(var n=t.querySelectorAll(i),h=0;h<n.length;h++){var c=C(n[h],null);m.push(c)}for(var o=t.querySelectorAll('source[type="'+M+'"]'),l=0;l<o.length;l++){var A=E(o[l]),S=C(A,null);m.push(S)}return m}function E(i){return/^VIDEO$/i.test(i.nodeName)?i:E(i.parentNode)}return{create:C,createAll:v}}var d=g(),f;function y(){window.removeEventListener("load",y),d.createAll()}function _(){window.dashjs&&(window.clearInterval(f),d.createAll())}var r=typeof window<"u"&&window&&window.dashjs&&window.dashjs.skipAutoCreate;!r&&typeof window<"u"&&window&&window.addEventListener&&(window.document.readyState==="complete"?window.dashjs?d.createAll():f=window.setInterval(_,500):window.addEventListener("load",y));const T=d},"./src/streaming/PreBufferSink.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});var I=e("./src/core/Debug.js"),g=e("./src/core/FactoryMaker.js");function d(_){var r=this.context,T,M,p,C=[],v=_;function E(){M=(0,I.default)(r).getInstance().getLogger(T)}function i(){C=[],p=null,v=null}function t(L){return L.segmentType!=="InitializationSegment"?(C.push(L),C.sort(function(U,k){return U.start-k.start}),p=null):p=L,M.debug("PreBufferSink appended chunk s: "+L.start+"; e: "+L.end),v&&v({chunk:L}),Promise.resolve()}function m(L,U){return C=C.filter(function(k){return!((isNaN(U)||k.start<U)&&(isNaN(L)||k.end>L))}),Promise.resolve()}function n(){return Promise.resolve()}function h(){for(var L=[],U=0;U<C.length;U++){var k=C[U];L.length===0||k.start>L[L.length-1].end?L.push({start:k.start,end:k.end}):L[L.length-1].end=k.end}var X={start:function(b){return L[b].start},end:function(b){return L[b].end}};return Object.defineProperty(X,"length",{get:function(){return L.length}}),X}function c(){return Promise.resolve()}function o(){return this}function l(L,U){var k=A(L,U);return p&&(k.push(p),p=null),m(L,U),k}function A(L,U){return C.filter(function(k){return(isNaN(U)||k.start<U)&&(isNaN(L)||k.end>L)})}function S(L){L()}return T={getAllBufferRanges:h,append:t,remove:m,abort:n,discharge:l,reset:i,updateTimestampOffset:c,waitForUpdateEnd:S,getBuffer:o},E(),T}d.__dashjs_factory_name="PreBufferSink";var f=g.default.getClassFactory(d);const y=f},"./src/streaming/SourceBufferSink.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>i});var I=e("./src/core/Debug.js"),g=e("./src/streaming/vo/DashJSError.js"),d=e("./src/core/FactoryMaker.js"),f=e("./src/core/errors/Errors.js"),y=e("./src/core/Settings.js"),_=e("./src/streaming/constants/Constants.js"),r=e("./src/streaming/vo/metrics/HTTPRequest.js"),T=e("./src/core/events/Events.js"),M=.1,p=.01,C=50;function v(t){var m=this.context,n=(0,y.default)(m).getInstance(),h=t.textController,c=t.eventBus,o,l,A,S,L,U,k=[],X=[],W=!1,b=t.mediaSource,j=null;function Q(){A=(0,I.default)(m).getInstance().getLogger(o)}function q(x,ne,re){L=x,l=L.type;var G=L.codec;J(re),K();var fe=[];return fe.push(z()),fe.push(ue(L.streamInfo)),fe.push(Y(G)),ne&&ne.MSETimeOffset!==void 0&&fe.push(oe(ne.MSETimeOffset)),Promise.all(fe)}function Y(x){return new Promise(function(ne){B(function(){S.changeType&&S.changeType(x),ne()})})}function J(x){S=x.getBuffer()}function $(x,ne,re){L=ne,l=L.type;var G=L.codec;try{if(G.match(/application\/mp4;\s*codecs="(stpp|wvtt).*"/i))return ae(x);S=b.addSourceBuffer(G),K();var fe=[];return fe.push(ue(L.streamInfo)),re&&re.MSETimeOffset!==void 0&&fe.push(oe(re.MSETimeOffset)),Promise.all(fe)}catch(le){return L.type==_.default.TEXT&&!L.isFragmented||G.indexOf('codecs="stpp')!==-1||G.indexOf('codecs="vtt')!==-1?ae(x):Promise.reject(le)}}function ae(x){return S=h.getTextSourceBuffer(x),Promise.resolve()}function K(){if(typeof S.addEventListener=="function")try{S.addEventListener("updateend",w,!1),S.addEventListener("error",O,!1),S.addEventListener("abort",O,!1)}catch{U=setInterval(w,C)}else U=setInterval(w,C)}function ee(){return l}function se(){try{typeof S.removeEventListener=="function"&&(S.removeEventListener("updateend",w,!1),S.removeEventListener("error",O,!1),S.removeEventListener("abort",O,!1)),clearInterval(U)}catch(x){A.error(x)}}function ue(x){return new Promise(function(ne){if(!S||!n.get().streaming.buffer.useAppendWindow){ne();return}B(function(){try{if(!S){ne();return}var re=b.duration,G=0;x&&!isNaN(x.start)&&!isNaN(x.duration)&&isFinite(x.duration)&&(re=x.start+x.duration),x&&!isNaN(x.start)&&(G=x.start),(S.appendWindowEnd!==re||S.appendWindowStart!==G)&&(S.appendWindowStart=0,S.appendWindowEnd=re+p,S.appendWindowStart=Math.max(G-M,0),A.debug("Updated append window for ".concat(L.type,". Set start to ").concat(S.appendWindowStart," and end to ").concat(S.appendWindowEnd))),ne()}catch{A.warn("Failed to set append window"),ne()}})})}function oe(x){return new Promise(function(ne){if(!S){ne();return}B(function(){try{S.timestampOffset!==x&&!isNaN(x)&&(S.timestampOffset=x,A.debug("Set MSE timestamp offset to ".concat(x))),ne()}catch{ne()}})})}function Z(){if(S){try{k=[],se(),W=!1,X=[],(!S.getClassName||S.getClassName()!=="TextSourceBuffer")&&(A.debug("Removing sourcebuffer from media source"),b.removeSourceBuffer(S))}catch{}S=null}j=null}function H(){return S}function V(){try{return S.buffered}catch(x){return A.error("getAllBufferRanges exception: "+x.message),null}}function te(x){var ne=this,re=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return new Promise(function(G,fe){if(!x){fe({chunk:x,error:new g.default(f.default.APPEND_ERROR_CODE,f.default.APPEND_ERROR_MESSAGE)});return}X.push({data:x,promise:{resolve:G,reject:fe},request:re}),B(u.bind(ne))})}function z(){return new Promise(function(x){B(function(){var ne=S.appendWindowStart,re=S.appendWindowEnd;S&&(S.abort(),S.appendWindowStart=ne,S.appendWindowEnd=re),x()})})}function R(x){return new Promise(function(ne,re){var G=x.start,fe=x.end;if(!(G>=0&&fe>G)){ne();return}B(function(){try{S.remove(G,fe),B(function(){ne({from:G,to:fe,unintended:!1}),x.resolve&&x.resolve()})}catch(le){re({from:G,to:fe,unintended:!1,error:new g.default(f.default.REMOVE_ERROR_CODE,f.default.REMOVE_ERROR_MESSAGE)}),x.reject&&x.reject(le)}})})}function u(){if(!W&&X.length>0){W=!0;var x=X[0];X.splice(0,1);var ne=function(){W=!1,X.length>0&&u.call(this),x&&x.data&&x.data.segmentType&&x.data.segmentType!==r.HTTPRequest.INIT_SEGMENT_TYPE&&delete x.data.bytes,x.promise.resolve({chunk:x.data})};try{j=x.request,x.data.bytes.byteLength===0?ne.call(this):(S.appendBuffer?S.appendBuffer(x.data.bytes):S.append(x.data.bytes,x.data),B(ne.bind(this)))}catch(re){A.fatal('SourceBuffer append failed "'+re+'"'),X.length>0?u():W=!1,delete x.data.bytes,x.promise.reject({chunk:x.data,error:new g.default(re.code,re.message)})}}}function D(){return new Promise(function(x){try{X=[],b.readyState==="open"?B(function(){try{S&&S.abort(),x()}catch{x()}}):(S&&S.setTextTrack&&b.readyState==="ended"&&S.abort(),x())}catch{x()}})}function F(){if(k.length>0&&!S.updating){var x=k.shift();x(),F()}}function w(){S.updating||F()}function O(x){var ne=x.target||{};P(T.default.SOURCE_BUFFER_ERROR,{error:ne,lastRequestAppended:j})}function P(x,ne){var re=ne||{};c.trigger(x,re,{streamId:L.streamInfo.id,mediaType:l})}function B(x){k.push(x),S.updating||F()}return o={getType:ee,getAllBufferRanges:V,getBuffer:H,append:te,remove:R,abort:D,reset:Z,updateTimestampOffset:oe,initializeForStreamSwitch:q,initializeForFirstUse:$,updateAppendWindow:ue,changeType:Y},Q(),o}v.__dashjs_factory_name="SourceBufferSink";var E=d.default.getClassFactory(v);const i=E},"./src/streaming/Stream.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>n});var I=e("./src/streaming/constants/Constants.js"),g=e("./src/dash/constants/DashConstants.js"),d=e("./src/streaming/StreamProcessor.js"),f=e("./src/streaming/controllers/FragmentController.js"),y=e("./src/streaming/thumbnail/ThumbnailController.js"),_=e("./src/core/EventBus.js"),r=e("./src/core/events/Events.js"),T=e("./src/core/Debug.js"),M=e("./src/core/errors/Errors.js"),p=e("./src/core/FactoryMaker.js"),C=e("./src/streaming/vo/DashJSError.js"),v=e("./src/streaming/utils/BoxParser.js"),E=e("./src/streaming/utils/URLUtils.js"),i=e("./src/streaming/controllers/BlacklistController.js"),t=[I.default.VIDEO,I.default.AUDIO,I.default.TEXT,I.default.MUXED,I.default.IMAGE];function m(h){h=h||{};var c=this.context,o=(0,_.default)(c).getInstance(),l=(0,E.default)(c).getInstance(),A=h.manifestModel,S=h.mediaPlayerModel,L=h.dashMetrics,U=h.manifestUpdater,k=h.adapter,X=h.timelineConverter,W=h.capabilities,b=h.errHandler,j=h.abrController,Q=h.playbackController,q=h.eventController,Y=h.mediaController,J=h.protectionController,$=h.textController,ae=h.videoModel,K=h.streamInfo,ee=h.settings,se,ue,oe,Z,H,V,te,z,R,u,D,F,w,O,P,B,x,ne;function re(){try{B=(0,T.default)(c).getInstance(),ue=B.getLogger(se),tt(),P=(0,v.default)(c).getInstance(),w=(0,i.default)(c).create({updateEventName:r.default.SEGMENT_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:r.default.SEGMENT_LOCATION_BLACKLIST_ADD}),D=(0,f.default)(c).create({streamInfo:K,mediaPlayerModel:S,dashMetrics:L,errHandler:b,settings:ee,boxParser:P,dashConstants:g.default,urlUtils:l})}catch(ke){throw ke}}function G(){fe(),_e(),$.initializeForStream(K),o.trigger(r.default.STREAM_UPDATED,{streamInfo:K})}function fe(){o.on(r.default.BUFFERING_COMPLETED,et,se),o.on(r.default.DATA_UPDATE_COMPLETED,lt,se),o.on(r.default.INBAND_EVENTS,vt,se)}function le(){o.off(r.default.DATA_UPDATE_COMPLETED,lt,se),o.off(r.default.BUFFERING_COMPLETED,et,se),o.off(r.default.INBAND_EVENTS,vt,se)}function _e(){J&&(o.on(r.default.KEY_ERROR,ut,se),o.on(r.default.SERVER_CERTIFICATE_UPDATED,ut,se),o.on(r.default.LICENSE_REQUEST_COMPLETE,ut,se),o.on(r.default.KEY_SYSTEM_SELECTED,ut,se),o.on(r.default.KEY_SESSION_CREATED,ut,se),o.on(r.default.KEY_STATUSES_CHANGED,ut,se))}function Me(){J&&(o.off(r.default.KEY_ERROR,ut,se),o.off(r.default.SERVER_CERTIFICATE_UPDATED,ut,se),o.off(r.default.LICENSE_REQUEST_COMPLETE,ut,se),o.off(r.default.KEY_SYSTEM_SELECTED,ut,se),o.off(r.default.KEY_SESSION_CREATED,ut,se),o.off(r.default.KEY_STATUSES_CHANGED,ut,se))}function Oe(){return K?K.id:null}function Ne(ke,ct){return new Promise(function(ft,pe){if(H){ft(ct);return}if(gt()){H=!0,o.trigger(r.default.STREAM_ACTIVATED,{streamInfo:K}),ft(ct);return}Se(ke,ct).then(function(be){H=!0,o.trigger(r.default.STREAM_ACTIVATED,{streamInfo:K}),ft(be)}).catch(function(be){pe(be)})})}function xe(ke,ct){return new Promise(function(ft,pe){if(gt()){pe();return}ue.info("[startPreloading] Preloading next stream with id ".concat(he())),Et(!0),me(ke,ct).then(function(){for(var be=0;be<oe.length&&oe[be];be++)oe[be].setExplicitBufferingTime(ie()),oe[be].getScheduleController().startScheduleTimer();ft()}).catch(function(){Et(!1),pe()})})}function Se(ke,ct){return me(ke,ct)}function me(ke,ct){return new Promise(function(ft,pe){Ve(),u=!0,Le();var be=ae.getElement();t.forEach(function(Ee){!(Ee===I.default.TEXT&&!ke)&&(Ee!==I.default.VIDEO||!be||be&&/^VIDEO$/i.test(be.nodeName))&&He(Ee,ke)}),ye(ct).then(function(Ee){if(u=!1,oe.length===0){var Ue="No streams to play.";b.error(new C.default(M.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,Ue,A.getValue())),ue.fatal(Ue)}else Ge();ke&&$.createTracks(K),ft(Ee)}).catch(function(Ee){pe(Ee)})})}function Ae(ke){return new Promise(function(ct,ft){He(I.default.TEXT,ke),Fe().then(function(){$.createTracks(K),ct()}).catch(function(pe){ft(pe)})})}function He(ke,ct){var ft=k.getAllMediaInfoForType(K,ke),pe=[],be=null,Ee;if(!ft||ft.length===0){ue.info("No "+ke+" data.");return}ke===I.default.VIDEO&&(te=!0),ke===I.default.AUDIO&&(z=!0);for(var Ue=0,$e=ft.length;Ue<$e;Ue++)be=ft[Ue],ke===I.default.TEXT&&be.isEmbedded&&($.addEmbeddedTrack(K,be),pe.push(be)),Qe(be)&&Y.addTrack(be);if(pe.length>0&&(Y.setInitialMediaSettingsForType(ke,K),$.addMediaInfosToBuffer(K,ke,pe)),ft=ft.filter(function(_t){return!_t.isEmbedded}),ft.length!==0){if(ke===I.default.IMAGE){F=(0,y.default)(c).create({streamInfo:K,adapter:k,baseURLController:h.baseURLController,timelineConverter:h.timelineConverter,debug:B,eventBus:o,events:r.default,dashConstants:g.default,dashMetrics:h.dashMetrics,segmentBaseController:h.segmentBaseController}),F.initialize();return}o.trigger(r.default.STREAM_INITIALIZING,{streamInfo:K,mediaInfo:be}),Y.setInitialMediaSettingsForType(ke,K);var dt=Je(ft,ct);Ee=Y.getCurrentTrackFor(ke,K.id),Ee&&(j.updateTopQualityIndex(Ee),dt.selectMediaInfo(ke!==I.default.TEXT||!Ee.isEmbedded?Ee:ft[0]))}}function Qe(ke){var ct=ke?ke.type:null,ft;return ct===I.default.MUXED?(ft="Multiplexed representations are intentionally not supported, as they are not compliant with the DASH-AVC/264 guidelines",ue.fatal(ft),b.error(new C.default(M.default.MANIFEST_ERROR_ID_MULTIPLEXED_CODE,ft,A.getValue())),!1):ct===I.default.TEXT||ct===I.default.IMAGE?!0:ke.contentProtection&&!W.supportsEncryptedMedia()?(b.error(new C.default(M.default.CAPABILITY_MEDIAKEYS_ERROR_CODE,M.default.CAPABILITY_MEDIAKEYS_ERROR_MESSAGE)),!1):!0}function Je(ke,ct){var ft=ke&&ke.length>0?ke[0]:null,pe=D.getModel(ft?ft.type:null),be=ft?ft.type:null,Ee=ft?ft.mimeType:null,Ue=ft?ft.isFragmented:null,$e=(0,d.default)(c).create({streamInfo:K,type:be,mimeType:Ee,timelineConverter:X,adapter:k,manifestModel:A,mediaPlayerModel:S,fragmentModel:pe,dashMetrics:h.dashMetrics,baseURLController:h.baseURLController,segmentBaseController:h.segmentBaseController,abrController:j,playbackController:Q,mediaController:Y,textController:$,errHandler:b,settings:ee,boxParser:P,segmentBlacklistController:w});$e.initialize(ct,te,Ue),oe.push($e);for(var dt=0;dt<ke.length;dt++)$e.addMediaInfo(ke[dt]);return be===I.default.TEXT&&$.addMediaInfosToBuffer(K,be,ke,pe),$e}function ye(ke){return new Promise(function(ct){var ft={},pe=oe.map(function(be){return be.createBufferSinks(ke)});Promise.all(pe).then(function(be){be.forEach(function(Ee){Ee&&(ft[Ee.getType()]=Ee)}),ct(ft)}).catch(function(){ct(ft)})})}function Fe(){var ke=Ct(I.default.TEXT);return ke?ke.createBufferSinks():Promise.resolve()}function Be(ke){for(var ct=oe?oe.length:0,ft=!1,pe=0;pe<ct;pe++){var be=oe[pe].getFragmentModel();be.abortRequests(),be.resetInitialSettings(),oe[pe].reset(ft,ke)}$&&$.deactivateStream(K),oe=[],H=!1,V=!1,Et(!1),ge(!1),o.trigger(r.default.STREAM_DEACTIVATED,{streamInfo:K})}function Ye(){return H}function Ze(ke){return new Promise(function(ct,ft){for(var pe=[],be=0;be<oe.length;)Qe(oe[be].getMediaInfo())?(pe.push(oe[be].setMediaSource(ke)),be++):(oe[be].reset(),oe.splice(be,1));Promise.all(pe).then(function(){for(var Ee=0;Ee<oe.length;Ee++)oe[Ee].dischargePreBuffer();if(oe.length===0){var Ue="No streams to play.";b.error(new C.default(M.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,Ue+"nostreams",A.getValue())),ue.fatal(Ue)}ct()}).catch(function(Ee){ue.error(Ee),ft(Ee)})})}function tt(ke){Be(ke),Z=!1,te=!1,z=!1,R={},u=!1,x=!1,ne=[]}function nt(ke){D&&(D.reset(),D=null),j&&K&&j.clearDataForStream(K.id),w&&(w.reset(),w=null),tt(ke),K=null,le(),Me()}function ht(){return K?K.duration:NaN}function je(){return x}function ge(ke){x=ke}function ie(){return K?K.start:NaN}function he(){return K?K.id:null}function De(){return K}function Ce(){return z}function We(){return te}function Xe(){return F}function Ve(){if(!ae||!j)throw new Error(I.default.MISSING_CONFIG_ERROR)}function rt(ke){if(Ve(),ke===I.default.IMAGE)return F?F.getBitrateList():[];var ct=at(ke);return j.getBitrateList(ct)}function ut(ke){ke.error&&(b.error(ke.error),ue.fatal(ke.error.message))}function mt(ke){if(!(!H||!K)){V=!1;var ct=ke.newMediaInfo,ft=A.getValue();k.setCurrentMediaInfo(K.id,ct.type,ct);var pe=Mt(ct);if(pe){var be=Q.getTime();ue.info("Stream -  Process track changed at current time "+be),ft.refreshManifestOnSwitchTrack?(ne.push(ke),U.getIsUpdating()||(ue.debug("Stream -  Refreshing manifest for switch track"),U.refreshManifest())):pe.selectMediaInfo(ct).then(function(){(ct.type===I.default.VIDEO||ct.type===I.default.AUDIO)&&j.updateTopQualityIndex(ct),pe.prepareTrackSwitch()})}}}function ve(ke){var ct=Ct(ke.mediaType);ct&&ct.prepareQualityChange(ke)}function Le(){if(q){var ke=k.getEventsFor(K);ke&&ke.length>0&&q.addInlineEvents(ke,K.id)}}function Ge(){for(var ke=oe.length,ct=!!R.audio||!!R.video,ft=ct?new C.default(M.default.DATA_UPDATE_FAILED_ERROR_CODE,M.default.DATA_UPDATE_FAILED_ERROR_MESSAGE):null,pe=0;pe<ke;pe++)if(oe[pe].isUpdating()||u)return;if(J){J.clearMediaInfoArray();for(var be=0;be<ke&&oe[be];be++){var Ee=oe[be].getType(),Ue=oe[be].getMediaInfo();if(Ee===I.default.AUDIO||Ee===I.default.VIDEO||Ee===I.default.TEXT&&Ue.isFragmented){var $e=oe[be].getMediaInfo();$e&&J.initializeForMedia($e)}}J.handleKeySystemFromManifest()}ft?b.error(ft):Z||(Z=!0,ae.waitForReadyState(I.default.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,function(){o.trigger(r.default.STREAM_INITIALIZED,{streamInfo:K})}))}function at(ke){for(var ct=null,ft=0;ft<oe.length;ft++)if(ct=oe[ft],ct.getType()===ke)return ct.getMediaInfo();return null}function et(){var ke=de(),ct=ke.length;if(ct===0){ue.warn("onBufferingCompleted - can't trigger STREAM_BUFFERING_COMPLETED because no streamProcessor is defined");return}for(var ft=0;ft<ct;ft++)if(!ke[ft].isBufferingCompleted()&&(ke[ft].getType()===I.default.AUDIO||ke[ft].getType()===I.default.VIDEO)){ue.debug("onBufferingCompleted - One streamProcessor has finished but",ke[ft].getType(),"one is not buffering completed");return}ue.debug("onBufferingCompleted - trigger STREAM_BUFFERING_COMPLETED"),V=!0,o.trigger(r.default.STREAM_BUFFERING_COMPLETED,{streamInfo:K},{streamInfo:K})}function lt(ke){R[ke.mediaType]=ke.error,Ge()}function vt(ke){q&&q.addInbandEvents(ke.events,K.id)}function Mt(ke){return!ke||!ke.type?null:Ct(ke.type)}function Ct(ke){if(!ke)return null;var ct=de();return ct.filter(function(ft){return ft.getType()===ke})[0]}function de(){for(var ke=[],ct,ft,pe=0;pe<oe.length;pe++)ft=oe[pe],ct=ft.getType(),(ct===I.default.AUDIO||ct===I.default.VIDEO||ct===I.default.TEXT)&&ke.push(ft);return ke}function we(){for(var ke=oe.length,ct=0;ct<ke&&oe[ct];ct++)oe[ct].getScheduleController().startScheduleTimer()}function qe(ke){return new Promise(function(ct){u=!0,K=ke,q&&Le();for(var ft=[],pe=0,be=oe.length;pe<be;pe++){var Ee=oe[pe],Ue=Ee.getMediaInfo();ft.push(Ee.updateStreamInfo(K));var $e=k.getAllMediaInfoForType(K,Ee.getType());if($e=$e.filter(function(St){return!St.isEmbedded}),$e){Ee.clearMediaInfoArray();for(var dt=0;dt<$e.length;dt++){var _t=$e[dt];Ee.addMediaInfo($e[dt]),k.areMediaInfosEqual(Ue,_t)&&(j.updateTopQualityIndex(_t),ft.push(Ee.selectMediaInfo(_t)))}}}Promise.all(ft).then(function(){for(ft=[];ne.length>0;){var St=ne.pop(),Pt=St.newMediaInfo,Rt=Mt(St.oldMediaInfo);if(!Rt)return;ft.push(Rt.prepareTrackSwitch()),Rt.selectMediaInfo(Pt)}return Promise.all(ft)}).then(function(){u=!1,Ge(),o.trigger(r.default.STREAM_UPDATED,{streamInfo:K}),ct()})})}function Te(ke){var ct=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return pt(ke,I.default.VIDEO,ct)&&pt(ke,I.default.AUDIO,ct)}function Ie(ke){return ke?Ke(I.default.VIDEO,ke)&&Ke(I.default.AUDIO,ke):!0}function Ke(ke,ct){var ft=De(),pe=ct.getStreamInfo();if(!pe||!ft)return!0;var be=k.getAdaptationForType(pe.index,ke,pe),Ee=k.getAdaptationForType(ft.index,ke,ft);return!be||!Ee?!be&&!Ee:!(!it(Ee)&&it(be))}function it(ke){return ke?!!(ke.ContentProtection||ke.Representation&&ke.Representation.length>0&&ke.Representation[0].ContentProtection):!1}function pt(ke,ct){var ft=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;if(!ke||!ke.hasOwnProperty("getStreamInfo"))return!1;var pe=ke.getStreamInfo(),be=ft?ft.getStreamInfo():De();if(!pe||!be)return!1;var Ee=k.getAdaptationForType(pe.index,ct,pe),Ue=k.getAdaptationForType(be.index,ct,be);if(!Ee||!Ue)return!Ee&&!Ue;var $e=Ee&&Ue&&Ee.mimeType===Ue.mimeType,dt=Ue.Representation_asArray.map(function(Rt){return Rt.codecs}),_t=Ee.Representation_asArray.map(function(Rt){return Rt.codecs}),St=_t.some(function(Rt){return dt.indexOf(Rt)>-1}),Pt=_t.some(function(Rt){return dt.some(function(Ut){return W.codecRootCompatibleWithCodec(Ut,Rt)})});return St||Pt&&$e}function Et(ke){O=ke}function gt(){return O}function Nt(){return V}function Dt(){return k}return se={initialize:G,getStreamId:Oe,activate:Ne,deactivate:Be,getIsActive:Ye,getDuration:ht,getStartTime:ie,getId:he,getStreamInfo:De,getHasAudioTrack:Ce,getHasVideoTrack:We,startPreloading:xe,initializeForTextWithMediaSource:Ae,getThumbnailController:Xe,getBitrateListFor:rt,updateData:qe,reset:nt,getProcessors:de,setMediaSource:Ze,isMediaCodecCompatible:Te,isProtectionCompatible:Ie,getPreloaded:gt,getIsEndedEventSignaled:je,setIsEndedEventSignaled:ge,getAdapter:Dt,getHasFinishedBuffering:Nt,setPreloaded:Et,startScheduleControllers:we,prepareTrackChange:mt,prepareQualityChange:ve},re(),se}m.__dashjs_factory_name="Stream";const n=p.default.getClassFactory(m)},"./src/streaming/StreamProcessor.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>L});var I=e("./src/streaming/constants/Constants.js"),g=e("./src/dash/constants/DashConstants.js"),d=e("./src/streaming/constants/MetricsConstants.js"),f=e("./src/streaming/models/FragmentModel.js"),y=e("./src/streaming/controllers/BufferController.js"),_=e("./src/streaming/text/NotFragmentedTextBufferController.js"),r=e("./src/streaming/controllers/ScheduleController.js"),T=e("./src/dash/controllers/RepresentationController.js"),M=e("./src/core/FactoryMaker.js"),p=e("./src/streaming/utils/SupervisorTools.js"),C=e("./src/core/EventBus.js"),v=e("./src/core/events/Events.js"),E=e("./src/dash/DashHandler.js"),i=e("./src/core/errors/Errors.js"),t=e("./src/streaming/vo/DashJSError.js"),m=e("./src/core/Debug.js"),n=e("./src/streaming/utils/RequestModifier.js"),h=e("./src/streaming/utils/URLUtils.js"),c=e("./src/streaming/utils/BoxParser.js"),o=e("./src/streaming/vo/metrics/PlayList.js"),l=e("./src/dash/controllers/SegmentsController.js"),A=e("./src/streaming/vo/metrics/HTTPRequest.js");function S(U){U=U||{};var k=this.context,X=(0,C.default)(k).getInstance(),W=U.streamInfo,b=U.type,j=U.errHandler,Q=U.mimeType,q=U.timelineConverter,Y=U.adapter,J=U.manifestModel,$=U.mediaPlayerModel,ae=U.fragmentModel,K=U.abrController,ee=U.playbackController,se=U.mediaController,ue=U.textController,oe=U.dashMetrics,Z=U.settings,H=U.boxParser,V=U.segmentBlacklistController,te,z,R,u,D,F,w,O,P,B,x,ne,re;function G(){z=(0,m.default)(k).getInstance().getLogger(te),Oe(),X.on(v.default.DATA_UPDATE_COMPLETED,Ye,te,{priority:C.default.EVENT_PRIORITY_HIGH}),X.on(v.default.INIT_FRAGMENT_NEEDED,Ae,te),X.on(v.default.MEDIA_FRAGMENT_NEEDED,He,te),X.on(v.default.INIT_FRAGMENT_LOADED,it,te),X.on(v.default.MEDIA_FRAGMENT_LOADED,pt,te),X.on(v.default.BUFFER_LEVEL_STATE_CHANGED,Ze,te),X.on(v.default.BUFFER_CLEARED,tt,te),X.on(v.default.SEEK_TARGET,ft,te),X.on(v.default.FRAGMENT_LOADING_ABANDONED,he,te),X.on(v.default.FRAGMENT_LOADING_COMPLETED,De,te),X.on(v.default.QUOTA_EXCEEDED,Ve,te),X.on(v.default.SET_FRAGMENTED_TEXT_AFTER_DISABLED,We,te),X.on(v.default.SET_NON_FRAGMENTED_TEXT,Xe,te),X.on(v.default.SOURCE_BUFFER_ERROR,nt,te)}function fe(Ee,Ue,$e){ne=(0,l.default)(k).create({events:v.default,eventBus:X,streamInfo:W,timelineConverter:q,dashConstants:g.default,segmentBaseController:U.segmentBaseController,type:b}),x=(0,E.default)(k).create({streamInfo:W,type:b,timelineConverter:q,dashMetrics:oe,mediaPlayerModel:$,baseURLController:U.baseURLController,errHandler:j,segmentsController:ne,settings:Z,boxParser:H,events:v.default,eventBus:X,errors:i.default,debug:(0,m.default)(k).getInstance(),requestModifier:(0,n.default)(k).getInstance(),dashConstants:g.default,constants:I.default,urlUtils:(0,h.default)(k).getInstance()}),R=W.manifestInfo.isDynamic,x.initialize(R),K.registerStreamType(b,te),O=(0,T.default)(k).create({streamInfo:W,type:b,abrController:K,dashMetrics:oe,playbackController:ee,timelineConverter:q,dashConstants:g.default,events:v.default,eventBus:X,errors:i.default,isDynamic:R,segmentsController:ne}),F=ct(b,$e),F&&F.initialize(Ee),w=(0,r.default)(k).create({streamInfo:W,type:b,mimeType:Q,adapter:Y,dashMetrics:oe,mediaPlayerModel:$,fragmentModel:ae,abrController:K,playbackController:ee,textController:ue,mediaController:se,bufferController:F,settings:Z}),w.initialize(Ue),re=0,P=!1}function le(){return W.id}function _e(){return b}function Me(){return Y.getIsTextTrack(O.getData())}function Oe(){D=[],u=null,re=0,P=!1,B=!1}function Ne(Ee,Ue){x&&x.reset(),F&&(F.reset(Ee,Ue),F=null),w&&(w.reset(),w=null),O&&(O.reset(),O=null),ne&&(ne=null),K&&K.unRegisterStreamType(le(),b),X.off(v.default.DATA_UPDATE_COMPLETED,Ye,te),X.off(v.default.INIT_FRAGMENT_NEEDED,Ae,te),X.off(v.default.MEDIA_FRAGMENT_NEEDED,He,te),X.off(v.default.INIT_FRAGMENT_LOADED,it,te),X.off(v.default.MEDIA_FRAGMENT_LOADED,pt,te),X.off(v.default.BUFFER_LEVEL_STATE_CHANGED,Ze,te),X.off(v.default.BUFFER_CLEARED,tt,te),X.off(v.default.SEEK_TARGET,ft,te),X.off(v.default.FRAGMENT_LOADING_ABANDONED,he,te),X.off(v.default.FRAGMENT_LOADING_COMPLETED,De,te),X.off(v.default.SET_FRAGMENTED_TEXT_AFTER_DISABLED,We,te),X.off(v.default.SET_NON_FRAGMENTED_TEXT,Xe,te),X.off(v.default.QUOTA_EXCEEDED,Ve,te),X.off(v.default.SOURCE_BUFFER_ERROR,nt,te),Oe(),b=null,W=null}function xe(){return O?O.isUpdating():!1}function Se(Ee){return new Promise(function(Ue){var $e=F.hasBufferAtTime(Ee.seekTime);if($e){F.pruneBuffer(),Ue();return}w.clearScheduleTimer(),ae.abortRequests(),F.prepareForPlaybackSeek().then(function(){var dt=F.getAllRangesWithSafetyFactor(Ee.seekTime);return F.clearBuffers(dt)}).then(function(){var dt=F.getContinuousBufferTimeForTargetTime(Ee.seekTime);if(!isNaN(dt)&&!isNaN(W.duration)&&isFinite(W.duration)&&dt>=W.start+W.duration)F.setIsBufferingCompleted(!0),Ue();else{var _t=isNaN(dt)?Ee.seekTime:dt;pe(_t),F.setSeekTarget(_t);var St=[];St.push(F.updateAppendWindow());var Pt=qe();St.push(F.updateBufferTimestampOffset(Pt)),Promise.all(St).then(function(){w.setInitSegmentRequired(!0),w.setCheckPlaybackQuality(!1),w.startScheduleTimer(),Ue()})}}).catch(function(dt){z.error(dt)})})}function me(){return new Promise(function(Ee,Ue){try{w.clearScheduleTimer(),ae.abortRequests(),F.prepareForPlaybackSeek().then(function(){return F.pruneAllSafely()}).then(function(){Ee()})}catch($e){Ue($e)}})}function Ae(Ee){var Ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(Ee.sender){if(ee.getIsManifestUpdateInProgress()){Be();return}if(!(Me()&&!ue.isTextEnabled())&&F&&Ee.representationId&&!F.appendInitSegmentFromCache(Ee.representationId)){var $e=O.getCurrentRepresentation();if($e.range===0){He();return}var dt=x?x.getInitRequest(u,$e):null;dt?ae.executeRequest(dt):Ue&&(w.setInitSegmentRequired(!0),Be())}}}function He(Ee){var Ue=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(ee.getIsManifestUpdateInProgress()||F.getIsPruningInProgress()){Be();return}var $e=Fe();$e?(P=!1,Qe($e)):Je(Ue)}function Qe(Ee){isNaN(Ee.startTime+Ee.duration)||(re=Ee.startTime+Ee.duration),Ee.delayLoadingTime=new Date().getTime()+w.getTimeToLoadDelay(),w.setTimeToLoadDelay(0),ye(Ee)?(z.warn("Fragment request url ".concat(Ee.url," for stream id ").concat(W.id," and media type ").concat(b," is on the ignore list and will be skipped")),Be()):(z.debug("Next fragment request url for stream id ".concat(W.id," and media type ").concat(b," is ").concat(Ee.url)),ae.executeRequest(Ee))}function Je(Ee){var Ue=O.getCurrentRepresentation();if(Z.get().streaming.gaps.enableSeekFix&&(P||ee.getTime()===0)){var $e;if(R?R&&Ue.segmentInfoType===g.default.SEGMENT_TIMELINE&&($e=x.getValidTimeAheadOfTargetTime(re,u,Ue,Z.get().streaming.gaps.threshold)):$e=x.getValidTimeAheadOfTargetTime(re,u,Ue,Z.get().streaming.gaps.threshold),!isNaN($e)&&$e!==re){ee.isSeeking()||ee.getTime()===0?(z.warn("Adjusting playback time ".concat($e," because of gap in the manifest. Seeking by ").concat($e-re)),ee.seek($e,!1,!1)):(z.warn("Adjusting buffering time ".concat($e," because of gap in the manifest. Adjusting time by ").concat($e-re)),pe($e),Ee&&Be());return}}var dt=x.isLastSegmentRequested(Ue,re);if(dt){var _t=x.getCurrentIndex();z.debug("Segment requesting for stream ".concat(W.id," has finished")),X.trigger(v.default.STREAM_REQUESTING_COMPLETED,{segmentIndex:_t},{streamId:W.id,mediaType:b}),F.segmentRequestingCompleted(_t),w.clearScheduleTimer();return}Ee&&Be()}function ye(Ee){var Ue=Ee.url;return Ee.range&&(Ue=Ue.concat("_",Ee.range)),V.contains(Ue)}function Fe(){var Ee=qe(),Ue;if(isNaN(re)||_e()===I.default.TEXT&&!ue.isTextEnabled())return null;if(x){var $e=O&&Ee?O.getRepresentationForQuality(Ee.quality):null;P?Ue=x.getSegmentRequestForTime(u,$e,re):Ue=x.getNextSegmentRequest(u,$e)}return Ue}function Be(){w.startScheduleTimer(ee.getLowLatencyModeEnabled()?Z.get().streaming.scheduling.lowLatencyTimeout:Z.get().streaming.scheduling.defaultTimeout)}function Ye(Ee){Ee.error||(w.setCurrentRepresentation(Y.convertRepresentationToRepresentationInfo(Ee.currentRepresentation)),F.getIsBufferingCompleted()||F.updateBufferTimestampOffset(Ee.currentRepresentation))}function Ze(Ee){oe.addBufferState(b,Ee.state,w.getBufferTarget()),Ee.state===d.default.BUFFER_EMPTY&&!ee.isSeeking()&&(z.info("Buffer is empty! Stalling!"),oe.pushPlayListTraceMetrics(new Date,o.PlayListTrace.REBUFFERING_REASON))}function tt(Ee){ae.syncExecutedRequestsWithBufferedRange(F.getBuffer().getAllBufferRanges(),W.duration),Ee.quotaExceeded&&Ee.from>ee.getTime()&&pe(Ee.from),Ee.hasEnoughSpaceToAppend&&Ee.quotaExceeded&&w.startScheduleTimer()}function nt(Ee){if(!(!Ee||!Ee.lastRequestAppended||!Ee.lastRequestAppended.url)){var Ue=Ee.lastRequestAppended.url;Ee.lastRequestAppended.range&&(Ue=Ue.concat("_",Ee.lastRequestAppended.range)),z.warn("Blacklisting segment with url ".concat(Ue)),V.add(Ue)}}function ht(Ee){z.debug("Preparing quality switch for type ".concat(b));var Ue=Ee.newQuality;B=!0,w.clearScheduleTimer();var $e=qe(Ue);w.setCurrentRepresentation($e),O.prepareQualityChange(Ue),ae.abortRequests(),F.updateBufferTimestampOffset($e).then(function(){Ee.reason&&Ee.reason.forceReplace?je():Z.get().streaming.buffer.fastSwitchEnabled?ge($e):ie(),oe.pushPlayListTraceMetrics(new Date,o.PlayListTrace.REPRESENTATION_SWITCH_STOP_REASON),oe.createPlaylistTraceMetrics($e.id,ee.getTime()*1e3,ee.getPlaybackRate())})}function je(){X.trigger(v.default.BUFFER_REPLACEMENT_STARTED,{mediaType:b,streamId:W.id},{mediaType:b,streamId:W.id}),F.prepareForReplacementQualitySwitch().then(function(){Dt(),B=!1}).catch(function(){Dt(),B=!1})}function ge(Ee){var Ue=ee.getTime(),$e=1.5*(isNaN(Ee.fragmentDuration)?1:Ee.fragmentDuration),dt=ae.getRequests({state:f.default.FRAGMENT_MODEL_EXECUTED,time:Ue+$e,threshold:0})[0];if(dt&&!Me()){var _t=F.getBufferLevel(),St=K.getAbandonmentStateFor(W.id,b);if(dt.quality<Ee.quality&&_t>=$e&&St!==d.default.ABANDON_LOAD){var Pt=Ue+$e;pe(Pt),w.setCheckPlaybackQuality(!1),w.startScheduleTimer()}else ie()}else w.startScheduleTimer();B=!1}function ie(){ke(),B=!1}function he(Ee){z.info("onFragmentLoadingAbandoned request: "+Ee.request.url+" has been aborted"),!ee.isSeeking()&&!w.getSwitchStrack()&&!B&&(z.info("onFragmentLoadingAbandoned request: "+Ee.request.url+" has to be downloaded again, origin is not seeking process or switch track call"),Ee.request&&Ee.request.isInitializationRequest()?w.setInitSegmentRequired(!0):pe(Ee.request.startTime+Ee.request.duration/2),w.startScheduleTimer(0))}function De(Ee){z.info("OnFragmentLoadingCompleted for stream id "+W.id+" and media type "+b+" - Url:",Ee.request?Ee.request.url:"undefined",Ee.request.range?", Range:"+Ee.request.range:""),Me()&&w.startScheduleTimer(0),Ee.error&&Ee.request.serviceLocation&&Ce(Ee)}function Ce(Ee){z.info("Fragment loading completed with an error"),!(!Ee||!Ee.request||!Ee.request.type)&&(Ee.request.type===A.HTTPRequest.INIT_SEGMENT_TYPE?Ae({representationId:Ee.request.representationId,sender:{}},!1):Ee.request.type===A.HTTPRequest.MEDIA_SEGMENT_TYPE&&(pe(Ee.request.startTime+Ee.request.duration/2),He({},!1)))}function We(){pe(ee.getTime()),we().startScheduleTimer()}function Xe(Ee){var Ue=Ee.currentTrackInfo;if(Ue){var $e=D.find(function(dt){return dt.index===Ue.index&&dt.lang===Ue.lang});$e&&et($e).then(function(){F.setIsBufferingCompleted(!1),pe(ee.getTime()),w.setInitSegmentRequired(!0),w.startScheduleTimer()})}}function Ve(Ee){pe(Ee.quotaExceededTime),w.clearScheduleTimer()}function rt(){return O}function ut(){return F?F.getBuffer():null}function mt(){return F}function ve(){F.dischargePreBuffer()}function Le(){return ae}function Ge(Ee){return W=Ee,Te()?Promise.resolve():F.updateAppendWindow()}function at(){return W}function et(Ee){Ee!==u&&(!Ee||!u||Ee.type===u.type)&&(u=Ee);var Ue=Y.getRealAdaptation(W,u),$e=Y.getVoRepresentations(u);if(O){var dt=O.getData(),_t=K.getMaxAllowedIndexFor(b,W.id),St=K.getMinAllowedIndexFor(b,W.id),Pt,Rt,Ut=null;return(dt===null||dt.id!==Ue.id)&&b!==I.default.TEXT?(Rt=K.getThroughputHistory().getAverageThroughput(b,R),Ut=Rt||K.getInitialBitrateFor(b,W.id),Pt=K.getQualityForBitrate(u,Ut,W.id)):Pt=K.getQualityFor(b,W.id),St!==void 0&&Pt<St&&(Pt=St),Pt>_t&&(Pt=_t),O.updateData(Ue,$e,b,u.isFragmented,Pt)}else return Promise.resolve()}function lt(Ee){D.indexOf(Ee)===-1&&D.push(Ee)}function vt(){D=[]}function Mt(){return u}function Ct(){return F.getMediaSource()}function de(Ee){return F.setMediaSource(Ee,u)}function we(){return w}function qe(Ee){var Ue;return Ee!==void 0?((0,p.checkInteger)(Ee),Ue=O?O.getRepresentationForQuality(Ee):null):Ue=O?O.getCurrentRepresentation():null,Y.convertRepresentationToRepresentationInfo(Ue)}function Te(){return F?F.getIsBufferingCompleted():!1}function Ie(){return F?F.getBufferLevel():0}function Ke(){var Ee=qe(),Ue=O&&Ee?O.getRepresentationForQuality(Ee.quality):null;return x.getNextSegmentRequestIdempotent(u,Ue)}function it(Ee){if(Z.get().streaming.enableManifestTimescaleMismatchFix){var Ue=Ee.chunk,$e=Ue.bytes,dt=Ue.quality,_t=qe(dt),St=O&&_t?O.getRepresentationForQuality(_t.quality):null;if(_t&&St){var Pt=H.getMediaTimescaleFromMoov($e);St.timescale=Pt}}}function pt(Ee){var Ue=Ee.chunk,$e=Ue.bytes,dt=Ue.quality,_t=qe(dt),St=O&&_t?O.getRepresentationForQuality(_t.quality):null;if(_t&&St){var Pt=Y.getEventsFor(_t.mediaInfo,null,W),Rt=Y.getEventsFor(_t,St,W);if(Pt&&Pt.length>0||Rt&&Rt.length>0){var Ut=ae.getRequests({state:f.default.FRAGMENT_MODEL_EXECUTED,quality:dt,index:Ue.index})[0],kt=Et($e,Ut,Pt,Rt);X.trigger(v.default.INBAND_EVENTS,{events:kt},{streamId:W.id})}}}function Et(Ee,Ue,$e,dt){try{for(var _t={},St=[],Pt=$e.concat(dt),Rt=0,Ut=Pt.length;Rt<Ut;Rt++)_t[Pt[Rt].schemeIdUri+"/"+Pt[Rt].value]=Pt[Rt];var kt=(0,c.default)(k).getInstance().parse(Ee),Vt=kt.getBoxes("emsg");if(!Vt||Vt.length===0)return St;for(var jt=kt.getBox("sidx"),Qt=jt&&!isNaN(jt.earliest_presentation_time)&&!isNaN(jt.timescale)?jt.earliest_presentation_time/jt.timescale:Ue&&!isNaN(Ue.mediaStartTime)?Ue.mediaStartTime:0,rr=Math.max(Qt,0),or=O.getCurrentRepresentation(),Gt=0,Jt=Vt.length;Gt<Jt;Gt++){var Zt=Y.getEvent(Vt[Gt],_t,rr,or);Zt&&St.push(Zt)}return St}catch{return[]}}function gt(Ee){var Ue=ut();return Ue?Promise.resolve(Ue):F?F.createBufferSink(u,Ee):Promise.resolve(null)}function Nt(){return new Promise(function(Ee){z.debug("Preparing track switch for type ".concat(b));var Ue=b===I.default.TEXT||Z.get().streaming.trackSwitchMode[b]===I.default.TRACK_SWITCH_MODE_ALWAYS_REPLACE&&ee.getTimeToStreamEnd(W)>Z.get().streaming.buffer.stallThreshold;if(F.getIsBufferingCompleted()&&!Ue){F.prepareForNonReplacementTrackSwitch(u.codec).then(function(){X.trigger(v.default.BUFFERING_COMPLETED,{},{streamId:W.id,mediaType:b})}).catch(function(){X.trigger(v.default.BUFFERING_COMPLETED,{},{streamId:W.id,mediaType:b})}),Ee();return}w.clearScheduleTimer(),w.setSwitchTrack(!0),Ue?(X.trigger(v.default.BUFFER_REPLACEMENT_STARTED,{mediaType:b,streamId:W.id},{mediaType:b,streamId:W.id}),ae.abortRequests(),F.prepareForReplacementTrackSwitch(u.codec).then(function(){var $e=qe();return F.updateBufferTimestampOffset($e)}).then(function(){Dt(),Ee()}).catch(function(){Dt(),Ee()})):F.prepareForNonReplacementTrackSwitch(u.codec).then(function(){ke(),Ee()}).catch(function(){ke(),Ee()})})}function Dt(){var Ee=ee.getTime();Z.get().streaming.buffer.flushBufferAtTrackSwitch&&ee.seek(Ee+.001,!1,!0),pe(Ee),F.setSeekTarget(Ee),w.startScheduleTimer()}function ke(){var Ee=ee.getTime(),Ue=F.getContinuousBufferTimeForTargetTime(Ee),$e=isNaN(Ue)?Ee:Ue;pe($e),w.startScheduleTimer()}function ct(Ee,Ue){var $e=null;return Ee?(Ee===I.default.TEXT&&!Ue?$e=(0,_.default)(k).create({streamInfo:W,type:Ee,mimeType:Q,fragmentModel:ae,textController:ue,errHandler:j,settings:Z}):$e=(0,y.default)(k).create({streamInfo:W,type:Ee,mediaPlayerModel:$,manifestModel:J,fragmentModel:ae,errHandler:j,mediaController:se,representationController:O,adapter:Y,textController:ue,abrController:K,playbackController:ee,settings:Z}),$e):(j.error(new t.default(i.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,i.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+"not properly defined")),null)}function ft(Ee){Ee&&!isNaN(Ee.time)&&(pe(Ee.time),F.setSeekTarget(Ee.time))}function pe(Ee){re=Ee,P=!0}function be(Ee,Ue){oe.pushPlayListTraceMetrics(Ee,Ue)}return te={initialize:fe,getStreamId:le,getType:_e,isUpdating:xe,getBufferController:mt,dischargePreBuffer:ve,getFragmentModel:Le,getScheduleController:we,getRepresentationController:rt,getRepresentationInfo:qe,getBufferLevel:Ie,isBufferingCompleted:Te,createBufferSinks:gt,updateStreamInfo:Ge,getStreamInfo:at,selectMediaInfo:et,clearMediaInfoArray:vt,addMediaInfo:lt,prepareTrackSwitch:Nt,prepareQualityChange:ht,getMediaInfo:Mt,getMediaSource:Ct,setMediaSource:de,getBuffer:ut,setExplicitBufferingTime:pe,finalisePlayList:be,probeNextRequest:Ke,prepareInnerPeriodPlaybackSeeking:Se,prepareOuterPeriodPlaybackSeeking:me,reset:Ne},G(),te}S.__dashjs_factory_name="StreamProcessor";const L=M.default.getClassFactory(S)},"./src/streaming/XlinkLoader.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>p});var I=e("./src/streaming/vo/DashJSError.js"),g=e("./src/streaming/net/URLLoader.js"),d=e("./src/streaming/vo/metrics/HTTPRequest.js"),f=e("./src/streaming/vo/TextRequest.js"),y=e("./src/core/EventBus.js"),_=e("./src/core/events/Events.js"),r=e("./src/core/FactoryMaker.js"),T=e("./src/core/errors/Errors.js");function M(C){C=C||{};var v="urn:mpeg:dash:resolve-to-zero:2013",E=this.context,i=(0,y.default)(E).getInstance(),t=(0,g.default)(E).create({errHandler:C.errHandler,dashMetrics:C.dashMetrics,mediaPlayerModel:C.mediaPlayerModel,requestModifier:C.requestModifier,errors:T.default}),m;function n(c,o,l){var A=function(U,k){o.resolved=!0,o.resolvedContent=U||null,i.trigger(_.default.XLINK_ELEMENT_LOADED,{element:o,resolveObject:l,error:U||k?null:new I.default(T.default.XLINK_LOADER_LOADING_FAILURE_ERROR_CODE,T.default.XLINK_LOADER_LOADING_FAILURE_ERROR_MESSAGE+c)})};if(c===v)A(null,!0);else{var S=new f.default(c,d.HTTPRequest.XLINK_EXPANSION_TYPE);t.load({request:S,success:function(U){A(U)},error:function(){A(null)}})}}function h(){t&&(t.abort(),t=null)}return m={load:n,reset:h},m}M.__dashjs_factory_name="XlinkLoader";const p=r.default.getClassFactory(M)},"./src/streaming/constants/ConformanceViolationConstants.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>I});const I={LEVELS:{SUGGESTION:"Suggestion",WARNING:"Warning",ERROR:"Error"},EVENTS:{NO_UTC_TIMING_ELEMENT:{key:"NO_UTC_TIMING_ELEMENT",message:"No UTCTiming element is present in the manifest. You may experience playback failures. For a detailed validation use https://conformance.dashif.org/"},NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE:{key:"NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE",message:'SMPTE 2052-1:2013 defines the attribute name as "imageType" and does not define "imagetype"'},INVALID_DVR_WINDOW:{key:"INVALID_DVR_WINDOW",message:"No valid segment found when applying a specification compliant DVR window calculation. Using SegmentTimeline entries as a fallback."}}}},"./src/streaming/constants/Constants.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>_});function I(r,T){if(!(r instanceof T))throw new TypeError("Cannot call a class as a function")}function g(r,T){for(var M=0;M<T.length;M++){var p=T[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(r,p.key,p)}}function d(r,T,M){return T&&g(r.prototype,T),M&&g(r,M),r}var f=function(){function r(){I(this,r),this.init()}return d(r,[{key:"init",value:function(){this.STREAM="stream",this.VIDEO="video",this.AUDIO="audio",this.TEXT="text",this.MUXED="muxed",this.IMAGE="image",this.STPP="stpp",this.TTML="ttml",this.VTT="vtt",this.WVTT="wvtt",this.CONTENT_STEERING="contentSteering",this.ABR_STRATEGY_DYNAMIC="abrDynamic",this.ABR_STRATEGY_BOLA="abrBola",this.ABR_STRATEGY_L2A="abrL2A",this.ABR_STRATEGY_LoLP="abrLoLP",this.ABR_STRATEGY_THROUGHPUT="abrThroughput",this.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA="abrFetchThroughputCalculationDownloadedData",this.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING="abrFetchThroughputCalculationMoofParsing",this.ABR_FETCH_THROUGHPUT_CALCULATION_AAST="abrFetchThroughputCalculationAAST",this.LIVE_CATCHUP_MODE_DEFAULT="liveCatchupModeDefault",this.LIVE_CATCHUP_MODE_LOLP="liveCatchupModeLoLP",this.MOVING_AVERAGE_SLIDING_WINDOW="slidingWindow",this.MOVING_AVERAGE_EWMA="ewma",this.BAD_ARGUMENT_ERROR="Invalid Arguments",this.MISSING_CONFIG_ERROR="Missing config parameter(s)",this.TRACK_SWITCH_MODE_ALWAYS_REPLACE="alwaysReplace",this.TRACK_SWITCH_MODE_NEVER_REPLACE="neverReplace",this.TRACK_SELECTION_MODE_FIRST_TRACK="firstTrack",this.TRACK_SELECTION_MODE_HIGHEST_BITRATE="highestBitrate",this.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY="highestEfficiency",this.TRACK_SELECTION_MODE_WIDEST_RANGE="widestRange",this.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY="highestSelectionPriority",this.CMCD_MODE_QUERY="query",this.CMCD_MODE_HEADER="header",this.LOCATION="Location",this.INITIALIZE="initialize",this.TEXT_SHOWING="showing",this.TEXT_HIDDEN="hidden",this.CC1="CC1",this.CC3="CC3",this.UTF8="utf-8",this.SCHEME_ID_URI="schemeIdUri",this.START_TIME="starttime",this.SERVICE_DESCRIPTION_DVB_LL_SCHEME="urn:dvb:dash:lowlatency:scope:2019",this.SUPPLEMENTAL_PROPERTY_DVB_LL_SCHEME="urn:dvb:dash:lowlatency:critical:2019",this.XML="XML",this.ARRAY_BUFFER="ArrayBuffer",this.DVB_REPORTING_URL="dvb:reportingUrl",this.DVB_PROBABILITY="dvb:probability",this.VIDEO_ELEMENT_READY_STATES={HAVE_NOTHING:0,HAVE_METADATA:1,HAVE_CURRENT_DATA:2,HAVE_FUTURE_DATA:3,HAVE_ENOUGH_DATA:4},this.FILE_LOADER_TYPES={FETCH:"fetch_loader",XHR:"xhr_loader"}}}]),r}(),y=new f;const _=y},"./src/streaming/constants/MetricsConstants.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>_});function I(r,T){if(!(r instanceof T))throw new TypeError("Cannot call a class as a function")}function g(r,T){for(var M=0;M<T.length;M++){var p=T[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(r,p.key,p)}}function d(r,T,M){return T&&g(r.prototype,T),M&&g(r,M),r}var f=function(){function r(){I(this,r),this.init()}return d(r,[{key:"init",value:function(){this.TCP_CONNECTION="TcpList",this.HTTP_REQUEST="HttpList",this.TRACK_SWITCH="RepSwitchList",this.BUFFER_LEVEL="BufferLevel",this.BUFFER_LOADED="bufferLoaded",this.ABANDON_LOAD="abandonload",this.ALLOW_LOAD="allowload",this.BUFFER_EMPTY="bufferStalled",this.BUFFER_STATE="BufferState",this.DVR_INFO="DVRInfo",this.DROPPED_FRAMES="DroppedFrames",this.SCHEDULING_INFO="SchedulingInfo",this.REQUESTS_QUEUE="RequestsQueue",this.MANIFEST_UPDATE="ManifestUpdate",this.MANIFEST_UPDATE_STREAM_INFO="ManifestUpdatePeriodInfo",this.MANIFEST_UPDATE_TRACK_INFO="ManifestUpdateRepresentationInfo",this.PLAY_LIST="PlayList",this.DVB_ERRORS="DVBErrors",this.HTTP_REQUEST_DVB_REPORTING_TYPE="DVBReporting"}}]),r}(),y=new f;const _=y},"./src/streaming/constants/ProtectionConstants.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>_});function I(r,T){if(!(r instanceof T))throw new TypeError("Cannot call a class as a function")}function g(r,T){for(var M=0;M<T.length;M++){var p=T[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(r,p.key,p)}}function d(r,T,M){return T&&g(r.prototype,T),M&&g(r,M),r}var f=function(){function r(){I(this,r),this.init()}return d(r,[{key:"init",value:function(){this.CLEARKEY_KEYSTEM_STRING="org.w3.clearkey",this.WIDEVINE_KEYSTEM_STRING="com.widevine.alpha",this.PLAYREADY_KEYSTEM_STRING="com.microsoft.playready",this.PLAYREADY_RECOMMENDATION_KEYSTEM_STRING="com.microsoft.playready.recommendation",this.INITIALIZATION_DATA_TYPE_CENC="cenc",this.INITIALIZATION_DATA_TYPE_KEYIDS="keyids",this.INITIALIZATION_DATA_TYPE_WEBM="webm"}}]),r}(),y=new f;const _=y},"./src/streaming/controllers/AbrController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>S});var I=e("./src/streaming/rules/abr/ABRRulesCollection.js"),g=e("./src/streaming/constants/Constants.js"),d=e("./src/streaming/constants/MetricsConstants.js"),f=e("./src/streaming/vo/BitrateInfo.js"),y=e("./src/streaming/models/FragmentModel.js"),_=e("./src/core/EventBus.js"),r=e("./src/core/events/Events.js"),T=e("./src/core/FactoryMaker.js"),M=e("./src/streaming/rules/RulesContext.js"),p=e("./src/streaming/rules/SwitchRequest.js"),C=e("./src/streaming/rules/SwitchRequestHistory.js"),v=e("./src/streaming/rules/DroppedFramesHistory.js"),E=e("./src/streaming/rules/ThroughputHistory.js"),i=e("./src/core/Debug.js"),t=e("./src/streaming/vo/metrics/HTTPRequest.js"),m=e("./src/streaming/utils/SupervisorTools.js"),n=e("./src/streaming/MediaPlayerEvents.js"),h=1e3,c=100,o=0;function l(){var L=this.context,U=(0,i.default)(L).getInstance(),k=(0,_.default)(L).getInstance(),X,W,b,j,Q,q,Y,J,$,ae,K,ee,se,ue,oe,Z,H,V,te,z,R,u,D,F,w,O,P;function B(){W=U.getLogger(X),fe()}function x(){R=(0,v.default)(L).create(),u=(0,E.default)(L).create({settings:P}),b=(0,I.default)(L).create({dashMetrics:O,customParametersModel:Z,mediaPlayerModel:oe,settings:P}),b.initialize(),k.on(n.default.QUALITY_CHANGE_RENDERED,Ne,X),k.on(n.default.METRIC_ADDED,xe,X),k.on(r.default.LOADING_PROGRESS,Oe,X)}function ne(ve,Le){var Ge=Le.getStreamInfo().id;Y[Ge]||(Y[Ge]={}),z[Ge]||(z[Ge]={}),J[Ge]||(J[Ge]={}),z[Ge][ve]=(0,C.default)(L).create(),Y[Ge][ve]=Le,J[Ge][ve]={},J[Ge][ve].state=d.default.ALLOW_LOAD,re(ve),ve===g.default.VIDEO&&ut()}function re(ve){var Le=P.get().streaming.abr.ABRStrategy;Le===g.default.ABR_STRATEGY_L2A?(D[ve]=!1,w[ve]=!1,F[ve]=!0):Le===g.default.ABR_STRATEGY_LoLP?(D[ve]=!1,w[ve]=!0,F[ve]=!1):Le===g.default.ABR_STRATEGY_BOLA?(D[ve]=!0,w[ve]=!1,F[ve]=!1):Le===g.default.ABR_STRATEGY_THROUGHPUT?(D[ve]=!1,w[ve]=!1,F[ve]=!1):Le===g.default.ABR_STRATEGY_DYNAMIC&&(D[ve]=D&&D[ve]?D[ve]:!1,w[ve]=!1,F[ve]=!1)}function G(ve,Le){try{Y[ve]&&Y[ve][Le]&&delete Y[ve][Le],z[ve]&&z[ve][Le]&&delete z[ve][Le],J[ve]&&J[ve][Le]&&delete J[ve][Le]}catch{}}function fe(){Q={},q={},J={},Y={},z={},D={},F={},w={},ae===void 0&&(ae=!1),R&&R.reset(),te=void 0,R=void 0,u=void 0,clearTimeout($),$=null}function le(){fe(),k.off(r.default.LOADING_PROGRESS,Oe,X),k.off(n.default.QUALITY_CHANGE_RENDERED,Ne,X),k.off(n.default.METRIC_ADDED,xe,X),b&&b.reset()}function _e(ve){ve&&(ve.streamController&&(j=ve.streamController),ve.domStorage&&(V=ve.domStorage),ve.mediaPlayerModel&&(oe=ve.mediaPlayerModel),ve.customParametersModel&&(Z=ve.customParametersModel),ve.cmsdModel&&(H=ve.cmsdModel),ve.dashMetrics&&(O=ve.dashMetrics),ve.adapter&&(se=ve.adapter),ve.videoModel&&(ue=ve.videoModel),ve.settings&&(P=ve.settings))}function Me(){if(!V||!V.hasOwnProperty("getSavedBitrateSettings"))throw new Error(g.default.MISSING_CONFIG_ERROR)}function Oe(ve){var Le=ve.request.mediaType,Ge=ve.streamId;if(!(!Le||!Ge||!Y[Ge]||!P.get().streaming.abr.autoSwitchBitrate[Le])){var at=Y[Ge][Le];if(at){var et=(0,M.default)(L).create({abrController:X,streamProcessor:at,currentRequest:ve.request,useBufferOccupancyABR:D[Le],useL2AABR:F[Le],useLoLPABR:w[Le],videoModel:ue}),lt=b.shouldAbandonFragment(et,Ge);if(lt.quality>p.default.NO_CHANGE){var vt=at.getFragmentModel(),Mt=vt.getRequests({state:y.default.FRAGMENT_MODEL_LOADING,index:ve.request.index})[0];Mt&&(J[Ge][Le].state=d.default.ABANDON_LOAD,z[Ge][Le].reset(),z[Ge][Le].push({oldValue:tt(Le,Ge),newValue:lt.quality,confidence:1,reason:lt.reason}),nt(Le,j.getActiveStreamInfo(),lt.quality,lt.reason),clearTimeout($),$=setTimeout(function(){J[Ge][Le].state=d.default.ALLOW_LOAD,$=null},P.get().streaming.abandonLoadTimeout))}}}}function Ne(ve){ve.mediaType===g.default.VIDEO&&(te!==void 0&&R.push(ve.streamId,te,ue.getPlaybackQuality()),te=ve.newQuality)}function xe(ve){ve.metric===d.default.HTTP_REQUEST&&ve.value&&ve.value.type===t.HTTPRequest.MEDIA_SEGMENT_TYPE&&(ve.mediaType===g.default.AUDIO||ve.mediaType===g.default.VIDEO)&&u.push(ve.mediaType,ve.value,P.get().streaming.abr.useDeadTimeLatency),ve.metric===d.default.BUFFER_LEVEL&&(ve.mediaType===g.default.AUDIO||ve.mediaType===g.default.VIDEO)&&De(ve.mediaType,.001*ve.value.level)}function Se(ve,Le){try{var Ge;return Q[Le]=Q[Le]||{},Q[Le].hasOwnProperty(ve)||(Q[Le][ve]=0),Ge=Qe(ve,Le),Ge=ye(Ge,ve,Le),Ge=Fe(Ge,ve,Le),P.get().streaming.cmsd.enabled&&P.get().streaming.cmsd.abr.applyMb&&(Ge=Je(Ge,ve,Le)),Ge}catch{return}}function me(ve,Le){try{return He(ve,Le)}catch{return}}function Ae(ve,Le){try{var Ge=oe.getAbrBitrateParameter("maxBitrate",ve);return Ge>-1?ie(Y[Le][ve].getMediaInfo(),Ge,Le):void 0}catch{return}}function He(ve,Le){try{var Ge=oe.getAbrBitrateParameter("minBitrate",ve);if(Ge>-1){var at=Y[Le][ve].getMediaInfo(),et=he(at),lt=ie(at,Ge,Le);return et[lt]&&lt<et.length-1&&et[lt].bitrate<Ge*1e3&&lt++,lt}else return}catch{return}}function Qe(ve,Le){var Ge=Q[Le][ve],at=Ge;if(!Y[Le]||!Y[Le][ve])return at;var et=me(ve,Le);et!==void 0&&(at=Math.max(Ge,et));var lt=Ae(ve,Le);return lt!==void 0&&(at=Math.min(at,lt)),at}function Je(ve,Le,Ge){if(Le!=="video")return ve;var at=H.getMaxBitrate(Le);if(at<0)return ve;var et=ge(Ge,"audio",tt("audio",Ge));at-=et?et.bitrate/1e3:0;var lt=ie(Y[Ge][Le].getMediaInfo(),at,Ge);return W.debug("Stream ID: "+Ge+" ["+Le+"] Apply max bit rate from CMSD: "+at),Math.min(ve,lt)}function ye(ve,Le,Ge){var at=Q[Ge][Le],et=P.get().streaming.abr.maxRepresentationRatio[Le];return isNaN(et)||et>=1||et<0?ve:Math.min(ve,Math.round(at*et))}function Fe(ve,Le,Ge){if(Le!==g.default.VIDEO||!P.get().streaming.abr.limitBitrateByPortal||!Y[Ge]||!Y[Ge][Le])return ve;ae||ut();var at=Y[Ge][Le].getStreamInfo(),et=se.getAdaptationForType(at.index,Le,at).Representation_asArray,lt=ve;if(K>0&&ee>0){for(;lt>0&&et[lt]&&K<et[lt].width&&K-et[lt-1].width<et[lt].width-K;)lt=lt-1;for(;lt<et.length-1&&et[lt].width===et[lt+1].width;)lt=lt+1}return lt}function Be(ve){var Le=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(Le||(Le=j.getActiveStreamInfo().id),ve&&Y&&Y[Le]&&Y[Le][ve]){var Ge=Se(ve,Le),at=he(Y[Le][ve].getMediaInfo());return at[Ge]?at[Ge]:null}return null}function Ye(ve,Le){if(Me(),ve===g.default.TEXT)return NaN;var Ge=V.getSavedBitrateSettings(ve),at=oe.getAbrBitrateParameter("initialBitrate",ve),et=P.get().streaming.abr.initialRepresentationRatio[ve];if(at===-1)if(et>-1){var lt=Y[Le][ve].getStreamInfo(),vt=se.getAdaptationForType(lt.index,ve,lt).Representation_asArray;if(Array.isArray(vt)){var Mt=Math.max(Math.round(vt.length*et)-1,0);at=vt[Mt].bandwidth/1e3}else at=0}else isNaN(Ge)?at=ve===g.default.VIDEO?h:c:at=Ge;return at}function Ze(ve,Le){try{if(!ve||!Y||!Y[Le]||!Y[Le][ve])return!1;if(R){var Ge=ue.getPlaybackQuality();Ge&&R.push(Le,te,Ge)}if(!P.get().streaming.abr.autoSwitchBitrate[ve])return!1;var at=tt(ve,Le),et=(0,M.default)(L).create({abrController:X,switchHistory:z[Le][ve],droppedFramesHistory:R,streamProcessor:Y[Le][ve],currentValue:at,useBufferOccupancyABR:D[ve],useL2AABR:F[ve],useLoLPABR:w[ve],videoModel:ue}),lt=me(ve,Le),vt=Se(ve,Le),Mt=b.getMaxQuality(et),Ct=Mt.quality;return lt!==void 0&&(Ct>p.default.NO_CHANGE?Ct:at)<lt&&(Ct=lt),Ct>vt&&(Ct=vt),z[Le][ve].push({oldValue:at,newValue:Ct}),Ct>p.default.NO_CHANGE&&Ct!==at&&(J[Le][ve].state===d.default.ALLOW_LOAD||Ct<at)?(je(ve,at,Ct,vt,Mt.reason,Le),!0):!1}catch{return!1}}function tt(ve){var Le=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;try{if(Le||(Le=j.getActiveStreamInfo().id),ve&&Y[Le]&&Y[Le][ve]){var Ge;if(Le)return q[Le]=q[Le]||{},q[Le].hasOwnProperty(ve)||(q[Le][ve]=o),Ge=q[Le][ve],Ge}return o}catch{return o}}function nt(ve,Le,Ge){var at=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null;if(!(!Le||!Le.id||!ve)){var et=Le.id,lt=tt(ve,et);(0,m.checkInteger)(Ge);var vt=Se(ve,et);Ge!==lt&&Ge>=0&&Ge<=vt&&je(ve,lt,Ge,vt,at,et)}}function ht(ve,Le){return J[ve]&&J[ve][Le]?J[ve][Le].state:null}function je(ve,Le,Ge,at,et,lt){if(ve&&Y[lt]&&Y[lt][ve]){var vt=Y[lt][ve].getStreamInfo(),Mt=vt&&vt.manifestInfo&&vt.manifestInfo.isDynamic,Ct=O.getCurrentBufferLevel(ve);W.info("Stream ID: "+lt+" ["+ve+"] switch from "+Le+" to "+Ge+"/"+at+" (buffer: "+Ct+") "+(et?JSON.stringify(et):".")),q[lt]=q[lt]||{},q[lt][ve]=Ge;var de=ge(lt,ve,Ge);k.trigger(r.default.QUALITY_CHANGE_REQUESTED,{oldQuality:Le,newQuality:Ge,reason:et,streamInfo:vt,bitrateInfo:de,maxIdx:at,mediaType:ve},{streamId:vt.id,mediaType:ve});var we=u.getAverageThroughput(ve,Mt);isNaN(we)||V.setSavedBitrateSettings(ve,we)}}function ge(ve,Le,Ge){if(Le&&Y&&Y[ve]&&Y[ve][Le]){var at=he(Y[ve][Le].getMediaInfo());return at[Ge]?at[Ge]:null}return null}function ie(ve,Le,Ge){var at=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,et=ve&&ve.type?Y[Ge][ve.type].getRepresentationInfo():null;if(P.get().streaming.abr.useDeadTimeLatency&&at&&et&&et.fragmentDuration){at=at/1e3;var lt=et.fragmentDuration;if(at>lt)return 0;var vt=at/lt;Le=Le*(1-vt)}for(var Mt=he(ve),Ct=Mt.length-1;Ct>=0;Ct--){var de=Mt[Ct];if(Le*1e3>=de.bitrate)return Ct}return o}function he(ve){var Le=[];if(!ve||!ve.bitrateList)return Le;for(var Ge=ve.bitrateList,at=ve.type,et,lt=0,vt=Ge.length;lt<vt;lt++)et=new f.default,et.mediaType=at,et.qualityIndex=lt,et.bitrate=Ge[lt].bandwidth,et.width=Ge[lt].width,et.height=Ge[lt].height,et.scanType=Ge[lt].scanType,Le.push(et);return Le}function De(ve,Le){var Ge=P.get().streaming.abr.ABRStrategy;Ge===g.default.ABR_STRATEGY_DYNAMIC&&Ce(ve,Le)}function Ce(ve,Le){try{var Ge=oe.getStableBufferTime(),at=Ge,et=.5*Ge,lt=D[ve],vt=Le>(lt?et:at);D[ve]=vt,vt!==lt&&(vt?W.info("["+ve+"] switching from throughput to buffer occupancy ABR rule (buffer: "+Le.toFixed(3)+")."):W.info("["+ve+"] switching from buffer occupancy to throughput ABR rule (buffer: "+Le.toFixed(3)+")."))}catch(Mt){W.error(Mt)}}function We(){return u}function Xe(ve){var Le=ve.type,Ge=ve.streamInfo.id,at=ve.representationCount-1;return Q[Ge]=Q[Ge]||{},Q[Ge][Le]=at,at}function Ve(ve){var Le=ve?ve.id:null,Ge=tt(g.default.AUDIO,Le),at=tt(g.default.VIDEO,Le),et=Ge===Se(g.default.AUDIO,Le)&&at===Se(g.default.VIDEO,Le);return et}function rt(ve){ae=ve}function ut(){if(ue){var ve=P.get().streaming.abr.usePixelRatioInLimitBitrateByPortal&&window.hasOwnProperty("devicePixelRatio"),Le=ve?window.devicePixelRatio:1;K=ue.getClientWidth()*Le,ee=ue.getClientHeight()*Le}}function mt(ve){R&&R.clearForStream(ve),Y[ve]&&delete Y[ve],z[ve]&&delete z[ve],J[ve]&&delete J[ve]}return X={initialize:x,isPlayingAtTopQuality:Ve,updateTopQualityIndex:Xe,clearDataForStream:mt,getThroughputHistory:We,getBitrateList:he,getQualityForBitrate:ie,getTopBitrateInfoFor:Be,getMinAllowedIndexFor:me,getMaxAllowedIndexFor:Se,getInitialBitrateFor:Ye,getQualityFor:tt,getAbandonmentStateFor:ht,setPlaybackQuality:nt,checkPlaybackQuality:Ze,setElementSize:ut,setWindowResizeEventCalled:rt,registerStreamType:ne,unRegisterStreamType:G,setConfig:_e,reset:le},B(),X}l.__dashjs_factory_name="AbrController";var A=T.default.getSingletonFactory(l);A.QUALITY_DEFAULT=o,T.default.updateSingletonFactory(l.__dashjs_factory_name,A);const S=A},"./src/streaming/controllers/BaseURLController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>M});var I=e("./src/streaming/models/BaseURLTreeModel.js"),g=e("./src/streaming/utils/BaseURLSelector.js"),d=e("./src/streaming/utils/URLUtils.js"),f=e("./src/dash/vo/BaseURL.js"),y=e("./src/core/FactoryMaker.js"),_=e("./src/core/EventBus.js"),r=e("./src/core/events/Events.js");function T(){var p,C,v=this.context,E=(0,_.default)(v).getInstance(),i=(0,d.default)(v).getInstance(),t,m;function n(L){t.invalidateSelectedIndexes(L.entry)}function h(){t=(0,I.default)(v).create(),m=(0,g.default)(v).create(),E.on(r.default.SERVICE_LOCATION_BLACKLIST_CHANGED,n,p)}function c(L){L.baseURLTreeModel&&(t=L.baseURLTreeModel),L.baseURLSelector&&(m=L.baseURLSelector),L.adapter&&(C=L.adapter)}function o(L){t.update(L),m.chooseSelector(C.getIsDVB(L))}function l(L){var U=t.getForPath(L),k=U.reduce(function(X,W){var b=m.select(W);if(b)i.isRelative(b.url)?X.url=i.resolve(b.url,X.url):(X.url=b.url,X.serviceLocation=b.serviceLocation),X.availabilityTimeOffset=b.availabilityTimeOffset,X.availabilityTimeComplete=b.availabilityTimeComplete;else return new f.default;return X},new f.default);if(!i.isRelative(k.url))return k}function A(){t.reset(),m.reset()}function S(L){t.setConfig({adapter:C}),o(L)}return p={reset:A,initialize:S,resolve:l,setConfig:c},h(),p}T.__dashjs_factory_name="BaseURLController";const M=y.default.getClassFactory(T)},"./src/streaming/controllers/BlacklistController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>f});var I=e("./src/core/FactoryMaker.js"),g=e("./src/core/EventBus.js");function d(y){y=y||{};var _,r=[],T=(0,g.default)(this.context).getInstance(),M=y.updateEventName,p=y.addBlacklistEventName;function C(m){return!r.length||!m||!m.length?!1:r.indexOf(m)!==-1}function v(m){r.indexOf(m)===-1&&(r.push(m),T.trigger(M,{entry:m}))}function E(m){v(m.entry)}function i(){p&&T.on(p,E,_)}function t(){r=[]}return _={add:v,contains:C,reset:t},i(),_}d.__dashjs_factory_name="BlackListController";const f=I.default.getClassFactory(d)},"./src/streaming/controllers/BufferController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>o});var I=e("./src/streaming/constants/Constants.js"),g=e("./src/streaming/constants/MetricsConstants.js"),d=e("./src/streaming/models/FragmentModel.js"),f=e("./src/streaming/SourceBufferSink.js"),y=e("./src/streaming/PreBufferSink.js"),_=e("./src/core/EventBus.js"),r=e("./src/core/events/Events.js"),T=e("./src/core/FactoryMaker.js"),M=e("./src/core/Debug.js"),p=e("./src/streaming/utils/InitCache.js"),C=e("./src/streaming/vo/DashJSError.js"),v=e("./src/core/errors/Errors.js"),E=e("./src/streaming/vo/metrics/HTTPRequest.js"),i=e("./src/streaming/MediaPlayerEvents.js"),t=.5,m=.01,n=22,h="BufferController";function c(l){l=l||{};var A=this.context,S=(0,_.default)(A).getInstance(),L=l.errHandler,U=l.fragmentModel,k=l.representationController,X=l.adapter,W=l.textController,b=l.abrController,j=l.playbackController,Q=l.streamInfo,q=l.type,Y=l.settings,J,$,ae,K,ee,se,ue,oe,Z,H,V,te,z,R,u,D,F,w,O,P;function B(){$=(0,M.default)(A).getInstance().getLogger(J),F=(0,p.default)(A).getInstance(),ct()}function x(pe){fe(pe),S.on(r.default.INIT_FRAGMENT_LOADED,Se,J),S.on(r.default.MEDIA_FRAGMENT_LOADED,Ae,J),S.on(r.default.WALLCLOCK_TIME_UPDATED,de,J),S.on(i.default.PLAYBACK_PLAYING,De,J),S.on(i.default.PLAYBACK_PROGRESS,ie,J),S.on(i.default.PLAYBACK_TIME_UPDATED,ie,J),S.on(i.default.PLAYBACK_RATE_CHANGED,we,J),S.on(i.default.PLAYBACK_STALLED,he,J)}function ne(){return Q.id}function re(){return q}function G(){return h}function fe(pe){var be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return new Promise(function(Ee,Ue){se=pe,Z&&be&&typeof Z.discharge=="function"?(H=Z,_e(be).then(function(){Ee()}).catch(function($e){Ue($e)})):Ee()})}function le(pe){return X.convertRepresentationToRepresentationInfo(k.getRepresentationForQuality(pe))}function _e(pe){var be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return new Promise(function(Ee,Ue){if(!F||!pe){Ee(null);return}se?Oe(pe,be).then(function($e){Ee($e)}).catch(function($e){Ue($e)}):Me().then(function($e){Ee($e)}).catch(function($e){Ue($e)})})}function Me(){var pe=this;return new Promise(function(be,Ee){var Ue=b.getQualityFor(q,Q.id);Z=(0,y.default)(A).create(Je.bind(pe)),vt(le(Ue)).then(function(){be(Z)}).catch(function(){Ee()})})}function Oe(pe,be){return new Promise(function(Ee,Ue){var $e=b.getQualityFor(q,Q.id);Z=(0,f.default)(A).create({mediaSource:se,textController:W,eventBus:S}),Ne(pe,be,$e).then(function(){return vt(le($e))}).then(function(){Ee(Z)}).catch(function(dt){$.fatal("Caught error on create SourceBuffer: "+dt),L.error(new C.default(v.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,v.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+q)),Ue(dt)})})}function Ne(pe,be,Ee){var Ue=le(Ee);return be&&be[q]&&(q===I.default.VIDEO||q===I.default.AUDIO)?Z.initializeForStreamSwitch(pe,Ue,be[q]):Z.initializeForFirstUse(Q,pe,Ue)}function xe(){if(Z&&H&&typeof H.discharge=="function"){var pe=H.getAllBufferRanges();if(pe.length>0){for(var be="Beginning "+q+"PreBuffer discharge, adding buffer for:",Ee=0;Ee<pe.length;Ee++)be+=" start: "+pe.start(Ee)+", end: "+pe.end(Ee)+";";$.debug(be)}else $.debug("PreBuffer discharge requested, but there were no media segments in the PreBuffer.");V=[];for(var Ue=H.discharge(),$e=null,dt=0;dt<Ue.length;dt++){var _t=Ue[dt];if(_t.segmentType!==E.HTTPRequest.INIT_SEGMENT_TYPE){var St=F.extract(_t.streamId,_t.representationId);St&&$e!==St&&(V.push(St),Z.append(St),$e=St)}V.push(_t),Z.append(_t)}H.reset(),H=null}}function Se(pe){Y.get().streaming.cacheInitSegments&&($.info("Init fragment finished loading saving to",q+"'s init cache"),F.save(pe.chunk)),$.debug("Append Init fragment",q," with representationId:",pe.chunk.representationId," and quality:",pe.chunk.quality,", data size:",pe.chunk.bytes.byteLength),He(pe.chunk)}function me(pe){var be=F.extract(Q.id,pe);return be?($.info("Append Init fragment",q," with representationId:",be.representationId," and quality:",be.quality,", data size:",be.bytes.byteLength),He(be),!0):!1}function Ae(pe){He(pe.chunk,pe.request)}function He(pe){var be=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;Z.append(pe,be).then(function(Ee){Je(Ee)}).catch(function(Ee){Je(Ee)}),pe.mediaInfo.type===I.default.VIDEO&&ke(r.default.VIDEO_CHUNK_RECEIVED,{chunk:pe})}function Qe(pe){if(pe&&pe.length>0)for(var be=0,Ee=pe.length;be<Ee;be++)$.debug("Buffered range: "+pe.start(be)+" - "+pe.end(be)+", currentTime = ",j.getTime())}function Je(pe){if(pe.error){pe.error.code===n&&Fe(),(pe.error.code===n||!Nt())&&($.warn("Clearing playback buffer to overcome quota exceed situation"),ke(r.default.QUOTA_EXCEEDED,{criticalBufferLevel:ee,quotaExceededTime:pe.chunk.start}),Ge(Le()));return}if(Z&&(Ve(),D=!1,z=pe.chunk,!(!z||!z.endFragment))){z&&!isNaN(z.index)&&(ue=Math.max(z.index,ue),rt());var be=Z.getAllBufferRanges();z.segmentType===E.HTTPRequest.MEDIA_SEGMENT_TYPE&&(Qe(be),ie(),ye());var Ee=!1;V&&(V.indexOf(z)>0&&(Ee=!0),V=null),z&&!Ee&&ke(r.default.BYTES_APPENDED_END_FRAGMENT,{quality:z.quality,startTime:z.start,index:z.index,bufferedRanges:be,segmentType:z.segmentType,mediaType:q})}}function ye(){if(!isNaN(P)){if(q!==I.default.AUDIO&&q!==I.default.VIDEO){P=NaN;return}var pe=j.getTime(),be=We(pe,0),Ee=We(P,0);if(be&&Ee&&be.start===Ee.start){P=NaN;return}var Ue=k.getCurrentRepresentation().segmentDuration,$e=We(P,Ue);$e&&(Y.get().streaming.buffer.enableSeekDecorrelationFix&&Math.abs(pe-P)>Ue?P<=$e.end&&j.seek(Math.max(P,$e.start),!1,!0):pe<$e.start&&j.seek($e.start,!1,!0))}}function Fe(){if(D=!0,ee=Et()*.8,$.warn("Quota exceeded, Critical Buffer: "+ee),ee>0){var pe=Math.max(.2*ee,1),be=ee-pe,Ee=Math.min(Y.get().streaming.buffer.bufferTimeAtTopQuality,be*.9),Ue=Math.min(Y.get().streaming.buffer.bufferTimeAtTopQualityLongForm,be*.9),$e={streaming:{buffer:{bufferToKeep:parseFloat(pe.toFixed(5)),bufferTimeAtTopQuality:parseFloat(Ee.toFixed(5)),bufferTimeAtTopQualityLongForm:parseFloat(Ue.toFixed(5))}}};Y.update($e)}}function Be(){return ae&&it(!1),Z.abort()}function Ye(pe){return new Promise(function(be,Ee){Z.abort().then(function(){return Mt()}).then(function(){return Y.get().streaming.buffer.useChangeTypeForTrackSwitch?Z.changeType(pe):Promise.resolve()}).then(function(){return nt()}).then(function(){it(!1),be()}).catch(function(Ue){Ee(Ue)})})}function Ze(){return new Promise(function(pe,be){Z.abort().then(function(){return Mt()}).then(function(){return nt()}).then(function(){it(!1),pe()}).catch(function(Ee){be(Ee)})})}function tt(pe){return new Promise(function(be,Ee){Mt().then(function(){return Y.get().streaming.buffer.useChangeTypeForTrackSwitch?Z.changeType(pe):Promise.resolve()}).then(function(){be()}).catch(function(Ue){Ee(Ue)})})}function nt(){return new Promise(function(pe,be){var Ee=ht();if(!Ee||Ee.length===0){ie(),pe();return}Ge(Ee).then(function(){pe()}).catch(function(Ue){be(Ue)})})}function ht(pe){var be=[],Ee=Z.getAllBufferRanges();if(!Ee||Ee.length===0)return be;if(!pe&&pe!==0||isNaN(pe))be.push({start:Ee.start(0),end:Ee.end(Ee.length-1)+t});else{var Ue=je(pe,Ee),$e=ge(pe,Ee);Ue&&be.push(Ue),$e&&be.push($e)}return be}function je(pe,be){var Ee=Y.get().streaming.buffer.bufferToKeep,Ue=be.start(0),$e=pe-Ue;if($e>Ee){var dt=Math.max(0,pe-Ee),_t=U.getRequests({state:d.default.FRAGMENT_MODEL_EXECUTED,time:pe,threshold:m})[0];if(_t&&(dt=Math.min(_t.startTime,dt)),dt>0)return{start:Ue,end:dt}}return null}function ge(pe,be){var Ee=be.end(be.length-1)+t,Ue=gt(pe),$e=Q.manifestInfo.duration>=Y.get().streaming.buffer.longFormContentDurationThreshold,dt=$e?Y.get().streaming.buffer.bufferTimeAtTopQualityLongForm:Y.get().streaming.buffer.bufferTimeAtTopQuality,_t=isNaN(Ue)?pe:Math.min(Ue,pe+dt);if(_t>=be.end(be.length-1))return null;var St=U.getRequests({state:d.default.FRAGMENT_MODEL_EXECUTED,time:pe,threshold:m})[0];St&&(_t=Math.max(St.startTime+St.duration,_t));var Pt=Y.get().streaming.buffer.avoidCurrentTimeRangePruning;if(Pt){for(var Rt=0;Rt<be.length;Rt++)if(be.start(Rt)<=pe&&pe<=be.end(Rt)&&be.start(Rt)<=_t&&_t<=be.end(Rt)){var Ut=_t;Rt+1<be.length?_t=be.start(Rt+1):_t=be.end(Rt)+1,$.debug("Buffered range ["+be.start(Rt)+", "+be.end(Rt)+"] overlaps with targetTime "+pe+" and range to be pruned ["+Ut+", "+Ee+"], using ["+_t+", "+Ee+"] instead"+(_t<Ee?"":" (no actual pruning)"));break}}return _t<be.end(be.length-1)?{start:_t,end:Ee}:null}function ie(){(!O||q===I.default.TEXT&&W.isTextEnabled())&&Ve()}function he(){ut()}function De(){ut(),P=NaN}function Ce(pe){try{var be=Z.getAllBufferRanges();if(!be||be.length===0)return!1;for(var Ee=0;Ee<be.length;){var Ue=be.start(Ee),$e=be.end(Ee);if(pe>=Ue&&pe<=$e)return!0;Ee+=1}return!1}catch(dt){return $.error(dt),!1}}function We(pe,be){var Ee=Z.getAllBufferRanges(),Ue=0,$e=0,dt=null,_t=null,St=0,Pt,Rt,Ut=isNaN(be)?.15:be;if(Ee!=null){for(Rt=0,Pt=Ee.length;Rt<Pt;Rt++)if(Ue=Ee.start(Rt),$e=Ee.end(Rt),dt===null)St=Math.abs(Ue-pe),(pe>=Ue&&pe<$e||St<=Ut)&&(dt=Ue,_t=$e);else if(St=Ue-_t,St<=Ut)_t=$e;else break;if(dt!==null)return{start:dt,end:_t}}return null}function Xe(pe,be){var Ee,Ue;return Y.get().streaming.gaps.jumpGaps&&(be=Y.get().streaming.gaps.smallGapLimit),Ee=We(pe,be),Ee===null?Ue=0:Ue=Ee.end-pe,Ue}function Ve(){if(j){var pe=Y.get().streaming.gaps.jumpGaps&&!isNaN(Y.get().streaming.gaps.smallGapLimit)?Y.get().streaming.gaps.smallGapLimit:NaN;K=Math.max(Xe(j.getTime()||0,pe),0),ke(r.default.BUFFER_LEVEL_UPDATED,{mediaType:q,bufferLevel:K}),ut()}}function rt(){var pe=ue>=oe-1,be=j.getTimeToStreamEnd(Q)-K<1e-5;(pe||be)&&!ae&&(it(!0),$.debug("checkIfBufferingCompleted trigger BUFFERING_COMPLETED for stream id ".concat(Q.id," and type ").concat(q)))}function ut(){q!==I.default.AUDIO&&q!==I.default.VIDEO||((!j.getLowLatencyModeEnabled()&&K<Y.get().streaming.buffer.stallThreshold||K===0)&&!ae?mt(g.default.BUFFER_EMPTY):(ae||K>=Y.get().streaming.buffer.stallThreshold||j.getLowLatencyModeEnabled()&&K>0)&&mt(g.default.BUFFER_LOADED))}function mt(pe){te===pe||pe===g.default.BUFFER_EMPTY&&j.getTime()===0||q===I.default.TEXT&&!W.isTextEnabled()||(te=pe,ke(r.default.BUFFER_LEVEL_STATE_CHANGED,{state:pe}),ke(pe===g.default.BUFFER_LOADED?r.default.BUFFER_LOADED:r.default.BUFFER_EMPTY),$.debug(pe===g.default.BUFFER_LOADED?"Got enough buffer to start":"Waiting for more buffer before starting playback"))}function ve(){!Z||q===I.default.TEXT||ae||Ge(Le())}function Le(){var pe=[],be=Z.getAllBufferRanges();if(!be||be.length===0)return pe;var Ee=j.getTime(),Ue=Math.max(0,Ee-Y.get().streaming.buffer.bufferToKeep),$e=U.getRequests({state:d.default.FRAGMENT_MODEL_EXECUTED,time:Ee,threshold:m})[0];if($e)Ue=Math.min($e.startTime,Ue);else if(Ee===0&&j.getIsDynamic())return[];if(be.start(0)<=Ue){for(var dt={start:0,end:Ue},_t=0;_t<be.length&&be.end(_t)<=Ue;_t++)dt.end=be.end(_t);dt.start<dt.end&&pe.push(dt)}return pe}function Ge(pe){return new Promise(function(be,Ee){if(!pe||!Z||pe.length===0){be();return}var Ue=[];pe.forEach(function($e){Ue.push(at($e))}),u||et(),Promise.all(Ue).then(function(){be()}).catch(function($e){Ee($e)})})}function at(pe){return new Promise(function(be,Ee){pe.resolve=be,pe.reject=Ee,w.push(pe)})}function et(){try{if(w.length===0||!Z){$.debug("Nothing to prune, halt pruning"),w=[],u=!1;return}var pe=Z.getBuffer();if(!pe||!pe.buffered||pe.buffered.length===0){$.debug("SourceBuffer is empty (or does not exist), halt pruning"),w=[],u=!1;return}var be=w.shift();$.debug("".concat(q,": Removing buffer from: ").concat(be.start," to ").concat(be.end)),u=!0;var Ee=j.getTime();Ee<be.end&&it(!1),Z.remove(be).then(function(Ue){lt(Ue)}).catch(function(Ue){lt(Ue)})}catch{u=!1}}function lt(pe){$.debug("onRemoved buffer from:",pe.from,"to",pe.to);var be=Z.getAllBufferRanges();Qe(be),w.length===0&&(u=!1,Ve()),pe.unintended&&($.warn("Detected unintended removal from:",pe.from,"to",pe.to,"setting streamprocessor time to",pe.from),ke(r.default.SEEK_TARGET,{time:pe.from})),u?et():(O?O=!1:Ve(),ke(r.default.BUFFER_CLEARED,{from:pe.from,to:pe.to,unintended:pe.unintended,hasEnoughSpaceToAppend:Nt(),quotaExceeded:D}))}function vt(pe){return new Promise(function(be){if(!pe||pe.MSETimeOffset===void 0||!Z||!Z.updateTimestampOffset){be();return}Z.updateTimestampOffset(pe.MSETimeOffset).then(function(){be()}).catch(function(){be()})})}function Mt(){return Z&&!ae?Z.updateAppendWindow(Q):Promise.resolve()}function Ct(pe){isNaN(pe)||(oe=pe,rt())}function de(){R++;var pe=R*(Y.get().streaming.wallclockTimeUpdateInterval/1e3);pe>=Y.get().streaming.buffer.bufferPruningInterval&&(R=0,ve())}function we(){ut()}function qe(){return Z}function Te(){return K}function Ie(){return se}function Ke(){return ae}function it(pe){ae!==pe&&(ae=pe,ae?ke(r.default.BUFFERING_COMPLETED):oe=Number.POSITIVE_INFINITY)}function pt(){return u}function Et(){try{var pe=Z.getAllBufferRanges(),be=0,Ee,Ue;if(!pe)return be;for(Ue=0,Ee=pe.length;Ue<Ee;Ue++)be+=pe.end(Ue)-pe.start(Ue);return be}catch{return 0}}function gt(pe){try{var be=pe,Ee=Z.getAllBufferRanges();if(!Ee||Ee.length===0)return NaN;for(var Ue=0;be===pe&&Ue<Ee.length;){var $e=Ee.start(Ue),dt=Ee.end(Ue);be>=$e&&be<=dt&&(be=dt),Ue+=1}return be===pe?NaN:be}catch{}}function Nt(){var pe=Et();return isNaN(pe)||pe<ee}function Dt(pe){P=pe}function ke(pe,be){var Ee=be||{};S.trigger(pe,Ee,{streamId:Q.id,mediaType:q})}function ct(pe,be){if(ee=Number.POSITIVE_INFINITY,te=void 0,oe=Number.POSITIVE_INFINITY,ue=0,z=null,ae=!1,u=!1,D=!1,K=0,R=0,w=[],P=NaN,Z){var Ee=Z;Z=null,!pe&&!be&&Ee.abort().then(function(){Ee.reset(be),Ee=null})}O=!1}function ft(pe,be){S.off(r.default.INIT_FRAGMENT_LOADED,Se,this),S.off(r.default.MEDIA_FRAGMENT_LOADED,Ae,this),S.off(r.default.WALLCLOCK_TIME_UPDATED,de,this),S.off(i.default.PLAYBACK_PLAYING,De,this),S.off(i.default.PLAYBACK_PROGRESS,ie,this),S.off(i.default.PLAYBACK_TIME_UPDATED,ie,this),S.off(i.default.PLAYBACK_RATE_CHANGED,we,this),S.off(i.default.PLAYBACK_STALLED,he,this),ct(pe,be)}return J={initialize:x,getStreamId:ne,getType:re,getBufferControllerType:G,createBufferSink:_e,dischargePreBuffer:xe,getBuffer:qe,getBufferLevel:Te,getRangeAt:We,hasBufferAtTime:Ce,pruneBuffer:ve,setMediaSource:fe,getMediaSource:Ie,appendInitSegmentFromCache:me,getIsBufferingCompleted:Ke,setIsBufferingCompleted:it,getIsPruningInProgress:pt,reset:ft,prepareForPlaybackSeek:Be,prepareForReplacementTrackSwitch:Ye,prepareForNonReplacementTrackSwitch:tt,prepareForReplacementQualitySwitch:Ze,updateAppendWindow:Mt,getAllRangesWithSafetyFactor:ht,getContinuousBufferTimeForTargetTime:gt,clearBuffers:Ge,pruneAllSafely:nt,updateBufferTimestampOffset:vt,setSeekTarget:Dt,segmentRequestingCompleted:Ct},B(),J}c.__dashjs_factory_name=h;const o=T.default.getClassFactory(c)},"./src/streaming/controllers/CatchupController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>p});var I=e("./src/core/FactoryMaker.js"),g=e("./src/core/Debug.js"),d=e("./src/core/EventBus.js"),f=e("./src/streaming/constants/Constants.js"),y=e("./src/streaming/MediaPlayerEvents.js"),_=e("./src/core/events/Events.js"),r=e("./src/streaming/constants/MetricsConstants.js"),T=e("./src/core/Utils.js");function M(){var C=this.context,v=(0,d.default)(C).getInstance(),E,i,t,m,n,h,c,o,l,A;function S(){U(),H()}function L(V){V&&(V.settings&&(n=V.settings),V.videoModel&&(m=V.videoModel),V.streamController&&(h=V.streamController),V.playbackController&&(c=V.playbackController),V.mediaPlayerModel&&(o=V.mediaPlayerModel))}function U(){v.on(y.default.BUFFER_LEVEL_UPDATED,Q,E),v.on(y.default.BUFFER_LEVEL_STATE_CHANGED,q,E),v.on(y.default.PLAYBACK_PROGRESS,J,E),v.on(y.default.PLAYBACK_TIME_UPDATED,J,E),v.on(y.default.PLAYBACK_SEEKED,j,E),v.on(_.default.SETTING_UPDATED_CATCHUP_ENABLED,Y,E),v.on(_.default.SETTING_UPDATED_PLAYBACK_RATE_MIN,H,E),v.on(_.default.SETTING_UPDATED_PLAYBACK_RATE_MAX,H,E),v.on(y.default.STREAM_INITIALIZED,H,E)}function k(){v.off(y.default.BUFFER_LEVEL_UPDATED,Q,E),v.off(y.default.BUFFER_LEVEL_STATE_CHANGED,q,E),v.off(y.default.PLAYBACK_PROGRESS,J,E),v.off(y.default.PLAYBACK_TIME_UPDATED,J,E),v.off(y.default.PLAYBACK_SEEKED,J,E),v.off(_.default.SETTING_UPDATED_CATCHUP_ENABLED,Y,E),v.off(_.default.SETTING_UPDATED_PLAYBACK_RATE_MIN,H,E),v.off(_.default.SETTING_UPDATED_PLAYBACK_RATE_MAX,H,E),v.off(y.default.STREAM_INITIALIZED,H,E)}function X(){A=(0,g.default)(C).getInstance().getLogger(E),b()}function W(){k(),b(),m.setPlaybackRate(1,!0)}function b(){i=!1;var V=T.default.parseUserAgent();t=V&&V.browser&&V.browser.name&&V.browser.name.toLowerCase()==="safari"}function j(){i=!1}function Q(V){if(!(V.streamId!==h.getActiveStreamInfo().id||!l)){var te=c.getLiveDelay(),z=c.getBufferLevel();z>te/2&&(l=!1)}}function q(V){V.streamId===h.getActiveStreamInfo().id&&(l=V.state===r.default.BUFFER_EMPTY)}function Y(){o.getCatchupModeEnabled()||m.setPlaybackRate(1)}function J(){c.getIsDynamic()&&o.getCatchupModeEnabled()&&(o.getCatchupPlaybackRates().max>0||o.getCatchupPlaybackRates().min<0)&&!c.isPaused()&&!c.isSeeking()&&K()&&$()}function $(){if(!i&&m){var V,te=m.getPlaybackRate(),z=o.getCatchupPlaybackRates(),R=c.getBufferLevel(),u=ae(),D=o.getCatchupMaxDrift();if(!isNaN(D)&&D>0&&u>D)A.info("[CatchupController]: Low Latency catchup mechanism. Latency too high, doing a seek to live point"),i=!0,c.seekToCurrentLive(!0,!1);else{var F=c.getCurrentLiveLatency(),w=c.getLiveDelay();if(ee()===f.default.LIVE_CATCHUP_MODE_LOLP){var O=n.get().streaming.liveCatchup.playbackBufferMin;V=Z(z,F,w,O,R)}else V=oe(z,F,w,R);var P=t?.25:.02/(.5/z.max);V&&Math.abs(te-V)>=P&&(A.debug("[CatchupController]: Setting playback rate to ".concat(V)),m.setPlaybackRate(V))}}}function ae(){var V=c.getCurrentLiveLatency(),te=c.getLiveDelay();return V-te}function K(){try{if(!c.getTime()>0||i)return!1;var V=ee();if(V===f.default.LIVE_CATCHUP_MODE_LOLP){var te=c.getBufferLevel(),z=n.get().streaming.liveCatchup.playbackBufferMin;return ue(te,z)}else return se()}catch{return!1}}function ee(){var V=n.get().streaming.liveCatchup.playbackBufferMin;return n.get().streaming.liveCatchup.mode===f.default.LIVE_CATCHUP_MODE_LOLP&&V!==null&&!isNaN(V)?f.default.LIVE_CATCHUP_MODE_LOLP:f.default.LIVE_CATCHUP_MODE_DEFAULT}function se(){try{var V=Math.abs(ae());return V>0}catch{return!1}}function ue(V,te){try{var z=Math.abs(ae());return z>0||V<te}catch{return!1}}function oe(V,te,z,R){if(l)return 1;var u=te-z,D=u<0?Math.abs(V.min):V.max,F=u*5,w=D*2/(1+Math.pow(Math.E,-F)),O=1-D+w;return c.getPlaybackStalled()&&R<=z/2&&u>0&&(O=1),O}function Z(V,te,z,R,u){var D;if(u<R){var F=Math.abs(V.min),w=u-R,O=w*5,P=F*2/(1+Math.pow(Math.E,-O));D=1-F+P,A.debug("[LoL+ playback control_buffer-based] bufferLevel: "+u+", newRate: "+D)}else{var B=V.max,x=.02;if(Math.abs(te-z)<=x*z)D=1;else{var ne=te-z,re=ne*5,G=B*2/(1+Math.pow(Math.E,-re));D=1-B+G}A.debug("[LoL+ playback control_latency-based] latency: "+te+", newRate: "+D)}return D}function H(){o.getCatchupPlaybackRates(!0)}return E={reset:W,setConfig:L,initialize:S},X(),E}M.__dashjs_factory_name="CatchupController";const p=I.default.getSingletonFactory(M)},"./src/streaming/controllers/EventController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>r});var I=e("./src/core/FactoryMaker.js"),g=e("./src/core/Debug.js"),d=e("./src/core/EventBus.js"),f=e("./src/streaming/MediaPlayerEvents.js"),y=e("./src/streaming/net/XHRLoader.js");function _(){var T="urn:mpeg:dash:event:2012",M=1,p="urn:mpeg:dash:event:callback:2015",C=1,v=300,E={DISCARDED:"discarded",UPDATED:"updated",ADDED:"added"},i=this.context,t=(0,d.default)(i).getInstance(),m,n,h,c,o,l,A,S,L,U,k;function X(){n=(0,g.default)(i).getInstance().getLogger(m),b()}function W(){if(!A||!S)throw new Error("setConfig function has to be called previously")}function b(){k=!1,h={},c={},o=null,U=!1,l=Date.now()/1e3}function j(){try{o!==null&&k&&(clearInterval(o),o=null,k=!1,se())}catch(O){throw O}}function Q(){try{W(),n.debug("Start Event Controller");var O=L.get().streaming.eventControllerRefreshDelay;!k&&!isNaN(O)&&(k=!0,o=setInterval(q,O))}catch(P){throw P}}function q(){try{if(!U){U=!0;var O=S.getTime(),P=O-l;P=l>0?Math.max(0,P):0,Y(c,P,O),Y(h,P,O),J(c),J(h),l=O,U=!1}}catch(B){U=!1,n.error(B)}}function Y(O,P,B){try{var x=function(re){if(re!==void 0){var G=isNaN(re.duration)?0:re.duration;re.calculatedPresentationTime<=B&&re.calculatedPresentationTime+P+G>=B?V(re,f.default.EVENT_MODE_ON_START):(Z(B,G+P,re.calculatedPresentationTime)||H(re))&&(n.debug("Removing event ".concat(re.id," from period ").concat(re.eventStream.period.id," as it is expired or invalid")),te(O,re))}};oe(O,x)}catch(ne){n.error(ne)}}function J(O){try{for(var P in O)O.hasOwnProperty(P)&&Object.keys(O[P]).length===0&&delete O[P]}catch(B){n.error(B)}}function $(O,P){try{if(W(),h[P]||(h[P]={}),O)for(var B=0;B<O.length;B++){var x=O[B],ne=S.getTime(),re=isNaN(x.duration)?0:x.duration;if(!Z(ne,re,x.calculatedPresentationTime)){var G=K(x,h[P],!0);G===E.ADDED?(n.debug("Added inline event with id ".concat(x.id," from period ").concat(P)),V(x,f.default.EVENT_MODE_ON_RECEIVE)):G===E.UPDATED&&n.debug("Updated inline event with id ".concat(x.id," from period ").concat(P))}}}catch(fe){throw fe}}function ae(O,P){try{W(),c[P]||(c[P]={});for(var B=0;B<O.length;B++){var x=O[B],ne=S.getTime(),re=isNaN(x.duration)?0:x.duration;if(!Z(ne,re,x.calculatedPresentationTime)){var G=K(x,c[P],!1);G===E.ADDED?(x.eventStream.schemeIdUri===T&&ee(x),n.debug("Added inband event with id ".concat(x.id," from period ").concat(P)),V(x,f.default.EVENT_MODE_ON_RECEIVE)):n.debug("Inband event with scheme_id_uri ".concat(x.eventStream.schemeIdUri,", value ").concat(x.eventStream.value,", period id ").concat(P," and event id ").concat(x.id," was ignored because it has been added before."))}}q()}catch(fe){throw fe}}function K(O,P){var B=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,x=O.eventStream.schemeIdUri,ne=O.eventStream.value,re=O.id,G=E.DISCARDED;P[x]||(P[x]=[]);var fe=P[x].findIndex(function(_e){return(!ne||_e.eventStream.value&&_e.eventStream.value===ne)&&_e.id===re});if(fe===-1)P[x].push(O),O.triggeredReceivedEvent=!1,O.triggeredStartEvent=!1,G=E.ADDED;else if(B){var le=P[x][fe];O.triggeredReceivedEvent=le.triggeredReceivedEvent,O.triggeredStartEvent=le.triggeredStartEvent,P[x][fe]=O,G=E.UPDATED}return G}function ee(O){try{if(O.eventStream.value==M){var P=O.calculatedPresentationTime,B;O.calculatedPresentationTime==4294967295?B=NaN:B=O.calculatedPresentationTime+O.duration,t.trigger(f.default.MANIFEST_VALIDITY_CHANGED,{id:O.id,validUntil:P,newDuration:B,newManifestValidAfter:NaN},{mode:f.default.EVENT_MODE_ON_START})}}catch(x){n.error(x)}}function se(){try{ue(c),ue(h)}catch(O){n.error(O)}}function ue(O){try{var P=S.getTime(),B=function(ne){var re=ne.eventStream&&ne.eventStream.period&&!isNaN(ne.eventStream.period.duration)?ne.eventStream.period.duration:NaN,G=ne.eventStream&&ne.eventStream.period&&!isNaN(ne.eventStream.period.start)?ne.eventStream.period.start:NaN;if(!(isNaN(re)||isNaN(G))){var fe=ne.calculatedPresentationTime;Math.abs(fe-P)<v&&V(ne,f.default.EVENT_MODE_ON_START)}};oe(O,B)}catch(x){n.error(x)}}function oe(O,P){try{if(O)for(var B=Object.keys(O),x=0;x<B.length;x++)for(var ne=O[B[x]],re=Object.keys(ne),G=0;G<re.length;G++){var fe=ne[re[G]];fe.forEach(function(le){le!==void 0&&P(le)})}}catch(le){n.error(le)}}function Z(O,P,B){try{return O-P>B}catch(x){return n.error(x),!1}}function H(O){try{var P=O.eventStream.period.start+O.eventStream.period.duration;return O.calculatedPresentationTime>P}catch(B){return n.error(B),!1}}function V(O,P){try{var B=S.getTime(),x=O.id;if(P===f.default.EVENT_MODE_ON_RECEIVE&&!O.triggeredReceivedEvent){n.debug("Received event ".concat(x)),O.triggeredReceivedEvent=!0,t.trigger(O.eventStream.schemeIdUri,{event:O},{mode:P});return}O.triggeredStartEvent||(O.eventStream.schemeIdUri===T&&O.eventStream.value==M?(O.duration!==0||O.presentationTimeDelta!==0)&&(n.debug("Starting manifest refresh event ".concat(x," at ").concat(B)),z()):O.eventStream.schemeIdUri===p&&O.eventStream.value==C?(n.debug("Starting callback event ".concat(x," at ").concat(B)),R(O.messageData)):(n.debug("Starting event ".concat(x," from period ").concat(O.eventStream.period.id," at ").concat(B)),t.trigger(O.eventStream.schemeIdUri,{event:O},{mode:P})),O.triggeredStartEvent=!0)}catch(ne){n.error(ne)}}function te(O,P){try{var B=P.eventStream.schemeIdUri,x=P.eventStream.period.id,ne=P.eventStream.value,re=P.id;O[x][B]=O[x][B].filter(function(G){return ne&&G.eventStream.value&&G.eventStream.value!==ne||G.id!==re}),O[x][B].length===0&&delete O[x][B]}catch(G){n.error(G)}}function z(){try{W(),A.refreshManifest()}catch(O){n.error(O)}}function R(O){try{var P=(0,y.default)(i).create({});P.load({method:"get",url:O,request:{responseType:"arraybuffer"}})}catch(B){n.error(B)}}function u(O){try{if(!O)return;O.manifestUpdater&&(A=O.manifestUpdater),O.playbackController&&(S=O.playbackController),O.settings&&(L=O.settings)}catch(P){throw P}}function D(){return h}function F(){return c}function w(){j(),b()}return m={addInlineEvents:$,addInbandEvents:ae,getInbandEvents:F,getInlineEvents:D,start:Q,setConfig:u,reset:w},X(),m}_.__dashjs_factory_name="EventController";const r=I.default.getSingletonFactory(_)},"./src/streaming/controllers/FragmentController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>i});var I=e("./src/streaming/constants/Constants.js"),g=e("./src/streaming/vo/DataChunk.js"),d=e("./src/streaming/models/FragmentModel.js"),f=e("./src/streaming/FragmentLoader.js"),y=e("./src/streaming/utils/RequestModifier.js"),_=e("./src/core/EventBus.js"),r=e("./src/core/events/Events.js"),T=e("./src/streaming/MediaPlayerEvents.js"),M=e("./src/core/errors/Errors.js"),p=e("./src/core/FactoryMaker.js"),C=e("./src/core/Debug.js"),v=e("./src/streaming/utils/SegmentResponseModifier.js");function E(t){t=t||{};var m=this.context,n=(0,_.default)(m).getInstance(),h=t.errHandler,c=t.mediaPlayerModel,o=t.dashMetrics,l=(0,C.default)(m).getInstance(),A=(0,v.default)(m).getInstance(),S=t.streamInfo,L,U,k;function X(){U=l.getLogger(L),j(),n.on(T.default.FRAGMENT_LOADING_COMPLETED,Y,L),n.on(T.default.FRAGMENT_LOADING_PROGRESS,Y,L)}function W(){return S.id}function b(J){var $=k[J];return $||($=(0,d.default)(m).create({streamInfo:S,type:J,dashMetrics:o,fragmentLoader:(0,f.default)(m).create({dashMetrics:o,mediaPlayerModel:c,errHandler:h,requestModifier:(0,y.default)(m).getInstance(),settings:t.settings,boxParser:t.boxParser,eventBus:n,events:r.default,errors:M.default,dashConstants:t.dashConstants,urlUtils:t.urlUtils,streamId:W()}),debug:l,eventBus:n,events:r.default}),k[J]=$),$}function j(){for(var J in k)k[J].reset();k={}}function Q(){n.off(T.default.FRAGMENT_LOADING_COMPLETED,Y,this),n.off(T.default.FRAGMENT_LOADING_PROGRESS,Y,this),j()}function q(J,$,ae,K){var ee=new g.default;return ee.streamId=ae,ee.mediaInfo=$.mediaInfo,ee.segmentType=$.type,ee.start=$.startTime,ee.duration=$.duration,ee.end=ee.start+ee.duration,ee.bytes=J,ee.index=$.index,ee.quality=$.quality,ee.representationId=$.representationId,ee.endFragment=K,ee}function Y(J){if(J.sender){var $=J.request,ae=J.response,K=$.isInitializationRequest(),ee=$.mediaInfo.streamInfo;if(J.error&&($.mediaType===I.default.AUDIO||$.mediaType===I.default.VIDEO||$.mediaType===I.default.TEXT&&$.mediaInfo.isFragmented)&&n.trigger(r.default.SERVICE_LOCATION_BLACKLIST_ADD,{entry:J.request.serviceLocation}),!ae||!ee){U.warn("No "+$.mediaType+" bytes to push or stream is inactive.");return}var se=q(ae,$,S.id,J.type!==r.default.FRAGMENT_LOADING_PROGRESS);A.modifyResponseAsync(se).then(function(ue){n.trigger(K?r.default.INIT_FRAGMENT_LOADED:r.default.MEDIA_FRAGMENT_LOADED,{chunk:ue,request:$},{streamId:ee.id,mediaType:$.mediaType})}).catch(function(ue){U.error(ue),n.trigger(K?r.default.INIT_FRAGMENT_LOADED:r.default.MEDIA_FRAGMENT_LOADED,{chunk:se,request:$},{streamId:ee.id,mediaType:$.mediaType})})}}return L={getStreamId:W,getModel:b,reset:Q},X(),L}E.__dashjs_factory_name="FragmentController";const i=p.default.getClassFactory(E)},"./src/streaming/controllers/GapController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>p});var I=e("./src/core/FactoryMaker.js"),g=e("./src/core/Debug.js"),d=e("./src/core/events/Events.js"),f=e("./src/core/EventBus.js"),y=e("./src/streaming/constants/Constants.js"),_=100,r=10,T=.1;function M(){var C=this.context,v=(0,f.default)(C).getInstance(),E,i,t,m,n,h,c,o,l,A,S,L;function U(){j()}function k(){L=(0,g.default)(C).getInstance().getLogger(E),X()}function X(){Z(),Q(),W()}function W(){n=null,h=NaN,m=0,A=null,S={}}function b(V){V&&(V.settings&&(t=V.settings),V.playbackController&&(c=V.playbackController),V.streamController&&(o=V.streamController),V.videoModel&&(l=V.videoModel))}function j(){v.on(d.default.WALLCLOCK_TIME_UPDATED,ae,this),v.on(d.default.INITIAL_STREAM_SWITCH,$,this),v.on(d.default.PLAYBACK_SEEKING,q,this),v.on(d.default.BUFFER_REPLACEMENT_STARTED,Y,E),v.on(d.default.TRACK_CHANGE_RENDERED,J,E)}function Q(){v.off(d.default.WALLCLOCK_TIME_UPDATED,ae,this),v.off(d.default.INITIAL_STREAM_SWITCH,$,this),v.off(d.default.PLAYBACK_SEEKING,q,this),v.off(d.default.BUFFER_REPLACEMENT_STARTED,Y,E),v.off(d.default.TRACK_CHANGE_RENDERED,J,E)}function q(){A&&(clearTimeout(A),A=null)}function Y(V){try{if(V.streamId!==o.getActiveStreamInfo().id||V.mediaType!==y.default.VIDEO&&V.mediaType!==y.default.AUDIO)return;V.streamId===o.getActiveStreamInfo().id&&(S[V.mediaType]=!0)}catch(te){L.error(te)}}function J(V){!V||!V.mediaType||(S[V.mediaType]=!1)}function $(){n||oe()}function ae(){if(K(t.get().streaming.gaps.enableSeekFix)&&(m++,m>=r)){var V=c.getTime();i===V?H(V,!0):(i=V,h=NaN),m=0}}function K(){var V=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!o.getActiveStream())return!1;var te=Object.keys(S).some(function(R){return S[R]}),z=V?ee():!1;return!te&&t.get().streaming.gaps.jumpGaps&&o.getActiveStreamProcessors().length>0&&(!c.isSeeking()||z)&&!c.isPaused()&&!o.getIsStreamSwitchInProgress()&&!o.getHasMediaOrInitialisationError()}function ee(){var V=o.getActiveStream(),te=parseFloat((V.getStartTime()+V.getDuration()).toFixed(5));return c.getTime()+t.get().streaming.gaps.threshold>=te}function se(V,te){try{if(!V||V.length<=1&&te>0)return NaN;for(var z=NaN,R=0;isNaN(z)&&R<V.length;){var u=R>0?V.end(R-1):0;te<V.start(R)&&u-te<t.get().streaming.gaps.threshold&&(z=R),R+=1}return z}catch{return null}}function ue(V,te){for(var z=0,R=V.length;z<R;z++)if(te>=V.start(z)&&te<=V.end(z))return!0;return!1}function oe(){try{n||(L.debug("Starting the gap controller"),n=setInterval(function(){if(K()){var V=c.getTime();H(V)}},_))}catch{}}function Z(){L.debug("Stopping the gap controller"),n&&(clearInterval(n),n=null)}function H(V){var te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,z=t.get().streaming.gaps.enableStallFix,R=t.get().streaming.gaps.stallSeek,u=t.get().streaming.gaps.smallGapLimit,D=t.get().streaming.gaps.jumpLargeGaps,F=l.getBufferRange(),w,O=NaN,P=!1;if(w=se(F,V),!isNaN(w)){var B=F.start(w),x=B-V;x>0&&(x<=u||D)&&(O=B)}var ne=c.getTimeToStreamEnd();if(isNaN(O)&&te&&isFinite(ne)&&!isNaN(ne)&&ne<u&&(O=parseFloat(c.getStreamEndTime().toFixed(5)),P=!0),z&&isNaN(O)&&te&&isNaN(w)&&ue(F,V)&&(R===0?(L.warn("Toggle play pause to break stall"),l.pause(),l.play()):(L.warn("Jumping ".concat(R,"s to break stall")),O=V+R)),O>0&&h!==O&&O>V&&!A){var re=O-V;if(P){var G=o.getStreamForTime(O),fe=G&&!!G.getPreloaded();L.warn("Jumping to end of stream because of gap from ".concat(V," to ").concat(O,". Gap duration: ").concat(re)),c.seek(O,!0,fe)}else{var le=c.getIsDynamic(),_e=w>0?F.end(w-1):V,Me=le?Math.max(0,re-T)*1e3:0;A=window.setTimeout(function(){c.seek(O,!0,!0),L.warn("Jumping gap occuring in period ".concat(o.getActiveStream().getStreamId()," starting at ").concat(_e," and ending at ").concat(O,". Jumping by: ").concat(O-_e)),A=null},Me)}h=O}}return E={reset:X,setConfig:b,initialize:U},k(),E}M.__dashjs_factory_name="GapController";const p=I.default.getSingletonFactory(M)},"./src/streaming/controllers/MediaController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>C});var I=e("./src/streaming/constants/Constants.js"),g=e("./src/core/events/Events.js"),d=e("./src/core/EventBus.js"),f=e("./src/core/FactoryMaker.js"),y=e("./src/core/Debug.js"),_=e("./node_modules/bcp-47-normalize/index.js"),r=e.n(_),T=e("./node_modules/bcp-47-match/index.js");function M(){var v=this.context,E=(0,d.default)(v).getInstance(),i,t,m,n,h,c,o,l;function A(){t=(0,y.default)(v).getInstance().getLogger(i),$()}function S(re,G){var fe=c[re]||j(re),le=U(re,G.id),_e=[];fe||(fe=l.getSavedMediaSettings(re),b(re,fe)),!(!le||le.length===0)&&(fe&&(_e=Array.from(le),_e=K(_e,ee,fe),_e=K(_e,se,fe),_e=K(_e,ue,fe),re===I.default.AUDIO&&c[re]||(_e=K(_e,oe,fe)),_e=K(_e,Z,fe),_e=K(_e,H,fe)),_e.length===0?W(F(re,le),!0):_e.length>1?W(F(re,_e,!!c[re])):W(_e[0]))}function L(re){if(re){var G=re.type;if(q(G)){var fe=re.streamInfo.id;m[fe]||(m[fe]=ne());for(var le=m[fe][G].list,_e=0,Me=le.length;_e<Me;++_e)if(Y(le[_e],re))return;le.push(re)}}}function U(re,G){return re?!m[G]||!m[G][re]?[]:m[G][re].list:[]}function k(re,G){return!re||!m[G]||!m[G][re]?null:m[G][re].current}function X(re){if(!re)return!1;var G=re.type,fe=re.streamInfo.id;return m[fe]&&m[fe][G]&&Y(m[fe][G].current,re)}function W(re){var G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(!(!re||!re.streamInfo)){var fe=re.type,le=re.streamInfo,_e=le.id,Me=k(fe,_e);if(!(!m[_e]||!m[_e][fe])&&(m[_e][fe].current=re,m[_e][fe].current&&(fe!==I.default.TEXT&&!Y(re,Me)||fe===I.default.TEXT&&re.isFragmented)&&E.trigger(g.default.CURRENT_TRACK_CHANGED,{oldMediaInfo:Me,newMediaInfo:re,switchMode:n.get().streaming.trackSwitchMode[fe]},{streamId:_e}),!G)){var Oe=ae(re);if(!Oe||!m[_e][fe].storeLastSettings)return;Oe.roles&&(Oe.role=Oe.roles[0],delete Oe.roles),Oe.accessibility&&(Oe.accessibility=Oe.accessibility[0]),Oe.audioChannelConfiguration&&(Oe.audioChannelConfiguration=Oe.audioChannelConfiguration[0]),c[fe]=Oe,l.setSavedMediaSettings(fe,Oe)}}}function b(re,G){!re||!G||(h[re]=G)}function j(re){return re?h[re]:null}function Q(){l.setSavedMediaSettings(I.default.TEXT,null)}function q(re){return re===I.default.AUDIO||re===I.default.VIDEO||re===I.default.TEXT||re===I.default.IMAGE}function Y(re,G){if(!re&&!G)return!0;if(!re||!G)return!1;var fe=re.id===G.id,le=re.viewpoint===G.viewpoint,_e=re.lang===G.lang,Me=re.codec===G.codec,Oe=re.roles.toString()===G.roles.toString(),Ne=re.accessibility.toString()===G.accessibility.toString(),xe=re.audioChannelConfiguration.toString()===G.audioChannelConfiguration.toString();return fe&&Me&&le&&_e&&Oe&&Ne&&xe}function J(re){re&&(re.domStorage&&(l=re.domStorage),re.settings&&(n=re.settings),re.customParametersModel&&(o=re.customParametersModel))}function $(){m={},c={},te()}function ae(re){var G={lang:re.lang,viewpoint:re.viewpoint,roles:re.roles,accessibility:re.accessibility,audioChannelConfiguration:re.audioChannelConfiguration},fe=G.lang||G.viewpoint||G.role&&G.role.length>0||G.accessibility&&G.accessibility.length>0||G.audioChannelConfiguration&&G.audioChannelConfiguration.length>0;return fe?G:null}function K(re,G,fe){var le=[];return re.forEach(function(_e){G(fe,_e)&&le.push(_e)}),le.length!==0?le:re}function ee(re,G){return!re.lang||re.lang instanceof RegExp?G.lang.match(re.lang):G.lang!==""?(0,T.extendedFilter)(G.lang,r()(re.lang)).length>0:!1}function se(re,G){return re.index===void 0||re.index===null||G.index===re.index}function ue(re,G){return!re.viewpoint||re.viewpoint===G.viewpoint}function oe(re,G){var fe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,le=!re.role||!!G.roles.filter(function(_e){return _e===re.role})[0];return le||G.type===I.default.AUDIO&&fe}function Z(re,G){var fe;return re.accessibility?fe=!!G.accessibility.filter(function(le){return le===re.accessibility})[0]:fe=!G.accessibility.length,fe}function H(re,G){var fe=!re.audioChannelConfiguration||!!G.audioChannelConfiguration.filter(function(le){return le===re.audioChannelConfiguration})[0];return fe}function V(re,G){var fe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;try{var le=!1;if(!re.lang)le=!0;else if(re.lang instanceof RegExp)le=G.lang.match(re.lang);else if(G.lang!==""){var _e=r()(re.lang);_e&&(le=(0,T.extendedFilter)(G.lang,_e).length>0)}var Me=re.index===void 0||re.index===null||G.index===re.index,Oe=!re.viewpoint||re.viewpoint===G.viewpoint,Ne=!re.role||!!G.roles.filter(function(me){return me===re.role})[0],xe=!re.accessibility||!!G.accessibility.filter(function(me){return me===re.accessibility})[0],Se=!re.audioChannelConfiguration||!!G.audioChannelConfiguration.filter(function(me){return me===re.audioChannelConfiguration})[0];return le&&Me&&Oe&&(Ne||G.type===I.default.AUDIO&&fe)&&xe&&Se}catch{return!1}}function te(){h={audio:null,video:null,text:null}}function z(re){var G=0,fe=[];return re.forEach(function(le){isNaN(le.selectionPriority)||(le.selectionPriority>G?(G=le.selectionPriority,fe=[le]):le.selectionPriority===G&&fe.push(le))}),fe}function R(re){var G=0,fe=[],le;return re.forEach(function(_e){le=Math.max.apply(Math,_e.bitrateList.map(function(Me){return Me.bandwidth})),le>G?(G=le,fe=[_e]):le===G&&fe.push(_e)}),fe}function u(re){var G=1/0,fe=[],le;return re.forEach(function(_e){var Me=_e.bitrateList.reduce(function(Oe,Ne){var xe=Math.max(1,Ne.width*Ne.height),Se=Ne.bandwidth/xe;return Oe+Se},0);le=Me/_e.bitrateList.length,le<G?(G=le,fe=[_e]):le===G&&fe.push(_e)}),fe}function D(re){var G=0,fe=[],le;return re.forEach(function(_e){le=_e.representationCount,le>G?(G=le,fe=[_e]):le===G&&fe.push(_e)}),fe}function F(re,G){if(re===I.default.TEXT)return G[0];var fe=n.get().streaming.selectionModeForInitialTrack,le,_e=o.getCustomInitialTrackSelectionFunction();if(_e&&typeof _e=="function")le=_e(G);else switch(fe){case I.default.TRACK_SELECTION_MODE_HIGHEST_SELECTION_PRIORITY:le=w(G);break;case I.default.TRACK_SELECTION_MODE_HIGHEST_BITRATE:le=O(G);break;case I.default.TRACK_SELECTION_MODE_FIRST_TRACK:le=P(G);break;case I.default.TRACK_SELECTION_MODE_HIGHEST_EFFICIENCY:le=B(G);break;case I.default.TRACK_SELECTION_MODE_WIDEST_RANGE:le=x(G);break;default:t.warn("Track selection mode ".concat(fe," is not supported. Falling back to TRACK_SELECTION_MODE_FIRST_TRACK")),le=P(G);break}return le.length>0?le[0]:G[0]}function w(re){var G=z(re);return G.length>1&&(G=R(G)),G.length>1&&(G=D(G)),G}function O(re){var G=R(re);return G.length>1&&(G=D(G)),G}function P(re){return re[0]}function B(re){var G=u(re);return G.length>1&&(G=R(G)),G}function x(re){var G=D(re);return G.length>1&&(G=R(re)),G}function ne(){return{audio:{list:[],storeLastSettings:!0,current:null},video:{list:[],storeLastSettings:!0,current:null},text:{list:[],storeLastSettings:!0,current:null},image:{list:[],storeLastSettings:!0,current:null}}}return i={setInitialMediaSettingsForType:S,addTrack:L,getTracksFor:U,getCurrentTrackFor:k,isCurrentTrack:X,setTrack:W,selectInitialTrack:F,setInitialSettings:b,getInitialSettings:j,getTracksWithHighestBitrate:R,getTracksWithHighestEfficiency:u,getTracksWithWidestRange:D,isTracksEqual:Y,matchSettings:V,matchSettingsLang:ee,matchSettingsIndex:se,matchSettingsViewPoint:ue,matchSettingsRole:oe,matchSettingsAccessibility:Z,matchSettingsAudioChannelConfig:H,saveTextSettingsDisabled:Q,setConfig:J,reset:$},A(),i}M.__dashjs_factory_name="MediaController";var p=f.default.getSingletonFactory(M);f.default.updateSingletonFactory(M.__dashjs_factory_name,p);const C=p},"./src/streaming/controllers/MediaSourceController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>f});var I=e("./src/core/FactoryMaker.js"),g=e("./src/core/Debug.js");function d(){var y,_,r,T=this.context;function M(){r=(0,g.default)(T).getInstance().getLogger(y)}function p(){var n="WebKitMediaSource"in window,h="MediaSource"in window;return h?_=new MediaSource:n&&(_=new WebKitMediaSource),_}function C(n){var h=window.URL.createObjectURL(_);return n.setSource(h),h}function v(n){n.setSource(null)}function E(n){!_||_.readyState!=="open"||n===null&&isNaN(n)||_.duration!==n&&(m(_)?setTimeout(E.bind(null,n),50):(r.info("Set MediaSource duration:"+n),_.duration=n))}function i(n,h){_&&typeof _.setLiveSeekableRange=="function"&&typeof _.clearLiveSeekableRange=="function"&&_.readyState==="open"&&n>=0&&n<h&&(_.clearLiveSeekableRange(),_.setLiveSeekableRange(n,h))}function t(n){if(!(!n||n.readyState!=="open")){for(var h=n.sourceBuffers,c=0;c<h.length;c++)if(h[c].updating||h[c].buffered.length===0)return;r.info("call to mediaSource endOfStream"),n.endOfStream()}}function m(n){for(var h=n.sourceBuffers,c=0;c<h.length;c++)if(h[c].updating)return!0;return!1}return y={createMediaSource:p,attachMediaSource:C,detachMediaSource:v,setDuration:E,setSeekable:i,signalEndOfStream:t},M(),y}d.__dashjs_factory_name="MediaSourceController";const f=I.default.getSingletonFactory(d)},"./src/streaming/controllers/PlaybackController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>p});var I=e("./src/streaming/constants/Constants.js"),g=e("./src/core/EventBus.js"),d=e("./src/core/events/Events.js"),f=e("./src/core/FactoryMaker.js"),y=e("./src/core/Debug.js"),_=e("./src/streaming/MediaPlayerEvents.js"),r=e("./src/streaming/constants/MetricsConstants.js"),T=500;function M(){var C=this.context,v=(0,g.default)(C).getInstance(),E,i,t,m,n,h,c,o,l,A,S,L,U,k,X,W,b,j,Q,q,Y,J,$,ae;function K(){i=(0,y.default)(C).getInstance().getLogger(E),ee()}function ee(){te(),k=!1,A=0,S=0,W=0,J=!1,b=!0,j=!1,$=!1,Q=NaN,c&&(v.off(d.default.DATA_UPDATE_COMPLETED,Je,E),v.off(d.default.LOADING_PROGRESS,Ge,E),v.off(d.default.MANIFEST_UPDATED,Mt,E),v.off(d.default.STREAMS_COMPOSED,Ct,E),v.off(_.default.PLAYBACK_ENDED,Ve,E),v.off(_.default.STREAM_INITIALIZING,et,E),v.off(_.default.REPRESENTATION_SWITCH,lt,E),v.off(_.default.BUFFER_LEVEL_STATE_CHANGED,Be,E),Qe(),qe()),l=null,c=null,L=null,U=null}function se(Te,Ie){L=Te,Ie!==!0&&ue()}function ue(){we(),U=L.manifestInfo.isDynamic,Y=!1,q=!1,v.on(d.default.DATA_UPDATE_COMPLETED,Je,E),v.on(d.default.LOADING_PROGRESS,Ge,E),v.on(d.default.MANIFEST_UPDATED,Mt,E),v.on(d.default.STREAMS_COMPOSED,Ct,E),v.on(_.default.PLAYBACK_ENDED,Ve,E,{priority:g.default.EVENT_PRIORITY_HIGH}),v.on(_.default.STREAM_INITIALIZING,et,E),v.on(_.default.REPRESENTATION_SWITCH,lt,E),v.on(_.default.BUFFER_LEVEL_STATE_CHANGED,Be,E),k&&(k=!1,V())}function oe(){return Y}function Z(){var Te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return parseFloat((H(Te)-w()).toFixed(5))}function H(Te){var Ie=Te||L;return Ie.start+Ie.duration}function V(){var Te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;L&&c&&c.getElement()?(Te&&U&&F(w()),c.play()):k=!0}function te(){L&&c&&c.pause()}function z(Te){var Ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,Ke=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,it=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!(!L||!c)){var pt=isNaN(Q)?c.getTime():Q;Te!==pt&&(q=Ke===!0,q||(Q=Te),i.info("Requesting seek to time: "+Te+(q?" (internal)":"")),U&&it&&F(Te),c.setCurrentTime(Te,Ie))}}function R(){var Te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,Ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,Ke=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,it=D();if(it!==0){A=S;var pt=it-A;z(pt,Te,Ie,Ke)}}function u(){var Te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,Ie=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,Ke=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,it=D();if(it!==0){var pt=it-A;z(pt,Te,Ie,Ke)}}function D(){if(!(!L||!c||!U)){var Te=t&&t.hasVideoTrack()?I.default.VIDEO:I.default.AUDIO,Ie=n.getCurrentDVRInfo(Te);return Ie&&Ie.range?Ie.range.end:0}}function F(Te){var Ie=new Date(o.getClientReferenceTime()),Ke=h.getRegularPeriods()[0],it=o.calcPresentationTimeFromWallTime(Ie,Ke);A=it-Te}function w(){return L&&c?c.getTime():null}function O(){return L&&c?c.isPaused():null}function P(){return L&&c?c.isSeeking():null}function B(){return L&&c?c.isStalled():null}function x(){return L&&c?c.getPlaybackRate():null}function ne(){return L&&c?c.getPlayedRanges():null}function re(){return L&&c?c.getEnded():null}function G(){return U}function fe(){return t}function le(){return J}function _e(){return W}function Me(){return A}function Oe(){return S}function Ne(){if(!U||isNaN(W))return NaN;var Te=w();if(isNaN(Te)||Te===0)return 0;var Ie=new Date().getTime()+o.getClientTimeOffset()*1e3;return Math.max(((Ie-W-Te*1e3)/1e3).toFixed(3),0)}function xe(Te,Ie){var Ke,it,pt,Et=4,gt=4,Nt=!isNaN(Te)&&isFinite(Te)?Te:NaN,Dt=h.getSuggestedPresentationDelay(),ke=m.getServiceDescriptionSettings();return isNaN(ae.get().streaming.delay.liveDelay)?ae.get().streaming.delay.liveDelayFragmentCount!==null&&!isNaN(ae.get().streaming.delay.liveDelayFragmentCount)&&!isNaN(Nt)?Ke=Nt*ae.get().streaming.delay.liveDelayFragmentCount:ke&&!isNaN(ke.liveDelay)&&ke.liveDelay>0?Ke=ke.liveDelay:ae.get().streaming.delay.useSuggestedPresentationDelay===!0&&Dt!==null&&!isNaN(Dt)&&Dt>0?Ke=Dt:isNaN(Nt)?Ke=Ie&&!isNaN(Ie.minBufferTime)?Ie.minBufferTime*Et:L.manifestInfo.minBufferTime*Et:Ke=Nt*gt:Ke=ae.get().streaming.delay.liveDelay,pt=h.getAvailabilityStartTime(),pt!==null&&(W=pt),Ie&&Ie.dvrWindowSize>0?it=Math.min(Ke,Ie.dvrWindowSize):it=Ke,A=it,S=it,it}function Se(Te){Te&&(Te.streamController&&(t=Te.streamController),Te.serviceDescriptionController&&(m=Te.serviceDescriptionController),Te.dashMetrics&&(n=Te.dashMetrics),Te.adapter&&(h=Te.adapter),Te.videoModel&&(c=Te.videoModel),Te.timelineConverter&&(o=Te.timelineConverter),Te.settings&&(ae=Te.settings))}function me(){var Te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;if(!(O()||!U||c.getReadyState()===0||P()||J)){Te||(Te=t.hasVideoTrack()?I.default.VIDEO:I.default.AUDIO);var Ie=w(),Ke=Ae(Ie,Te),it=!isNaN(Ke)&&Ke!==Ie;it&&!P()&&(B()||Y||c.getReadyState()===1)&&(i.debug("UpdateCurrentTime: Seek to actual time: ".concat(Ke," from currentTime: ").concat(Ie)),z(Ke,!1,!1))}}function Ae(Te,Ie){var Ke=n.getCurrentDVRInfo(Ie),it=Ke?Ke.range:null,pt;return it?(Te>it.end?pt=Math.max(it.end-A,it.start):Te>0&&Te+.25<it.start&&Math.abs(Te-it.start)<31536e4?j?pt=Math.max(it.end-A,it.start):pt=it.start:pt=Te,pt):NaN}function He(){l===null&&(l=setInterval(function(){ut()},ae.get().streaming.wallclockTimeUpdateInterval))}function Qe(){clearInterval(l),l=null}function Je(Te){var Ie=h.convertRepresentationToRepresentationInfo(Te.currentRepresentation),Ke=Ie?Ie.mediaInfo.streamInfo:null;Ke===null||L.id!==Ke.id||(L=Ke)}function ye(){v.trigger(d.default.CAN_PLAY)}function Fe(){v.trigger(d.default.CAN_PLAY_THROUGH)}function Be(Te){Te.streamId===t.getActiveStreamInfo().id&&(Y=Te.state===r.default.BUFFER_EMPTY,ae.get().streaming.buffer.setStallState&&c.setStallState(Te.mediaType,Te.state===r.default.BUFFER_EMPTY))}function Ye(){i.info("Native video element event: play"),me(),He(),v.trigger(d.default.PLAYBACK_STARTED,{startTime:w()})}function Ze(){i.info("Native video element event: waiting"),v.trigger(d.default.PLAYBACK_WAITING,{playingTime:w()})}function tt(){i.info("Native video element event: playing"),q=!1,v.trigger(d.default.PLAYBACK_PLAYING,{playingTime:w()})}function nt(){i.info("Native video element event: pause"),v.trigger(d.default.PLAYBACK_PAUSED,{ended:re()})}function ht(){if(!q){var Te=w();!isNaN(Q)&&Q!==Te&&(Te=Q),Q=NaN,i.info("Seeking to: "+Te),He(),v.trigger(d.default.PLAYBACK_SEEKING,{seekTime:Te,streamId:L.id})}}function je(){i.info("Native video element event: seeked"),q=!1,v.trigger(d.default.PLAYBACK_SEEKED)}function ge(){L&&v.trigger(d.default.PLAYBACK_TIME_UPDATED,{timeToEnd:Z(),time:w(),streamId:L.id})}function ie(){v.trigger(d.default.PLAYBACK_PROGRESS,{streamId:L.id})}function he(){var Te=x();i.info("Native video element event: ratechange: ",Te),v.trigger(d.default.PLAYBACK_RATE_CHANGED,{playbackRate:Te})}function De(){i.info("Native video element event: loadedmetadata"),v.trigger(d.default.PLAYBACK_METADATA_LOADED),He()}function Ce(){i.info("Native video element event: loadeddata"),v.trigger(d.default.PLAYBACK_LOADED_DATA)}function We(){i.info("Native video element event: ended"),te(),Qe();var Te=t?t.getActiveStreamInfo():null;Te&&v.trigger(d.default.PLAYBACK_ENDED,{isLast:Te.isLast})}function Xe(){v.trigger(d.default.PLAYBACK_VOLUME_CHANGED)}function Ve(Te){if(l&&Te.isLast){i.info("onPlaybackEnded -- PLAYBACK_ENDED but native video element didn't fire ended");var Ie=Te.seekTime?Te.seekTime:H();c.setCurrentTime(Ie),te(),Qe()}}function rt(Te){var Ie=Te.target||Te.srcElement;v.trigger(d.default.PLAYBACK_ERROR,{error:Ie.error})}function ut(){v.trigger(d.default.WALLCLOCK_TIME_UPDATED,{isDynamic:U,time:new Date}),G()&&(t.addDVRMetric(),O()?mt():me())}function mt(){var Te=Date.now();(!X||Te>X+T)&&(X=Te,ge())}function ve(){var Te=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,Ie=null;return t.getActiveStreamProcessors().forEach(function(Ke){if(!Te||Te.length===0||Te.indexOf(Ke.getType())===-1){var it=Ke.getBufferLevel();Ie===null?Ie=it:Ie=Math.min(Ie,it)}}),Ie}function Le(){return j}function Ge(Te){if(Te.stream===!1&&j&&!isNaN(Te.request.duration)){var Ie=1.2*Te.request.duration;Ie>A&&(i.warn("Browser does not support fetch API with StreamReader. Increasing live delay to be 20% higher than segment duration:",Ie.toFixed(2)),A=Ie,S=Ie)}}function at(Te){v.trigger(d.default.PLAYBACK_STALLED,{e:Te})}function et(Te){de(Te.mediaInfo)}function lt(Te){var Ie=t.getActiveStreamInfo();!Te||!Ie||!Te.currentRepresentation||!Te.streamId||Te.streamId!==Ie.id||!Te.mediaType||Te.mediaType!==I.default.VIDEO&&Te.mediaType!==I.default.AUDIO||(b=Te.currentRepresentation.availabilityTimeComplete,j=!b,j&&!$&&($=!0))}function vt(){return $}function Mt(){J=!0}function Ct(){J=!1}function de(Te){Te&&Te.supplementalProperties&&Te.supplementalProperties[I.default.SUPPLEMENTAL_PROPERTY_DVB_LL_SCHEME]==="true"&&(i.debug("Low Latency critical SupplementalProperty set: Enabling low Latency"),j=!0)}function we(){c.addEventListener("canplay",ye),c.addEventListener("canplaythrough",Fe),c.addEventListener("play",Ye),c.addEventListener("waiting",Ze),c.addEventListener("playing",tt),c.addEventListener("pause",nt),c.addEventListener("error",rt),c.addEventListener("seeking",ht),c.addEventListener("seeked",je),c.addEventListener("timeupdate",ge),c.addEventListener("progress",ie),c.addEventListener("ratechange",he),c.addEventListener("loadedmetadata",De),c.addEventListener("loadeddata",Ce),c.addEventListener("stalled",at),c.addEventListener("ended",We),c.addEventListener("volumechange",Xe)}function qe(){c.removeEventListener("canplay",ye),c.removeEventListener("canplaythrough",Fe),c.removeEventListener("play",Ye),c.removeEventListener("waiting",Ze),c.removeEventListener("playing",tt),c.removeEventListener("pause",nt),c.removeEventListener("error",rt),c.removeEventListener("seeking",ht),c.removeEventListener("seeked",je),c.removeEventListener("timeupdate",ge),c.removeEventListener("progress",ie),c.removeEventListener("ratechange",he),c.removeEventListener("loadedmetadata",De),c.removeEventListener("loadeddata",Ce),c.removeEventListener("stalled",at),c.removeEventListener("ended",We),c.removeEventListener("volumechange",Xe)}return E={initialize:se,setConfig:Se,getTimeToStreamEnd:Z,getBufferLevel:ve,getPlaybackStalled:oe,getTime:w,getLowLatencyModeEnabled:Le,getInitialCatchupModeActivated:vt,getIsManifestUpdateInProgress:le,getPlaybackRate:x,getPlayedRanges:ne,getEnded:re,getIsDynamic:G,getStreamController:fe,computeAndSetLiveDelay:xe,getLiveDelay:Me,getOriginalLiveDelay:Oe,getCurrentLiveLatency:Ne,play:V,isPaused:O,isStalled:B,pause:te,isSeeking:P,getStreamEndTime:H,seek:z,seekToOriginalLive:R,seekToCurrentLive:u,reset:ee,updateCurrentTime:me,getAvailabilityStartTime:_e},K(),E}M.__dashjs_factory_name="PlaybackController";const p=f.default.getSingletonFactory(M)},"./src/streaming/controllers/ScheduleController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>p});var I=e("./src/streaming/constants/Constants.js"),g=e("./src/streaming/models/FragmentModel.js"),d=e("./src/core/EventBus.js"),f=e("./src/core/events/Events.js"),y=e("./src/core/FactoryMaker.js"),_=e("./src/core/Debug.js"),r=e("./src/streaming/constants/MetricsConstants.js"),T=e("./src/streaming/MediaPlayerEvents.js");function M(C){C=C||{};var v=this.context,E=(0,d.default)(v).getInstance(),i=C.dashMetrics,t=C.mediaPlayerModel,m=C.fragmentModel,n=C.abrController,h=C.playbackController,c=C.textController,o=C.type,l=C.bufferController,A=C.settings,S,L,U,k,X,W,b,j,Q,q,Y,J,$;function ae(){U=(0,_.default)(v).getInstance().getLogger(S),xe(),L=C.streamInfo}function K(Ae){b=Ae,E.on(f.default.BYTES_APPENDED_END_FRAGMENT,re,S),E.on(f.default.URL_RESOLUTION_FAILED,G,S),E.on(T.default.PLAYBACK_STARTED,fe,S),E.on(T.default.PLAYBACK_RATE_CHANGED,le,S),E.on(T.default.PLAYBACK_TIME_UPDATED,x,S)}function ee(){return o}function se(){return L.id}function ue(Ae){k=Ae}function oe(Ae){if(!l.getIsBufferingCompleted()){Z();var He=isNaN(Ae)?0:Ae;W=setTimeout(V,He)}}function Z(){W&&(clearTimeout(W),W=null)}function H(){var Ae=L.id,He=n.getMaxAllowedIndexFor(o,Ae);return isNaN(Q)||Q!=He?(U.info("Top quality "+o+" index has changed from "+Q+" to "+He),Q=He,!0):!1}function V(){try{if(z()){Z();return}if(R()){var Ae=!1;$&&(Ae=n.checkPlaybackQuality(o,L.id)),Ae||te()}else oe(h.getLowLatencyModeEnabled()?A.get().streaming.scheduling.lowLatencyTimeout:A.get().streaming.scheduling.defaultTimeout)}catch{oe(h.getLowLatencyModeEnabled()?A.get().streaming.scheduling.lowLatencyTimeout:A.get().streaming.scheduling.defaultTimeout)}}function te(){J||k.quality!==q||Y?(Y?(U.debug("Switch track for "+o+", representation id = "+k.id),Y=!1):U.debug("Quality has changed, get init request for representationid = "+k.id),E.trigger(f.default.INIT_FRAGMENT_NEEDED,{representationId:k.id,sender:S},{streamId:L.id,mediaType:o}),$=!1,J=!1):(U.debug("Media segment needed for ".concat(o," and stream id ").concat(L.id)),E.trigger(f.default.MEDIA_FRAGMENT_NEEDED,{},{streamId:L.id,mediaType:o}),$=!0)}function z(){try{return o===I.default.TEXT&&!c.isTextEnabled()||h.isPaused()&&(!h.getStreamController().getInitialPlayback()||!h.getStreamController().getAutoPlay())&&!A.get().streaming.scheduling.scheduleWhilePaused}catch{return!1}}function R(){try{return k&&(isNaN(q)||Y||H()||u())}catch{return!1}}function u(){if(!o||!k)return!0;var Ae=i.getCurrentBufferLevel(o);return Ae<D()}function D(){var Ae=NaN;return!o||!k||(o===I.default.TEXT?Ae=F():o===I.default.AUDIO&&b?Ae=w():Ae=O()),Ae}function F(){try{if(c.isTextEnabled())if(isNaN(k.fragmentDuration)){var Ae=i.getCurrentSchedulingInfo(r.default.SCHEDULING_INFO);return Ae?Ae.duration:0}else return k.fragmentDuration;else return 0}catch{return 0}}function w(){try{var Ae=i.getCurrentBufferLevel(I.default.VIDEO);return isNaN(k.fragmentDuration)?Ae+1:Math.max(Ae+1,k.fragmentDuration)}catch{return 0}}function O(){try{var Ae=k.mediaInfo.streamInfo;if(n.isPlayingAtTopQuality(Ae)){var He=Ae.manifestInfo.duration>=A.get().streaming.buffer.longFormContentDurationThreshold;return He?A.get().streaming.buffer.bufferTimeAtTopQualityLongForm:A.get().streaming.buffer.bufferTimeAtTopQuality}else return t.getStableBufferTime()}catch{return t.getStableBufferTime()}}function P(Ae){Y=Ae}function B(){return Y}function x(){ne(!0)}function ne(Ae){if(h&&m){var He=m.getRequests({state:g.default.FRAGMENT_MODEL_EXECUTED,time:h.getTime(),threshold:0})[0];He&&h.getTime()>=He.startTime&&((!j.mediaInfo||He.mediaInfo.type===j.mediaInfo.type&&He.mediaInfo.id!==j.mediaInfo.id)&&Ae&&E.trigger(f.default.TRACK_CHANGE_RENDERED,{mediaType:o,oldMediaInfo:j.mediaInfo,newMediaInfo:He.mediaInfo,streamId:L.id}),(He.quality!==j.quality||He.adaptationIndex!==j.adaptationIndex)&&Ae&&(U.debug("Quality change rendered for streamId ".concat(L.id," and type ").concat(o)),E.trigger(f.default.QUALITY_CHANGE_RENDERED,{mediaType:o,oldQuality:j.quality,newQuality:He.quality,streamId:L.id})),j={mediaInfo:He.mediaInfo,quality:He.quality,adaptationIndex:He.adaptationIndex})}}function re(Ae){U.debug("Appended bytes for ".concat(Ae.mediaType," and stream id ").concat(L.id)),(isNaN(Ae.index)||isNaN(q))&&(q=Ae.quality,U.info("["+o+"] lastInitializedRepresentationInfo changed to "+Ae.quality)),oe(0)}function G(){m.abortRequests(),Z()}function fe(){A.get().streaming.scheduling.scheduleWhilePaused||oe()}function le(Ae){i.updatePlayListTraceMetrics({playbackspeed:Ae.playbackRate.toString()})}function _e(Ae){X=Ae}function Me(){return X}function Oe(Ae){$=Ae}function Ne(Ae){J=Ae}function xe(){$=!0,X=0,q=NaN,j={mediaInfo:void 0,quality:NaN,adaptationIndex:NaN},Q=NaN,Y=!1,J=!1}function Se(){E.off(f.default.BYTES_APPENDED_END_FRAGMENT,re,S),E.off(f.default.URL_RESOLUTION_FAILED,G,S),E.off(T.default.PLAYBACK_STARTED,fe,S),E.off(T.default.PLAYBACK_RATE_CHANGED,le,S),E.off(T.default.PLAYBACK_TIME_UPDATED,x,S),Z(),ne(!1),xe(),L=null}function me(){return h}return S={initialize:K,getType:ee,getStreamId:se,setCurrentRepresentation:ue,setTimeToLoadDelay:_e,getTimeToLoadDelay:Me,setSwitchTrack:P,getSwitchStrack:B,startScheduleTimer:oe,clearScheduleTimer:Z,reset:Se,getBufferTarget:D,getPlaybackController:me,setCheckPlaybackQuality:Oe,setInitSegmentRequired:Ne},ae(),S}M.__dashjs_factory_name="ScheduleController";const p=y.default.getClassFactory(M)},"./src/streaming/controllers/StreamController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>X});var I=e("./src/streaming/constants/Constants.js"),g=e("./src/streaming/constants/MetricsConstants.js"),d=e("./src/streaming/Stream.js"),f=e("./src/streaming/ManifestUpdater.js"),y=e("./src/core/EventBus.js"),_=e("./src/core/events/Events.js"),r=e("./src/core/FactoryMaker.js"),T=e("./src/streaming/vo/metrics/PlayList.js"),M=e("./src/core/Debug.js"),p=e("./src/streaming/utils/InitCache.js"),C=e("./src/streaming/MediaPlayerEvents.js"),v=e("./src/streaming/controllers/TimeSyncController.js"),E=e("./src/streaming/controllers/MediaSourceController.js"),i=e("./src/streaming/vo/DashJSError.js"),t=e("./src/core/errors/Errors.js"),m=e("./src/streaming/controllers/EventController.js"),n=e("./src/streaming/constants/ConformanceViolationConstants.js");function h(W){return A(W)||l(W)||o(W)||c()}function c(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o(W,b){if(W){if(typeof W=="string")return S(W,b);var j=Object.prototype.toString.call(W).slice(8,-1);if(j==="Object"&&W.constructor&&(j=W.constructor.name),j==="Map"||j==="Set")return Array.from(W);if(j==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(j))return S(W,b)}}function l(W){if(typeof Symbol<"u"&&Symbol.iterator in Object(W))return Array.from(W)}function A(W){if(Array.isArray(W))return S(W)}function S(W,b){(b==null||b>W.length)&&(b=W.length);for(var j=0,Q=new Array(b);j<b;j++)Q[j]=W[j];return Q}var L=200,U=2;function k(){var W=this.context,b=(0,y.default)(W).getInstance(),j,Q,q,Y,J,$,ae,K,ee,se,ue,oe,Z,H,V,te,z,R,u,D,F,w,O,P,B,x,ne,re,G,fe,le,_e,Me,Oe,Ne,xe,Se,me,Ae,He,Qe,Je,ye,Fe,Be,Ye,Ze,tt;function nt(){Q=(0,M.default)(W).getInstance().getLogger(j),ue=(0,v.default)(W).getInstance(),se=(0,E.default)(W).getInstance(),u=(0,p.default)(W).getInstance(),cr()}function ht(Re,ze){ie(),ne=Re,x=ze,F.initialize(),J=(0,f.default)(W).create(),J.setConfig({manifestModel:ae,adapter:K,manifestLoader:$,errHandler:D,settings:Fe}),J.initialize(),R=(0,m.default)(W).getInstance(),R.setConfig({manifestUpdater:J,playbackController:Me,settings:Fe}),R.start(),ue.setConfig({dashMetrics:ee,baseURLController:Z,errHandler:D,settings:Fe}),ue.initialize(),P&&(b.trigger(_.default.PROTECTION_CREATED,{controller:P}),P.setMediaElement(_e.getElement()),x&&P.setProtectionData(x)),je()}function je(){b.on(C.default.PLAYBACK_TIME_UPDATED,it,j),b.on(C.default.PLAYBACK_SEEKING,Ge,j),b.on(C.default.PLAYBACK_ERROR,Zt,j),b.on(C.default.PLAYBACK_STARTED,pt,j),b.on(C.default.PLAYBACK_PAUSED,Et,j),b.on(C.default.PLAYBACK_ENDED,pe,j),b.on(C.default.METRIC_ADDED,dr,j),b.on(C.default.MANIFEST_VALIDITY_CHANGED,fr,j),b.on(C.default.BUFFER_LEVEL_UPDATED,Te,j),b.on(C.default.QUALITY_CHANGE_REQUESTED,Ie,j),_.default.KEY_SESSION_UPDATED&&b.on(_.default.KEY_SESSION_UPDATED,Xe,j),b.on(_.default.MANIFEST_UPDATED,jt,j),b.on(_.default.STREAM_BUFFERING_COMPLETED,gt,j),b.on(_.default.TIME_SYNCHRONIZATION_COMPLETED,We,j),b.on(_.default.CURRENT_TRACK_CHANGED,Mt,j),b.on(_.default.SETTING_UPDATED_LIVE_DELAY,Ke,j),b.on(_.default.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,Ke,j)}function ge(){b.off(C.default.PLAYBACK_TIME_UPDATED,it,j),b.off(C.default.PLAYBACK_SEEKING,Ge,j),b.off(C.default.PLAYBACK_ERROR,Zt,j),b.off(C.default.PLAYBACK_STARTED,pt,j),b.off(C.default.PLAYBACK_PAUSED,Et,j),b.off(C.default.PLAYBACK_ENDED,pe,j),b.off(C.default.METRIC_ADDED,dr,j),b.off(C.default.MANIFEST_VALIDITY_CHANGED,fr,j),b.off(C.default.BUFFER_LEVEL_UPDATED,Te,j),b.off(C.default.QUALITY_CHANGE_REQUESTED,Ie,j),_.default.KEY_SESSION_UPDATED&&b.off(_.default.KEY_SESSION_UPDATED,Xe,j),b.off(_.default.MANIFEST_UPDATED,jt,j),b.off(_.default.STREAM_BUFFERING_COMPLETED,gt,j),b.off(_.default.TIME_SYNCHRONIZATION_COMPLETED,We,j),b.off(_.default.CURRENT_TRACK_CHANGED,Mt,j),b.off(_.default.SETTING_UPDATED_LIVE_DELAY,Ke,j),b.off(_.default.SETTING_UPDATED_LIVE_DELAY_FRAGMENT_COUNT,Ke,j)}function ie(){if(!$||!$.hasOwnProperty("load")||!F||!F.hasOwnProperty("initialize")||!F.hasOwnProperty("reset")||!F.hasOwnProperty("getClientTimeOffset")||!ae||!D||!ee||!Me)throw new Error(I.default.MISSING_CONFIG_ERROR)}function he(){if(!J||!J.hasOwnProperty("setManifest"))throw new Error("initialize function has to be called previously")}function De(Re){var ze=arguments.length>1&&arguments[1]!==void 0?arguments[1]:NaN;ie(),Ze=ze,$.load(Re)}function Ce(Re){var ze=arguments.length>1&&arguments[1]!==void 0?arguments[1]:NaN;he(),Ze=ze,J.setManifest(Re)}function We(){Ve()}function Xe(){Be=!0}function Ve(){try{var Re=K.getStreamsInfo();if(!O&&Re.length===0)throw new Error("There are no periods in the MPD");O&&Re.length>0&&ee.updateManifestUpdateInfo({currentTime:Me.getTime(),buffered:_e.getBufferRange(),presentationStartTime:Re[0].start,clientTimeOffset:F.getClientTimeOffset()}),w.length>0&&kt(Re);for(var ze=[],st=0,yt=Re.length;st<yt;st++){var At=Re[st];ze.push(rt(At)),ee.addManifestUpdateStreamInfo(At)}Promise.all(ze).then(function(){return Fe.get().streaming.applyContentSteering&&!O&&oe.shouldQueryBeforeStart()?oe.loadSteeringData():Promise.resolve()}).then(function(){O||ut(Re),b.trigger(_.default.STREAMS_COMPOSED),Nt()}).catch(function(It){throw It})}catch(It){D.error(new i.default(t.default.MANIFEST_ERROR_ID_NOSTREAMS_CODE,It.message+" nostreamscomposed",ae.getValue())),fe=!0,nr()}}function rt(Re){var ze=sr(Re.id);return ze?ze.updateData(Re):(ze=(0,d.default)(W).create({manifestModel:ae,mediaPlayerModel:Ne,dashMetrics:ee,manifestUpdater:J,adapter:K,timelineConverter:F,capabilities:q,capabilitiesFilter:Y,errHandler:D,baseURLController:Z,segmentBaseController:H,textController:B,abrController:te,playbackController:Me,eventController:R,mediaController:z,protectionController:P,videoModel:_e,streamInfo:Re,settings:Fe}),w.push(ze),ze.initialize(),Promise.resolve())}function ut(Re){qe();var ze=ee.getCurrentDVRInfo().range;if(ze.end<ze.start){Ye&&clearTimeout(Ye);var st=Math.min(((ze.end-ze.start)*-1+U)*1e3,2147483647);Q.debug("Waiting for ".concat(st," ms before playback can start")),b.trigger(_.default.AST_IN_FUTURE,{delay:st}),Ye=setTimeout(function(){ut(Re)},st);return}Fe.get().streaming.applyProducerReferenceTime&&Oe.calculateProducerReferenceTimeOffsets(Re);var yt=Re[0].manifestInfo;if(Fe.get().streaming.applyServiceDescription&&Oe.applyServiceDescription(yt),K.getIsDynamic()){var At=Vt(Re,yt);Me.computeAndSetLiveDelay(At,yt)}var It=St(),Ot=we(It),Kt=Ot!==null?Ot:w[0];b.trigger(_.default.INITIAL_STREAM_SWITCH,{startTime:It}),mt(Kt,null,It),Dt()}function mt(Re,ze,st){try{if(re||!Re||ze===Re&&Re.getIsActive())return;re=!0,b.trigger(_.default.PERIOD_SWITCH_STARTED,{fromStreamInfo:ze?ze.getStreamInfo():null,toStreamInfo:Re.getStreamInfo()});var yt=!1;O=Re,ze&&(yt=Ct(Re,ze),ze.deactivate(yt)),st=isNaN(st)?!yt&&ze?Re.getStreamInfo().start:NaN:st,Q.info("Switch to stream ".concat(Re.getId(),". Seektime is ").concat(st,", current playback time is ").concat(Me.getTime(),". Seamless period switch is set to ").concat(yt)),Je=Je.filter(function(At){return At.getId()!==O.getId()}),Me.initialize(Yt(),!!ze),_e.getElement()?ve(st,yt,!1):Le(st,yt)}catch{re=!1}}function ve(Re,ze){var st=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,yt;function At(){if(!(!le||le.readyState!=="open")){Q.debug("MediaSource is open!"),window.URL.revokeObjectURL(yt),le.removeEventListener("sourceopen",At),le.removeEventListener("webkitsourceopen",At),Ue();var Ot=ee.getCurrentDVRInfo();se.setSeekable(Ot.range.start,Ot.range.end),st?O.setMediaSource(le).then(function(){O.initializeForTextWithMediaSource(le)}):Le(Re,ze)}}function It(){le.addEventListener("sourceopen",At,!1),le.addEventListener("webkitsourceopen",At,!1),yt=se.attachMediaSource(_e),Q.debug("MediaSource attached to element.  Waiting on open...")}le?ze?Le(Re,ze):(se.detachMediaSource(_e),It()):(le=se.createMediaSource(),It())}function Le(Re,ze){O.activate(le,ze?Qe:void 0,Re).then(function(st){if(st){var yt=Object.keys(st);yt.length>0&&st[yt[0]].getBuffer().changeType&&(ye=!0),Qe=st}isNaN(Re)||(b.trigger(_.default.SEEK_TARGET,{time:Re},{streamId:O.getId()}),Me.seek(Re,!1,!0),O.startScheduleControllers()),re=!1,b.trigger(_.default.PERIOD_SWITCH_COMPLETED,{toStreamInfo:Yt()})})}function Ge(Re){var ze=Re.seekTime,st=we(ze);!st||st===O?(at(),lt(Re)):st&&st!==O&&(at(st),vt(Re,st)),Jt(T.PlayList.SEEK_START_REASON)}function at(){var Re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;et()}function et(){Je&&Je.length>0&&(Je.forEach(function(Re){Re.deactivate(!0)}),Je=[])}function lt(Re){var ze=O.getProcessors();ze.forEach(function(st){return st.prepareInnerPeriodPlaybackSeeking(Re)}),Gt(T.PlayListTrace.USER_REQUEST_STOP_REASON)}function vt(Re,ze){var st=Re&&!isNaN(Re.seekTime)?Re.seekTime:NaN,yt=O.getProcessors(),At=yt.map(function(It){return It.prepareOuterPeriodPlaybackSeeking(Re)});Promise.all(At).then(function(){mt(ze,O,st)}).catch(function(It){D.error(It)})}function Mt(Re){Re.newMediaInfo.streamInfo.id===O.getId()&&(et(),O.prepareTrackChange(Re))}function Ct(Re,ze){try{return Fe.get().streaming.buffer.reuseExistingSourceBuffers&&(ze.isProtectionCompatible(Re)||Be)&&(ye||ze.isMediaCodecCompatible(Re,ze))}catch{return!1}}function de(Re){var ze=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(le&&!Re.getPreloaded()){var st=Ct(Re,ze);st&&Re.startPreloading(le,Qe).then(function(){Je.push(Re)})}}function we(Re){if(isNaN(Re))return null;for(var ze=w.length,st=0;st<ze;st++){var yt=w[st],At=parseFloat((yt.getStartTime()+yt.getDuration()).toFixed(5));if(Re<At)return yt}return null}function qe(){try{var Re=K.getIsDynamic(),ze=K.getStreamsInfo(),st=ze[0].manifestInfo,yt=Me.getTime(),At=F.calcTimeShiftBufferWindow(w,Re),It=ft();if(typeof At.start>"u"||typeof At.end>"u")return;!It||It.length===0?ee.addDVRInfo(I.default.VIDEO,yt,st,At):It.forEach(function(Ot){ee.addDVRInfo(Ot.getType(),yt,st,At)})}catch{}}function Te(Re){if(me&&ne){var ze=Ne.getInitialBufferLevel(),st=[I.default.TEXT];(isNaN(ze)||ze<=Me.getBufferLevel(st)||K.getIsDynamic()&&ze>Me.getLiveDelay())&&(me=!1,Jt(T.PlayList.INITIAL_PLAYOUT_START_REASON),Me.play())}Re&&Re.mediaType&&ee.addBufferLevel(Re.mediaType,new Date,Re.bufferLevel*1e3)}function Ie(Re){Re.streamInfo.id===O.getId()&&Re.reason&&Re.reason.forceReplace&&et();var ze=sr(Re.streamInfo.id);ze.prepareQualityChange(Re)}function Ke(){if(K.getIsDynamic()&&Me.getOriginalLiveDelay()!==0&&O){var Re=K.getStreamsInfo();if(Re.length>0){var ze=Re[0].manifestInfo,st=Vt(Re,ze);Me.computeAndSetLiveDelay(st,ze)}}}function it(){if(Qt()){var Re=_e.getPlaybackQuality();Re&&ee.addDroppedFrames(Re)}}function pt(){Q.debug("[onPlaybackStarted]"),!me&&Se&&Jt(T.PlayList.RESUME_FROM_PAUSE_START_REASON),me&&(me=!1),Ae&&(Ae=!1,Fe.get().streaming.applyContentSteering&&!oe.shouldQueryBeforeStart()&&oe.loadSteeringData()),Se=!1}function Et(Re){Q.debug("[onPlaybackPaused]"),Re.ended||(Se=!0,Gt(T.PlayListTrace.USER_REQUEST_STOP_REASON))}function gt(Re){Q.debug("Stream with id ".concat(Re.streamInfo.id," finished buffering"));var ze=Re.streamInfo.isLast;le&&ze?(Q.info("[onStreamBufferingCompleted] calls signalEndOfStream of mediaSourceController."),se.signalEndOfStream(le)):Nt()}function Nt(){if(!(!O||!O.getHasFinishedBuffering()))for(var Re=Ee(O),ze=0;ze<Re.length;){var st=Re[ze],yt=ze===0?O:Re[ze-1];!st.getPreloaded()&&yt.getHasFinishedBuffering()&&le&&de(st,yt),ze+=1}}function Dt(){He||(He=setInterval(function(){!re&&Me.getTimeToStreamEnd()<=0&&!Me.isSeeking()&&b.trigger(_.default.PLAYBACK_ENDED,{isLast:Yt().isLast})},L))}function ke(){He&&(clearInterval(He),He=null)}function ct(Re,ze){for(var st=null,yt=0,At=0,It=null,Ot=0;Ot<w.length;Ot++){if(st=w[Ot],At=st.getStartTime(),It=st.getDuration(),Number.isFinite(At)&&(yt=At),st.getId()===ze)return Re-yt;Number.isFinite(It)&&(yt+=It)}return null}function ft(){return O?O.getProcessors():[]}function pe(Re){if(O&&!O.getIsEndedEventSignaled()){O.setIsEndedEventSignaled(!0);var ze=be();ze?(Q.debug("StreamController onEnded, found next stream with id ".concat(ze.getStreamInfo().id,". Switching from ").concat(O.getStreamInfo().id," to ").concat(ze.getStreamInfo().id)),mt(ze,O,NaN)):(Q.debug("StreamController no next stream found"),O.setIsEndedEventSignaled(!1)),Gt(ze?T.PlayListTrace.END_OF_PERIOD_STOP_REASON:T.PlayListTrace.END_OF_CONTENT_STOP_REASON)}Re&&Re.isLast&&(ke(),oe.stopSteeringRequestTimer())}function be(){var Re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,ze=Re||O||null;if(!ze)return null;for(var st=ze.getStreamInfo(),yt=st.start,At=0,It=-1,Ot=NaN;At<w.length;){var Kt=w[At],Bt=Kt.getStreamInfo(),Ht=Bt.start-yt;Ht>0&&(isNaN(Ot)||Ht<Ot)&&st.id!==Bt.id&&(Ot=Ht,It=At),At+=1}return It>=0?w[It]:null}function Ee(){var Re=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;try{var ze=Re||O||null;if(ze){var st=ze.getStreamInfo();return w.filter(function(yt){var At=yt.getStreamInfo();return At.start>st.start&&st.id!==At.id})}}catch{return[]}}function Ue(Re){var ze=Re||Yt().manifestInfo.duration;se.setDuration(ze)}function $e(){return O}function dt(){return me}function _t(){return ne}function St(){var Re,ze=K.getIsDynamic();if(ze){var st=ee.getCurrentDVRInfo(),yt=st&&st.range?st.range.end:0;Re=yt-Me.getOriginalLiveDelay();var At=st?st.range:null;if(At){if(!isNaN(Ze)||Ze.toString().indexOf("posix:")!==-1){Q.info("Start time provided by the app: ".concat(Ze));var It=Rt(!0,Ze);isNaN(It)||(Re=Math.min(Re,It))}else{var Ot=Pt(!0);isNaN(Ot)||(Q.info("Start time from URI parameters: ".concat(Ot)),Re=Math.min(Re,Ot))}var Kt=Fe.get().streaming.timeShiftBuffer.calcFromSegmentTimeline?.1:0;Re=Math.max(Re,At.start+Kt)}}else{var Bt=$t(),Ht=Bt[0].getStreamInfo();if(Re=Ht.start,isNaN(Ze)){var qt=Pt(!1);isNaN(qt)||(Q.info("Start time from URI parameters: ".concat(qt)),Re=Math.max(Re,qt))}else{Q.info("Start time provided by the app: ".concat(Ze));var xt=Rt(!1,Ze);isNaN(xt)||(Re=Math.max(Re,xt))}}return Re}function Pt(Re){var ze=V.getURIFragmentData();if(!ze||!ze.t)return NaN;var st=$t()[0],yt=st.getStreamInfo().start;return ze.t=ze.t.split(",")[0],Ut(Re,ze.t,yt)}function Rt(Re,ze){var st=0;if(!Re){var yt=$t()[0];st=yt.getStreamInfo().start}return Ut(Re,ze,st)}function Ut(Re,ze,st){var yt=K.getRegularPeriods()[0],At=ze.toString(),It=At.indexOf("posix:")!==-1?At.substring(6)==="now"?Date.now()/1e3:parseFloat(At.substring(6)):NaN,Ot=Re&&!isNaN(It)?F.calcPresentationTimeFromWallTime(new Date(It*1e3),yt):parseFloat(At)+st;return Ot}function kt(Re){if(Re.length===0){Q.warn("No periods included in the current manifest. Skipping the filtering of outdated stream objects.");return}w=w.filter(function(ze){var st=Re.filter(function(At){return At.id===ze.getId()}).length>0,yt=st||ze.getId()===O.getId();return yt||(Q.debug("Removing stream ".concat(ze.getId())),ze.reset(!0)),yt})}function Vt(Re,ze){try{var st=NaN;if(ze&&!isNaN(ze.maxFragmentDuration)&&isFinite(ze.maxFragmentDuration))return ze.maxFragmentDuration;if(Re&&Re.length===1){var yt=Re[0],At=[I.default.VIDEO,I.default.AUDIO,I.default.TEXT],It=At.reduce(function(Ot,Kt){var Bt=K.getMediaInfoForType(yt,Kt);return Bt&&Bt.isFragmented!==!1&&Ot.push(Bt),Ot},[]).reduce(function(Ot,Kt){var Bt=K.getVoRepresentations(Kt);return Bt&&Bt.length>0&&Bt.forEach(function(Ht){Ht&&Ot.push(Ht)}),Ot},[]).reduce(function(Ot,Kt){var Bt=K.convertRepresentationToRepresentationInfo(Kt);return Bt&&Bt.fragmentDuration&&!isNaN(Bt.fragmentDuration)&&Ot.push(Bt.fragmentDuration),Ot},[]);st=Math.max.apply(Math,h(It))}return isFinite(st)?st:NaN}catch{return NaN}}function jt(Re){if(Re.error)fe=!0,nr();else{Q.info("Manifest updated... updating data system wide.");var ze=Re.manifest;K.updatePeriods(ze);var st=K.getUTCTimingSources();K.getIsDynamic()&&(!st||st.length===0)&&b.trigger(C.default.CONFORMANCE_VIOLATION,{level:n.default.LEVELS.WARNING,event:n.default.EVENTS.NO_UTC_TIMING_ELEMENT});var yt=K.getIsDynamic()?st.concat(xe.getUTCTimingSources()):st;Y.filterUnsupportedFeatures(ze).then(function(){Z.initialize(ze),ue.attemptSync(yt,K.getIsDynamic())})}}function Qt(){return O?O.getHasVideoTrack():!1}function rr(){return O?O.getHasAudioTrack():!1}function or(Re){O&&(Me.initialize(Yt()),ve(Re,!1,!0))}function Gt(Re,ze){ze=ze||new Date,ft().forEach(function(st){st.finalisePlayList(ze,Re)}),ee.addPlayList()}function Jt(Re){ee.createPlaylistMetrics(Me.getTime()*1e3,Re)}function Zt(Re){if(Re.error){var ze="";switch(Re.error.code){case 1:ze="MEDIA_ERR_ABORTED";break;case 2:ze="MEDIA_ERR_NETWORK";break;case 3:ze="MEDIA_ERR_DECODE",tt.counts.mediaErrorDecode+=1;break;case 4:ze="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:ze="MEDIA_ERR_ENCRYPTED";break;default:ze="UNKNOWN";break}if(ze==="MEDIA_ERR_DECODE"&&Fe.get().errors.recoverAttempts.mediaErrorDecode>=tt.counts.mediaErrorDecode){ur();return}G=!0,Re.error.message&&(ze+=" ("+Re.error.message+")"),Re.error.msExtendedCode&&(ze+=" (0x"+(Re.error.msExtendedCode>>>0).toString(16).toUpperCase()+")"),Q.fatal("Video Element Error: "+ze),Re.error&&Q.fatal(Re.error),D.error(new i.default(Re.error.code,ze)),nr()}}function ur(){Q.warn("A MEDIA_ERR_DECODE occured: Resetting the MediaSource");var Re=Me.getTime();O.deactivate(!1),Q.warn("MediaSource has been resetted. Resuming playback from time ".concat(Re)),ve(Re,!1,!1)}function Yt(){return O?O.getStreamInfo():null}function Er(){return re}function _r(){return G||fe}function sr(Re){for(var ze=0,st=w.length;ze<st;ze++)if(w[ze].getId()===Re)return w[ze];return null}function fr(Re){isNaN(Re.newDuration)||Ue(Re.newDuration)}function mr(Re){Re&&(Re.capabilities&&(q=Re.capabilities),Re.capabilitiesFilter&&(Y=Re.capabilitiesFilter),Re.manifestLoader&&($=Re.manifestLoader),Re.manifestModel&&(ae=Re.manifestModel),Re.mediaPlayerModel&&(Ne=Re.mediaPlayerModel),Re.customParametersModel&&(xe=Re.customParametersModel),Re.protectionController&&(P=Re.protectionController),Re.adapter&&(K=Re.adapter),Re.dashMetrics&&(ee=Re.dashMetrics),Re.errHandler&&(D=Re.errHandler),Re.timelineConverter&&(F=Re.timelineConverter),Re.videoModel&&(_e=Re.videoModel),Re.playbackController&&(Me=Re.playbackController),Re.serviceDescriptionController&&(Oe=Re.serviceDescriptionController),Re.contentSteeringController&&(oe=Re.contentSteeringController),Re.textController&&(B=Re.textController),Re.abrController&&(te=Re.abrController),Re.mediaController&&(z=Re.mediaController),Re.settings&&(Fe=Re.settings),Re.baseURLController&&(Z=Re.baseURLController),Re.uriFragmentModel&&(V=Re.uriFragmentModel),Re.segmentBaseController&&(H=Re.segmentBaseController))}function hr(Re){x=Re,P&&P.setProtectionData(x)}function cr(){w=[],Ze=NaN,P=null,re=!1,O=null,G=!1,fe=!1,me=!0,Ae=!0,Se=!1,ne=!0,He=null,Be=!1,ye=!1,Je=[],Ye=null,tt={counts:{mediaErrorDecode:0}}}function nr(){ie(),ue.reset(),Gt(G||fe?T.PlayListTrace.FAILURE_STOP_REASON:T.PlayListTrace.USER_REQUEST_STOP_REASON);for(var Re=0,ze=w?w.length:0;Re<ze;Re++){var st=w[Re];st.reset(G)}ge(),Z.reset(),J.reset(),R.reset(),ee.clearAllCurrentMetrics(),ae.setValue(null),$.reset(),F.reset(),u.reset(),le&&(se.detachMediaSource(_e),le=null),_e=null,P&&(P=null,x=null,ae.getValue()&&b.trigger(_.default.PROTECTION_DESTROYED,{data:ae.getValue().url})),ke(),b.trigger(_.default.STREAM_TEARDOWN_COMPLETE),cr()}function dr(Re){if(Re.metric===g.default.DVR_INFO){var ze=rr()?I.default.AUDIO:I.default.VIDEO;Re.mediaType===ze&&se.setSeekable(Re.value.range.start,Re.value.range.end)}}function $t(){return w}return j={initialize:ht,getActiveStreamInfo:Yt,addDVRMetric:qe,hasVideoTrack:Qt,hasAudioTrack:rr,getStreamById:sr,getStreamForTime:we,getTimeRelativeToStreamId:ct,load:De,loadWithManifest:Ce,getActiveStreamProcessors:ft,setConfig:mr,setProtectionData:hr,getIsStreamSwitchInProgress:Er,switchToVideoElement:or,getHasMediaOrInitialisationError:_r,getStreams:$t,getActiveStream:$e,getInitialPlayback:dt,getAutoPlay:_t,reset:nr},nt(),j}k.__dashjs_factory_name="StreamController";const X=r.default.getSingletonFactory(k)},"./src/streaming/controllers/TimeSyncController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>c});var I=e("./src/streaming/vo/DashJSError.js"),g=e("./src/streaming/vo/metrics/HTTPRequest.js"),d=e("./src/core/EventBus.js"),f=e("./src/core/events/Events.js"),y=e("./src/core/errors/Errors.js"),_=e("./src/core/FactoryMaker.js"),r=e("./src/core/Debug.js"),T=e("./src/streaming/utils/URLUtils.js"),M=5e3,p=100,C=2,v=2,E=30,i=30,t=600,m=2;function n(){var o=this.context,l=(0,d.default)(o).getInstance(),A=(0,T.default)(o).getInstance(),S,L,U,k,X,W,b,j,Q,q,Y,J,$,ae,K,ee;function se(){L=(0,r.default)(o).getInstance().getLogger(S),l.on(f.default.ATTEMPT_BACKGROUND_SYNC,V,S)}function ue(Ne){Ne&&(Ne.dashMetrics&&(b=Ne.dashMetrics),Ne.baseURLController&&(ee=Ne.baseURLController),Ne.errHandler&&(K=Ne.errHandler),Ne.settings&&(X=Ne.settings))}function oe(){j=[],Q=[],q=null,Y=null,$=null,J=NaN,U=!1,k=!1,ae=X.get().streaming.utcSynchronization.timeBetweenSyncAttempts}function Z(){oe(),W={"urn:mpeg:dash:utc:http-head:2014":re,"urn:mpeg:dash:utc:http-xsdate:2014":ne.bind(null,w),"urn:mpeg:dash:utc:http-iso:2014":ne.bind(null,O),"urn:mpeg:dash:utc:direct:2014":x,"urn:mpeg:dash:utc:http-head:2012":re,"urn:mpeg:dash:utc:http-xsdate:2012":ne.bind(null,w),"urn:mpeg:dash:utc:http-iso:2012":ne.bind(null,O),"urn:mpeg:dash:utc:direct:2012":x,"urn:mpeg:dash:utc:http-ntp:2014":B,"urn:mpeg:dash:utc:ntp:2014":B,"urn:mpeg:dash:utc:sntp:2014":B}}function H(Ne,xe){if(Q=Ne,!U){if(!u(xe)){l.trigger(f.default.TIME_SYNCHRONIZATION_COMPLETED);return}U=!0,z()}}function V(){if(!(!X.get().streaming.utcSynchronization.enabled||U||k||!$||!$.value||!$.schemeIdUri||isNaN(J)||isNaN(X.get().streaming.utcSynchronization.backgroundAttempts))&&!(Y&&(Date.now()-Y)/1e3<i)){j=[],k=!0;var Ne=isNaN(X.get().streaming.utcSynchronization.backgroundAttempts)?v:X.get().streaming.utcSynchronization.backgroundAttempts;te(Ne)}}function te(Ne){try{if(Ne<=0){_e();return}var xe=Date.now();W[$.schemeIdUri]($.value,function(Se){var me=Date.now(),Ae=R(xe,me,Se);j.push(Ae),te(Ne-1)},function(){_e()})}catch{_e()}}function z(){var Ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,xe=Ne||0;if(!Q||Q.length===0||xe>=Q.length){D();return}var Se=Q[xe];if(Se)if(W.hasOwnProperty(Se.schemeIdUri)){var me=new Date().getTime();W[Se.schemeIdUri](Se.value,function(Ae){var He=new Date().getTime(),Qe=R(me,He,Ae);$=Se,D(Qe)},function(){z(xe+1)})}else z(xe+1);else D()}function R(Ne,xe,Se){var me=xe-(xe-Ne)/2;return Se-me}function u(Ne){try{if(!Ne||!X.get().streaming.utcSynchronization.enabled)return!1;var xe=isNaN(ae)?E:ae;return!q||!xe||isNaN(xe)?!0:(Date.now()-q)/1e3>=xe}catch{return!0}}function D(){var Ne=arguments.length>0&&arguments[0]!==void 0?arguments[0]:NaN,xe=isNaN(Ne);xe&&X.get().streaming.utcSynchronization.useManifestDateHeaderTimeSource?G():fe(xe,Ne)}function F(Ne){var xe=60,Se=60,me=1e3,Ae=/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2})(?::([0-9]*)(\.[0-9]*)?)?(?:([+\-])([0-9]{2})([0-9]{2}))?/,He,Qe,Je=Ae.exec(Ne);return He=Date.UTC(parseInt(Je[1],10),parseInt(Je[2],10)-1,parseInt(Je[3],10),parseInt(Je[4],10),parseInt(Je[5],10),Je[6]&&(parseInt(Je[6],10)||0),Je[7]&&parseFloat(Je[7])*me||0),Je[9]&&Je[10]&&(Qe=parseInt(Je[9],10)*Se+parseInt(Je[10],10),He+=(Je[8]==="+"?-1:1)*Qe*xe*me),new Date(He).getTime()}function w(Ne){var xe=Date.parse(Ne);return isNaN(xe)&&(xe=F(Ne)),xe}function O(Ne){return Date.parse(Ne)}function P(Ne){return Date.parse(Ne)}function B(Ne,xe,Se){Se()}function x(Ne,xe,Se){var me=w(Ne);if(!isNaN(me)){xe(me);return}Se()}function ne(Ne,xe,Se,me,Ae){var He,Qe,Je=!1,ye=new XMLHttpRequest,Fe=Ae?g.HTTPRequest.HEAD:g.HTTPRequest.GET,Be=xe.match(/\S+/g);if(xe=Be.shift(),He=function(){Je||(Je=!0,Be.length?ne(Ne,Be.join(" "),Se,me,Ae):me())},Qe=function(){var tt,nt;ye.status===200&&(tt=Ae?ye.getResponseHeader("Date"):ye.response,nt=Ne(tt),isNaN(nt)||(Se(nt),Je=!0))},A.isRelative(xe)){var Ye=ee.resolve();Ye&&(xe=A.resolve(xe,Ye.url))}ye.open(Fe,xe),ye.timeout=M,ye.onload=Qe,ye.onloadend=He,ye.send()}function re(Ne,xe,Se){ne(P,Ne,xe,Se,!0)}function G(){var Ne=b.getLatestMPDRequestHeaderValueByID("Date"),xe=Ne!==null?new Date(Ne).getTime():Number.NaN;if(isNaN(xe))fe(!0);else{var Se=xe-Date.now();fe(!1,Se)}}function fe(Ne,xe){if(!isNaN(J)&&!isNaN(xe)&&!Ne&&le(xe),!Ne&&!isNaN(xe)){q=Date.now(),U=!1;var Se=isNaN(J);J=xe,Se&&V(),L.debug("Completed UTC sync. Setting client - server offset to ".concat(xe))}Ne&&($=null,U=!1,K.error(new I.default(y.default.TIME_SYNC_FAILED_ERROR_CODE,y.default.TIME_SYNC_FAILED_ERROR_MESSAGE))),l.trigger(f.default.UPDATE_TIME_SYNC_OFFSET,{offset:xe}),l.trigger(f.default.TIME_SYNCHRONIZATION_COMPLETED)}function le(Ne){try{var xe=Me(Ne),Se=isNaN(ae)?E:ae,me=isNaN(X.get().streaming.utcSynchronization.timeBetweenSyncAttemptsAdjustmentFactor)?C:X.get().streaming.utcSynchronization.timeBetweenSyncAttemptsAdjustmentFactor,Ae=isNaN(X.get().streaming.utcSynchronization.maximumTimeBetweenSyncAttempts)?t:X.get().streaming.utcSynchronization.maximumTimeBetweenSyncAttempts,He=isNaN(X.get().streaming.utcSynchronization.minimumTimeBetweenSyncAttempts)?m:X.get().streaming.utcSynchronization.minimumTimeBetweenSyncAttempts,Qe;xe?(Qe=Math.min(Se*me,Ae),L.debug("Increasing timeBetweenSyncAttempts to ".concat(Qe))):(Qe=Math.max(Se/me,He),L.debug("Decreasing timeBetweenSyncAttempts to ".concat(Qe))),ae=Qe}catch{}}function _e(){if(!(!j||j.length===0)){var Ne=j.reduce(function(xe,Se){return xe+Se},0)/j.length;Me(Ne)?L.debug("Completed background UTC sync. Offset is within allowed threshold and is not adjusted."):(L.debug("Completed background UTC sync. Setting client - server offset to ".concat(Ne)),J=Ne,l.trigger(f.default.UPDATE_TIME_SYNC_OFFSET,{offset:J})),k=!1,Y=Date.now()}}function Me(Ne){try{if(isNaN(J))return!0;var xe=X.get().streaming.utcSynchronization.maximumAllowedDrift&&!isNaN(X.get().streaming.utcSynchronization.maximumAllowedDrift)?X.get().streaming.utcSynchronization.maximumAllowedDrift:p,Se=J-xe,me=J+xe;return Ne>=Se&&Ne<=me}catch{return!0}}function Oe(){oe(),l.off(f.default.ATTEMPT_BACKGROUND_SYNC,V,S)}return S={initialize:Z,attemptSync:H,setConfig:ue,reset:Oe},se(),S}n.__dashjs_factory_name="TimeSyncController";var h=_.default.getSingletonFactory(n);h.HTTP_TIMEOUT_MS=M,_.default.updateSingletonFactory(n.__dashjs_factory_name,h);const c=h},"./src/streaming/controllers/XlinkController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>v});var I=e("./src/streaming/XlinkLoader.js"),g=e("./src/core/EventBus.js"),d=e("./src/core/events/Events.js"),f=e("./src/core/FactoryMaker.js"),y=e("./externals/xml2json.js"),_=e("./src/streaming/utils/URLUtils.js"),r=e("./src/dash/constants/DashConstants.js"),T="onLoad",M="onActuate",p="urn:mpeg:dash:resolve-to-zero:2013";function C(E){E=E||{};var i=this.context,t=(0,g.default)(i).getInstance(),m=(0,_.default)(i).getInstance(),n,h,c,o,l,A;function S(){t.on(d.default.XLINK_ELEMENT_LOADED,b,n),A=(0,I.default)(i).create({errHandler:E.errHandler,dashMetrics:E.dashMetrics,mediaPlayerModel:E.mediaPlayerModel,requestModifier:E.requestModifier,settings:E.settings})}function L(ae){ae&&(h=ae)}function U(ae){ae&&(c=ae)}function k(ae){var K;l=new y.default({escapeMode:!1,attributePrefix:"",arrayAccessForm:"property",emptyNodeForm:"object",stripWhitespaces:!1,enableToStringFunc:!1,ignoreRoot:!0,matchers:h}),o=ae,o.Period_asArray?(K=Q(o.Period_asArray,o,r.default.PERIOD,T),W(K,r.default.PERIOD,T)):t.trigger(d.default.XLINK_READY,{manifest:o})}function X(){t.off(d.default.XLINK_ELEMENT_LOADED,b,n),A&&(A.reset(),A=null)}function W(ae,K,ee){var se={},ue,oe;se.elements=ae,se.type=K,se.resolveType=ee,se.elements.length===0&&j(se);for(var Z=0;Z<se.elements.length;Z++)ue=se.elements[Z],m.isHTTPURL(ue.url)?oe=ue.url:oe=ue.originalContent.BaseURL+ue.url,A.load(oe,ue,se)}function b(ae){var K,ee,se="<response>",ue="</response>",oe="";if(K=ae.element,ee=ae.resolveObject,K.resolvedContent){var Z=0;K.resolvedContent.indexOf("<?xml")===0&&(Z=K.resolvedContent.indexOf("?>")+2),oe=K.resolvedContent.substr(0,Z)+se+K.resolvedContent.substr(Z)+ue,K.resolvedContent=l.xml_str2json(oe)}J(ee)&&j(ee)}function j(ae){var K=[],ee,se;if(q(ae),ae.resolveType===M&&t.trigger(d.default.XLINK_READY,{manifest:o}),ae.resolveType===T)switch(ae.type){case r.default.PERIOD:for(ee=0;ee<o[r.default.PERIOD+"_asArray"].length;ee++)se=o[r.default.PERIOD+"_asArray"][ee],se.hasOwnProperty(r.default.ADAPTATION_SET+"_asArray")&&(K=K.concat(Q(se[r.default.ADAPTATION_SET+"_asArray"],se,r.default.ADAPTATION_SET,T))),se.hasOwnProperty(r.default.EVENT_STREAM+"_asArray")&&(K=K.concat(Q(se[r.default.EVENT_STREAM+"_asArray"],se,r.default.EVENT_STREAM,T)));W(K,r.default.ADAPTATION_SET,T);break;case r.default.ADAPTATION_SET:t.trigger(d.default.XLINK_READY,{manifest:o});break}}function Q(ae,K,ee,se){var ue=[],oe,Z,H;for(Z=ae.length-1;Z>=0;Z--)oe=ae[Z],oe.hasOwnProperty("xlink:href")&&oe["xlink:href"]===p&&ae.splice(Z,1);for(Z=0;Z<ae.length;Z++)oe=ae[Z],oe.hasOwnProperty("xlink:href")&&oe.hasOwnProperty("xlink:actuate")&&oe["xlink:actuate"]===se&&(H=Y(oe["xlink:href"],K,ee,Z,se,oe),ue.push(H));return ue}function q(ae){var K=[],ee,se,ue,oe,Z,H;for(oe=ae.elements.length-1;oe>=0;oe--){if(ee=ae.elements[oe],se=ee.type+"_asArray",!ee.resolvedContent||$())delete ee.originalContent["xlink:actuate"],delete ee.originalContent["xlink:href"],K.push(ee.originalContent);else if(ee.resolvedContent)for(Z=0;Z<ee.resolvedContent[se].length;Z++)ue=ee.resolvedContent[se][Z],K.push(ue);for(ee.parentElement[se].splice(ee.index,1),H=0;H<K.length;H++)ee.parentElement[se].splice(ee.index+H,0,K[H]);K=[]}ae.elements.length>0&&c.run(o)}function Y(ae,K,ee,se,ue,oe){return{url:ae,parentElement:K,type:ee,index:se,resolveType:ue,originalContent:oe,resolvedContent:null,resolved:!1}}function J(ae){var K,ee;for(K=0;K<ae.elements.length;K++)if(ee=ae.elements[K],ee.resolved===!1)return!1;return!0}function $(){return!1}return n={resolveManifestOnLoad:k,setMatchers:L,setIron:U,reset:X},S(),n}C.__dashjs_factory_name="XlinkController";const v=f.default.getClassFactory(C)},"./src/streaming/metrics/MetricsReporting.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>T});var I=e("./src/streaming/metrics/utils/DVBErrorsTranslator.js"),g=e("./src/streaming/metrics/MetricsReportingEvents.js"),d=e("./src/streaming/metrics/controllers/MetricsCollectionController.js"),f=e("./src/streaming/metrics/metrics/MetricsHandlerFactory.js"),y=e("./src/streaming/metrics/reporting/ReportingFactory.js");function _(){var M=this.context,p,C;function v(t){return C=(0,I.default)(M).getInstance({eventBus:t.eventBus,dashMetrics:t.dashMetrics,metricsConstants:t.metricsConstants,events:t.events}),C.initialise(),(0,d.default)(M).create(t)}function E(){return(0,y.default)(M).getInstance()}function i(){return(0,f.default)(M).getInstance()}return p={createMetricsReporting:v,getReportingFactory:E,getMetricsHandlerFactory:i},p}_.__dashjs_factory_name="MetricsReporting";var r=dashjs.FactoryMaker.getClassFactory(_);r.events=g.default,dashjs.FactoryMaker.updateClassFactory(_.__dashjs_factory_name,r);const T=r},"./src/streaming/metrics/MetricsReportingEvents.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>E});var I=e("./src/core/events/EventsBase.js");function g(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(m){return typeof m}:g=function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},g(i)}function d(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function f(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),t&&y(i,t)}function y(i,t){return y=Object.setPrototypeOf||function(n,h){return n.__proto__=h,n},y(i,t)}function _(i){var t=M();return function(){var n=p(i),h;if(t){var c=p(this).constructor;h=Reflect.construct(n,arguments,c)}else h=n.apply(this,arguments);return r(this,h)}}function r(i,t){return t&&(g(t)==="object"||typeof t=="function")?t:T(i)}function T(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function M(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function p(i){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)},p(i)}var C=function(i){f(m,i);var t=_(m);function m(){var n;return d(this,m),n=t.call(this),n.METRICS_INITIALISATION_COMPLETE="internal_metricsReportingInitialized",n.BECAME_REPORTING_PLAYER="internal_becameReportingPlayer",n.CMCD_DATA_GENERATED="cmcdDataGenerated",n}return m}(I.default),v=new C;const E=v},"./src/streaming/metrics/controllers/MetricsCollectionController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});var I=e("./src/streaming/metrics/controllers/MetricsController.js"),g=e("./src/streaming/metrics/utils/ManifestParsing.js"),d=e("./src/streaming/metrics/MetricsReportingEvents.js");function f(_){_=_||{};var r,T={},M=this.context,p=_.eventBus,C=_.events;function v(m){if(!m.error){var n=Object.keys(T),h=(0,g.default)(M).getInstance({adapter:_.adapter,constants:_.constants}).getMetrics(m.manifest);h.forEach(function(c){var o=JSON.stringify(c);if(T.hasOwnProperty(o))n.splice(o,1);else try{var l=(0,I.default)(M).create(_);l.initialize(c),T[o]=l}catch{}}),n.forEach(function(c){T[c].reset(),delete T[c]}),p.trigger(d.default.METRICS_INITIALISATION_COMPLETE)}}function E(){Object.keys(T).forEach(function(m){T[m].reset()}),T={}}function i(){p.on(C.MANIFEST_UPDATED,v,r),p.on(C.STREAM_TEARDOWN_COMPLETE,E,r)}function t(){p.off(C.MANIFEST_UPDATED,v,r),p.off(C.STREAM_TEARDOWN_COMPLETE,E,r)}return r={reset:t},i(),r}f.__dashjs_factory_name="MetricsCollectionController";const y=dashjs.FactoryMaker.getClassFactory(f)},"./src/streaming/metrics/controllers/MetricsController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});var I=e("./src/streaming/metrics/controllers/RangeController.js"),g=e("./src/streaming/metrics/controllers/ReportingController.js"),d=e("./src/streaming/metrics/controllers/MetricsHandlersController.js");function f(_){_=_||{};var r,T,M,p,C=this.context;function v(i){try{M=(0,I.default)(C).create({mediaElement:_.mediaElement}),M.initialize(i.Range),T=(0,g.default)(C).create({debug:_.debug,metricsConstants:_.metricsConstants,mediaPlayerModel:_.mediaPlayerModel}),T.initialize(i.Reporting,M),r=(0,d.default)(C).create({debug:_.debug,eventBus:_.eventBus,metricsConstants:_.metricsConstants,events:_.events}),r.initialize(i.metrics,T)}catch(t){throw E(),t}}function E(){r&&r.reset(),T&&T.reset(),M&&M.reset()}return p={initialize:v,reset:E},p}f.__dashjs_factory_name="MetricsController";const y=dashjs.FactoryMaker.getClassFactory(f)},"./src/streaming/metrics/controllers/MetricsHandlersController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});var I=e("./src/streaming/metrics/metrics/MetricsHandlerFactory.js");function g(f){f=f||{};var y=[],_,r=this.context,T=f.eventBus,M=f.events,p=(0,I.default)(r).getInstance({debug:f.debug,eventBus:f.eventBus,metricsConstants:f.metricsConstants});function C(i){y.forEach(function(t){t.handleNewMetric(i.metric,i.value,i.mediaType)})}function v(i,t){i.split(",").forEach(function(m,n,h){var c;if(m.indexOf("(")!==-1&&m.indexOf(")")===-1){var o=h[n+1];o&&o.indexOf("(")===-1&&o.indexOf(")")!==-1&&(m+=","+o,delete h[n+1])}c=p.create(m,t),c&&y.push(c)}),T.on(M.METRIC_ADDED,C,_),T.on(M.METRIC_UPDATED,C,_)}function E(){T.off(M.METRIC_ADDED,C,_),T.off(M.METRIC_UPDATED,C,_),y.forEach(function(i){return i.reset()}),y=[]}return _={initialize:v,reset:E},_}g.__dashjs_factory_name="MetricsHandlersController";const d=dashjs.FactoryMaker.getClassFactory(g)},"./src/streaming/metrics/controllers/RangeController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});var I=e("./src/streaming/utils/CustomTimeRanges.js");function g(f){f=f||{};var y=!1,_=this.context,r,T,M=f.mediaElement;function p(i){i&&i.length&&(i.forEach(function(t){var m=t.starttime,n=m+t.duration;T.add(m,n)}),y=!!i[0]._useWallClockTime)}function C(){T.clear()}function v(){T=(0,I.default)(_).create()}function E(){var i=T.length,t;if(!i)return!0;t=y?new Date().getTime()/1e3:M.currentTime;for(var m=0;m<i;m+=1){var n=T.start(m),h=T.end(m);if(n<=t&&t<h)return!0}return!1}return r={initialize:p,reset:C,isEnabled:E},v(),r}g.__dashjs_factory_name="RangeController";const d=dashjs.FactoryMaker.getClassFactory(g)},"./src/streaming/metrics/controllers/ReportingController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});var I=e("./src/streaming/metrics/reporting/ReportingFactory.js");function g(f){var y=[],_,r=(0,I.default)(this.context).getInstance(f);function T(C,v){C.some(function(E){var i=r.create(E,v);if(i)return y.push(i),!0})}function M(){y.forEach(function(C){return C.reset()}),y=[]}function p(C,v){y.forEach(function(E){return E.report(C,v)})}return _={initialize:T,reset:M,report:p},_}g.__dashjs_factory_name="ReportingController";const d=dashjs.FactoryMaker.getClassFactory(g)},"./src/streaming/metrics/metrics/MetricsHandlerFactory.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>_});var I=e("./src/streaming/metrics/metrics/handlers/BufferLevelHandler.js"),g=e("./src/streaming/metrics/metrics/handlers/DVBErrorsHandler.js"),d=e("./src/streaming/metrics/metrics/handlers/HttpListHandler.js"),f=e("./src/streaming/metrics/metrics/handlers/GenericMetricHandler.js");function y(r){r=r||{};var T,M=r.debug?r.debug.getLogger(T):{},p=/([a-zA-Z]*)(\(([0-9]*)(\,\s*([a-zA-Z]*))?\))?/,C=this.context,v={BufferLevel:I.default,DVBErrors:g.default,HttpList:d.default,PlayList:f.default,RepSwitchList:f.default,TcpList:f.default};function E(m,n){var h=m.match(p),c;if(h){try{c=v[h[1]](C).create({eventBus:r.eventBus,metricsConstants:r.metricsConstants}),c.initialize(h[1],n,h[3],h[5])}catch(o){c=null,M.error("MetricsHandlerFactory: Could not create handler for type ".concat(h[1]," with args ").concat(h[3],", ").concat(h[5]," (").concat(o.message,")"))}return c}}function i(m,n){v[m]=n}function t(m){delete v[m]}return T={create:E,register:i,unregister:t},T}y.__dashjs_factory_name="MetricsHandlerFactory";const _=dashjs.FactoryMaker.getSingletonFactory(y)},"./src/streaming/metrics/metrics/handlers/BufferLevelHandler.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});var I=e("./src/streaming/metrics/utils/HandlerHelpers.js");function g(f){f=f||{};var y,_,r,T,M,p,C=this.context,v=(0,I.default)(C).getInstance(),E=[],i=f.metricsConstants;function t(){try{return Object.keys(E).map(function(o){return E[o]}).reduce(function(o,l){return o.level<l.level?o:l})}catch{return}}function m(){var o=t();o&&p!==o.t&&(p=o.t,_.report(T,o))}function n(o,l,A){l&&(r=v.validateN(A),_=l,T=v.reconstructFullMetricName(o,A),M=setInterval(m,r))}function h(){clearInterval(M),M=null,r=0,_=null,p=null}function c(o,l,A){o===i.BUFFER_LEVEL&&(E[A]=l)}return y={initialize:n,reset:h,handleNewMetric:c},y}g.__dashjs_factory_name="BufferLevelHandler";const d=dashjs.FactoryMaker.getClassFactory(g)},"./src/streaming/metrics/metrics/handlers/DVBErrorsHandler.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});var I=e("./src/streaming/metrics/MetricsReportingEvents.js");function g(f){f=f||{};var y,_,r=f.eventBus,T=f.metricsConstants;function M(){r.off(I.default.METRICS_INITIALISATION_COMPLETE,M,this),r.trigger(I.default.BECAME_REPORTING_PLAYER)}function p(E,i){i&&(_=i,r.on(I.default.METRICS_INITIALISATION_COMPLETE,M,this))}function C(){_=null}function v(E,i){E===T.DVB_ERRORS&&_&&_.report(E,i)}return y={initialize:p,reset:C,handleNewMetric:v},y}const d=dashjs.FactoryMaker.getClassFactory(g)},"./src/streaming/metrics/metrics/handlers/GenericMetricHandler.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>g});function I(){var d,f,y;function _(M,p){f=M,y=p}function r(){y=null,f=void 0}function T(M,p){M===f&&y&&y.report(f,p)}return d={initialize:_,reset:r,handleNewMetric:T},d}I.__dashjs_factory_name="GenericMetricHandler";const g=dashjs.FactoryMaker.getClassFactory(I)},"./src/streaming/metrics/metrics/handlers/HttpListHandler.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});var I=e("./src/streaming/metrics/utils/HandlerHelpers.js");function g(f){f=f||{};var y,_,r,T,M,p,C=[],v=(0,I.default)(this.context).getInstance(),E=f.metricsConstants;function i(){var h=C;h.length&&_&&_.report(M,h),C=[]}function t(h,c,o,l){c&&(r=v.validateN(o),_=c,l&&l.length&&(T=l),M=v.reconstructFullMetricName(h,o,l),p=setInterval(i,r))}function m(){clearInterval(p),p=null,r=null,T=null,C=[],_=null}function n(h,c){h===E.HTTP_REQUEST&&(!T||T===c.type)&&C.push(c)}return y={initialize:t,reset:m,handleNewMetric:n},y}g.__dashjs_factory_name="HttpListHandler";const d=dashjs.FactoryMaker.getClassFactory(g)},"./src/streaming/metrics/reporting/ReportingFactory.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});var I=e("./src/streaming/metrics/reporting/reporters/DVBReporting.js");function g(f){f=f||{};var y={"urn:dvb:dash:reporting:2014":I.default},_=this.context,r,T=f.debug?f.debug.getLogger(r):{},M=f.metricsConstants,p=f.mediaPlayerModel||{};function C(i,t){var m;try{m=y[i.schemeIdUri](_).create({metricsConstants:M,mediaPlayerModel:p}),m.initialize(i,t)}catch(n){m=null,T.error("ReportingFactory: could not create Reporting with schemeIdUri ".concat(i.schemeIdUri," (").concat(n.message,")"))}return m}function v(i,t){y[i]=t}function E(i){delete y[i]}return r={create:C,register:v,unregister:E},r}g.__dashjs_factory_name="ReportingFactory";const d=dashjs.FactoryMaker.getSingletonFactory(g)},"./src/streaming/metrics/reporting/reporters/DVBReporting.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});var I=e("./src/streaming/metrics/utils/MetricSerialiser.js"),g=e("./src/streaming/metrics/utils/RNG.js"),d=e("./src/streaming/models/CustomParametersModel.js");function f(_){_=_||{};var r,T=this.context,M,p,C,v,E,i,t,m=[],n=_.metricsConstants;function h(){M=(0,I.default)(T).getInstance(),C=(0,g.default)(T).getInstance(),p=(0,d.default)(T).getInstance(),A()}function c(L,U,k){var X=new XMLHttpRequest;X.withCredentials=p.getXHRWithCredentialsForType(n.HTTP_REQUEST_DVB_REPORTING_TYPE);var W=function(){var j=m.indexOf(X);j!==-1&&(m.splice(j,1),X.status>=200&&X.status<300?U&&U():k&&k())};m.push(X);try{X.open("GET",L),X.onloadend=W,X.onerror=W,X.send()}catch{X.onerror()}}function o(L,U){Array.isArray(U)||(U=[U]),E&&t.isEnabled()&&U.forEach(function(k){var X=M.serialise(k);L!==n.DVB_ERRORS&&(X="metricname=".concat(L,"&").concat(X)),X="".concat(i,"?").concat(X),c(X,null,function(){E=!1})})}function l(L,U){var k;if(t=U,i=L.dvb_reportingUrl,!i)throw new Error("required parameter missing (dvb:reportingUrl)");v||(k=L.dvb_probability,k&&(k===1e3||k/1e3>=C.random())&&(E=!0),v=!0)}function A(){v=!1,E=!1,i=null,t=null}function S(){A()}return r={report:o,initialize:l,reset:S},h(),r}f.__dashjs_factory_name="DVBReporting";const y=dashjs.FactoryMaker.getClassFactory(f)},"./src/streaming/metrics/utils/DVBErrorsTranslator.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>f});var I=e("./src/streaming/metrics/vo/DVBErrors.js"),g=e("./src/streaming/metrics/MetricsReportingEvents.js");function d(y){y=y||{};var _,r,T=y.eventBus,M=y.dashMetrics,p=y.metricsConstants,C=y.events;function v(l){var A=new I.default;if(r){for(var S in l)l.hasOwnProperty(S)&&(A[S]=l[S]);A.mpdurl||(A.mpdurl=r.originalUrl||r.url),A.terror||(A.terror=new Date),M.addDVBErrors(A)}}function E(l){l.error||(r=l.manifest)}function i(l){v({errorcode:I.default.BASE_URL_CHANGED,servicelocation:l.entry})}function t(){v({errorcode:I.default.BECAME_REPORTER})}function m(l){(l.responsecode===0||l.responsecode==null||l.responsecode>=400||l.responsecode<100||l.responsecode>=600)&&v({errorcode:l.responsecode||I.default.CONNECTION_ERROR,url:l.url,terror:l.tresponse,servicelocation:l._serviceLocation})}function n(l){switch(l.metric){case p.HTTP_REQUEST:m(l.value);break}}function h(l){var A=l.error?l.error.code:0,S;switch(A){case MediaError.MEDIA_ERR_NETWORK:S=I.default.CONNECTION_ERROR;break;case MediaError.MEDIA_ERR_DECODE:S=I.default.CORRUPT_MEDIA_OTHER;break;default:return}v({errorcode:S})}function c(){T.on(C.MANIFEST_UPDATED,E,_),T.on(C.SERVICE_LOCATION_BLACKLIST_CHANGED,i,_),T.on(C.METRIC_ADDED,n,_),T.on(C.METRIC_UPDATED,n,_),T.on(C.PLAYBACK_ERROR,h,_),T.on(g.default.BECAME_REPORTING_PLAYER,t,_)}function o(){T.off(C.MANIFEST_UPDATED,E,_),T.off(C.SERVICE_LOCATION_BLACKLIST_CHANGED,i,_),T.off(C.METRIC_ADDED,n,_),T.off(C.METRIC_UPDATED,n,_),T.off(C.PLAYBACK_ERROR,h,_),T.off(g.default.BECAME_REPORTING_PLAYER,t,_)}return _={initialise:c,reset:o},_}d.__dashjs_factory_name="DVBErrorsTranslator";const f=dashjs.FactoryMaker.getSingletonFactory(d)},"./src/streaming/metrics/utils/HandlerHelpers.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>g});function I(){return{reconstructFullMetricName:function(f,y,_){var r=f;return y&&(r+="("+y,_&&_.length&&(r+=","+_),r+=")"),r},validateN:function(f){if(!f)throw new Error("missing n");if(isNaN(f))throw new Error("n is NaN");if(f<0)throw new Error("n must be positive");return f}}}I.__dashjs_factory_name="HandlerHelpers";const g=dashjs.FactoryMaker.getSingletonFactory(I)},"./src/streaming/metrics/utils/ManifestParsing.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});var I=e("./src/streaming/metrics/vo/Metrics.js"),g=e("./src/streaming/metrics/vo/Range.js"),d=e("./src/streaming/metrics/vo/Reporting.js");function f(_){_=_||{};var r,T=_.adapter,M=_.constants;function p(v,E,i){var t,m,n=0;return E?n=T.getAvailabilityStartTime(v)/1e3:(t=T.getRegularPeriods(v),t.length&&(n=t[0].start)),m=n,i&&i.hasOwnProperty(M.START_TIME)&&(m+=i.starttime),m}function C(v){var E=[];return v&&v.Metrics_asArray&&v.Metrics_asArray.forEach(function(i){var t=new I.default,m=T.getIsDynamic(v);if(i.hasOwnProperty("metrics"))t.metrics=i.metrics;else return;if(i.Range_asArray&&i.Range_asArray.forEach(function(n){var h=new g.default;h.starttime=p(v,m,n),n.hasOwnProperty("duration")?h.duration=n.duration:h.duration=T.getDuration(v),h._useWallClockTime=m,t.Range.push(h)}),i.Reporting_asArray)i.Reporting_asArray.forEach(function(n){var h=new d.default;if(n.hasOwnProperty(M.SCHEME_ID_URI))h.schemeIdUri=n.schemeIdUri;else return;n.hasOwnProperty("value")&&(h.value=n.value),n.hasOwnProperty(M.DVB_REPORTING_URL)&&(h.dvb_reportingUrl=n[M.DVB_REPORTING_URL]),n.hasOwnProperty(M.DVB_PROBABILITY)&&(h.dvb_probability=n[M.DVB_PROBABILITY]),t.Reporting.push(h)});else return;E.push(t)}),E}return r={getMetrics:C},r}f.__dashjs_factory_name="ManifestParsing";const y=dashjs.FactoryMaker.getSingletonFactory(f)},"./src/streaming/metrics/utils/MetricSerialiser.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>g});function I(){function d(f){var y=[],_=[],r,T;for(r in f)if(f.hasOwnProperty(r)&&r.indexOf("_")!==0){if(T=f[r],T==null&&(T=""),Array.isArray(T)){if(!T.length)continue;_=[],T.forEach(function(M){var p=Object.prototype.toString.call(M).slice(8,-1)!=="Object";_.push(p?M:d(M))}),T=_.map(encodeURIComponent).join(",")}else typeof T=="string"?T=encodeURIComponent(T):T instanceof Date?T=T.toISOString():typeof T=="number"&&(T=Math.round(T));y.push(r+"="+T)}return y.join("&")}return{serialise:d}}I.__dashjs_factory_name="MetricSerialiser";const g=dashjs.FactoryMaker.getSingletonFactory(I)},"./src/streaming/metrics/utils/RNG.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>g});function I(){var d=window.crypto||window.msCrypto,f=Uint32Array,y=Math.pow(2,f.BYTES_PER_ELEMENT*8)-1,_=10,r,T,M;function p(){d&&(r||(r=new f(_)),d.getRandomValues(r),T=0)}function C(v,E){var i;return v||(v=0),E||(E=1),d?(T===r.length&&p(),i=r[T]/y,T+=1):i=Math.random(),i*(E-v)+v}return M={random:C},p(),M}I.__dashjs_factory_name="RNG";const g=dashjs.FactoryMaker.getSingletonFactory(I)},"./src/streaming/metrics/vo/DVBErrors.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.mpdurl=null,this.errorcode=null,this.terror=null,this.url=null,this.ipaddress=null,this.servicelocation=null};g.SSL_CONNECTION_FAILED_PREFIX="SSL",g.DNS_RESOLUTION_FAILED="C00",g.HOST_UNREACHABLE="C01",g.CONNECTION_REFUSED="C02",g.CONNECTION_ERROR="C03",g.CORRUPT_MEDIA_ISOBMFF="M00",g.CORRUPT_MEDIA_OTHER="M01",g.BASE_URL_CHANGED="F00",g.BECAME_REPORTER="S00";const d=g},"./src/streaming/metrics/vo/Metrics.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.metrics="",this.Range=[],this.Reporting=[]};const d=g},"./src/streaming/metrics/vo/Range.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.starttime=0,this.duration=1/0,this._useWallClockTime=!1};const d=g},"./src/streaming/metrics/vo/Reporting.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>f});function I(y,_){if(!(y instanceof _))throw new TypeError("Cannot call a class as a function")}var g=1e3,d=function y(){I(this,y),this.schemeIdUri="",this.value="",this.dvb_reportingUrl="",this.dvb_probability=g};const f=d},"./src/streaming/models/BaseURLTreeModel.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>r});var I=e("./src/streaming/utils/ObjectUtils.js"),g=e("./src/core/FactoryMaker.js");function d(T,M){if(!(T instanceof M))throw new TypeError("Cannot call a class as a function")}var f=NaN,y=function T(M,p){d(this,T),this.data={baseUrls:M||null,selectedIdx:p||f},this.children=[]};function _(){var T,M,p,C=this.context,v=(0,I.default)(C).getInstance();function E(){l()}function i(S){S.adapter&&(p=S.adapter)}function t(){if(!p||!p.hasOwnProperty("getBaseURLsFromElement")||!p.hasOwnProperty("getRepresentationSortFunction"))throw new Error("setConfig function has to be called previously")}function m(S,L,U){var k=p.getBaseURLsFromElement(U);S[L]?v.areEqual(k,S[L].data.baseUrls)||(S[L].data.baseUrls=k,S[L].data.selectedIdx=f):S[L]=new y(k)}function n(S){t();var L=p.getBaseURLsFromElement(S);v.areEqual(L,M.data.baseUrls)||(M.data.baseUrls=L,M.data.selectedIdx=f),S&&S.Period_asArray&&S.Period_asArray.forEach(function(U,k){m(M.children,k,U),U.AdaptationSet_asArray&&U.AdaptationSet_asArray.forEach(function(X,W){m(M.children[k].children,W,X),X.Representation_asArray&&X.Representation_asArray.sort(p.getRepresentationSortFunction()).forEach(function(b,j){m(M.children[k].children[W].children,j,b)})})})}function h(S,L){var U=L||M;S(U.data),U.children&&U.children.forEach(function(k){return h(S,k)})}function c(S){h(function(L){isNaN(L.selectedIdx)||S===L.baseUrls[L.selectedIdx].serviceLocation&&(L.selectedIdx=f)})}function o(S){n(S)}function l(){M=new y}function A(S){var L=M,U=[L.data];return S&&S.forEach(function(k){L=L.children[k],L&&U.push(L.data)}),U.filter(function(k){return k.baseUrls.length})}return T={reset:l,update:o,getForPath:A,invalidateSelectedIndexes:c,setConfig:i},E(),T}_.__dashjs_factory_name="BaseURLTreeModel";const r=g.default.getClassFactory(_)},"./src/streaming/models/CmcdModel.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>o});var I=e("./src/core/EventBus.js"),g=e("./src/streaming/MediaPlayerEvents.js"),d=e("./src/streaming/metrics/MetricsReportingEvents.js"),f=e("./src/core/FactoryMaker.js"),y=e("./src/core/Settings.js"),_=e("./src/streaming/constants/Constants.js"),r=e("./src/streaming/vo/metrics/HTTPRequest.js"),T=e("./src/dash/models/DashManifestModel.js"),M=e("./src/core/Utils.js");function p(l,A){var S;if(typeof Symbol>"u"||l[Symbol.iterator]==null){if(Array.isArray(l)||(S=C(l))||A&&l&&typeof l.length=="number"){S&&(l=S);var L=0,U=function(){};return{s:U,n:function(){return L>=l.length?{done:!0}:{done:!1,value:l[L++]}},e:function(j){throw j},f:U}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var k=!0,X=!1,W;return{s:function(){S=l[Symbol.iterator]()},n:function(){var j=S.next();return k=j.done,j},e:function(j){X=!0,W=j},f:function(){try{!k&&S.return!=null&&S.return()}finally{if(X)throw W}}}}function C(l,A){if(l){if(typeof l=="string")return v(l,A);var S=Object.prototype.toString.call(l).slice(8,-1);if(S==="Object"&&l.constructor&&(S=l.constructor.name),S==="Map"||S==="Set")return Array.from(l);if(S==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(S))return v(l,A)}}function v(l,A){(A==null||A>l.length)&&(A=l.length);for(var S=0,L=new Array(A);S<A;S++)L[S]=l[S];return L}var E="CMCD",i=1,t={MANIFEST:"m",AUDIO:"a",VIDEO:"v",INIT:"i",CAPTION:"c",ISOBMFF_TEXT_TRACK:"tt",ENCRYPTION_KEY:"k",OTHER:"o"},m={DASH:"d",MSS:"s"},n={VOD:"v",LIVE:"l"},h=5;function c(){var l,A,S,L,U,k,X,W,b,j,Q=this.context,q=(0,I.default)(Q).getInstance(),Y=(0,y.default)(Q).getInstance();function J(){l=(0,T.default)(Q).getInstance(),K()}function $(){q.on(g.default.PLAYBACK_RATE_CHANGED,fe,A),q.on(g.default.MANIFEST_LOADED,le,A),q.on(g.default.BUFFER_LEVEL_STATE_CHANGED,_e,A),q.on(g.default.PLAYBACK_SEEKED,Me,A),q.on(g.default.PERIOD_SWITCH_COMPLETED,ee,A)}function ae(me){me&&(me.abrController&&(L=me.abrController),me.dashMetrics&&(U=me.dashMetrics),me.playbackController&&(k=me.playbackController))}function K(){S={pr:1,nor:null,st:null,sf:null,sid:"".concat(M.default.generateUuid()),cid:null},b={},W={},j={},se()}function ee(){se()}function se(){if(k){var me=k.getStreamController();if(me&&typeof me.getActiveStream=="function"){var Ae=me.getActiveStream();Ae&&(X=Ae.getProcessors())}}}function ue(me){try{if(Y.get().streaming.cmcd&&Y.get().streaming.cmcd.enabled){var Ae=te(me),He=oe(Ae),Qe=Oe(He);return q.trigger(d.default.CMCD_DATA_GENERATED,{url:me.url,mediaType:me.mediaType,cmcdData:Ae,cmcdString:Qe}),{key:E,value:Qe}}return null}catch{return null}}function oe(me){try{var Ae=Y.get().streaming.cmcd.enabledKeys;return Object.keys(me).filter(function(He){return Ae.includes(He)}).reduce(function(He,Qe){return He[Qe]=me[Qe],He},{})}catch{return me}}function Z(me,Ae){var He={},Qe=p(Ae),Je;try{for(Qe.s();!(Je=Qe.n()).done;){var ye=Je.value;me[ye]&&(He[ye]=me[ye])}}catch(Fe){Qe.e(Fe)}finally{Qe.f()}return He}function H(me){try{if(Y.get().streaming.cmcd&&Y.get().streaming.cmcd.enabled){var Ae=te(me),He=Z(Ae,V(["br","d","ot","tb"])),Qe=Z(Ae,V(["bl","dl","mtp","nor","nrr","su"])),Je=Z(Ae,V(["bs","rtp"])),ye=Z(Ae,V(["cid","pr","sf","sid","st","v"])),Fe={"CMCD-Object":Oe(He),"CMCD-Request":Oe(Qe),"CMCD-Status":Oe(Je),"CMCD-Session":Oe(ye)};return q.trigger(d.default.CMCD_DATA_GENERATED,{url:me.url,mediaType:me.mediaType,cmcdData:Ae,headers:Fe}),Fe}return null}catch{return null}}function V(me){var Ae=Y.get().streaming.cmcd.enabledKeys;return me.filter(function(He){return Ae.includes(He)})}function te(me){try{var Ae=null;return me.type===r.HTTPRequest.MPD_TYPE?R(me):me.type===r.HTTPRequest.MEDIA_SEGMENT_TYPE?(D(me.mediaType),u(me)):me.type===r.HTTPRequest.INIT_SEGMENT_TYPE?F(me):me.type===r.HTTPRequest.OTHER_TYPE||me.type===r.HTTPRequest.XLINK_EXPANSION_TYPE?w(me):me.type===r.HTTPRequest.LICENSE?z(me):Ae}catch{return null}}function z(me){var Ae=O();return Ae.ot=t.ENCRYPTION_KEY,Ae}function R(){var me=O();return me.ot=t.MANIFEST,me}function u(me){var Ae=O(),He=P(me),Qe=x(me),Je=ne(me.mediaType),ye=re(me.mediaType),Fe=G(me.mediaType),Be=B(me.mediaType),Ye=S.pr,Ze=Ne(me.mediaType),tt;me.mediaType===_.default.VIDEO&&(tt=t.VIDEO),me.mediaType===_.default.AUDIO&&(tt=t.AUDIO),me.mediaType===_.default.TEXT&&(me.mediaInfo.mimeType==="application/mp4"?tt=t.ISOBMFF_TEXT_TRACK:tt=t.CAPTION);var nt=Y.get().streaming.cmcd.rtp;return nt||(nt=xe(me)),Ae.rtp=nt,Ze&&(me.url!==Ze.url?Ae.nor=encodeURIComponent(M.default.getRelativeUrl(me.url,Ze.url)):Ze.range&&(Ae.nrr=Ze.range)),He&&(Ae.br=He),tt&&(Ae.ot=tt),isNaN(Qe)||(Ae.d=Qe),isNaN(Je)||(Ae.mtp=Je),isNaN(ye)||(Ae.dl=ye),isNaN(Fe)||(Ae.bl=Fe),isNaN(Be)||(Ae.tb=Be),!isNaN(Ye)&&Ye!==1&&(Ae.pr=Ye),b[me.mediaType]&&(Ae.bs=!0,b[me.mediaType]=!1),(W[me.mediaType]||!j[me.mediaType])&&(Ae.su=!0,W[me.mediaType]=!1,j[me.mediaType]=!0),Ae}function D(me){j.hasOwnProperty(me)||(j[me]=!1),W.hasOwnProperty(me)||(W[me]=!1),b.hasOwnProperty(me)||(b[me]=!1)}function F(){var me=O();return me.ot=t.INIT,me.su=!0,me}function w(){var me=O();return me.ot=t.OTHER,me}function O(){var me={},Ae=Y.get().streaming.cmcd.cid?Y.get().streaming.cmcd.cid:S.cid;return me.v=i,me.sid=Y.get().streaming.cmcd.sid?Y.get().streaming.cmcd.sid:S.sid,me.sid="".concat(me.sid),Ae&&(me.cid="".concat(Ae)),!isNaN(S.pr)&&S.pr!==1&&S.pr!==null&&(me.pr=S.pr),S.st&&(me.st=S.st),S.sf&&(me.sf=S.sf),me}function P(me){try{var Ae=me.quality,He=me.mediaInfo.bitrateList;return parseInt(He[Ae].bandwidth/1e3)}catch{return null}}function B(me){try{var Ae=L.getTopBitrateInfoFor(me);return Math.round(Ae.bitrate/1e3)}catch{return null}}function x(me){try{return isNaN(me.duration)?null:Math.round(me.duration*1e3)}catch{return null}}function ne(me){try{return parseInt(L.getThroughputHistory().getSafeAverageThroughput(me)/100)*100}catch{return null}}function re(me){try{var Ae=S.pr,He=U.getCurrentBufferLevel(me);return!isNaN(Ae)&&!isNaN(He)?parseInt(He/Ae*10)*100:null}catch{return null}}function G(me){try{var Ae=U.getCurrentBufferLevel(me);return isNaN(Ae)?null:parseInt(Ae*10)*100}catch{return null}}function fe(me){try{S.pr=me.playbackRate}catch{}}function le(me){try{var Ae=l.getIsDynamic(me.data),He=Ae?n.LIVE:n.VOD,Qe=me.protocol&&me.protocol==="MSS"?m.MSS:m.DASH;S.st="".concat(He),S.sf="".concat(Qe)}catch{}}function _e(me){try{me.state&&me.mediaType&&me.state===g.default.BUFFER_EMPTY&&(b[me.mediaType]||(b[me.mediaType]=!0),W[me.mediaType]||(W[me.mediaType]=!0))}catch{}}function Me(){for(var me in b)b.hasOwnProperty(me)&&(b[me]=!0);for(var Ae in W)W.hasOwnProperty(Ae)&&(W[Ae]=!0)}function Oe(me){try{if(!me)return null;var Ae=Object.keys(me).sort(function(Je,ye){return Je.localeCompare(ye)}),He=Ae.length,Qe=Ae.reduce(function(Je,ye,Fe){return ye==="v"&&me[ye]===1||(typeof me[ye]=="string"&&ye!=="ot"&&ye!=="sf"&&ye!=="st"?Je+="".concat(ye,"=").concat(JSON.stringify(me[ye])):Je+="".concat(ye,"=").concat(me[ye]),Fe<He-1&&(Je+=",")),Je},"");return Qe=Qe.replace(/=true/g,""),Qe=Qe.replace(/,\s*$/,""),Qe}catch{return null}}function Ne(me){if(!(!X||X.length===0)){var Ae=p(X),He;try{for(Ae.s();!(He=Ae.n()).done;){var Qe=He.value;if(Qe.getType()===me)return Qe.probeNextRequest()}}catch(Je){Ae.e(Je)}finally{Ae.f()}}}function xe(me){var Ae=k.getPlaybackRate();Ae||(Ae=1);var He=me.quality,Qe=me.mediaType,Je=me.mediaInfo,ye=me.duration,Fe=G(Qe);Fe===0&&(Fe=500);var Be=Je.bitrateList[He].bandwidth,Ye=Be*ye/1e3,Ze=Fe/Ae/1e3,tt=Ye/Ze,nt=Y.get().streaming.cmcd.rtpSafetyFactor&&!isNaN(Y.get().streaming.cmcd.rtpSafetyFactor)?Y.get().streaming.cmcd.rtpSafetyFactor:h,ht=tt*nt,je=(parseInt(ht/100)+1)*100;return je}function Se(){q.off(g.default.PLAYBACK_RATE_CHANGED,fe,this),q.off(g.default.MANIFEST_LOADED,le,this),q.off(g.default.BUFFER_LEVEL_STATE_CHANGED,_e,A),q.off(g.default.PLAYBACK_SEEKED,Me,A),K()}return A={getQueryParameter:ue,getHeaderParameters:H,setConfig:ae,reset:Se,initialize:$},J(),A}c.__dashjs_factory_name="CmcdModel";const o=f.default.getSingletonFactory(c)},"./src/streaming/models/CmsdModel.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>U});var I=e("./src/core/FactoryMaker.js"),g=e("./src/core/EventBus.js"),d=e("./src/core/events/Events.js"),f=e("./src/core/Debug.js");function y(k){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?y=function(W){return typeof W}:y=function(W){return W&&typeof Symbol=="function"&&W.constructor===Symbol&&W!==Symbol.prototype?"symbol":typeof W},y(k)}function _(k,X){_=function(J,$){return new Q(J,void 0,$)};var W=T(RegExp),b=RegExp.prototype,j=new WeakMap;function Q(Y,J,$){var ae=W.call(this,Y,J);return j.set(ae,$||j.get(Y)),ae}r(Q,W),Q.prototype.exec=function(Y){var J=b.exec.call(this,Y);return J&&(J.groups=q(J,this)),J},Q.prototype[Symbol.replace]=function(Y,J){if(typeof J=="string"){var $=j.get(this);return b[Symbol.replace].call(this,Y,J.replace(/\$<([^>]+)>/g,function(K,ee){return"$"+$[ee]}))}else if(typeof J=="function"){var ae=this;return b[Symbol.replace].call(this,Y,function(){var K=[];return K.push.apply(K,arguments),y(K[K.length-1])!=="object"&&K.push(q(K,ae)),J.apply(this,K)})}else return b[Symbol.replace].call(this,Y,J)};function q(Y,J){var $=j.get(J);return Object.keys($).reduce(function(ae,K){return ae[K]=Y[$[K]],ae},Object.create(null))}return _.apply(this,arguments)}function r(k,X){if(typeof X!="function"&&X!==null)throw new TypeError("Super expression must either be null or a function");k.prototype=Object.create(X&&X.prototype,{constructor:{value:k,writable:!0,configurable:!0}}),X&&v(k,X)}function T(k){var X=typeof Map=="function"?new Map:void 0;return T=function(b){if(b===null||!C(b))return b;if(typeof b!="function")throw new TypeError("Super expression must either be null or a function");if(typeof X<"u"){if(X.has(b))return X.get(b);X.set(b,j)}function j(){return M(b,arguments,E(this).constructor)}return j.prototype=Object.create(b.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}),v(j,b)},T(k)}function M(k,X,W){return p()?M=Reflect.construct:M=function(j,Q,q){var Y=[null];Y.push.apply(Y,Q);var J=Function.bind.apply(j,Y),$=new J;return q&&v($,q.prototype),$},M.apply(null,arguments)}function p(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function C(k){return Function.toString.call(k).indexOf("[native code]")!==-1}function v(k,X){return v=Object.setPrototypeOf||function(b,j){return b.__proto__=j,b},v(k,X)}function E(k){return E=Object.setPrototypeOf?Object.getPrototypeOf:function(W){return W.__proto__||Object.getPrototypeOf(W)},E(k)}var i="static",t="dynamic",m="cmsd-",n=m+i,h=m+t,c={AVAILABILITY_TIME:"at",DURESS:"du",ENCODED_BITRATE:"br",ESTIMATED_THROUGHPUT:"etp",HELD_TIME:"ht",INTERMEDIARY_IDENTIFIER:"n",MAX_SUGGESTED_BITRATE:"mb",NEXT_OBJECT_RESPONSE:"nor",NEXT_RANGE_RESPONSE:"nrr",OBJECT_DURATION:"d",OBJECT_TYPE:"ot",RESPONSE_DELAY:"rd",ROUND_TRIP_TIME:"rtt",STARTUP:"su",STREAM_TYPE:"st",STREAMING_FORMAT:"sf",VERSION:"v"},o={MANIFEST:"m",AUDIO:"a",VIDEO:"v",INIT:"i",CAPTION:"c",ISOBMFF_TEXT_TRACK:"tt",ENCRYPTION_KEY:"k",OTHER:"o",STREAM:"stream"},l=[c.MAX_SUGGESTED_BITRATE,c.STREAM_TYPE,c.STREAMING_FORMAT,c.VERSION],A={video:o.VIDEO,audio:o.AUDIO,text:o.ISOBMFF_TEXT_TRACK,stream:o.STREAM},S=/^[-0-9]/;function L(){var k=this.context,X=(0,g.default)(k).getInstance(),W,b,j,Q;function q(){b=(0,f.default)(k).getInstance().getLogger(W),$()}function Y(){}function J(){}function $(){j={},Q={}}function ae(u){u&&Object.keys(u).forEach(function(D){l.includes(D)||delete u[D]})}function K(u){return u?u.toLowerCase()==="false"?!1:S.test(u)?parseInt(u,10):u.replace(/["]+/g,""):!0}function ee(u){try{for(var D={},F=u.split(","),w=0;w<F.length;w++){var O=F[w].split("="),P=O[0],B=K(O[1]);D[P]=B}return D}catch(x){b.error("Failed to parse CMSD-Static response header value:",x)}}function se(u){try{for(var D={},F=u.split(","),w=F[F.length-1],O=w.split(";"),P=1;P<O.length;P++){var B=O[P].split("="),x=B[0],ne=K(B[1]);D[x]=ne}return D}catch(re){return b.error("Failed to parse CMSD-Dynamic response header value:",re),[]}}function ue(u){return A[u]||o.OTHER}function oe(u,D,F){var w=u===i?j:Q,O=w[D]||{},P=w[o.STREAM]||{},B=O[F]||P[F];return B}function Z(u,D){for(var F=null,w=null,O=u.split(`\r
`),P=O.length-1;P>=0;P--){var B=O[P],x=B.match(_(/^((?:(?!:)[\s\S])*):[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*(.*)$/,{key:1,value:2}));if(x&&x.groups){var ne=x.groups.key.toLowerCase(),re=x.groups.value;switch(ne){case n:F=ee(re),X.trigger(d.default.CMSD_STATIC_HEADER,F);break;case h:w||(w=se(re));break}}}var G=o.STREAM;return F&&F[c.OBJECT_TYPE]?G=F[c.OBJECT_TYPE]:D&&(G=ue(D)),ae(j[G]),ae(Q[G]),F&&(j[G]=Object.assign(j[G]||{},F)),w&&(Q[G]=Object.assign(Q[G]||{},w)),{static:F,dynamic:w}}function H(u){var D=ue(u),F=oe(t,D,c.MAX_SUGGESTED_BITRATE);return F||-1}function V(u){var D=ue(u),F=oe(t,D,c.ESTIMATED_THROUGHPUT);return F||null}function te(u){var D=ue(u),F=oe(t,D,c.RESPONSE_DELAY);return F||null}function z(u){var D=ue(u),F=oe(t,D,c.ROUND_TRIP_TIME);return F||null}function R(){$()}return W={setConfig:J,initialize:Y,reset:R,parseResponseHeaders:Z,getMaxBitrate:H,getEstimatedThroughput:V,getResponseDelay:te,getRoundTripTime:z},q(),W}L.__dashjs_factory_name="CmsdModel";const U=I.default.getSingletonFactory(L)},"./src/streaming/models/CustomParametersModel.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>M});var I=e("./src/dash/vo/UTCTiming.js"),g=e("./src/core/FactoryMaker.js"),d=e("./src/core/Settings.js"),f=e("./src/streaming/utils/SupervisorTools.js"),y=e("./src/streaming/rules/abr/ABRRulesCollection.js"),_=e("./src/streaming/constants/Constants.js"),r=!1;function T(){var p,C,v,E,i,t,m,n,h=this.context,c=(0,d.default)(h).getInstance();function o(){v={default:r},l()}function l(){E=[],i=[],t=[],n=[],m=null,C=[]}function A(){l()}function S(){}function L(D){m=D}function U(){m=null}function k(){return m}function X(){return E}function W(){return i}function b(D){E.push(D)}function j(D){i.push(D)}function Q(D){ae(E,D)}function q(D){ae(i,D)}function Y(){return t}function J(D){t.push(D)}function $(D){ae(t,D)}function ae(D,F){var w=-1;D.some(function(O,P){if(O===F)return w=P,!0}),!(w<0)&&D.splice(w,1)}function K(D){var F;for(F=0;F<n.length;F++)if(n[F].rulename===D)return F;return-1}function ee(D,F,w){if(typeof D!="string"||D!==y.default.ABANDON_FRAGMENT_RULES&&D!==y.default.QUALITY_SWITCH_RULES||typeof F!="string")throw _.default.BAD_ARGUMENT_ERROR;var O=K(F);O===-1?n.push({type:D,rulename:F,rule:w}):(n[O].type=D,n[O].rule=w)}function se(D){if(D){var F=K(D);F!==-1&&n.splice(F,1)}else n=[]}function ue(){n=[]}function oe(){return n}function Z(D,F){V(D,F);var w=new I.default;w.schemeIdUri=D,w.value=F,C.push(w)}function H(){return C}function V(D,F){(0,f.checkParameterType)(D,"string"),(0,f.checkParameterType)(F,"string"),C.forEach(function(w,O){w.schemeIdUri===D&&w.value===F&&C.splice(O,1)})}function te(){C=[]}function z(){var D=c.get().streaming.utcSynchronization.defaultTimingSource;Z(D.scheme,D.value)}function R(D,F){D?v[D]=!!F:Object.keys(v).forEach(function(w){R(w,F)})}function u(D){var F=v[D];return F===void 0?v.default:F}return p={getCustomInitialTrackSelectionFunction:k,setCustomInitialTrackSelectionFunction:L,resetCustomInitialTrackSelectionFunction:U,getLicenseResponseFilters:W,getLicenseRequestFilters:X,getCustomCapabilitiesFilters:Y,registerCustomCapabilitiesFilter:J,registerLicenseResponseFilter:j,registerLicenseRequestFilter:b,unregisterCustomCapabilitiesFilter:$,unregisterLicenseResponseFilter:q,unregisterLicenseRequestFilter:Q,addAbrCustomRule:ee,removeAllAbrCustomRule:ue,removeAbrCustomRule:se,getAbrCustomRules:oe,addUTCTimingSource:Z,removeUTCTimingSource:V,getUTCTimingSources:H,clearDefaultUTCTimingSources:te,restoreDefaultUTCTimingSources:z,setXHRWithCredentialsForType:R,getXHRWithCredentialsForType:u,setConfig:S,reset:A},o(),p}T.__dashjs_factory_name="CustomParametersModel";const M=g.default.getSingletonFactory(T)},"./src/streaming/models/FragmentModel.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>M});var I=e("./src/core/FactoryMaker.js"),g=e("./src/streaming/vo/FragmentRequest.js"),d="loading",f="executed",y="canceled",_="failed";function r(p){p=p||{};var C=p.eventBus,v=p.events,E=p.dashMetrics,i=p.fragmentLoader,t=p.debug,m=p.streamInfo,n=p.type,h,c,o,l;function A(){c=t.getLogger(h),H(),C.on(v.LOADING_COMPLETED,ue,h),C.on(v.LOADING_DATA_PROGRESS,oe,h),C.on(v.LOADING_ABANDONED,Z,h)}function S(){return m.id}function L(){return n}function U(z){var R=function(O,P){return O.action===g.default.ACTION_COMPLETE&&O.action===P.action},u=function(O,P){return!isNaN(O.index)&&O.startTime===P.startTime&&O.adaptationIndex===P.adaptationIndex&&O.type===P.type},D=function(O,P){return isNaN(O.index)&&isNaN(P.index)&&O.quality===P.quality},F=function(O){var P=!1;return O.some(function(B){if(u(z,B)||D(z,B)||R(z,B))return P=!0,P}),P};return z?F(o):!1}function k(z){var R=!1,u=0,D;if(R=U(z),!R)for(u=0;u<l.length;u++)D=l[u],z.url===D.url&&z.startTime===D.startTime&&(R=!0);return R}function X(z){var R=z?z.state instanceof Array?z.state:[z.state]:[],u=[];return R.forEach(function(D){var F=ee(D);u=u.concat(K(F,z))}),u}function W(z){return isNaN(z.duration)?.25:Math.min(z.duration/8,.5)}function b(z){o=o.filter(function(R){var u=W(R);return isNaN(R.startTime)||(z!==void 0?R.startTime>=z-u:!1)})}function j(z){o=o.filter(function(R){return isNaN(R.startTime)||(z!==void 0?R.startTime<z:!1)})}function Q(z,R){R<=z+.5||(o=o.filter(function(u){var D=W(u);return isNaN(u.startTime)||u.startTime>=R-D||isNaN(u.duration)||u.startTime+u.duration<=z+D}))}function q(z,R){if(!z||z.length===0){b();return}for(var u=0,D=0,F=z.length;D<F;D++)Q(u,z.start(D)),u=z.end(D);R>0&&Q(u,R)}function Y(){c.debug("abort requests"),i.abort(),l=[]}function J(z){switch(z.action){case g.default.ACTION_DOWNLOAD:se(z,d),l.push(z),$(z);break;default:c.warn("Unknown request action.")}}function $(z){C.trigger(v.FRAGMENT_LOADING_STARTED,{request:z},{streamId:m.id,mediaType:n}),i.load(z)}function ae(z,R,u){for(var D=z.length-1,F=D;F>=0;F--){var w=z[F],O=w.startTime,P=O+w.duration;if(u=isNaN(u)?W(w):u,!isNaN(O)&&!isNaN(P)&&R+u>=O&&R-u<P||isNaN(O)&&isNaN(R))return w}return null}function K(z,R){return R.hasOwnProperty("time")?[ae(z,R.time,R.threshold)]:z.filter(function(u){for(var D in R)if(D!=="state"&&R.hasOwnProperty(D)&&u[D]!=R[D])return!1;return!0})}function ee(z){var R;switch(z){case d:R=l;break;case f:R=o;break;default:R=[]}return R}function se(z,R){E.addSchedulingInfo(z,R),E.addRequestsQueue(z.mediaType,l,o)}function ue(z){z.sender===i&&(l.splice(l.indexOf(z.request),1),z.response&&!z.error&&o.push(z.request),se(z.request,z.error?_:f),C.trigger(v.FRAGMENT_LOADING_COMPLETED,{request:z.request,response:z.response,error:z.error,sender:this},{streamId:m.id,mediaType:n}))}function oe(z){z.sender===i&&C.trigger(v.FRAGMENT_LOADING_PROGRESS,{request:z.request,response:z.response,error:z.error,sender:this},{streamId:m.id,mediaType:n})}function Z(z){z.sender===i&&C.trigger(v.FRAGMENT_LOADING_ABANDONED,{request:z.request},{streamId:m.id,mediaType:n})}function H(){o=[],l=[]}function V(){C.off(v.LOADING_COMPLETED,ue,this),C.off(v.LOADING_DATA_PROGRESS,oe,this),C.off(v.LOADING_ABANDONED,Z,this),i&&i.reset(),H()}function te(z){o.push(z)}return h={getStreamId:S,getType:L,getRequests:X,isFragmentLoaded:U,isFragmentLoadedOrPending:k,removeExecutedRequestsBeforeTime:b,removeExecutedRequestsAfterTime:j,syncExecutedRequestsWithBufferedRange:q,abortRequests:Y,executeRequest:J,reset:V,resetInitialSettings:H,addExecutedRequest:te},A(),h}r.__dashjs_factory_name="FragmentModel";var T=I.default.getClassFactory(r);T.FRAGMENT_MODEL_LOADING=d,T.FRAGMENT_MODEL_EXECUTED=f,T.FRAGMENT_MODEL_CANCELED=y,T.FRAGMENT_MODEL_FAILED=_,I.default.updateClassFactory(r.__dashjs_factory_name,T);const M=T},"./src/streaming/models/LowLatencyThroughputModel.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>f});var I=e("./src/core/Debug.js"),g=e("./src/core/FactoryMaker.js");function d(){var y=10,_=.8,r=.6,T=1.05,M=250,p=this.context,C,v,E={};function i(){v=(0,I.default)(p).getInstance().getLogger(C)}function t(o){for(var l={},A=0,S=0,L=0,U=0,k=o.length,X=0;X<k;++X)A+=o[X].chunkDownloadTimeRelativeMS,S+=o[X].bufferLevel,L+=o[X].chunkDownloadTimeRelativeMS*o[X].bufferLevel,U+=o[X].chunkDownloadTimeRelativeMS*o[X].chunkDownloadTimeRelativeMS;return l.m=(L-A*S/k)/(U-A*A/k),l.b=S/k-l.m*A/k,function(W){return l.m*W+l.b}}function m(o){var l=!0,A,S=o.reduce(function(L,U){return L+U.bufferLevelAtSegmentEnd},0)/o.length;return o.forEach(function(L){Math.abs(L.bufferLevelAtSegmentEnd/L.bufferLevelAtSegmentStart)<.95&&(l=!1),L.bufferLevelAtSegmentEnd/S<.8&&(l=!1),A?A>L.bitrate&&(l=!1):A=L.bitrate}),l}function n(o){var l=E[o.mediaType].slice(-1).pop(),A=E[o.mediaType].slice(-3),S=l.chunkMeasurements.slice(-1).pop().chunkDownloadTimeRelativeMS;l.bufferLevelAtSegmentStart=l.getEstimatedBufferLevel(S/2),l.bufferLevelAtSegmentEnd=l.getEstimatedBufferLevel(S);var L=m(A),U=L?r:_;if(l.isBufferStable&&l.segDurationMS*T<l.fetchDownloadDurationMS)return l.fetchDownloadDurationMS;if(!L||l.segDurationMS<l.fetchDownloadDurationMS||l.adjustedAvailabilityStartTimeMS<=l.requestTimeMS+l.throughputCapacityDelayMS-l.segDurationMS)return l.fetchDownloadDurationMS*_;for(var k=l.requestTimeMS+l.throughputCapacityDelayMS-l.adjustedAvailabilityStartTimeMS,X=0,W=0,b=0,j=0;j<l.chunkMeasurements.length;j++){var Q=l.chunkMeasurements[j];if(k<W+Q.chunkDownloadDurationMS)break;W+=Q.chunkDownloadDurationMS,X+=Q.chunkBytes,b++}if(k<0&&v.warn("request time was before adjusted availibitly start time"),X&&W&&b>l.chunkMeasurements.length*.2){var q=X/W,Y=l.segmentBytes/q;return l.fetchDownloadDurationMS<Y?l.fetchDownloadDurationMS*U:Y*U}var J=l.bitrate;return l.bitrateList.some(function($){if($.bandwidth>l.bitrate)return J=$.bandwidth,!0}),J===l.bitrate?l.fetchDownloadDurationMS*U:U*l.segmentBytes*8*1e3/J}function h(o,l){var A=E[o.mediaType]&&E[o.mediaType].slice(-3);return!A||A.length<3||!m(A)?0:l/4>M?M:l/4}function c(o,l,A,S,L){o&&o.mediaType&&!E[o.mediaType]&&(E[o.mediaType]=[]);var U=o.mediaInfo.bitrateList.find(function(k){return k.id===o.representationId});E[o.mediaType].push({index:o.index,repId:o.representationId,mediaType:o.mediaType,requestTimeMS:S,adjustedAvailabilityStartTimeMS:o.availabilityStartTime.getTime(),segDurationMS:o.duration*1e3,chunksDurationMS:A.reduce(function(k,X){return k+X.chunkDownloadDurationMS},0),segmentBytes:A.reduce(function(k,X){return k+X.chunkBytes},0),bitrate:U&&U.bandwidth,bitrateList:o.mediaInfo.bitrateList,chunkMeasurements:A,fetchDownloadDurationMS:l,throughputCapacityDelayMS:L,getEstimatedBufferLevel:t(A.slice(1))}),E[o.mediaType].length>y&&E[o.mediaType].shift()}return C={setup:i,addMeasurement:c,getThroughputCapacityDelayMS:h,getEstimatedDownloadDurationMS:n},i(),C}d.__dashjs_factory_name="LowLatencyThroughputModel";const f=g.default.getSingletonFactory(d)},"./src/streaming/models/ManifestModel.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});var I=e("./src/core/EventBus.js"),g=e("./src/core/events/Events.js"),d=e("./src/core/FactoryMaker.js");function f(){var _=this.context,r=(0,I.default)(_).getInstance(),T,M;function p(){return M}function C(v){M=v,v&&r.trigger(g.default.MANIFEST_LOADED,{data:v})}return T={getValue:p,setValue:C},T}f.__dashjs_factory_name="ManifestModel";const y=d.default.getSingletonFactory(f)},"./src/streaming/models/MediaPlayerModel.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>i});var I=e("./src/core/Debug.js"),g=e("./src/core/FactoryMaker.js"),d=e("./src/core/Settings.js"),f=12,y=20,_=10,r=5,T=12,M=-.5,p=.5,C=-.5,v=1;function E(){var t,m,n,h,c=this.context,o=(0,d.default)(c).getInstance();function l(){m=(0,I.default)(c).getInstance().getLogger(t)}function A(J){J.playbackController&&(n=J.playbackController),J.serviceDescriptionController&&(h=J.serviceDescriptionController)}function S(J,$){return isNaN(J)?0:J>0?($&&m.warn("Supplied minimum playback rate is a positive value when it should be negative or 0. The supplied rate will not be applied and set to 0: 100% playback speed."),0):J<C?($&&m.warn("Supplied minimum playback rate is out of range and will be limited to ".concat(C,": ").concat(C*100,"% playback speed.")),C):J}function L(J,$){return isNaN(J)?0:J<0?($&&m.warn("Supplied maximum playback rate is a negative value when it should be negative or 0. The supplied rate will not be applied and set to 0: 100% playback speed."),0):J>v?($&&m.warn("Supplied maximum playback rate is out of range and will be limited to ".concat(v,": ").concat((1+v)*100,"% playback speed.")),v):J}function U(){if(!isNaN(o.get().streaming.liveCatchup.maxDrift)&&o.get().streaming.liveCatchup.maxDrift>0)return o.get().streaming.liveCatchup.maxDrift;var J=h.getServiceDescriptionSettings();return J&&J.liveCatchup&&!isNaN(J.liveCatchup.maxDrift)&&J.liveCatchup.maxDrift>0?J.liveCatchup.maxDrift:T}function k(J){var $=o.get().streaming.liveCatchup.playbackRate;if(!isNaN($.min)||!isNaN($.max))return{min:S($.min,J),max:L($.max,J)};var ae=h.getServiceDescriptionSettings();if(ae&&ae.liveCatchup&&(!isNaN(ae.liveCatchup.playbackRate.min)||!isNaN(ae.liveCatchup.playbackRate.max))){var K=ae.liveCatchup.playbackRate;return{min:S(K.min,J),max:L(K.max,J)}}return{min:M,max:p}}function X(){return o.get().streaming.liveCatchup.enabled!==null?o.get().streaming.liveCatchup.enabled:n.getInitialCatchupModeActivated()}function W(J,$){try{var ae=o.get().streaming.abr[J][$];if(!isNaN(ae)&&ae!==-1)return ae;var K=h.getServiceDescriptionSettings();return K&&K[J]&&!isNaN(K[J][$])?K[J][$]:-1}catch{return-1}}function b(){var J=o.get().streaming.buffer.initialBufferLevel;return isNaN(J)||J<0?0:Math.min(j(),J)}function j(){var J=o.get().streaming.buffer.stableBufferTime>0?o.get().streaming.buffer.stableBufferTime:o.get().streaming.buffer.fastSwitchEnabled?y:f,$=n.getLiveDelay();return!isNaN($)&&$>0?Math.min(J,$):J}function Q(J){var $=isNaN(o.get().streaming.retryAttempts.lowLatencyMultiplyFactor)?r:o.get().streaming.retryAttempts.lowLatencyMultiplyFactor;return n.getLowLatencyModeEnabled()?o.get().streaming.retryAttempts[J]*$:o.get().streaming.retryAttempts[J]}function q(J){var $=isNaN(o.get().streaming.retryIntervals.lowLatencyReductionFactor)?_:o.get().streaming.retryIntervals.lowLatencyReductionFactor;return n.getLowLatencyModeEnabled()?o.get().streaming.retryIntervals[J]/$:o.get().streaming.retryIntervals[J]}function Y(){}return t={getCatchupMaxDrift:U,getCatchupModeEnabled:X,getStableBufferTime:j,getInitialBufferLevel:b,getRetryAttemptsForType:Q,getRetryIntervalsForType:q,getCatchupPlaybackRates:k,getAbrBitrateParameter:W,setConfig:A,reset:Y},l(),t}E.__dashjs_factory_name="MediaPlayerModel";const i=g.default.getSingletonFactory(E)},"./src/streaming/models/MetricsModel.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>n});var I=e("./src/streaming/constants/Constants.js"),g=e("./src/streaming/constants/MetricsConstants.js"),d=e("./src/streaming/vo/MetricsList.js"),f=e("./src/streaming/vo/metrics/HTTPRequest.js"),y=e("./src/streaming/vo/metrics/RepresentationSwitch.js"),_=e("./src/streaming/vo/metrics/BufferLevel.js"),r=e("./src/streaming/vo/metrics/BufferState.js"),T=e("./src/streaming/vo/metrics/DVRInfo.js"),M=e("./src/streaming/vo/metrics/DroppedFrames.js"),p=e("./src/streaming/vo/metrics/ManifestUpdate.js"),C=e("./src/streaming/vo/metrics/SchedulingInfo.js"),v=e("./src/core/EventBus.js"),E=e("./src/streaming/vo/metrics/RequestsQueue.js"),i=e("./src/core/events/Events.js"),t=e("./src/core/FactoryMaker.js");function m(h){h=h||{};var c=h.settings,o=this.context,l=(0,v.default)(o).getInstance(),A,S;function L(){S={}}function U(){l.trigger(i.default.METRICS_CHANGED)}function k(D){l.trigger(i.default.METRIC_CHANGED,{mediaType:D}),U()}function X(D,F,w){l.trigger(i.default.METRIC_UPDATED,{mediaType:D,metric:F,value:w}),k(D)}function W(D,F,w){l.trigger(i.default.METRIC_ADDED,{mediaType:D,metric:F,value:w}),k(D)}function b(D){delete S[D],k(D)}function j(){S={},U()}function Q(D,F){var w=null;return D&&(S.hasOwnProperty(D)?w=S[D]:F||(w=new d.default,S[D]=w)),w}function q(D,F,w){var O=Q(D);O!==null&&(O[F].push(w),O[F].length>c.get().streaming.metrics.maxListDepth&&O[F].shift())}function Y(D,F,w,O){var P=new f.HTTPRequestTrace;return P.s=F,P.d=w,P.b=O,D.trace.push(P),D.interval||(D.interval=0),D.interval+=w,P}function J(D,F,w,O,P,B,x,ne,re,G,fe,le,_e,Me,Oe,Ne,xe){var Se=new f.HTTPRequest;B&&B!==O&&(J(D,null,w,O,P,null,null,ne,re,null,null,null,_e,null,null,Ne,xe),Se.actualurl=B),Se.tcpid=F,Se.type=w,Se.url=O,Se.range=ne,Se.trequest=re,Se.tresponse=G,Se.responsecode=le,Se.cmsd=xe,Se._tfinish=fe,Se._stream=D,Se._mediaduration=_e,Se._quality=P,Se._responseHeaders=Me,Se._serviceLocation=x,Se._fileLoaderType=Ne,Oe?Oe.forEach(function(me){Y(Se,me.s,me.d,me.b)}):(delete Se.interval,delete Se.trace),ae(D,g.default.HTTP_REQUEST,Se)}function $(D,F,w,O,P){var B=new y.default;B.t=F,B.mt=w,B.to=O,P?B.lto=P:delete B.lto,ae(D,g.default.TRACK_SWITCH,B)}function ae(D,F,w){q(D,F,w),W(D,F,w)}function K(D,F,w){var O=new _.default;O.t=F,O.level=w,ae(D,g.default.BUFFER_LEVEL,O)}function ee(D,F,w){var O=new r.default;O.target=w,O.state=F,ae(D,g.default.BUFFER_STATE,O)}function se(D,F,w,O){var P=new T.default;P.time=F,P.range=O,P.manifestInfo=w,ae(D,g.default.DVR_INFO,P)}function ue(D,F){var w=new M.default,O=Q(D).DroppedFrames;F&&(w.time=F.creationTime,w.droppedFrames=F.droppedVideoFrames,!(O.length>0&&O[O.length-1]==w)&&ae(D,g.default.DROPPED_FRAMES,w))}function oe(D,F,w,O,P,B,x,ne,re){var G=new C.default;G.mediaType=D,G.t=F,G.type=w,G.startTime=O,G.availabilityStartTime=P,G.duration=B,G.quality=x,G.range=ne,G.state=re,ae(D,g.default.SCHEDULING_INFO,G)}function Z(D,F,w){var O=new E.default;O.loadingRequests=F,O.executedRequests=w,Q(D).RequestsQueue=O,W(D,g.default.REQUESTS_QUEUE,O)}function H(D,F,w,O,P,B,x,ne,re,G){var fe=new p.ManifestUpdate;fe.mediaType=D,fe.type=F,fe.requestTime=w,fe.fetchTime=O,fe.availabilityStartTime=P,fe.presentationStartTime=B,fe.clientTimeOffset=x,fe.currentTime=ne,fe.buffered=re,fe.latency=G,q(I.default.STREAM,g.default.MANIFEST_UPDATE,fe),W(D,g.default.MANIFEST_UPDATE,fe)}function V(D,F){if(D){for(var w in F)D[w]=F[w];X(D.mediaType,g.default.MANIFEST_UPDATE,D)}}function te(D,F,w,O,P){if(D){var B=new p.ManifestUpdateStreamInfo;B.id=F,B.index=w,B.start=O,B.duration=P,D.streamInfo.push(B),X(D.mediaType,g.default.MANIFEST_UPDATE_STREAM_INFO,D)}}function z(D,F,w,O,P,B,x,ne){if(D&&D.representationInfo){var re=new p.ManifestUpdateRepresentationInfo;re.id=F,re.index=w,re.streamIndex=O,re.mediaType=P,re.startNumber=x,re.fragmentInfoType=ne,re.presentationTimeOffset=B,D.representationInfo.push(re),X(D.mediaType,g.default.MANIFEST_UPDATE_TRACK_INFO,D)}}function R(D){D.trace&&Array.isArray(D.trace)?D.trace.forEach(function(F){F.hasOwnProperty("subreplevel")&&!F.subreplevel&&delete F.subreplevel}):delete D.trace,ae(I.default.STREAM,g.default.PLAY_LIST,D)}function u(D){ae(I.default.STREAM,g.default.DVB_ERRORS,D)}return A={clearCurrentMetricsForType:b,clearAllCurrentMetrics:j,getMetricsFor:Q,addHttpRequest:J,addRepresentationSwitch:$,addBufferLevel:K,addBufferState:ee,addDVRInfo:se,addDroppedFrames:ue,addSchedulingInfo:oe,addRequestsQueue:Z,addManifestUpdate:H,updateManifestUpdateInfo:V,addManifestUpdateStreamInfo:te,addManifestUpdateRepresentationInfo:z,addPlayList:R,addDVBErrors:u},L(),A}m.__dashjs_factory_name="MetricsModel";const n=t.default.getSingletonFactory(m)},"./src/streaming/models/URIFragmentModel.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>f});var I=e("./src/streaming/vo/URIFragmentData.js"),g=e("./src/core/FactoryMaker.js");function d(){var y,_;function r(M){if(_=new I.default,!M)return null;var p=M.indexOf("#");if(p!==-1)for(var C=M.substr(p+1).split("&"),v=0,E=C.length;v<E;++v){var i=C[v],t=i.indexOf("=");if(t!==-1){var m=i.substring(0,t);_.hasOwnProperty(m)&&(_[m]=i.substr(t+1))}}}function T(){return _}return y={initialize:r,getURIFragmentData:T},y}d.__dashjs_factory_name="URIFragmentModel";const f=g.default.getSingletonFactory(d)},"./src/streaming/models/VideoModel.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>T});var I=e("./src/core/FactoryMaker.js"),g=e("./src/core/EventBus.js"),d=e("./src/core/events/Events.js"),f=e("./src/core/Debug.js"),y=e("./src/streaming/constants/Constants.js"),_=new Map([[y.default.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,"loadedmetadata"],[y.default.VIDEO_ELEMENT_READY_STATES.HAVE_CURRENT_DATA,"loadeddata"],[y.default.VIDEO_ELEMENT_READY_STATES.HAVE_FUTURE_DATA,"canplay"],[y.default.VIDEO_ELEMENT_READY_STATES.HAVE_ENOUGH_DATA,"canplaythrough"]]);function r(){var M,p,C,v,E,i,t="element is not video or audio DOM type!",m=this.context,n=(0,g.default)(m).getInstance(),h=[];function c(){p=(0,f.default)(m).getInstance().getLogger(M),v=NaN}function o(){n.on(d.default.PLAYBACK_PLAYING,se,this)}function l(){n.off(d.default.PLAYBACK_PLAYING,se,this)}function A(){C&&(C.playbackRate=1,C.removeEventListener("canplay",A))}function S(Se){var me=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;C&&(!me&&C.readyState<=2&&Se>0?C.addEventListener("canplay",A):C.playbackRate=Se)}function L(Se,me){C&&(v=Se,Ne(y.default.VIDEO_ELEMENT_READY_STATES.HAVE_METADATA,function(){if(C.currentTime===v){v=NaN;return}try{v=me?U(v):v,C.currentTime=v,v=NaN}catch(Ae){C.readyState===0&&Ae.code===Ae.INVALID_STATE_ERR&&setTimeout(function(){C.currentTime=v,v=NaN},400)}}))}function U(Se){var me=O(),Ae=Se,He=9999999999;if(me)for(var Qe=0;Qe<me.length;Qe++){var Je=me.start(Qe),ye=me.end(Qe),Fe=Math.abs(Je-Se),Be=Math.abs(ye-Se);if(Se>=Je&&Se<=ye)return Se;Fe<He&&(He=Fe,Ae=Je),Be<He&&(He=Be,Ae=ye)}return Ae}function k(){return C}function X(Se){if(Se==null||Se&&/^(VIDEO|AUDIO)$/i.test(Se.nodeName))C=Se,C&&(C.preload="auto");else throw t}function W(Se){C&&(Se?C.src=Se:(C.removeAttribute("src"),C.load()))}function b(){return C?C.src:null}function j(){return E}function Q(){return i}function q(Se){E=Se,E.style.position="absolute",E.style.display="flex",E.style.overflow="hidden",E.style.pointerEvents="none",E.style.top=0,E.style.left=0}function Y(Se){i=Se}function J(Se,me){ee(Se,me)}function $(){return h.length>0}function ae(Se){Se===null||!C||C.seeking||h.indexOf(Se)!==-1||h.push(Se)}function K(Se){var me=h.indexOf(Se);Se!==null&&me!==-1&&h.splice(me,1)}function ee(Se,me){me?ae(Se):K(Se)}function se(){if(C&&$()&&C.playbackRate===0){var Se=document.createEvent("Event");Se.initEvent("waiting",!0,!1),C.dispatchEvent(Se)}}function ue(){if(!C)return null;var Se="webkitDroppedFrameCount"in C&&"webkitDecodedFrameCount"in C,me="getVideoPlaybackQuality"in C,Ae=null;return me?Ae=C.getVideoPlaybackQuality():Se&&(Ae={droppedVideoFrames:C.webkitDroppedFrameCount,totalVideoFrames:C.webkitDroppedFrameCount+C.webkitDecodedFrameCount,creationTime:new Date}),Ae}function oe(){if(C){C.autoplay=!0;var Se=C.play();Se&&Se.catch&&typeof Promise<"u"&&Se.catch(function(me){me.name==="NotAllowedError"&&n.trigger(d.default.PLAYBACK_NOT_ALLOWED),p.warn("Caught pending play exception - continuing (".concat(me,")"))})}}function Z(){return C?C.paused:null}function H(){C&&(C.pause(),C.autoplay=!1)}function V(){return C?C.seeking||!isNaN(v):null}function te(){return C?isNaN(v)?C.currentTime:v:null}function z(){return C?C.playbackRate:null}function R(){return C?C.played:null}function u(){return C?C.ended:null}function D(Se,me){C&&C.addEventListener(Se,me)}function F(Se,me){C&&C.removeEventListener(Se,me)}function w(){return C?C.readyState:NaN}function O(){return C?C.buffered:null}function P(){return C?C.clientWidth:NaN}function B(){return C?C.clientHeight:NaN}function x(){return C?C.videoWidth:NaN}function ne(){return C?C.videoHeight:NaN}function re(){var Se=C.parentNode.host||C.parentNode;return Se?C.getBoundingClientRect().top-Se.getBoundingClientRect().top:NaN}function G(){var Se=C.parentNode.host||C.parentNode;return Se?C.getBoundingClientRect().left-Se.getBoundingClientRect().left:NaN}function fe(){return C?C.textTracks:[]}function le(Se,me,Ae,He,Qe){if(C){for(var Je=0;Je<C.textTracks.length;Je++)if(C.textTracks[Je].kind===Se&&(!me||C.textTracks[Je].label==me)&&C.textTracks[Je].language===Ae&&C.textTracks[Je].isTTML===He&&C.textTracks[Je].isEmbedded===Qe)return C.textTracks[Je]}return null}function _e(Se,me,Ae,He,Qe){if(!C)return null;var Je=le(Se,me,Ae,He,Qe);return Je||(Je=C.addTextTrack(Se,me,Ae),Je.isEmbedded=Qe,Je.isTTML=He),Je}function Me(Se){C&&(C.appendChild(Se),Se.isTTML!==void 0&&(C.textTracks[C.textTracks.length-1].isTTML=Se.isTTML,C.textTracks[C.textTracks.length-1].isEmbedded=Se.isEmbedded))}function Oe(Se){C&&C.removeChild(Se)}function Ne(Se,me){if(Se===y.default.VIDEO_ELEMENT_READY_STATES.HAVE_NOTHING||w()>=Se)me();else{var Ae=_.get(Se);xe(Ae,me)}}function xe(Se,me){var Ae=function He(){F(Se,He),me(Se)};D(Se,Ae)}return M={initialize:o,setCurrentTime:L,play:oe,isPaused:Z,pause:H,isStalled:$,isSeeking:V,getTime:te,getPlaybackRate:z,setPlaybackRate:S,getPlayedRanges:R,getEnded:u,setStallState:J,getElement:k,setElement:X,setSource:W,getSource:b,getTTMLRenderingDiv:j,setTTMLRenderingDiv:q,getVttRenderingDiv:Q,setVttRenderingDiv:Y,getPlaybackQuality:ue,addEventListener:D,removeEventListener:F,getReadyState:w,getBufferRange:O,getClientWidth:P,getClientHeight:B,getTextTracks:fe,getTextTrack:le,addTextTrack:_e,appendChild:Me,removeChild:Oe,getVideoWidth:x,getVideoHeight:ne,getVideoRelativeOffsetTop:re,getVideoRelativeOffsetLeft:G,waitForReadyState:Ne,reset:l},c(),M}r.__dashjs_factory_name="VideoModel";const T=I.default.getSingletonFactory(r)},"./src/streaming/net/FetchLoader.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>i});var I=e("./src/core/FactoryMaker.js"),g=e("./src/core/Settings.js"),d=e("./src/streaming/constants/Constants.js"),f=e("./src/streaming/utils/RequestModifier.js");function y(t,m){return T(t)||r(t,m)||p(t,m)||_()}function _(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r(t,m){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var n=[],h=!0,c=!1,o=void 0;try{for(var l=t[Symbol.iterator](),A;!(h=(A=l.next()).done)&&(n.push(A.value),!(m&&n.length===m));h=!0);}catch(S){c=!0,o=S}finally{try{!h&&l.return!=null&&l.return()}finally{if(c)throw o}}return n}}function T(t){if(Array.isArray(t))return t}function M(t,m){var n;if(typeof Symbol>"u"||t[Symbol.iterator]==null){if(Array.isArray(t)||(n=p(t))||m&&t&&typeof t.length=="number"){n&&(t=n);var h=0,c=function(){};return{s:c,n:function(){return h>=t.length?{done:!0}:{done:!1,value:t[h++]}},e:function(L){throw L},f:c}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var o=!0,l=!1,A;return{s:function(){n=t[Symbol.iterator]()},n:function(){var L=n.next();return o=L.done,L},e:function(L){l=!0,A=L},f:function(){try{!o&&n.return!=null&&n.return()}finally{if(l)throw A}}}}function p(t,m){if(t){if(typeof t=="string")return C(t,m);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return C(t,m)}}function C(t,m){(m==null||m>t.length)&&(m=t.length);for(var n=0,h=new Array(m);n<m;n++)h[n]=t[n];return h}function v(t){t=t||{};var m=this.context,n=t.requestModifier,h=t.lowLatencyThroughputModel,c=t.boxParser,o=(0,g.default)(m).getInstance(),l,A;function S(Q){A=Q.dashMetrics}function L(Q){n&&n.modifyRequest?(0,f.modifyRequest)(Q,n).then(function(){return U(Q)}):U(Q)}function U(Q){var q=new Date,Y=Q.request,J=new Headers;if(Y.range&&J.append("Range","bytes="+Y.range),Q.headers)for(var $ in Q.headers){var ae=Q.headers[$];ae&&J.append($,ae)}Y.requestStartDate||(Y.requestStartDate=q),n&&n.modifyRequestHeader&&n.modifyRequestHeader({setRequestHeader:function(H,V){J.append(H,V)}},{url:Q.url});var K;typeof window.AbortController=="function"&&(K=new AbortController,Q.abortController=K,K.signal.onabort=Q.onabort);var ee={method:Q.method,headers:J,credentials:Q.withCredentials?"include":void 0,signal:K?K.signal:void 0},se=o.get().streaming.abr.fetchThroughputCalculationMode,ue=Date.now(),oe=0;new Promise(function(Z){if(se===d.default.ABR_FETCH_THROUGHPUT_CALCULATION_AAST&&h&&(oe=h.getThroughputCapacityDelayMS(Y,A.getCurrentBufferLevel(Y.mediaType)*1e3),oe))return setTimeout(Z,oe);Z()}).then(function(){var Z=Date.now();fetch(Q.url,ee).then(function(H){Q.response||(Q.response={}),Q.response.status=H.status,Q.response.statusText=H.statusText,Q.response.responseURL=H.url,H.ok||Q.onerror();var V="",te=M(H.headers.keys()),z;try{for(te.s();!(z=te.n()).done;){var R=z.value;V+=R+": "+H.headers.get(R)+`\r
`}}catch(xe){te.e(xe)}finally{te.f()}if(Q.response.responseHeaders=V,!H.body)return H.arrayBuffer().then(function(xe){Q.response.response=xe;var Se={loaded:xe.byteLength,total:xe.byteLength,stream:!1};Q.progress(Se),Q.onload(),Q.onend()});var u=parseInt(H.headers.get("Content-Length"),10),D=0,F=!1,w=new Uint8Array,O=0;if(se===d.default.ABR_FETCH_THROUGHPUT_CALCULATION_AAST&&h){var P=function(Se){var me=Se.getReader(),Ae=[];me.read().then(function He(Qe){var Je=Qe.value,ye=Qe.done;if(x=Date.now(),Je&&Je.length){var Fe=x-B,Be=Je.length;Ae.push({chunkDownloadTimeRelativeMS:x-Z,chunkDownloadDurationMS:Fe,chunkBytes:Be,kbps:Math.round(8*Be/(Fe/1e3)),bufferLevel:A.getCurrentBufferLevel(Y.mediaType)})}if(ye){var Ye=x-Z,Ze=Ae.reduce(function(tt,nt){return tt+nt.chunkBytes},0);h.addMeasurement(Y,Ye,Ae,ue,oe,V),Q.progress({loaded:Ze,total:Ze,lengthComputable:!0,time:h.getEstimatedDownloadDurationMS(Y),stream:!0});return}return B=Date.now(),me.read().then(He)})},B=Z,x=0,ne=H.body.tee(),re=y(ne,2),G=re[0],fe=re[1];P(G),Q.reader=fe.getReader()}else Q.reader=H.body.getReader();var le=[],_e=[],Me=[],Oe=!0,Ne=function xe(Se){var me=Se.value,Ae=Se.done;if(Ae){if(w){if(se!==d.default.ABR_FETCH_THROUGHPUT_CALCULATION_AAST){var He=null,Qe=null;se===d.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING?(He=j(_e,Me),He&&(Qe=D*8/He)):se===d.default.ABR_FETCH_THROUGHPUT_CALCULATION_DOWNLOADED_DATA&&(Qe=b(le,D)),Q.progress({loaded:D,total:isNaN(u)?D:u,lengthComputable:!0,time:Qe,stream:!0})}Q.response.response=w.buffer}Q.onload(),Q.onend();return}if(me&&me.length>0){if(w=X(w,me),D+=me.length,le.push({ts:Date.now(),bytes:me.length}),se===d.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING&&Oe){var Je=c.findLastTopIsoBoxCompleted(["moof"],w,O);Je.found&&(Oe=!1,_e.push({ts:performance.now(),bytes:me.length}))}var ye=c.findLastTopIsoBoxCompleted(["moov","mdat"],w,O);if(ye.found){var Fe=ye.lastCompletedOffset+ye.size;se===d.default.ABR_FETCH_THROUGHPUT_CALCULATION_MOOF_PARSING&&!Oe&&(Oe=!0,Me.push({ts:performance.now(),bytes:w.length}));var Be;Fe===w.length?(Be=w,w=new Uint8Array):(Be=new Uint8Array(w.subarray(0,Fe)),w=w.subarray(Fe)),Q.progress({data:Be.buffer,lengthComputable:!1,noTrace:!0}),O=0}else O=ye.lastCompletedOffset,F||(Q.progress({lengthComputable:!1,noTrace:!0}),F=!0)}k(Q,xe)};k(Q,Ne)}).catch(function(H){Q.onerror&&Q.onerror(H)})})}function k(Q,q){Q.reader.read().then(q).catch(function(Y){Q.onerror&&Q.response.status===200&&Q.onerror(Y)})}function X(Q,q){if(Q.length===0)return q;var Y=new Uint8Array(Q.length+q.length);return Y.set(Q),Y.set(q,Q.length),Y}function W(Q){if(Q.abortController)Q.abortController.abort();else if(Q.reader)try{Q.reader.cancel(),Q.onabort()}catch{}}function b(Q,q){try{if(Q=Q.filter(function($){return $.bytes>q/4/Q.length}),Q.length>1){var Y=0,J=(Q[Q.length-1].ts-Q[0].ts)/Q.length;return Q.forEach(function($,ae){var K=Q[ae+1];if(K){var ee=K.ts-$.ts;Y+=ee<J?ee:0}}),Y}return null}catch{return null}}function j(Q,q){try{var Y,J;Y=Q.filter(function(Z,H){return H<Q.length-1}),J=q.filter(function(Z,H){return H<q.length-1});var $=[];if(Y.length>1){for(var ae=0,K=0,ee=0;ee<Y.length;ee++)if(Y[ee]&&J[ee]){var se=J[ee].ts-Y[ee].ts;if(se>1)$.push(8*J[ee].bytes/se);else{K===0&&(K=Y[ee].ts);var ue=J[ee].ts-K;ue>1?($.push(8*ae/ue),ae=0,K=0):ae+=J[ee].bytes}}if($.length>0){var oe=$.reduce(function(Z,H){return Z+H},0);return oe/$.length}}return null}catch{return null}}return l={load:L,abort:W,calculateDownloadedTime:b,setup:S},l}v.__dashjs_factory_name="FetchLoader";var E=I.default.getClassFactory(v);const i=E},"./src/streaming/net/HTTPLoader.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>c});var I=e("./src/streaming/net/XHRLoader.js"),g=e("./src/streaming/net/FetchLoader.js"),d=e("./src/streaming/vo/metrics/HTTPRequest.js"),f=e("./src/core/FactoryMaker.js"),y=e("./src/streaming/vo/DashJSError.js"),_=e("./src/streaming/models/CmcdModel.js"),r=e("./src/streaming/models/CmsdModel.js"),T=e("./src/core/Utils.js"),M=e("./src/core/Debug.js"),p=e("./src/core/EventBus.js"),C=e("./src/core/events/Events.js"),v=e("./src/core/Settings.js"),E=e("./src/streaming/constants/Constants.js"),i=e("./src/streaming/models/LowLatencyThroughputModel.js"),t=e("./src/streaming/models/CustomParametersModel.js");function m(o,l,A){return l in o?Object.defineProperty(o,l,{value:A,enumerable:!0,configurable:!0,writable:!0}):o[l]=A,o}function n(o){o=o||{};var l=this.context,A=o.errHandler,S=o.dashMetrics,L=o.mediaPlayerModel,U=o.requestModifier,k=o.boxParser,X=o.errors,W=o.requestTimeout||0,b=(0,p.default)(l).getInstance(),j=(0,v.default)(l).getInstance(),Q,q,Y,J,$,ae,K,ee,se,ue;function oe(){var z;ue=(0,M.default)(l).getInstance().getLogger(Q),q=[],Y=[],J=[],ae=(0,_.default)(l).getInstance(),K=(0,r.default)(l).getInstance(),se=(0,i.default)(l).getInstance(),ee=(0,t.default)(l).getInstance(),$=(z={},m(z,d.HTTPRequest.MPD_TYPE,X.DOWNLOAD_ERROR_ID_MANIFEST_CODE),m(z,d.HTTPRequest.XLINK_EXPANSION_TYPE,X.DOWNLOAD_ERROR_ID_XLINK_CODE),m(z,d.HTTPRequest.INIT_SEGMENT_TYPE,X.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE),m(z,d.HTTPRequest.MEDIA_SEGMENT_TYPE,X.DOWNLOAD_ERROR_ID_CONTENT_CODE),m(z,d.HTTPRequest.INDEX_SEGMENT_TYPE,X.DOWNLOAD_ERROR_ID_CONTENT_CODE),m(z,d.HTTPRequest.BITSTREAM_SWITCHING_SEGMENT_TYPE,X.DOWNLOAD_ERROR_ID_CONTENT_CODE),m(z,d.HTTPRequest.OTHER_TYPE,X.DOWNLOAD_ERROR_ID_CONTENT_CODE),z)}function Z(z,R){var u=z.request,D=[],F=!0,w=!0,O=new Date,P=O,B=0,x=null,ne;if(!U||!S||!A)throw new Error("config object is not correct or missing");var re=function(Fe){if(w=!1,u.requestStartDate=O,u.requestEndDate=new Date,u.firstByteDate=u.firstByteDate||O,u.fileLoaderType=x,!u.checkExistenceOnly){var Be=ne.response?ne.response.responseURL:null,Ye=ne.response?ne.response.status:null,Ze=ne.response&&ne.response.getAllResponseHeaders?ne.response.getAllResponseHeaders():ne.response?ne.response.responseHeaders:null,tt=j.get().streaming.cmsd&&j.get().streaming.cmsd.enabled?K.parseResponseHeaders(Ze,u.mediaType):null;S.addHttpRequest(u,Be,Ye,Ze,Fe?D:null,tt),u.type===d.HTTPRequest.MPD_TYPE&&S.addManifestUpdate(u)}},G=function(){if(q.indexOf(ne)!==-1&&(q.splice(q.indexOf(ne),1),w))if(re(!1),R>0){try{if(j.get().streaming.utcSynchronization.enableBackgroundSyncAfterSegmentDownloadError&&u.type===d.HTTPRequest.MEDIA_SEGMENT_TYPE){var Fe=L.getRetryAttemptsForType(d.HTTPRequest.MEDIA_SEGMENT_TYPE);Fe===R&&b.trigger(C.default.ATTEMPT_BACKGROUND_SYNC)}}catch{}R--;var Be={config:z};J.push(Be),Be.timeout=setTimeout(function(){J.indexOf(Be)!==-1&&(J.splice(J.indexOf(Be),1),Z(z,R))},L.getRetryIntervalsForType(u.type))}else{if(u.type===d.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE)return;A.error(new y.default($[u.type],u.url+" is not available",{request:u,response:ne.response})),z.error&&z.error(u,"error",ne.response.statusText),z.complete&&z.complete(u,ne.response.statusText)}},fe=function(Fe){var Be=new Date;F&&(F=!1,(!Fe.lengthComputable||Fe.lengthComputable&&Fe.total!==Fe.loaded)&&(u.firstByteDate=Be)),Fe.lengthComputable&&(u.bytesLoaded=Fe.loaded,u.bytesTotal=Fe.total),Fe.noTrace||(D.push({s:P,d:Fe.time?Fe.time:Be.getTime()-P.getTime(),b:[Fe.loaded?Fe.loaded-B:0]}),P=Be,B=Fe.loaded),z.progress&&Fe&&z.progress(Fe)},le=function(){ne.response.status>=200&&ne.response.status<=299&&(re(!0),z.success&&z.success(ne.response.response,ne.response.statusText,ne.response.responseURL),z.complete&&z.complete(u,ne.response.statusText))},_e=function(){z.abort&&z.abort(u)},Me=function(Fe){var Be;if(Fe.lengthComputable){var Ye=Fe.loaded/Fe.total*100;Be="Request timeout: loaded: "+Fe.loaded+", out of: "+Fe.total+" : "+Ye.toFixed(3)+"% Completed"}else Be="Request timeout: non-computable download size";ue.warn(Be)},Oe;u.hasOwnProperty("availabilityTimeComplete")&&u.availabilityTimeComplete===!1&&window.fetch&&u.responseType==="arraybuffer"&&u.type===d.HTTPRequest.MEDIA_SEGMENT_TYPE?(Oe=(0,g.default)(l).create({requestModifier:U,lowLatencyThroughputModel:se,boxParser:k}),Oe.setup({dashMetrics:S}),x=E.default.FILE_LOADER_TYPES.FETCH):(Oe=(0,I.default)(l).create({requestModifier:U}),x=E.default.FILE_LOADER_TYPES.XHR);var Ne=null,xe=U.modifyRequestURL?U.modifyRequestURL(u.url):u.url;if(j.get().streaming.cmcd&&j.get().streaming.cmcd.enabled){var Se=j.get().streaming.cmcd.mode;if(Se===E.default.CMCD_MODE_QUERY){var me=H(u);xe=T.default.addAditionalQueryParameterToUrl(xe,me)}else Se===E.default.CMCD_MODE_HEADER&&(Ne=ae.getHeaderParameters(u))}u.url=xe;var Ae=u.checkExistenceOnly?d.HTTPRequest.HEAD:d.HTTPRequest.GET,He=ee.getXHRWithCredentialsForType(u.type);ne={url:xe,method:Ae,withCredentials:He,request:u,onload:le,onend:G,onerror:G,progress:fe,onabort:_e,ontimeout:Me,loader:Oe,timeout:W,headers:Ne};var Qe=new Date().getTime();if(isNaN(u.delayLoadingTime)||Qe>=u.delayLoadingTime)q.push(ne),Oe.load(ne);else{var Je={httpRequest:ne};Y.push(Je),Je.delayTimeout=setTimeout(function(){if(Y.indexOf(Je)!==-1){Y.splice(Y.indexOf(Je),1);try{O=new Date,P=O,q.push(Je.httpRequest),Oe.load(Je.httpRequest)}catch{Je.httpRequest.onerror()}}},u.delayLoadingTime-Qe)}}function H(z){try{var R=[],u=ae.getQueryParameter(z);return u&&R.push(u),R}catch{return[]}}function V(z){z.request?Z(z,L.getRetryAttemptsForType(z.request.type)):z.error&&z.error(z.request,"error")}function te(){J.forEach(function(z){clearTimeout(z.timeout),z.config.request&&z.config.abort&&z.config.abort(z.config.request)}),J=[],Y.forEach(function(z){return clearTimeout(z.delayTimeout)}),Y=[],q.forEach(function(z){z.request.type!==d.HTTPRequest.MSS_FRAGMENT_INFO_SEGMENT_TYPE&&(z.onloadend=z.onerror=z.onprogress=void 0,z.loader.abort(z))}),q=[]}return Q={load:V,abort:te},oe(),Q}n.__dashjs_factory_name="HTTPLoader";var h=f.default.getClassFactory(n);const c=h},"./src/streaming/net/SchemeLoaderFactory.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});var I=e("./src/core/FactoryMaker.js"),g=e("./src/streaming/net/HTTPLoader.js");function d(){var _,r;function T(i,t){r[i]=t}function M(i){r[i]&&delete r[i]}function p(){r={}}function C(i){for(var t in r)if(r.hasOwnProperty(t)&&i.startsWith(t))return r[t];return g.default}function v(){p()}function E(){v()}return E(),_={getLoader:C,registerLoader:T,unregisterLoader:M,unregisterAllLoader:p,reset:v},_}d.__dashjs_factory_name="SchemeLoaderFactory";var f=I.default.getSingletonFactory(d);const y=f},"./src/streaming/net/URLLoader.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});var I=e("./src/core/FactoryMaker.js"),g=e("./src/streaming/net/SchemeLoaderFactory.js");function d(_){_=_||{};var r=this.context,T,M,p;M=(0,g.default)(r).getInstance();function C(E){if(!p){var i=M.getLoader(E&&E.request?E.request.url:null);p=i(r).create({errHandler:_.errHandler,mediaPlayerModel:_.mediaPlayerModel,requestModifier:_.requestModifier,dashMetrics:_.dashMetrics,boxParser:_.boxParser?_.boxParser:null,constants:_.constants?_.constants:null,dashConstants:_.dashConstants?_.dashConstants:null,urlUtils:_.urlUtils?_.urlUtils:null,requestTimeout:isNaN(_.requestTimeout)?0:_.requestTimeout,errors:_.errors})}p.load(E)}function v(){p&&p.abort()}return T={load:C,abort:v},T}d.__dashjs_factory_name="URLLoader";var f=I.default.getClassFactory(d);const y=f},"./src/streaming/net/XHRLoader.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});var I=e("./src/core/FactoryMaker.js"),g=e("./src/streaming/utils/RequestModifier.js");function d(_){_=_||{};var r=_.requestModifier,T;function M(v){r&&r.modifyRequest?(0,g.modifyRequest)(v,r).then(function(){return p(v)}):p(v)}function p(v){var E=new Date,i=v.request,t=new XMLHttpRequest;if(t.open(v.method,v.url,!0),i.responseType&&(t.responseType=i.responseType),i.range&&t.setRequestHeader("Range","bytes="+i.range),i.requestStartDate||(i.requestStartDate=E),r&&r.modifyRequestHeader&&(t=r.modifyRequestHeader(t,{url:v.url})),v.headers)for(var m in v.headers){var n=v.headers[m];n&&t.setRequestHeader(m,n)}t.withCredentials=v.withCredentials,t.onload=v.onload,t.onloadend=v.onend,t.onerror=v.onerror,t.onprogress=v.progress,t.onabort=v.onabort,t.ontimeout=v.ontimeout,t.timeout=v.timeout,t.send(),v.response=t}function C(v){var E=v.response;E.onloadend=E.onerror=E.onprogress=void 0,E.abort()}return T={load:M,abort:C},T}d.__dashjs_factory_name="XHRLoader";var f=I.default.getClassFactory(d);const y=f},"./src/streaming/protection/CommonEncryption.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>_});function I(r,T){if(!(r instanceof T))throw new TypeError("Cannot call a class as a function")}function g(r,T){for(var M=0;M<T.length;M++){var p=T[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(r,p.key,p)}}function d(r,T,M){return T&&g(r.prototype,T),M&&g(r,M),r}var f={attributes:["Laurl","laurl"],prefixes:["clearkey","dashif"]},y=function(){function r(){I(this,r)}return d(r,null,[{key:"findCencContentProtection",value:function(M){for(var p=null,C=0;C<M.length;++C){var v=M[C];v.schemeIdUri.toLowerCase()==="urn:mpeg:dash:mp4protection:2011"&&(v.value.toLowerCase()==="cenc"||v.value.toLowerCase()==="cbcs")&&(p=v)}return p}},{key:"getPSSHData",value:function(M){var p=8,C=new DataView(M),v=C.getUint8(p);return p+=20,v>0&&(p+=4+16*C.getUint32(p)),p+=4,M.slice(p)}},{key:"getPSSHForKeySystem",value:function(M,p){var C=r.parsePSSHList(p);return M&&C.hasOwnProperty(M.uuid.toLowerCase())?C[M.uuid.toLowerCase()]:null}},{key:"parseInitDataFromContentProtection",value:function(M,p){return"pssh"in M?(M.pssh.__text=M.pssh.__text.replace(/\r?\n|\r/g,"").replace(/\s+/g,""),p.decodeArray(M.pssh.__text).buffer):null}},{key:"parsePSSHList",value:function(M){if(M==null)return[];for(var p=new DataView(M.buffer||M),C=!1,v={},E=0;!C;){var i=void 0,t=void 0,m=void 0,n=void 0,h=E;if(E>=p.buffer.byteLength)break;if(i=p.getUint32(E),t=E+i,E+=4,p.getUint32(E)!==1886614376){E=t;continue}if(E+=4,m=p.getUint8(E),m!==0&&m!==1){E=t;continue}E++,E+=3,n="";var c=void 0,o=void 0;for(c=0;c<4;c++)o=p.getUint8(E+c).toString(16),n+=o.length===1?"0"+o:o;for(E+=4,n+="-",c=0;c<2;c++)o=p.getUint8(E+c).toString(16),n+=o.length===1?"0"+o:o;for(E+=2,n+="-",c=0;c<2;c++)o=p.getUint8(E+c).toString(16),n+=o.length===1?"0"+o:o;for(E+=2,n+="-",c=0;c<2;c++)o=p.getUint8(E+c).toString(16),n+=o.length===1?"0"+o:o;for(E+=2,n+="-",c=0;c<6;c++)o=p.getUint8(E+c).toString(16),n+=o.length===1?"0"+o:o;E+=6,n=n.toLowerCase(),E+=4,v[n]=p.buffer.slice(h,t),E=t}return v}},{key:"getLicenseServerUrlFromMediaInfo",value:function(M,p){try{if(!M||M.length===0)return null;for(var C=0,v=null;C<M.length&&!v;){var E=M[C];if(E&&E.contentProtection&&E.contentProtection.length>0){var i=E.contentProtection.filter(function(l){return l.schemeIdUri&&l.schemeIdUri===p});if(i&&i.length>0)for(var t=0;t<i.length&&!v;){for(var m=i[t],n=0;n<f.attributes.length&&!v;){for(var h=0,c=f.attributes[n];h<f.prefixes.length&&!v;){var o=f.prefixes[h];m[c]&&m[c].__prefix&&m[c].__prefix===o&&m[c].__text&&(v=m[c].__text),h+=1}n+=1}t+=1}}C+=1}return v}catch{return null}}}]),r}();const _=y},"./src/streaming/protection/Protection.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>v});var I=e("./src/streaming/protection/controllers/ProtectionController.js"),g=e("./src/streaming/protection/controllers/ProtectionKeyController.js"),d=e("./src/streaming/protection/ProtectionEvents.js"),f=e("./src/streaming/protection/errors/ProtectionErrors.js"),y=e("./src/streaming/protection/models/ProtectionModel_21Jan2015.js"),_=e("./src/streaming/protection/models/ProtectionModel_3Feb2014.js"),r=e("./src/streaming/protection/models/ProtectionModel_01b.js"),T=[{generateKeyRequest:"generateKeyRequest",addKey:"addKey",cancelKeyRequest:"cancelKeyRequest",needkey:"needkey",keyerror:"keyerror",keyadded:"keyadded",keymessage:"keymessage"},{generateKeyRequest:"webkitGenerateKeyRequest",addKey:"webkitAddKey",cancelKeyRequest:"webkitCancelKeyRequest",needkey:"webkitneedkey",keyerror:"webkitkeyerror",keyadded:"webkitkeyadded",keymessage:"webkitkeymessage"}],M=[{setMediaKeys:"setMediaKeys",MediaKeys:"MediaKeys",release:"close",needkey:"needkey",error:"keyerror",message:"keymessage",ready:"keyadded",close:"keyclose"},{setMediaKeys:"msSetMediaKeys",MediaKeys:"MSMediaKeys",release:"close",needkey:"msneedkey",error:"mskeyerror",message:"mskeymessage",ready:"mskeyadded",close:"mskeyclose"}];function p(){var E,i=this.context;function t(h){var c=null,o=(0,g.default)(i).getInstance();o.setConfig({debug:h.debug,BASE64:h.BASE64,settings:h.settings}),o.initialize();var l=m(h);return!c&&l&&(c=(0,I.default)(i).create({protectionModel:l,protectionKeyController:o,eventBus:h.eventBus,debug:h.debug,events:h.events,BASE64:h.BASE64,constants:h.constants,cmcdModel:h.cmcdModel,customParametersModel:h.customParametersModel,settings:h.settings}),h.capabilities.setEncryptedMediaSupported(!0)),c}function m(h){var c=h.debug,o=c.getLogger(E),l=h.eventBus,A=h.errHandler,S=h.videoModel?h.videoModel.getElement():null;return(!S||S.onencrypted!==void 0)&&(!S||S.mediaKeys!==void 0)?(o.info("EME detected on this user agent! (ProtectionModel_21Jan2015)"),(0,y.default)(i).create({debug:c,eventBus:l,events:h.events})):n(S,M)?(o.info("EME detected on this user agent! (ProtectionModel_3Feb2014)"),(0,_.default)(i).create({debug:c,eventBus:l,events:h.events,api:n(S,M)})):n(S,T)?(o.info("EME detected on this user agent! (ProtectionModel_01b)"),(0,r.default)(i).create({debug:c,eventBus:l,errHandler:A,events:h.events,api:n(S,T)})):(o.warn("No supported version of EME detected on this user agent! - Attempts to play encrypted content will fail!"),null)}function n(h,c){for(var o=0;o<c.length;o++){var l=c[o];if(typeof h[l[Object.keys(l)[0]]]=="function")return l}return null}return E={createProtectionSystem:t},E}p.__dashjs_factory_name="Protection";var C=dashjs.FactoryMaker.getClassFactory(p);C.events=d.default,C.errors=f.default,dashjs.FactoryMaker.updateClassFactory(p.__dashjs_factory_name,C);const v=C},"./src/streaming/protection/ProtectionEvents.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>E});var I=e("./src/core/events/EventsBase.js");function g(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(m){return typeof m}:g=function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},g(i)}function d(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function f(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),t&&y(i,t)}function y(i,t){return y=Object.setPrototypeOf||function(n,h){return n.__proto__=h,n},y(i,t)}function _(i){var t=M();return function(){var n=p(i),h;if(t){var c=p(this).constructor;h=Reflect.construct(n,arguments,c)}else h=n.apply(this,arguments);return r(this,h)}}function r(i,t){return t&&(g(t)==="object"||typeof t=="function")?t:T(i)}function T(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function M(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function p(i){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)},p(i)}var C=function(i){f(m,i);var t=_(m);function m(){var n;return d(this,m),n=t.call(this),n.INTERNAL_KEY_MESSAGE="internalKeyMessage",n.INTERNAL_KEY_STATUS_CHANGED="internalkeyStatusChanged",n.KEY_ADDED="public_keyAdded",n.KEY_ERROR="public_keyError",n.KEY_MESSAGE="public_keyMessage",n.KEY_SESSION_CLOSED="public_keySessionClosed",n.KEY_SESSION_CREATED="public_keySessionCreated",n.KEY_SESSION_REMOVED="public_keySessionRemoved",n.KEY_STATUSES_CHANGED="public_keyStatusesChanged",n.KEY_SYSTEM_ACCESS_COMPLETE="public_keySystemAccessComplete",n.KEY_SYSTEM_SELECTED="public_keySystemSelected",n.LICENSE_REQUEST_COMPLETE="public_licenseRequestComplete",n.LICENSE_REQUEST_SENDING="public_licenseRequestSending",n.NEED_KEY="needkey",n.PROTECTION_CREATED="public_protectioncreated",n.PROTECTION_DESTROYED="public_protectiondestroyed",n.SERVER_CERTIFICATE_UPDATED="serverCertificateUpdated",n.TEARDOWN_COMPLETE="protectionTeardownComplete",n.VIDEO_ELEMENT_SELECTED="videoElementSelected",n.KEY_SESSION_UPDATED="public_keySessionUpdated",n}return m}(I.default),v=new C;const E=v},"./src/streaming/protection/controllers/ProtectionController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>c});var I=e("./src/streaming/protection/CommonEncryption.js"),g=e("./src/streaming/protection/vo/MediaCapability.js"),d=e("./src/streaming/protection/vo/KeySystemConfiguration.js"),f=e("./src/streaming/protection/errors/ProtectionErrors.js"),y=e("./src/streaming/vo/DashJSError.js"),_=e("./src/streaming/protection/vo/LicenseRequest.js"),r=e("./src/streaming/protection/vo/LicenseResponse.js"),T=e("./src/streaming/vo/metrics/HTTPRequest.js"),M=e("./src/core/Utils.js"),p=e("./src/streaming/constants/Constants.js"),C=e("./src/core/FactoryMaker.js");function v(o){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?v=function(A){return typeof A}:v=function(A){return A&&typeof Symbol=="function"&&A.constructor===Symbol&&A!==Symbol.prototype?"symbol":typeof A},v(o)}var E=5,i=500,t=3,m=1e3,n=8e3;function h(o){o=o||{};var l=o.protectionKeyController,A=o.protectionModel,S=o.eventBus,L=o.events,U=o.debug,k=o.BASE64,X=o.constants,W=[],b=o.cmcdModel,j=o.settings,Q=o.customParametersModel,q,Y,J,$,ae,K,ee,se,ue,oe,Z;function H(){Y=U.getLogger(q),J=[],$=[],K="temporary",ee="",oe=null,Z=null,S.on(L.INTERNAL_KEY_MESSAGE,Qe,q),S.on(L.INTERNAL_KEY_STATUS_CHANGED,He,q)}function V(){if(!S||!S.hasOwnProperty("on")||!l||!l.hasOwnProperty("getSupportedKeySystemsFromContentProtection"))throw new Error("Missing config parameter(s)")}function te(ie){if(!ie)throw new Error("mediaInfo can not be null or undefined");V(),$.push(ie)}function z(){if(!(!$||$.length===0)){var ie=[];$.forEach(function(he){var De=l.getSupportedKeySystemsFromContentProtection(he.contentProtection,ae,K);De.length>0&&(ie.length===0&&(ie=De),J.push(De))}),ie&&ie.length>0&&u(ie,!0)}}function R(ie){J.push(ie),u(ie,!1)}function u(ie,he){!se&&!ue?D(ie,he):se&&F()}function D(ie,he){if(!ue){ue=!0;var De=[];ie=ie.sort(function(Ve,rt){var ut=ae&&ae[Ve.ks.systemString]&&ae[Ve.ks.systemString].priority>=0?ae[Ve.ks.systemString].priority:ie.length,mt=ae&&ae[rt.ks.systemString]&&ae[rt.ks.systemString].priority>=0?ae[rt.ks.systemString].priority:ie.length;return ut-mt});for(var Ce=0;Ce<ie.length;Ce++){var We=Ae(ie[Ce]);De.push({ks:ie[Ce].ks,configs:[We],protData:ie[Ce].protData})}var Xe;A.requestKeySystemAccess(De).then(function(Ve){Xe=Ve.data;var rt=Xe.mksa&&Xe.mksa.selectedSystemString?Xe.mksa.selectedSystemString:Xe.keySystem.systemString;return Y.info("DRM: KeySystem Access Granted for system string ("+rt+")!  Selecting key system..."),A.selectKeySystem(Xe)}).then(function(Ve){if(se=Ve,ue=!1,!!A){S.trigger(L.KEY_SYSTEM_SELECTED,{data:Xe});var rt=B(se);rt&&rt.serverCertificate&&rt.serverCertificate.length>0&&A.setServerCertificate(k.decodeArray(rt.serverCertificate).buffer),F()}}).catch(function(Ve){se=null,ue=!1,he||S.trigger(L.KEY_SYSTEM_SELECTED,{data:null,error:new y.default(f.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE,f.default.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE+"Error selecting key system! -- "+Ve.error)})})}}function F(){for(var ie,he=0;he<J.length;he++)for(ie=0;ie<J[he].length;ie++)if(se===J[he][ie].ks){var De=J[he][ie];w(De);break}J=[]}function w(ie){if(l.isClearKey(se)&&ie.protData&&ie.protData.hasOwnProperty("clearkeys")&&Object.keys(ie.protData.clearkeys).length!==0){var he={kids:Object.keys(ie.protData.clearkeys)};ie.initData=new TextEncoder().encode(JSON.stringify(he))}ie.sessionId?O(ie):ie.initData!==null&&P(ie)}function O(ie){V(),A.loadKeySession(ie)}function P(ie){var he=I.default.getPSSHForKeySystem(se,ie?ie.initData:null);if(he){if(re(ie.keyId)||G(he))return;try{ie.initData=he,A.createKeySession(ie)}catch(De){S.trigger(L.KEY_SESSION_CREATED,{data:null,error:new y.default(f.default.KEY_SESSION_CREATED_ERROR_CODE,f.default.KEY_SESSION_CREATED_ERROR_MESSAGE+De.message)})}}else ie&&ie.initData?A.createKeySession(ie):S.trigger(L.KEY_SESSION_CREATED,{data:null,error:new y.default(f.default.KEY_SESSION_CREATED_ERROR_CODE,f.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Selected key system is "+(se?se.systemString:null)+".  needkey/encrypted event contains no initData corresponding to that key system!")})}function B(ie){if(ie){var he=ie.systemString;if(ae)return he in ae?ae[he]:null}return null}function x(){$=[]}function ne(ie){return V(),l.getSupportedKeySystemsFromContentProtection(ie,ae,K)}function re(ie){if(!ie)return!1;try{for(var he=A.getSessions(),De=0;De<he.length;De++)if(he[De].getKeyId()===ie)return!0;return!1}catch{return!1}}function G(ie){if(!ie)return!1;try{for(var he=A.getAllInitData(),De=0;De<he.length;De++)if(l.initDataEquals(ie,he[De]))return Y.debug("DRM: Ignoring initData because we have already seen it!"),!0;return!1}catch{return!1}}function fe(ie){V(),A.removeKeySession(ie)}function le(ie){V(),A.closeKeySession(ie)}function _e(ie){V(),A.setServerCertificate(ie)}function Me(ie){V(),ie?(A.setMediaElement(ie),S.on(L.NEED_KEY,ht,q)):ie===null&&(A.setMediaElement(ie),S.off(L.NEED_KEY,ht,q))}function Oe(ie){K=ie}function Ne(ie){ee=ie}function xe(ie){ae=ie,l.setProtectionData(ie)}function Se(){Be(),A&&A.stop()}function me(){S.off(L.INTERNAL_KEY_MESSAGE,Qe,q),S.off(L.INTERNAL_KEY_STATUS_CHANGED,He,q),V(),Be(),Me(null),se=null,ue=!1,A&&(A.reset(),A=null),W.forEach(function(ie){return clearTimeout(ie)}),W=[],$=[],J=[]}function Ae(ie){var he=ie.protData,De=[],Ce=[],We=he&&he.audioRobustness&&he.audioRobustness.length>0?he.audioRobustness:ee,Xe=he&&he.videoRobustness&&he.videoRobustness.length>0?he.videoRobustness:ee,Ve=ie.sessionType,rt=he&&he.distinctiveIdentifier?he.distinctiveIdentifier:"optional",ut=he&&he.persistentState?he.persistentState:Ve==="temporary"?"optional":"required";return $.forEach(function(mt){mt.type===X.AUDIO?De.push(new g.default(mt.codec,We)):mt.type===X.VIDEO&&Ce.push(new g.default(mt.codec,Xe))}),new d.default(De,Ce,rt,ut,[Ve])}function He(ie){ie.error?S.trigger(L.KEY_STATUSES_CHANGED,{data:null,error:ie.error}):Y.debug("DRM: key status = "+ie.status)}function Qe(ie){Y.debug("DRM: onKeyMessage");var he=ie.data;S.trigger(L.KEY_MESSAGE,{data:he});var De=he.messageType?he.messageType:"license-request",Ce=he.message,We=he.sessionToken,Xe=B(se),Ve=l.getLicenseServerModelInstance(se,Xe,De),rt={sessionToken:We,messageType:De};if(!Ce||Ce.byteLength===0){Je(rt,new y.default(f.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE,f.default.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE));return}if(!Ve){Y.debug("DRM: License server request not required for this message (type = "+ie.data.messageType+").  Session ID = "+We.getSessionId()),Je(rt);return}if(l.isClearKey(se)){var ut=l.processClearKeyLicenseRequest(se,Xe,Ce);if(ut&&ut.keyPairs&&ut.keyPairs.length>0){Y.debug("DRM: ClearKey license request handled by application!"),Je(rt),A.updateKeySession(We,ut);return}}ye(he,Ve,Xe)}function Je(ie,he){S.trigger(L.LICENSE_REQUEST_COMPLETE,{data:ie,error:he})}function ye(ie,he,De){var Ce=ie.sessionToken,We=ie.messageType?ie.messageType:"license-request",Xe={sessionToken:Ce,messageType:We},Ve=se?se.systemString:null,rt=Ye(De,We,Ce,ie,he);if(!rt){Je(Xe,new y.default(f.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE,f.default.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE));return}var ut={},mt=!1;De&&Ze(ut,De.httpRequestHeaders);var ve=ie.message,Le=se.getRequestHeadersFromMessage(ve);Ze(ut,Le),Object.keys(ut).forEach(function(Ie){Ie.toLowerCase()==="authorization"&&(mt=!0)}),De&&typeof De.withCredentials=="boolean"&&(mt=De.withCredentials);var Ge=function(Ke){if(A)if(Ke.status>=200&&Ke.status<=299){var it=M.default.parseHttpHeaders(Ke.getAllResponseHeaders?Ke.getAllResponseHeaders():null),pt=new r.default(Ke.responseURL,it,Ke.response),Et=Q.getLicenseResponseFilters();nt(Et,pt).then(function(){var gt=he.getLicenseMessage(pt.data,Ve,We);gt!==null?(Je(Xe),A.updateKeySession(Ce,gt)):tt(Ke,Xe,Ve,We,he)})}else tt(Ke,Xe,Ve,We,he)},at=function(Ke){Je(Xe,new y.default(f.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,f.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+Ve+' update, XHR aborted. status is "'+Ke.statusText+'" ('+Ke.status+"), readyState is "+Ke.readyState))},et=function(Ke){Je(Xe,new y.default(f.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,f.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+Ve+' update, XHR error. status is "'+Ke.statusText+'" ('+Ke.status+"), readyState is "+Ke.readyState))},lt=se.getLicenseRequestFromMessage(ve),vt=he.getHTTPMethod(We),Mt=he.getResponseType(Ve,We),Ct=De&&!isNaN(De.httpTimeout)?De.httpTimeout:n,de=Ce.getSessionId()||null,we=new _.default(rt,vt,Mt,ut,mt,We,de,lt),qe=isNaN(j.get().streaming.retryAttempts[T.HTTPRequest.LICENSE])?t:j.get().streaming.retryAttempts[T.HTTPRequest.LICENSE],Te=Q.getLicenseRequestFilters();nt(Te,we).then(function(){Fe(we,qe,Ct,Ge,at,et)})}function Fe(ie,he,De,Ce,We,Xe){var Ve=new XMLHttpRequest;if(j.get().streaming.cmcd&&j.get().streaming.cmcd.enabled){var rt=j.get().streaming.cmcd.mode;if(rt===p.default.CMCD_MODE_QUERY){var ut=b.getQueryParameter({url:ie.url,type:T.HTTPRequest.LICENSE});ut&&(ie.url=M.default.addAditionalQueryParameterToUrl(ie.url,[ut]))}}Ve.open(ie.method,ie.url,!0),Ve.responseType=ie.responseType,Ve.withCredentials=ie.withCredentials,De>0&&(Ve.timeout=De);for(var mt in ie.headers)Ve.setRequestHeader(mt,ie.headers[mt]);if(j.get().streaming.cmcd&&j.get().streaming.cmcd.enabled){var ve=j.get().streaming.cmcd.mode;if(ve===p.default.CMCD_MODE_HEADER){var Le=b.getHeaderParameters({url:ie.url,type:T.HTTPRequest.LICENSE});if(Le)for(var Ge in Le){var at=Le[Ge];at&&Ve.setRequestHeader(Ge,at)}}}var et=function(){he--;var vt=isNaN(j.get().streaming.retryIntervals[T.HTTPRequest.LICENSE])?m:j.get().streaming.retryIntervals[T.HTTPRequest.LICENSE];Z=setTimeout(function(){Fe(ie,he,De,Ce,We,Xe)},vt)};Ve.onload=function(){oe=null,this.status>=200&&this.status<=299||he<=0?Ce(this):(Y.warn("License request failed ("+this.status+"). Retrying it... Pending retries: "+he),et())},Ve.ontimeout=Ve.onerror=function(){oe=null,he<=0?Xe(this):(Y.warn("License request network request failed . Retrying it... Pending retries: "+he),et())},Ve.onabort=function(){We(this)},S.trigger(L.LICENSE_REQUEST_SENDING,{url:ie.url,headers:ie.headers,payload:ie.data,sessionId:ie.sessionId}),oe=Ve,Ve.send(ie.data)}function Be(){oe&&(oe.onloadend=oe.onerror=oe.onprogress=void 0,oe.abort(),oe=null),Z&&(clearTimeout(Z),Z=null)}function Ye(ie,he,De,Ce,We){var Xe=null,Ve=Ce.message;if(ie&&ie.serverURL){var rt=ie.serverURL;typeof rt=="string"&&rt!==""?Xe=rt:v(rt)==="object"&&rt.hasOwnProperty(he)&&(Xe=rt[he])}else if(ie&&ie.laURL&&ie.laURL!=="")Xe=ie.laURL;else if(Xe=I.default.getLicenseServerUrlFromMediaInfo($,se.schemeIdURI),!Xe&&!l.isClearKey(se)){var ut=I.default.getPSSHData(De.initData);Xe=se.getLicenseServerURLFromInitData(ut),Xe||(Xe=Ce.laURL)}return Xe=We.getServerURLFromMessage(Xe,Ve,he),Xe}function Ze(ie,he){if(he)for(var De in he)ie[De]=he[De]}function tt(ie,he,De,Ce,We){var Xe="NONE",Ve=null;ie.response&&(Xe=We.getErrorResponse(ie.response,De,Ce),Ve={serverResponse:ie.response||null,responseCode:ie.status||null,responseText:ie.statusText||null}),Je(he,new y.default(f.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE,f.default.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE+De+' update, XHR complete. status is "'+ie.statusText+'" ('+ie.status+"), readyState is "+ie.readyState+".  Response is "+Xe,Ve))}function nt(ie,he){return ie?ie.reduce(function(De,Ce){return De.then(function(){return Ce(he)})},Promise.resolve()):Promise.resolve()}function ht(ie,he){if(!j.get().streaming.protection.ignoreEmeEncryptedEvent){if(Y.debug("DRM: onNeedKey"),ie.key.initDataType!=="cenc"){Y.warn("DRM:  Only 'cenc' initData is supported!  Ignoring initData of type: "+ie.key.initDataType);return}if($.length===0&&(Y.warn("DRM: onNeedKey called before initializeForMedia, wait until initialized"),he=typeof he>"u"?1:he+1,he<E)){W.push(setTimeout(function(){ht(ie,he)},i));return}var De=ie.key.initData;if(ArrayBuffer.isView(De)&&(De=De.buffer),se){var Ce=I.default.getPSSHForKeySystem(se,De);if(Ce&&G(Ce))return}Y.debug("DRM: initData:",String.fromCharCode.apply(null,new Uint8Array(De)));var We=l.getSupportedKeySystemsFromSegmentPssh(De,ae,K);if(We.length===0){Y.debug("DRM: Received needkey event with initData, but we don't support any of the key systems!");return}R(We)}}function je(){return l?l.getKeySystems():[]}function ge(ie){l&&l.setKeySystems(ie)}return q={initializeForMedia:te,clearMediaInfoArray:x,handleKeySystemFromManifest:z,createKeySession:P,loadKeySession:O,removeKeySession:fe,closeKeySession:le,setServerCertificate:_e,setMediaElement:Me,setSessionType:Oe,setRobustnessLevel:Ne,setProtectionData:xe,getSupportedKeySystemsFromContentProtection:ne,getKeySystems:je,setKeySystems:ge,stop:Se,reset:me},H(),q}h.__dashjs_factory_name="ProtectionController";const c=C.default.getClassFactory(h)},"./src/streaming/protection/controllers/ProtectionKeyController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>v});var I=e("./src/streaming/protection/CommonEncryption.js"),g=e("./src/streaming/protection/drm/KeySystemClearKey.js"),d=e("./src/streaming/protection/drm/KeySystemW3CClearKey.js"),f=e("./src/streaming/protection/drm/KeySystemWidevine.js"),y=e("./src/streaming/protection/drm/KeySystemPlayReady.js"),_=e("./src/streaming/protection/servers/DRMToday.js"),r=e("./src/streaming/protection/servers/PlayReady.js"),T=e("./src/streaming/protection/servers/Widevine.js"),M=e("./src/streaming/protection/servers/ClearKey.js"),p=e("./src/streaming/constants/ProtectionConstants.js");function C(){var E=this.context,i,t,m,n,h,c,o,l;function A(K){K&&(K.debug&&(t=K.debug,m=t.getLogger(i)),K.BASE64&&(h=K.BASE64),K.settings&&(c=K.settings))}function S(){n=[];var K;K=(0,y.default)(E).getInstance({BASE64:h,settings:c}),n.push(K),K=(0,f.default)(E).getInstance({BASE64:h}),n.push(K),K=(0,g.default)(E).getInstance({BASE64:h}),n.push(K),o=K,K=(0,d.default)(E).getInstance({BASE64:h,debug:t}),n.push(K),l=K}function L(){return n}function U(K){n=K}function k(K){for(var ee=0;ee<n.length;ee++)if(n[ee].systemString===K)return n[ee];return null}function X(K){return K===o||K===l}function W(K,ee){if(K.byteLength===ee.byteLength){for(var se=new Uint8Array(K),ue=new Uint8Array(ee),oe=0;oe<se.length;oe++)if(se[oe]!==ue[oe])return!1;return!0}return!1}function b(K,ee,se){var ue,oe,Z,H,V=[];if(K){var te=I.default.findCencContentProtection(K);for(Z=0;Z<n.length;++Z){oe=n[Z];var z=J(oe.systemString,ee);for(H=0;H<K.length;++H)if(ue=K[H],ue.schemeIdUri.toLowerCase()===oe.schemeIdURI){var R=oe.getInitData(ue,te);V.push({ks:n[Z],keyId:ue.keyId,initData:R,protData:z,cdmData:oe.getCDMData(z?z.cdmData:null),sessionId:$(z,ue),sessionType:ae(z,se)})}}}return V}function j(K,ee,se){for(var ue=[],oe=I.default.parsePSSHList(K),Z,H,V=0;V<n.length;++V){Z=n[V],H=Z.systemString;var te=J(H,ee);Z.uuid in oe&&ue.push({ks:Z,initData:oe[Z.uuid],protData:te,cdmData:Z.getCDMData(te?te.cdmData:null),sessionId:$(te),sessionType:ae(te,se)})}return ue}function Q(K,ee,se){if(se==="license-release"||se==="individualization-request")return null;var ue=null;return ee&&ee.hasOwnProperty("drmtoday")?ue=(0,_.default)(E).getInstance({BASE64:h}):K.systemString===p.default.WIDEVINE_KEYSTEM_STRING?ue=(0,T.default)(E).getInstance():K.systemString===p.default.PLAYREADY_KEYSTEM_STRING?ue=(0,r.default)(E).getInstance():K.systemString===p.default.CLEARKEY_KEYSTEM_STRING&&(ue=(0,M.default)(E).getInstance()),ue}function q(K,ee,se){try{return K.getClearKeysFromProtectionData(ee,se)}catch{return m.error("Failed to retrieve clearkeys from ProtectionData"),null}}function Y(K){for(var ee=function(Z){var H=null;return K&&(H=Z in K?K[Z]:null),H},se=0;se<n.length;se++){var ue=n[se];ue.hasOwnProperty("init")&&ue.init(ee(ue.systemString))}}function J(K,ee){return ee&&K in ee?ee[K]:null}function $(K,ee){return K&&K.sessionId?K.sessionId:ee&&ee.sessionId?ee.sessionId:null}function ae(K,ee){return K&&K.sessionType?K.sessionType:ee}return i={initialize:S,setProtectionData:Y,isClearKey:X,initDataEquals:W,getKeySystems:L,setKeySystems:U,getKeySystemBySystemString:k,getSupportedKeySystemsFromContentProtection:b,getSupportedKeySystemsFromSegmentPssh:j,getLicenseServerModelInstance:Q,processClearKeyLicenseRequest:q,setConfig:A},i}C.__dashjs_factory_name="ProtectionKeyController";const v=dashjs.FactoryMaker.getSingletonFactory(C)},"./src/streaming/protection/drm/KeySystemClearKey.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>M});var I=e("./src/streaming/protection/vo/KeyPair.js"),g=e("./src/streaming/protection/vo/ClearKeyKeySet.js"),d=e("./src/streaming/protection/CommonEncryption.js"),f=e("./src/streaming/constants/ProtectionConstants.js"),y="e2719d58-a985-b3c9-781a-b030af78d30e",_=f.default.CLEARKEY_KEYSTEM_STRING,r="urn:uuid:"+y;function T(p){p=p||{};var C,v=p.BASE64;function E(o,l){var A=null;if(o){for(var S=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(l))),L=[],U=0;U<S.kids.length;U++){var k=S.kids[U],X=o.clearkeys&&o.clearkeys.hasOwnProperty(k)?o.clearkeys[k]:null;if(!X)throw new Error("DRM: ClearKey keyID ("+k+") is not known!");L.push(new I.default(k,X))}A=new g.default(L)}return A}function i(o,l){try{var A=d.default.parseInitDataFromContentProtection(o,v);if(!A&&l){var S=t(l["cenc:default_KID"]),L={kids:[S]};A=new TextEncoder().encode(JSON.stringify(L))}return A}catch{return null}}function t(o){try{var l=o.replace(/-/g,"");return l=btoa(l.match(/\w{2}/g).map(function(A){return String.fromCharCode(parseInt(A,16))}).join("")),l.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")}catch{return null}}function m(){return{"Content-Type":"application/json"}}function n(o){return JSON.stringify(JSON.parse(String.fromCharCode.apply(null,new Uint8Array(o))))}function h(){return null}function c(){return null}return C={uuid:y,schemeIdURI:r,systemString:_,getInitData:i,getRequestHeadersFromMessage:m,getLicenseRequestFromMessage:n,getLicenseServerURLFromInitData:h,getCDMData:c,getClearKeysFromProtectionData:E},C}T.__dashjs_factory_name="KeySystemClearKey";const M=dashjs.FactoryMaker.getSingletonFactory(T)},"./src/streaming/protection/drm/KeySystemPlayReady.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>T});var I=e("./src/streaming/protection/CommonEncryption.js"),g=e("./src/streaming/constants/ProtectionConstants.js"),d="9a04f079-9840-4286-ab92-e65be0885f95",f=g.default.PLAYREADY_KEYSTEM_STRING,y="urn:uuid:"+d,_='<PlayReadyCDMData type="LicenseAcquisition"><LicenseAcquisition version="1.0" Proactive="false"><CustomData encoding="base64encoded">%CUSTOMDATA%</CustomData></LicenseAcquisition></PlayReadyCDMData>';function r(M){M=M||{};var p,C="utf-16",v=M.BASE64,E=M.settings;function i(){if(!v||!v.hasOwnProperty("decodeArray")||!v.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}function t(l){var A,S,L={},U=new DOMParser;if(E&&E.get().streaming.protection.detectPlayreadyMessageFormat&&C==="utf-16"&&l&&l.byteLength%2===1)return L["Content-Type"]="text/xml; charset=utf-8",L;var k=C==="utf-16"?new Uint16Array(l):new Uint8Array(l);A=String.fromCharCode.apply(null,k),S=U.parseFromString(A,"application/xml");for(var X=S.getElementsByTagName("name"),W=S.getElementsByTagName("value"),b=0;b<X.length;b++)L[X[b].childNodes[0].nodeValue]=W[b].childNodes[0].nodeValue;return L.hasOwnProperty("Content")&&(L["Content-Type"]=L.Content,delete L.Content),L.hasOwnProperty("Content-Type")||(L["Content-Type"]="text/xml; charset=utf-8"),L}function m(l){var A=null,S=new DOMParser;if(E&&E.get().streaming.protection.detectPlayreadyMessageFormat&&C==="utf-16"&&l&&l.byteLength%2===1)return l;var L=C==="utf-16"?new Uint16Array(l):new Uint8Array(l);i();var U=String.fromCharCode.apply(null,L),k=S.parseFromString(U,"application/xml");if(k.getElementsByTagName("PlayReadyKeyMessage")[0]){var X=k.getElementsByTagName("Challenge")[0].childNodes[0].nodeValue;X&&(A=v.decode(X))}else return l;return A}function n(l){if(l)for(var A=new DataView(l),S=A.getUint16(4,!0),L=6,U=new DOMParser,k=0;k<S;k++){var X=A.getUint16(L,!0);L+=2;var W=A.getUint16(L,!0);if(L+=2,X!==1){L+=W;continue}var b=l.slice(L,L+W),j=String.fromCharCode.apply(null,new Uint16Array(b)),Q=U.parseFromString(j,"application/xml");if(Q.getElementsByTagName("LA_URL")[0]){var q=Q.getElementsByTagName("LA_URL")[0].childNodes[0].nodeValue;if(q)return q}if(Q.getElementsByTagName("LUI_URL")[0]){var Y=Q.getElementsByTagName("LUI_URL")[0].childNodes[0].nodeValue;if(Y)return Y}}return null}function h(l){var A=new Uint8Array([112,115,115,104,0,0,0,0]),S=new Uint8Array([154,4,240,121,152,64,66,134,171,146,230,91,224,136,95,149]),L=0,U=null,k,X,W,b,j;if(i(),!l)return null;if("pssh"in l)return I.default.parseInitDataFromContentProtection(l,v);if("pro"in l)U=v.decodeArray(l.pro.__text);else if("prheader"in l)U=v.decodeArray(l.prheader.__text);else return null;return k=U.length,X=4+A.length+S.length+4+k,W=new ArrayBuffer(X),b=new Uint8Array(W),j=new DataView(W),j.setUint32(L,X),L+=4,b.set(A,L),L+=A.length,b.set(S,L),L+=S.length,j.setUint32(L,k),L+=4,b.set(U,L),L+=k,b.buffer}function c(l){if(l!=="utf-8"&&l!=="utf-16")throw new Error('Specified message format is not one of "utf-8" or "utf-16"');C=l}function o(l){var A,S,L,U;if(i(),!l)return null;for(A=[],U=0;U<l.length;++U)A.push(l.charCodeAt(U)),A.push(0);for(A=String.fromCharCode.apply(null,A),A=v.encode(A),S=_.replace("%CUSTOMDATA%",A),L=[],U=0;U<S.length;++U)L.push(S.charCodeAt(U)),L.push(0);return new Uint8Array(L).buffer}return p={uuid:d,schemeIdURI:y,systemString:f,getInitData:h,getRequestHeadersFromMessage:t,getLicenseRequestFromMessage:m,getLicenseServerURLFromInitData:n,getCDMData:o,setPlayReadyMessageFormat:c},p}r.__dashjs_factory_name="KeySystemPlayReady";const T=dashjs.FactoryMaker.getSingletonFactory(r)},"./src/streaming/protection/drm/KeySystemW3CClearKey.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>M});var I=e("./src/streaming/protection/vo/KeyPair.js"),g=e("./src/streaming/protection/vo/ClearKeyKeySet.js"),d=e("./src/streaming/protection/CommonEncryption.js"),f=e("./src/streaming/constants/ProtectionConstants.js"),y="1077efec-c0b2-4d02-ace3-3c1e52e2fb4b",_=f.default.CLEARKEY_KEYSTEM_STRING,r="urn:uuid:"+y;function T(p){var C,v=p.BASE64,E=p.debug.getLogger(C);function i(o,l){var A=null;if(o){for(var S=JSON.parse(String.fromCharCode.apply(null,new Uint8Array(l))),L=[],U=0;U<S.kids.length;U++){var k=S.kids[U],X=o.clearkeys&&o.clearkeys.hasOwnProperty(k)?o.clearkeys[k]:null;if(!X)throw new Error("DRM: ClearKey keyID ("+k+") is not known!");L.push(new I.default(k,X))}A=new g.default(L),E.warn("ClearKey schemeIdURI is using W3C Common PSSH systemID (1077efec-c0b2-4d02-ace3-3c1e52e2fb4b) in Content Protection. See DASH-IF IOP v4.1 section 7.6.2.4")}return A}function t(o){return d.default.parseInitDataFromContentProtection(o,v)}function m(){return null}function n(o){return new Uint8Array(o)}function h(){return null}function c(){return null}return C={uuid:y,schemeIdURI:r,systemString:_,getInitData:t,getRequestHeadersFromMessage:m,getLicenseRequestFromMessage:n,getLicenseServerURLFromInitData:h,getCDMData:c,getClearKeysFromProtectionData:i},C}T.__dashjs_factory_name="KeySystemW3CClearKey";const M=dashjs.FactoryMaker.getSingletonFactory(T)},"./src/streaming/protection/drm/KeySystemWidevine.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>r});var I=e("./src/streaming/protection/CommonEncryption.js"),g=e("./src/streaming/constants/ProtectionConstants.js"),d="edef8ba9-79d6-4ace-a3c8-27dcd51d21ed",f=g.default.WIDEVINE_KEYSTEM_STRING,y="urn:uuid:"+d;function _(T){T=T||{};var M,p=T.BASE64;function C(m){return I.default.parseInitDataFromContentProtection(m,p)}function v(){return null}function E(m){return new Uint8Array(m)}function i(){return null}function t(){return null}return M={uuid:d,schemeIdURI:y,systemString:f,getInitData:C,getRequestHeadersFromMessage:v,getLicenseRequestFromMessage:E,getLicenseServerURLFromInitData:i,getCDMData:t},M}_.__dashjs_factory_name="KeySystemWidevine";const r=dashjs.FactoryMaker.getSingletonFactory(_)},"./src/streaming/protection/errors/ProtectionErrors.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>E});var I=e("./src/core/errors/ErrorsBase.js");function g(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(m){return typeof m}:g=function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},g(i)}function d(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function f(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),t&&y(i,t)}function y(i,t){return y=Object.setPrototypeOf||function(n,h){return n.__proto__=h,n},y(i,t)}function _(i){var t=M();return function(){var n=p(i),h;if(t){var c=p(this).constructor;h=Reflect.construct(n,arguments,c)}else h=n.apply(this,arguments);return r(this,h)}}function r(i,t){return t&&(g(t)==="object"||typeof t=="function")?t:T(i)}function T(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function M(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function p(i){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)},p(i)}var C=function(i){f(m,i);var t=_(m);function m(){var n;return d(this,m),n=t.call(this),n.MEDIA_KEYERR_CODE=100,n.MEDIA_KEYERR_UNKNOWN_CODE=101,n.MEDIA_KEYERR_CLIENT_CODE=102,n.MEDIA_KEYERR_SERVICE_CODE=103,n.MEDIA_KEYERR_OUTPUT_CODE=104,n.MEDIA_KEYERR_HARDWARECHANGE_CODE=105,n.MEDIA_KEYERR_DOMAIN_CODE=106,n.MEDIA_KEY_MESSAGE_ERROR_CODE=107,n.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_CODE=108,n.SERVER_CERTIFICATE_UPDATED_ERROR_CODE=109,n.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE=110,n.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_CODE=111,n.KEY_SYSTEM_ACCESS_DENIED_ERROR_CODE=112,n.KEY_SESSION_CREATED_ERROR_CODE=113,n.MEDIA_KEY_MESSAGE_LICENSER_ERROR_CODE=114,n.MEDIA_KEYERR_UNKNOWN_MESSAGE="An unspecified error occurred. This value is used for errors that don't match any of the other codes.",n.MEDIA_KEYERR_CLIENT_MESSAGE="The Key System could not be installed or updated.",n.MEDIA_KEYERR_SERVICE_MESSAGE="The message passed into update indicated an error from the license service.",n.MEDIA_KEYERR_OUTPUT_MESSAGE="There is no available output device with the required characteristics for the content protection system.",n.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE="A hardware configuration change caused a content protection error.",n.MEDIA_KEYERR_DOMAIN_MESSAGE="An error occurred in a multi-device domain licensing configuration. The most common error is a failure to join the domain.",n.MEDIA_KEY_MESSAGE_ERROR_MESSAGE="Multiple key sessions were creates with a user-agent that does not support sessionIDs!! Unpredictable behavior ahead!",n.MEDIA_KEY_MESSAGE_NO_CHALLENGE_ERROR_MESSAGE="DRM: Empty key message from CDM",n.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE="Error updating server certificate -- ",n.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE="DRM: KeyStatusChange error! -- License has expired",n.MEDIA_KEY_MESSAGE_NO_LICENSE_SERVER_URL_ERROR_MESSAGE="DRM: No license server URL specified!",n.KEY_SYSTEM_ACCESS_DENIED_ERROR_MESSAGE="DRM: KeySystem Access Denied! -- ",n.KEY_SESSION_CREATED_ERROR_MESSAGE="DRM: unable to create session! --",n.MEDIA_KEY_MESSAGE_LICENSER_ERROR_MESSAGE="DRM: licenser error! --",n}return m}(I.default),v=new C;const E=v},"./src/streaming/protection/models/ProtectionModel_01b.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>M});var I=e("./src/streaming/protection/controllers/ProtectionKeyController.js"),g=e("./src/streaming/protection/vo/NeedKey.js"),d=e("./src/streaming/vo/DashJSError.js"),f=e("./src/streaming/protection/vo/KeyMessage.js"),y=e("./src/streaming/protection/vo/KeySystemConfiguration.js"),_=e("./src/streaming/protection/vo/KeySystemAccess.js"),r=e("./src/streaming/protection/errors/ProtectionErrors.js");function T(p){p=p||{};var C=this.context,v=p.eventBus,E=p.events,i=p.debug,t=p.api,m=p.errHandler,n,h,c,o,l,A,S,L,U;function k(){h=i.getLogger(n),c=null,o=null,A=[],S=[],l=(0,I.default)(C).getInstance(),U=se()}function X(){c&&oe();for(var Z=0;Z<S.length;Z++)$(S[Z]);v.trigger(E.TEARDOWN_COMPLETE)}function W(){for(var Z=[],H=0;H<A.length;H++)Z.push(A[H].initData);for(var V=0;V<S.length;V++)Z.push(S[V].initData);return Z}function b(){return S.concat(A)}function j(Z){return new Promise(function(H,V){var te=c;te||(te=document.createElement("video"));for(var z=!1,R=0;R<Z.length;R++)for(var u=Z[R].ks.systemString,D=Z[R].configs,F=null,w=null,O=0;O<D.length;O++){var P=D[O].videoCapabilities;if(P&&P.length!==0){w=[];for(var B=0;B<P.length;B++)te.canPlayType(P[B].contentType,u)!==""&&w.push(P[B])}if(!(!F&&!w||F&&F.length===0||w&&w.length===0)){z=!0;var x=new y.default(F,w),ne=l.getKeySystemBySystemString(u),re=new _.default(ne,x);v.trigger(E.KEY_SYSTEM_ACCESS_COMPLETE,{data:re}),H({data:re});break}}if(!z){var G="Key system access denied! -- No valid audio/video content configurations detected!";v.trigger(E.KEY_SYSTEM_ACCESS_COMPLETE,{error:G}),V({error:G})}})}function Q(Z){return o=Z.keySystem,Promise.resolve(o)}function q(Z){if(c!==Z){if(c){oe();for(var H=0;H<S.length;H++)$(S[H]);S=[]}c=Z,c&&(c.addEventListener(t.keyerror,U),c.addEventListener(t.needkey,U),c.addEventListener(t.keymessage,U),c.addEventListener(t.keyadded,U),v.trigger(E.VIDEO_ELEMENT_SELECTED))}}function Y(Z){if(!o)throw new Error("Can not create sessions until you have selected a key system");if(L||S.length===0){var H={sessionId:null,keyId:Z.keyId,initData:Z.initData,getKeyId:function(){return this.keyId},getSessionId:function(){return this.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"}};return A.push(H),c[t.generateKeyRequest](o.systemString,new Uint8Array(Z.initData)),H}else throw new Error("Multiple sessions not allowed!")}function J(Z,H){var V=Z.sessionId;if(!l.isClearKey(o))c[t.addKey](o.systemString,new Uint8Array(H),new Uint8Array(Z.initData),V);else for(var te=0;te<H.keyPairs.length;te++)c[t.addKey](o.systemString,H.keyPairs[te].key,H.keyPairs[te].keyID,V);v.trigger(E.KEY_SESSION_UPDATED)}function $(Z){try{c[t.cancelKeyRequest](o.systemString,Z.sessionId)}catch(H){v.trigger(E.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+Z.sessionId+") "+H.message})}}function ae(){}function K(){}function ee(){}function se(){return{handleEvent:function(H){var V=null;switch(H.type){case t.needkey:var te=ArrayBuffer.isView(H.initData)?H.initData.buffer:H.initData;v.trigger(E.NEED_KEY,{key:new g.default(te,"cenc")});break;case t.keyerror:if(V=ue(S,H.sessionId),V||(V=ue(A,H.sessionId)),V){var z=r.default.MEDIA_KEYERR_CODE,R="";switch(H.errorCode.code){case 1:z=r.default.MEDIA_KEYERR_UNKNOWN_CODE,R+="MEDIA_KEYERR_UNKNOWN - "+r.default.MEDIA_KEYERR_UNKNOWN_MESSAGE;break;case 2:z=r.default.MEDIA_KEYERR_CLIENT_CODE,R+="MEDIA_KEYERR_CLIENT - "+r.default.MEDIA_KEYERR_CLIENT_MESSAGE;break;case 3:z=r.default.MEDIA_KEYERR_SERVICE_CODE,R+="MEDIA_KEYERR_SERVICE - "+r.default.MEDIA_KEYERR_SERVICE_MESSAGE;break;case 4:z=r.default.MEDIA_KEYERR_OUTPUT_CODE,R+="MEDIA_KEYERR_OUTPUT - "+r.default.MEDIA_KEYERR_OUTPUT_MESSAGE;break;case 5:z=r.default.MEDIA_KEYERR_HARDWARECHANGE_CODE,R+="MEDIA_KEYERR_HARDWARECHANGE - "+r.default.MEDIA_KEYERR_HARDWARECHANGE_MESSAGE;break;case 6:z=r.default.MEDIA_KEYERR_DOMAIN_CODE,R+="MEDIA_KEYERR_DOMAIN - "+r.default.MEDIA_KEYERR_DOMAIN_MESSAGE;break}R+="  System Code = "+H.systemCode,v.trigger(E.KEY_ERROR,{error:new d.default(z,R,V)})}else h.error("No session token found for key error");break;case t.keyadded:V=ue(S,H.sessionId),V||(V=ue(A,H.sessionId)),V?(h.debug("DRM: Key added."),v.trigger(E.KEY_ADDED,{data:V})):h.debug("No session token found for key added");break;case t.keymessage:if(L=H.sessionId!==null&&H.sessionId!==void 0,L?(V=ue(S,H.sessionId),!V&&A.length>0&&(V=A.shift(),S.push(V),V.sessionId=H.sessionId,v.trigger(E.KEY_SESSION_CREATED,{data:V}))):A.length>0&&(V=A.shift(),S.push(V),A.length!==0&&m.error(new d.default(r.default.MEDIA_KEY_MESSAGE_ERROR_CODE,r.default.MEDIA_KEY_MESSAGE_ERROR_MESSAGE))),V){var u=ArrayBuffer.isView(H.message)?H.message.buffer:H.message;V.keyMessage=u,v.trigger(E.INTERNAL_KEY_MESSAGE,{data:new f.default(V,u,H.defaultURL)})}else h.warn("No session token found for key message");break}}}}function ue(Z,H){if(!H||!Z)return null;for(var V=Z.length,te=0;te<V;te++)if(Z[te].sessionId==H)return Z[te];return null}function oe(){c.removeEventListener(t.keyerror,U),c.removeEventListener(t.needkey,U),c.removeEventListener(t.keymessage,U),c.removeEventListener(t.keyadded,U)}return n={getAllInitData:W,getSessions:b,requestKeySystemAccess:j,selectKeySystem:Q,setMediaElement:q,createKeySession:Y,updateKeySession:J,closeKeySession:$,setServerCertificate:ae,loadKeySession:K,removeKeySession:ee,stop:X,reset:X},k(),n}T.__dashjs_factory_name="ProtectionModel_01b";const M=dashjs.FactoryMaker.getClassFactory(T)},"./src/streaming/protection/models/ProtectionModel_21Jan2015.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>p});var I=e("./src/streaming/protection/controllers/ProtectionKeyController.js"),g=e("./src/streaming/protection/vo/NeedKey.js"),d=e("./src/streaming/protection/errors/ProtectionErrors.js"),f=e("./src/streaming/vo/DashJSError.js"),y=e("./src/streaming/protection/vo/KeyMessage.js"),_=e("./src/streaming/protection/vo/KeySystemAccess.js"),r=e("./src/streaming/constants/ProtectionConstants.js"),T={};T[r.default.PLAYREADY_KEYSTEM_STRING]=[r.default.PLAYREADY_KEYSTEM_STRING,r.default.PLAYREADY_RECOMMENDATION_KEYSTEM_STRING],T[r.default.WIDEVINE_KEYSTEM_STRING]=[r.default.WIDEVINE_KEYSTEM_STRING],T[r.default.CLEARKEY_KEYSTEM_STRING]=[r.default.CLEARKEY_KEYSTEM_STRING];function M(C){C=C||{};var v=this.context,E=C.eventBus,i=C.events,t=C.debug,m,n,h,c,o,l,A,S;function L(){n=t.getLogger(m),h=null,c=null,o=null,l=[],S=(0,I.default)(v).getInstance(),A=Z()}function U(){var z=l.length,R;z!==0?function(){for(var u=function(w){H(w),l.length===0&&(c?(c.removeEventListener("encrypted",A),c.setMediaKeys(null).then(function(){E.trigger(i.TEARDOWN_COMPLETE)})):E.trigger(i.TEARDOWN_COMPLETE))},D=0;D<z;D++)R=l[D],function(F){R.session.closed.then(function(){u(F)}),oe(R).catch(function(){u(F)})}(R)}():E.trigger(i.TEARDOWN_COMPLETE)}function k(){for(var z,R=0;R<l.length;R++)z=l[R],z.getUsable()||oe(z).catch(function(){H(z)})}function X(){for(var z=[],R=0;R<l.length;R++)l[R].initData&&z.push(l[R].initData);return z}function W(){return l}function b(z){return new Promise(function(R,u){j(z,0,R,u)})}function j(z,R,u,D){if(navigator.requestMediaKeySystemAccess===void 0||typeof navigator.requestMediaKeySystemAccess!="function"){var F="Insecure origins are not allowed";E.trigger(i.KEY_SYSTEM_ACCESS_COMPLETE,{error:F}),D({error:F});return}var w=z[R].protData&&z[R].protData.systemStringPriority?z[R].protData.systemStringPriority:null,O=z[R].configs,P=z[R].ks,B=P.systemString,x=w||(T[B]?T[B]:[B]);Q(x,O).then(function(ne){var re=typeof ne.getConfiguration=="function"?ne.getConfiguration():null,G=new _.default(P,re);G.mksa=ne,E.trigger(i.KEY_SYSTEM_ACCESS_COMPLETE,{data:G}),u({data:G})}).catch(function(ne){if(R+1<z.length)j(z,R+1,u,D);else{var re="Key system access denied! ";E.trigger(i.KEY_SYSTEM_ACCESS_COMPLETE,{error:re+ne.message}),D({error:re+ne.message})}})}function Q(z,R){return new Promise(function(u,D){q(z,R,0,u,D)})}function q(z,R,u,D,F){var w=z[u];n.debug("Requesting key system access for system string ".concat(w)),navigator.requestMediaKeySystemAccess(w,R).then(function(O){O.selectedSystemString=w,D(O)}).catch(function(O){u+1<z.length?q(z,R,u+1,D,F):F(O)})}function Y(z){return new Promise(function(R,u){z.mksa.createMediaKeys().then(function(D){return h=z.keySystem,o=D,c?c.setMediaKeys(o):Promise.resolve()}).then(function(){R(h)}).catch(function(){u({error:"Error selecting keys system ("+z.keySystem.systemString+")! Could not create MediaKeys -- TODO"})})})}function J(z){c!==z&&(c&&(c.removeEventListener("encrypted",A),c.setMediaKeys&&c.setMediaKeys(null)),c=z,c&&(c.addEventListener("encrypted",A),c.setMediaKeys&&o&&c.setMediaKeys(o)))}function $(z){if(!h||!o)throw new Error("Can not set server certificate until you have selected a key system");o.setServerCertificate(z).then(function(){n.info("DRM: License server certificate successfully updated."),E.trigger(i.SERVER_CERTIFICATE_UPDATED)}).catch(function(R){E.trigger(i.SERVER_CERTIFICATE_UPDATED,{error:new f.default(d.default.SERVER_CERTIFICATE_UPDATED_ERROR_CODE,d.default.SERVER_CERTIFICATE_UPDATED_ERROR_MESSAGE+R.name)})})}function ae(z){if(!h||!o)throw new Error("Can not create sessions until you have selected a key system");var R=o.createSession(z.sessionType),u=te(R,z),D=h.systemString===r.default.CLEARKEY_KEYSTEM_STRING&&(z.initData||z.protData&&z.protData.clearkeys)?r.default.INITIALIZATION_DATA_TYPE_KEYIDS:r.default.INITIALIZATION_DATA_TYPE_CENC;R.generateRequest(D,z.initData).then(function(){n.debug("DRM: Session created.  SessionID = "+u.getSessionId()),E.trigger(i.KEY_SESSION_CREATED,{data:u})}).catch(function(F){H(u),E.trigger(i.KEY_SESSION_CREATED,{data:null,error:new f.default(d.default.KEY_SESSION_CREATED_ERROR_CODE,d.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Error generating key request -- "+F.name)})})}function K(z,R){var u=z.session;S.isClearKey(h)&&(R=R.toJWK()),u.update(R).then(function(){E.trigger(i.KEY_SESSION_UPDATED)}).catch(function(D){E.trigger(i.KEY_ERROR,{error:new f.default(d.default.MEDIA_KEYERR_CODE,"Error sending update() message! "+D.name,z)})})}function ee(z){if(!h||!o)throw new Error("Can not load sessions until you have selected a key system");for(var R=z.sessionId,u=0;u<l.length;u++)if(R===l[u].sessionId){n.warn("DRM: Ignoring session ID because we have already seen it!");return}var D=o.createSession(z.sessionType),F=te(D,z);D.load(R).then(function(w){w?(n.debug("DRM: Session loaded.  SessionID = "+F.getSessionId()),E.trigger(i.KEY_SESSION_CREATED,{data:F})):(H(F),E.trigger(i.KEY_SESSION_CREATED,{data:null,error:new f.default(d.default.KEY_SESSION_CREATED_ERROR_CODE,d.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session! Invalid Session ID ("+R+")")}))}).catch(function(w){H(F),E.trigger(i.KEY_SESSION_CREATED,{data:null,error:new f.default(d.default.KEY_SESSION_CREATED_ERROR_CODE,d.default.KEY_SESSION_CREATED_ERROR_MESSAGE+"Could not load session ("+R+")! "+w.name)})})}function se(z){var R=z.session;R.remove().then(function(){n.debug("DRM: Session removed.  SessionID = "+z.getSessionId()),E.trigger(i.KEY_SESSION_REMOVED,{data:z.getSessionId()})},function(u){E.trigger(i.KEY_SESSION_REMOVED,{data:null,error:"Error removing session ("+z.getSessionId()+"). "+u.name})})}function ue(z){oe(z).catch(function(R){H(z),E.trigger(i.KEY_SESSION_CLOSED,{data:null,error:"Error closing session ("+z.getSessionId()+") "+R.name})})}function oe(z){var R=z.session;return R.removeEventListener("keystatuseschange",z),R.removeEventListener("message",z),R.close()}function Z(){return{handleEvent:function(R){switch(R.type){case"encrypted":if(R.initData){var u=ArrayBuffer.isView(R.initData)?R.initData.buffer:R.initData;E.trigger(i.NEED_KEY,{key:new g.default(u,R.initDataType)})}break}}}}function H(z){for(var R=0;R<l.length;R++)if(l[R]===z){l.splice(R,1);break}}function V(z){var R,u;return z&&z.length>0&&(z[0]&&(typeof z[0]=="string"?R=z[0]:u=z[0]),z[1]&&(typeof z[1]=="string"?R=z[1]:u=z[1])),{status:R,keyId:u}}function te(z,R){var u={session:z,keyId:R.keyId,initData:R.initData,sessionId:R.sessionId,sessionType:R.sessionType,handleEvent:function(F){switch(F.type){case"keystatuseschange":E.trigger(i.KEY_STATUSES_CHANGED,{data:this}),F.target.keyStatuses.forEach(function(){var O=V(arguments);switch(O.status){case"expired":E.trigger(i.INTERNAL_KEY_STATUS_CHANGED,{error:new f.default(d.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_CODE,d.default.KEY_STATUS_CHANGED_EXPIRED_ERROR_MESSAGE)});break;default:E.trigger(i.INTERNAL_KEY_STATUS_CHANGED,O);break}});break;case"message":var w=ArrayBuffer.isView(F.message)?F.message.buffer:F.message;E.trigger(i.INTERNAL_KEY_MESSAGE,{data:new y.default(this,w,void 0,F.messageType)});break}},getKeyId:function(){return this.keyId},getSessionId:function(){return z.sessionId},getSessionType:function(){return this.sessionType},getExpirationTime:function(){return z.expiration},getKeyStatuses:function(){return z.keyStatuses},getUsable:function(){var F=!1;return z.keyStatuses.forEach(function(){var w=V(arguments);w.status==="usable"&&(F=!0)}),F}};return z.addEventListener("keystatuseschange",u),z.addEventListener("message",u),z.closed.then(function(){H(u),n.debug("DRM: Session closed.  SessionID = "+u.getSessionId()),E.trigger(i.KEY_SESSION_CLOSED,{data:u.getSessionId()})}),l.push(u),u}return m={getAllInitData:X,getSessions:W,requestKeySystemAccess:b,selectKeySystem:Y,setMediaElement:J,setServerCertificate:$,createKeySession:ae,updateKeySession:K,loadKeySession:ee,removeKeySession:se,closeKeySession:ue,stop:k,reset:U},L(),m}M.__dashjs_factory_name="ProtectionModel_21Jan2015";const p=dashjs.FactoryMaker.getClassFactory(M)},"./src/streaming/protection/models/ProtectionModel_3Feb2014.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>M});var I=e("./src/streaming/protection/controllers/ProtectionKeyController.js"),g=e("./src/streaming/protection/vo/NeedKey.js"),d=e("./src/streaming/vo/DashJSError.js"),f=e("./src/streaming/protection/errors/ProtectionErrors.js"),y=e("./src/streaming/protection/vo/KeyMessage.js"),_=e("./src/streaming/protection/vo/KeySystemConfiguration.js"),r=e("./src/streaming/protection/vo/KeySystemAccess.js");function T(p){p=p||{};var C=this.context,v=p.eventBus,E=p.events,i=p.debug,t=p.api,m,n,h,c,o,l,A,S,L;function U(){n=i.getLogger(m),h=null,c=null,o=null,l=null,A=[],L=(0,I.default)(C).getInstance(),S=ee()}function k(){try{for(var oe=0;oe<A.length;oe++)J(A[oe]);h&&h.removeEventListener(t.needkey,S),v.trigger(E.TEARDOWN_COMPLETE)}catch(Z){v.trigger(E.TEARDOWN_COMPLETE,{error:"Error tearing down key sessions and MediaKeys! -- "+Z.message})}}function X(){for(var oe=[],Z=0;Z<A.length;Z++)oe.push(A[Z].initData);return oe}function W(){return A}function b(oe){return new Promise(function(Z,H){for(var V=!1,te=0;te<oe.length;te++)for(var z=oe[te].ks.systemString,R=oe[te].configs,u=null,D=null,F=0;F<R.length;F++){var w=R[F].audioCapabilities,O=R[F].videoCapabilities;if(w&&w.length!==0){u=[];for(var P=0;P<w.length;P++)window[t.MediaKeys].isTypeSupported(z,w[P].contentType)&&u.push(w[P])}if(O&&O.length!==0){D=[];for(var B=0;B<O.length;B++)window[t.MediaKeys].isTypeSupported(z,O[B].contentType)&&D.push(O[B])}if(!(!u&&!D||u&&u.length===0||D&&D.length===0)){V=!0;var x=new _.default(u,D),ne=L.getKeySystemBySystemString(z),re=new r.default(ne,x);v.trigger(E.KEY_SYSTEM_ACCESS_COMPLETE,{data:re}),Z({data:re});break}}if(!V){var G="Key system access denied! -- No valid audio/video content configurations detected!";v.trigger(E.KEY_SYSTEM_ACCESS_COMPLETE,{error:G}),H({error:G})}})}function j(oe){return new Promise(function(Z,H){try{o=oe.mediaKeys=new window[t.MediaKeys](oe.keySystem.systemString),c=oe.keySystem,l=oe,h&&se(),Z(c)}catch{H({error:"Error selecting keys system ("+c.systemString+")! Could not create MediaKeys -- TODO"})}})}function Q(oe){h!==oe&&(h&&h.removeEventListener(t.needkey,S),h=oe,h&&(h.addEventListener(t.needkey,S),o&&se()))}function q(oe){if(!c||!o||!l)throw new Error("Can not create sessions until you have selected a key system");var Z=null;if(l.ksConfiguration.videoCapabilities&&l.ksConfiguration.videoCapabilities.length>0&&(Z=l.ksConfiguration.videoCapabilities[0]),Z===null&&l.ksConfiguration.audioCapabilities&&l.ksConfiguration.audioCapabilities.length>0&&(Z=l.ksConfiguration.audioCapabilities[0]),Z===null)throw new Error("Can not create sessions for unknown content types.");var H=Z.contentType,V=o.createSession(H,new Uint8Array(oe.initData),oe.cdmData?new Uint8Array(oe.cdmData):null),te=ue(V,oe);V.addEventListener(t.error,te),V.addEventListener(t.message,te),V.addEventListener(t.ready,te),V.addEventListener(t.close,te),A.push(te),n.debug("DRM: Session created.  SessionID = "+te.getSessionId()),v.trigger(E.KEY_SESSION_CREATED,{data:te})}function Y(oe,Z){var H=oe.session;L.isClearKey(c)?H.update(new Uint8Array(Z.toJWK())):H.update(new Uint8Array(Z)),v.trigger(E.KEY_SESSION_UPDATED)}function J(oe){var Z=oe.session;Z.removeEventListener(t.error,oe),Z.removeEventListener(t.message,oe),Z.removeEventListener(t.ready,oe),Z.removeEventListener(t.close,oe);for(var H=0;H<A.length;H++)if(A[H]===oe){A.splice(H,1);break}Z[t.release]()}function $(){}function ae(){}function K(){}function ee(){return{handleEvent:function(Z){switch(Z.type){case t.needkey:if(Z.initData){var H=ArrayBuffer.isView(Z.initData)?Z.initData.buffer:Z.initData;v.trigger(E.NEED_KEY,{key:new g.default(H,"cenc")})}break}}}}function se(){var oe=null,Z=function(){h.removeEventListener("loadedmetadata",oe),h[t.setMediaKeys](o),v.trigger(E.VIDEO_ELEMENT_SELECTED)};h.readyState>=1?Z():(oe=Z.bind(this),h.addEventListener("loadedmetadata",oe))}function ue(oe,Z){return{session:oe,keyId:Z.keyId,initData:Z.initData,getKeyId:function(){return this.keyId},getSessionId:function(){return this.session.sessionId},getExpirationTime:function(){return NaN},getSessionType:function(){return"temporary"},handleEvent:function(V){switch(V.type){case t.error:var te="KeyError";v.trigger(E.KEY_ERROR,{error:new d.default(f.default.MEDIA_KEYERR_CODE,te,this)});break;case t.message:var z=ArrayBuffer.isView(V.message)?V.message.buffer:V.message;v.trigger(E.INTERNAL_KEY_MESSAGE,{data:new y.default(this,z,V.destinationURL)});break;case t.ready:n.debug("DRM: Key added."),v.trigger(E.KEY_ADDED);break;case t.close:n.debug("DRM: Session closed.  SessionID = "+this.getSessionId()),v.trigger(E.KEY_SESSION_CLOSED,{data:this.getSessionId()});break}}}}return m={getAllInitData:X,getSessions:W,requestKeySystemAccess:b,selectKeySystem:j,setMediaElement:Q,createKeySession:q,updateKeySession:Y,closeKeySession:J,setServerCertificate:$,loadKeySession:ae,removeKeySession:K,stop:k,reset:k},U(),m}T.__dashjs_factory_name="ProtectionModel_3Feb2014";const M=dashjs.FactoryMaker.getClassFactory(T)},"./src/streaming/protection/servers/ClearKey.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>f});var I=e("./src/streaming/protection/vo/KeyPair.js"),g=e("./src/streaming/protection/vo/ClearKeyKeySet.js");function d(){var y;function _(C){return C}function r(){return"POST"}function T(){return"json"}function M(C){if(!C.hasOwnProperty("keys"))return null;for(var v=[],E=0;E<C.keys.length;E++){var i=C.keys[E],t=i.kid.replace(/=/g,""),m=i.k.replace(/=/g,"");v.push(new I.default(t,m))}return new g.default(v)}function p(C){return String.fromCharCode.apply(null,new Uint8Array(C))}return y={getServerURLFromMessage:_,getHTTPMethod:r,getResponseType:T,getLicenseMessage:M,getErrorResponse:p},y}d.__dashjs_factory_name="ClearKey";const f=dashjs.FactoryMaker.getSingletonFactory(d)},"./src/streaming/protection/servers/DRMToday.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});var I=e("./src/streaming/constants/ProtectionConstants.js");function g(f){f=f||{};var y=f.BASE64,_={};_[I.default.WIDEVINE_KEYSTEM_STRING]={responseType:"json",getLicenseMessage:function(t){return y.decodeArray(t.license)},getErrorResponse:function(t){return t}},_[I.default.PLAYREADY_KEYSTEM_STRING]={responseType:"arraybuffer",getLicenseMessage:function(t){return t},getErrorResponse:function(t){return String.fromCharCode.apply(null,new Uint8Array(t))}};var r;function T(){if(!y||!y.hasOwnProperty("decodeArray"))throw new Error("Missing config parameter(s)")}function M(i){return i}function p(){return"POST"}function C(i){return _[i].responseType}function v(i,t){return T(),_[t].getLicenseMessage(i)}function E(i,t){return _[t].getErrorResponse(i)}return r={getServerURLFromMessage:M,getHTTPMethod:p,getResponseType:C,getLicenseMessage:v,getErrorResponse:E},r}g.__dashjs_factory_name="DRMToday";const d=dashjs.FactoryMaker.getSingletonFactory(g)},"./src/streaming/protection/servers/PlayReady.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});var I=e("./src/core/FactoryMaker.js");function g(){var f,y="http://schemas.xmlsoap.org/soap/envelope/";function _(i){var t=String.fromCharCode.apply(null,new Uint8Array(i)),m=decodeURIComponent(escape(t));return m}function r(i){if(window.DOMParser){var t=_(i),m=new window.DOMParser,n=m.parseFromString(t,"text/xml"),h=n?n.getElementsByTagNameNS(y,"Envelope")[0]:null,c=h?h.getElementsByTagNameNS(y,"Body")[0]:null,o=c?c.getElementsByTagNameNS(y,"Fault")[0]:null;if(o)return null}return i}function T(i){var t="",m="",n="",h=-1,c=-1;if(window.DOMParser){var o=_(i),l=new window.DOMParser,A=l.parseFromString(o,"text/xml"),S=A?A.getElementsByTagNameNS(y,"Envelope")[0]:null,L=S?S.getElementsByTagNameNS(y,"Body")[0]:null,U=L?L.getElementsByTagNameNS(y,"Fault")[0]:null,k=U?U.getElementsByTagName("detail")[0]:null,X=k?k.getElementsByTagName("Exception")[0]:null,W=null;if(U===null)return o;W=U.getElementsByTagName("faultstring")[0].firstChild,t=W?W.nodeValue:null,X!==null&&(W=X.getElementsByTagName("StatusCode")[0],m=W?W.firstChild.nodeValue:null,W=X.getElementsByTagName("Message")[0],n=W?W.firstChild.nodeValue:null,h=n?n.lastIndexOf("[")+1:-1,c=n?n.indexOf("]"):-1,n=n?n.substring(h,c):"")}var b="code: ".concat(m,", name: ").concat(t);return n&&(b+=", message: ".concat(n)),b}function M(i){return i}function p(){return"POST"}function C(){return"arraybuffer"}function v(i){return r.call(this,i)}function E(i){return T.call(this,i)}return f={getServerURLFromMessage:M,getHTTPMethod:p,getResponseType:C,getLicenseMessage:v,getErrorResponse:E},f}g.__dashjs_factory_name="PlayReady";const d=I.default.getSingletonFactory(g)},"./src/streaming/protection/servers/Widevine.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>g});function I(){var d;function f(M){return M}function y(){return"POST"}function _(){return"arraybuffer"}function r(M){return M}function T(M){return String.fromCharCode.apply(null,new Uint8Array(M))}return d={getServerURLFromMessage:f,getHTTPMethod:y,getResponseType:_,getLicenseMessage:r,getErrorResponse:T},d}I.__dashjs_factory_name="Widevine";const g=dashjs.FactoryMaker.getSingletonFactory(I)},"./src/streaming/protection/vo/ClearKeyKeySet.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});function I(_,r){if(!(_ instanceof r))throw new TypeError("Cannot call a class as a function")}function g(_,r){for(var T=0;T<r.length;T++){var M=r[T];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(_,M.key,M)}}function d(_,r,T){return r&&g(_.prototype,r),T&&g(_,T),_}var f=function(){function _(r,T){if(I(this,_),T&&T!=="persistent"&&T!=="temporary")throw new Error("Invalid ClearKey key set type!  Must be one of 'persistent' or 'temporary'");this.keyPairs=r,this.type=T}return d(_,[{key:"toJWK",value:function(){var T,M=this.keyPairs.length,p={keys:[]};for(T=0;T<M;T++){var C={kty:"oct",alg:"A128KW",kid:this.keyPairs[T].keyID,k:this.keyPairs[T].key};p.keys.push(C)}this.type&&(p.type=this.type);var v=JSON.stringify(p),E=v.length,i=new ArrayBuffer(E),t=new Uint8Array(i);for(T=0;T<E;T++)t[T]=v.charCodeAt(T);return i}}]),_}();const y=f},"./src/streaming/protection/vo/KeyMessage.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(y,_,r,T){I(this,f),this.sessionToken=y,this.message=_,this.defaultURL=r,this.messageType=T||"license-request"};const d=g},"./src/streaming/protection/vo/KeyPair.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(y,_){I(this,f),this.keyID=y,this.key=_};const d=g},"./src/streaming/protection/vo/KeySystemAccess.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(y,_){I(this,f),this.keySystem=y,this.ksConfiguration=_};const d=g},"./src/streaming/protection/vo/KeySystemConfiguration.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(y,_,r,T,M){I(this,f),this.initDataTypes=["cenc"],y&&y.length&&(this.audioCapabilities=y),_&&_.length&&(this.videoCapabilities=_),this.distinctiveIdentifier=r,this.persistentState=T,this.sessionTypes=M};const d=g},"./src/streaming/protection/vo/LicenseRequest.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(y,_,r,T,M,p,C,v){I(this,f),this.url=y,this.method=_,this.responseType=r,this.headers=T,this.withCredentials=M,this.messageType=p,this.sessionId=C,this.data=v};const d=g},"./src/streaming/protection/vo/LicenseResponse.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(y,_,r){I(this,f),this.url=y,this.headers=_,this.data=r};const d=g},"./src/streaming/protection/vo/MediaCapability.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(y,_){I(this,f),this.contentType=y,this.robustness=_};const d=g},"./src/streaming/protection/vo/NeedKey.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(y,_){I(this,f),this.initData=y,this.initDataType=_};const d=g},"./src/streaming/rules/DroppedFramesHistory.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>f});var I=e("./src/core/FactoryMaker.js");function g(){var y={},_={},r={};function T(v,E,i){if(E){y[v]||(y[v]=[],_[v]=0,r[v]=0);var t=i&&i.droppedVideoFrames?i.droppedVideoFrames:0,m=i&&i.totalVideoFrames?i.totalVideoFrames:0,n=t-_[v];_[v]=t;var h=m-r[v];r[v]=m;var c=y[v];isNaN(E)||(c[E]?(c[E].droppedVideoFrames+=n,c[E].totalVideoFrames+=h):c[E]={droppedVideoFrames:n,totalVideoFrames:h})}}function M(v){return y[v]}function p(v){try{delete y[v],delete _[v],delete r[v]}catch{}}function C(){y={},_={},r={}}return{push:T,getFrameHistory:M,clearForStream:p,reset:C}}g.__dashjs_factory_name="DroppedFramesHistory";var d=I.default.getClassFactory(g);const f=d},"./src/streaming/rules/RulesContext.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});var I=e("./src/core/FactoryMaker.js");function g(f){f=f||{};var y,_=f.abrController,r=f.switchHistory,T=f.droppedFramesHistory,M=f.currentRequest,p=f.useBufferOccupancyABR,C=f.useL2AABR,v=f.useLoLPABR,E=f.streamProcessor?f.streamProcessor.getScheduleController():null,i=f.streamProcessor?f.streamProcessor.getRepresentationInfo():null,t=f.videoModel?f.videoModel:null;function m(){var b=h();return b?b.type:null}function n(){var b=h();return b?b.streamInfo:null}function h(){return i?i.mediaInfo:null}function c(){return i}function o(){return E}function l(){return _}function A(){return r}function S(){return t}function L(){return T}function U(){return M}function k(){return p}function X(){return C}function W(){return v}return y={getMediaType:m,getMediaInfo:h,getDroppedFramesHistory:L,getCurrentRequest:U,getSwitchHistory:A,getStreamInfo:n,getScheduleController:o,getAbrController:l,getRepresentationInfo:c,useBufferOccupancyABR:k,useL2AABR:X,useLoLPABR:W,getVideoModel:S},y}g.__dashjs_factory_name="RulesContext";const d=I.default.getClassFactory(g)},"./src/streaming/rules/SwitchRequest.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>_});var I=e("./src/core/FactoryMaker.js"),g=-1,d={DEFAULT:.5,STRONG:1,WEAK:0};function f(r,T,M){var p,C,v,E;function i(t){var m=d.DEFAULT;return(t===d.DEFAULT||t===d.STRONG||t===d.WEAK)&&(m=t),m}return C=r===void 0?g:r,v=i(M),E=T===void 0?null:T,p={quality:C,reason:E,priority:v},p}f.__dashjs_factory_name="SwitchRequest";var y=I.default.getClassFactory(f);y.NO_CHANGE=g,y.PRIORITY=d,I.default.updateClassFactory(f.__dashjs_factory_name,y);const _=y},"./src/streaming/rules/SwitchRequestHistory.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>_});var I=e("./src/core/FactoryMaker.js"),g=e("./src/streaming/rules/SwitchRequest.js"),d=8;function f(){var r=[],T=[];function M(v){v.newValue===g.default.NO_CHANGE&&(v.newValue=v.oldValue),r[v.oldValue]||(r[v.oldValue]={noDrops:0,drops:0,dropSize:0});var E=v.newValue-v.oldValue,i=E<0?1:0,t=i?-E:0,m=i?0:1;if(r[v.oldValue].drops+=i,r[v.oldValue].dropSize+=t,r[v.oldValue].noDrops+=m,T.push({idx:v.oldValue,noDrop:m,drop:i,dropSize:t}),T.length>d){var n=T.shift();r[n.idx].drops-=n.drop,r[n.idx].dropSize-=n.dropSize,r[n.idx].noDrops-=n.noDrop}}function p(){return r}function C(){r=[],T=[]}return{push:M,getSwitchRequests:p,reset:C}}f.__dashjs_factory_name="SwitchRequestHistory";var y=I.default.getClassFactory(f);const _=y},"./src/streaming/rules/ThroughputHistory.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>f});var I=e("./src/streaming/constants/Constants.js"),g=e("./src/core/FactoryMaker.js");function d(y){y=y||{};var _=20,r=3,T=4,M=4,p=1.3,C=1.3,v=8,E=3,i=2,t=1,m=y.settings,n,h,c,o,l;function A(){l={throughputHalfLife:{fast:E,slow:v},latencyHalfLife:{fast:t,slow:i}},$()}function S(K,ee,se){if(K===I.default.VIDEO)return se<m.get().streaming.cacheLoadThresholds[I.default.VIDEO];if(K===I.default.AUDIO)return se<m.get().streaming.cacheLoadThresholds[I.default.AUDIO]}function L(K,ee,se){if(!(!ee.trace||!ee.trace.length)){var ue=ee.tresponse.getTime()-ee.trequest.getTime()||1,oe=ee._tfinish.getTime()-ee.tresponse.getTime()||1,Z=ee.trace.reduce(function(R,u){return R+u.b[0]},0),H=0,V=0;if(ee._fileLoaderType&&ee._fileLoaderType===I.default.FILE_LOADER_TYPES.FETCH?H=ee.trace.reduce(function(R,u){return R+u.d},0):H=se?oe:ue+oe,H!==0&&(V=Math.round(8*Z/H)),ee.cmsd){var te=ee.cmsd.dynamic&&ee.cmsd.dynamic.etp?ee.cmsd.dynamic.etp:null;if(te){var z=m.get().streaming.cmsd.abr.etpWeightRatio;z>0&&z<=1&&(V=V*(1-z)+te*z)}}if(Y(K),S(K,ue,oe)){if(n[K].length>0&&!n[K].hasCachedEntries)return;n[K].hasCachedEntries=!0}else n[K]&&n[K].hasCachedEntries&&J(K);n[K].push(V),n[K].length>_&&n[K].shift(),h[K].push(ue),h[K].length>_&&h[K].shift(),U(c[K],V,.001*oe,l.throughputHalfLife),U(o[K],ue,1,l.latencyHalfLife)}}function U(K,ee,se,ue){var oe=Math.pow(.5,se/ue.fast);K.fastEstimate=(1-oe)*ee+oe*K.fastEstimate;var Z=Math.pow(.5,se/ue.slow);K.slowEstimate=(1-Z)*ee+Z*K.slowEstimate,K.totalWeight+=se}function k(K,ee,se){var ue,oe;if(K?(ue=n[ee],oe=se?r:T):(ue=h[ee],oe=M),!ue)oe=0;else if(oe>=ue.length)oe=ue.length;else if(K)for(var Z=1;Z<oe;++Z){var H=ue[ue.length-Z]/ue[ue.length-Z-1];if((H>=C||H<=1/p)&&(oe+=1,oe===ue.length))break}return oe}function X(K,ee,se){return m.get().streaming.abr.movingAverageMethod!==I.default.MOVING_AVERAGE_SLIDING_WINDOW?b(K,ee):W(K,ee,se)}function W(K,ee,se){var ue=k(K,ee,se),oe=K?n:h,Z=oe[ee];return ue===0||!Z||Z.length===0?NaN:(Z=Z.slice(-ue),Z.reduce(function(H,V){return H+V})/Z.length)}function b(K,ee){var se=K?l.throughputHalfLife:l.latencyHalfLife,ue=K?c[ee]:o[ee];if(!ue||ue.totalWeight<=0)return NaN;var oe=ue.fastEstimate/(1-Math.pow(.5,ue.totalWeight/se.fast)),Z=ue.slowEstimate/(1-Math.pow(.5,ue.totalWeight/se.slow));return K?Math.min(oe,Z):Math.max(oe,Z)}function j(K,ee){return X(!0,K,ee)}function Q(K,ee){var se=j(K,ee);return isNaN(se)||(se*=m.get().streaming.abr.bandwidthSafetyFactor),se}function q(K){return X(!1,K)}function Y(K){n[K]=n[K]||[],h[K]=h[K]||[],c[K]=c[K]||{fastEstimate:0,slowEstimate:0,totalWeight:0},o[K]=o[K]||{fastEstimate:0,slowEstimate:0,totalWeight:0}}function J(K){delete n[K],delete h[K],delete c[K],delete o[K],Y(K)}function $(){n={},h={},c={},o={}}var ae={push:L,getAverageThroughput:j,getSafeAverageThroughput:Q,getAverageLatency:q,reset:$};return A(),ae}d.__dashjs_factory_name="ThroughputHistory";const f=g.default.getClassFactory(d)},"./src/streaming/rules/abr/ABRRulesCollection.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>m});var I=e("./src/streaming/rules/abr/ThroughputRule.js"),g=e("./src/streaming/rules/abr/InsufficientBufferRule.js"),d=e("./src/streaming/rules/abr/AbandonRequestsRule.js"),f=e("./src/streaming/rules/abr/DroppedFramesRule.js"),y=e("./src/streaming/rules/abr/SwitchHistoryRule.js"),_=e("./src/streaming/rules/abr/BolaRule.js"),r=e("./src/streaming/rules/abr/L2ARule.js"),T=e("./src/streaming/rules/abr/lolp/LoLpRule.js"),M=e("./src/core/FactoryMaker.js"),p=e("./src/streaming/rules/SwitchRequest.js"),C=e("./src/streaming/constants/Constants.js"),v="qualitySwitchRules",E="abandonFragmentRules";function i(n){n=n||{};var h=this.context,c=n.mediaPlayerModel,o=n.customParametersModel,l=n.dashMetrics,A=n.settings,S,L,U;function k(){L=[],U=[],A.get().streaming.abr.useDefaultABRRules&&(A.get().streaming.abr.ABRStrategy===C.default.ABR_STRATEGY_L2A?L.push((0,r.default)(h).create({dashMetrics:l,settings:A})):A.get().streaming.abr.ABRStrategy===C.default.ABR_STRATEGY_LoLP?L.push((0,T.default)(h).create({dashMetrics:l})):(L.push((0,_.default)(h).create({dashMetrics:l,mediaPlayerModel:c,settings:A})),L.push((0,I.default)(h).create({dashMetrics:l})),A.get().streaming.abr.additionalAbrRules.insufficientBufferRule&&L.push((0,g.default)(h).create({dashMetrics:l,settings:A})),A.get().streaming.abr.additionalAbrRules.switchHistoryRule&&L.push((0,y.default)(h).create()),A.get().streaming.abr.additionalAbrRules.droppedFramesRule&&L.push((0,f.default)(h).create()),A.get().streaming.abr.additionalAbrRules.abandonRequestsRule&&U.push((0,d.default)(h).create({dashMetrics:l,mediaPlayerModel:c,settings:A}))));var Y=o.getAbrCustomRules();Y.forEach(function(J){J.type===v&&L.push(J.rule(h).create()),J.type===E&&U.push(J.rule(h).create())})}function X(Y){return Y.filter(function(J){return J.quality>p.default.NO_CHANGE})}function W(Y){var J={},$=null,ae,K,ee,se,ue;if(Y.length!==0){for(J[p.default.PRIORITY.STRONG]={quality:p.default.NO_CHANGE,reason:null},J[p.default.PRIORITY.WEAK]={quality:p.default.NO_CHANGE,reason:null},J[p.default.PRIORITY.DEFAULT]={quality:p.default.NO_CHANGE,reason:null},ae=0,K=Y.length;ae<K;ae+=1)ee=Y[ae],ee.quality!==p.default.NO_CHANGE&&(J[ee.priority].quality===p.default.NO_CHANGE||J[ee.priority].quality>ee.quality)&&(J[ee.priority].quality=ee.quality,J[ee.priority].reason=ee.reason||null);return J[p.default.PRIORITY.WEAK].quality!==p.default.NO_CHANGE&&($=J[p.default.PRIORITY.WEAK]),J[p.default.PRIORITY.DEFAULT].quality!==p.default.NO_CHANGE&&($=J[p.default.PRIORITY.DEFAULT]),J[p.default.PRIORITY.STRONG].quality!==p.default.NO_CHANGE&&($=J[p.default.PRIORITY.STRONG]),$&&(se=$.quality,ue=$.reason),(0,p.default)(h).create(se,ue)}}function b(Y){var J=L.map(function(K){return K.getMaxIndex(Y)}),$=X(J),ae=W($);return ae||(0,p.default)(h).create()}function j(Y,J){var $=U.map(function(ee){return ee.shouldAbandon(Y,J)}),ae=X($),K=W(ae);return K||(0,p.default)(h).create()}function Q(){[L,U].forEach(function(Y){Y&&Y.length&&Y.forEach(function(J){return J.reset&&J.reset()})}),L=[],U=[]}function q(){return L}return S={initialize:k,reset:Q,getMaxQuality:b,getMinSwitchRequest:W,shouldAbandonFragment:j,getQualitySwitchRules:q},S}i.__dashjs_factory_name="ABRRulesCollection";var t=M.default.getClassFactory(i);t.QUALITY_SWITCH_RULES=v,t.ABANDON_FRAGMENT_RULES=E,M.default.updateSingletonFactory(i.__dashjs_factory_name,t);const m=t},"./src/streaming/rules/abr/AbandonRequestsRule.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});var I=e("./src/streaming/rules/SwitchRequest.js"),g=e("./src/core/FactoryMaker.js"),d=e("./src/core/Debug.js");function f(_){_=_||{};var r=1.8,T=500,M=5,p=this.context,C=_.mediaPlayerModel,v=_.dashMetrics,E=_.settings,i,t,m,n,h;function c(){t=(0,d.default)(p).getInstance().getLogger(i),S()}function o(L,U){m[L]=m[L]||{},m[L][U]=m[L][U]||{}}function l(L,U){h[L]=h[L]||[],h[L].push(U)}function A(L){var U=(0,I.default)(p).create(I.default.NO_CHANGE,{name:f.__dashjs_factory_name});if(!L||!L.hasOwnProperty("getMediaInfo")||!L.hasOwnProperty("getMediaType")||!L.hasOwnProperty("getCurrentRequest")||!L.hasOwnProperty("getRepresentationInfo")||!L.hasOwnProperty("getAbrController"))return U;var k=L.getMediaInfo(),X=L.getMediaType(),W=L.getStreamInfo(),b=W?W.id:null,j=L.getCurrentRequest();if(!isNaN(j.index)){o(X,j.index);var Q=C.getStableBufferTime(),q=v.getCurrentBufferLevel(X);if(q>Q)return U;var Y=m[X][j.index];if(Y===null||j.firstByteDate===null||n.hasOwnProperty(Y.id))return U;if(Y.firstByteTime===void 0&&(h[X]=[],Y.firstByteTime=j.firstByteDate.getTime(),Y.segmentDuration=j.duration,Y.bytesTotal=j.bytesTotal,Y.id=j.index),Y.bytesLoaded=j.bytesLoaded,Y.elapsedTime=new Date().getTime()-Y.firstByteTime,Y.bytesLoaded>0&&Y.elapsedTime>0&&l(X,Math.round(Y.bytesLoaded*8/Y.elapsedTime)),h[X].length>=M&&Y.elapsedTime>T&&Y.bytesLoaded<Y.bytesTotal){var J=h[X].reduce(function(Z,H){return Z+H},0);if(Y.measuredBandwidthInKbps=Math.round(J/h[X].length),Y.estimatedTimeOfDownload=+(Y.bytesTotal*8/Y.measuredBandwidthInKbps/1e3).toFixed(2),Y.estimatedTimeOfDownload<Y.segmentDuration*r||L.getRepresentationInfo().quality===0)return U;if(!n.hasOwnProperty(Y.id)){var $=L.getAbrController(),ae=Y.bytesTotal-Y.bytesLoaded,K=$.getBitrateList(k),ee=$.getQualityForBitrate(k,Y.measuredBandwidthInKbps*E.get().streaming.abr.bandwidthSafetyFactor,b),se=$.getMinAllowedIndexFor(X,b),ue=se!==void 0?Math.max(se,ee):ee,oe=Y.bytesTotal*K[ue].bitrate/K[$.getQualityFor(X,b)].bitrate;ae>oe&&(U.quality=ue,U.reason.throughput=Y.measuredBandwidthInKbps,U.reason.fragmentID=Y.id,n[Y.id]=Y,t.debug("["+X+"] frag id",Y.id," is asking to abandon and switch to quality to ",ue," measured bandwidth was",Y.measuredBandwidthInKbps),delete m[X][Y.id])}}else Y.bytesLoaded===Y.bytesTotal&&delete m[X][Y.id]}return U}function S(){m={},n={},h=[]}return i={shouldAbandon:A,reset:S},c(),i}f.__dashjs_factory_name="AbandonRequestsRule";const y=g.default.getClassFactory(f)},"./src/streaming/rules/abr/BolaRule.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>n});var I=e("./src/streaming/constants/MetricsConstants.js"),g=e("./src/streaming/rules/SwitchRequest.js"),d=e("./src/core/FactoryMaker.js"),f=e("./src/streaming/vo/metrics/HTTPRequest.js"),y=e("./src/core/EventBus.js"),_=e("./src/core/events/Events.js"),r=e("./src/core/Debug.js"),T=e("./src/streaming/MediaPlayerEvents.js"),M=e("./src/streaming/constants/Constants.js"),p=0,C=1,v=2,E=10,i=2,t=.99;function m(h){h=h||{};var c=this.context,o=h.dashMetrics,l=h.mediaPlayerModel,A=(0,y.default)(c).getInstance(),S,L,U;function k(){L=(0,r.default)(c).getInstance().getLogger(S),te(),A.on(T.default.BUFFER_EMPTY,K,S),A.on(T.default.PLAYBACK_SEEKING,ee,S),A.on(T.default.METRIC_ADDED,ue,S),A.on(T.default.QUALITY_CHANGE_REQUESTED,Z,S),A.on(T.default.FRAGMENT_LOADING_ABANDONED,H,S),A.on(_.default.MEDIA_FRAGMENT_LOADED,se,S)}function X(R){return R.map(function(u){return Math.log(u)})}function W(R,u,D){var F=D.reduce(function(B,x,ne){return x>D[B]?ne:B},0);if(F===0)return null;var w=Math.max(R,E+i*u.length),O=(D[F]-1)/(w/E-1),P=E/O;return{gp:O,Vp:P}}function b(R){var u={},D=R.getMediaInfo(),F=D.bitrateList.map(function(B){return B.bandwidth}),w=X(F);w=w.map(function(B){return B-w[0]+1});var O=l.getStableBufferTime(),P=W(O,F,w);return P?(u.state=C,u.bitrates=F,u.utilities=w,u.stableBufferTime=O,u.Vp=P.Vp,u.gp=P.gp,u.lastQuality=0,j(u)):u.state=p,u}function j(R){R.placeholderBuffer=0,R.mostAdvancedSegmentStart=NaN,R.lastSegmentWasReplacement=!1,R.lastSegmentStart=NaN,R.lastSegmentDurationS=NaN,R.lastSegmentRequestTimeMs=NaN,R.lastSegmentFinishTimeMs=NaN}function Q(R,u){var D=l.getStableBufferTime();if(R.stableBufferTime!==D){var F=W(D,R.bitrates,R.utilities);if(F.Vp!==R.Vp||F.gp!==R.gp){var w=o.getCurrentBufferLevel(u),O=w+R.placeholderBuffer;O-=E,O*=F.Vp/R.Vp,O+=E,R.stableBufferTime=D,R.Vp=F.Vp,R.gp=F.gp,R.placeholderBuffer=Math.max(0,O-w)}}}function q(R){var u=R.getMediaType(),D=U[u];return D?D.state!==p&&Q(D,u):(D=b(R),U[u]=D),D}function Y(R,u){for(var D=R.bitrates.length,F=NaN,w=NaN,O=0;O<D;++O){var P=(R.Vp*(R.utilities[O]+R.gp)-u)/R.bitrates[O];(isNaN(w)||P>=w)&&(w=P,F=O)}return F}function J(R,u){return R.Vp*(R.utilities[u]+R.gp)}function $(R,u){for(var D=R.bitrates[u],F=R.utilities[u],w=0,O=u-1;O>=0;--O)if(R.utilities[O]<R.utilities[u]){var P=R.bitrates[O],B=R.utilities[O],x=R.Vp*(R.gp+(D*B-P*F)/(D-P));w=Math.max(w,x)}return w}function ae(R,u){var D=Date.now();if(isNaN(R.lastSegmentFinishTimeMs)){if(!isNaN(R.lastCallTimeMs)){var w=.001*(D-R.lastCallTimeMs);R.placeholderBuffer+=Math.max(0,w)}}else{var F=.001*(D-R.lastSegmentFinishTimeMs);R.placeholderBuffer+=Math.max(0,F)}R.lastCallTimeMs=D,R.lastSegmentStart=NaN,R.lastSegmentRequestTimeMs=NaN,R.lastSegmentFinishTimeMs=NaN,Q(R,u)}function K(R){var u=R.mediaType,D=u===M.default.AUDIO?[M.default.AUDIO]:U;for(var F in D)U.hasOwnProperty(F)&&U[F].state===v&&(U[F].placeholderBuffer=0)}function ee(){for(var R in U)if(U.hasOwnProperty(R)){var u=U[R];u.state!==p&&(u.state=C,j(u))}}function se(R){if(R&&R.chunk&&R.chunk.mediaInfo){var u=U[R.chunk.mediaInfo.type];if(u&&u.state!==p){var D=R.chunk.start;isNaN(u.mostAdvancedSegmentStart)||D>u.mostAdvancedSegmentStart?(u.mostAdvancedSegmentStart=D,u.lastSegmentWasReplacement=!1):u.lastSegmentWasReplacement=!0,u.lastSegmentStart=D,u.lastSegmentDurationS=R.chunk.duration,u.lastQuality=R.chunk.quality,oe(u,R.chunk.mediaInfo.type)}}}function ue(R){if(R&&R.metric===I.default.HTTP_REQUEST&&R.value&&R.value.type===f.HTTPRequest.MEDIA_SEGMENT_TYPE&&R.value.trace&&R.value.trace.length){var u=U[R.mediaType];u&&u.state!==p&&(u.lastSegmentRequestTimeMs=R.value.trequest.getTime(),u.lastSegmentFinishTimeMs=R.value._tfinish.getTime(),oe(u,R.mediaType))}}function oe(R,u){if(!isNaN(R.lastSegmentStart)&&!isNaN(R.lastSegmentRequestTimeMs)&&!isNaN(R.placeholderBuffer)){if(R.placeholderBuffer*=t,!isNaN(R.lastSegmentFinishTimeMs)){var D=o.getCurrentBufferLevel(u),F=D+.001*(R.lastSegmentFinishTimeMs-R.lastSegmentRequestTimeMs),w=J(R,R.lastQuality),O=Math.max(0,w-F);R.placeholderBuffer=Math.min(O,R.placeholderBuffer)}R.lastSegmentWasReplacement&&!isNaN(R.lastSegmentDurationS)&&(R.placeholderBuffer+=R.lastSegmentDurationS),R.lastSegmentStart=NaN,R.lastSegmentRequestTimeMs=NaN}}function Z(R){if(R){var u=U[R.mediaType];u&&u.state!==p&&(u.abrQuality=R.newQuality)}}function H(R){if(R){var u=U[R.mediaType];if(u&&u.state!==p){var D=o.getCurrentBufferLevel(R.mediaType),F;u.abrQuality>0?F=$(u,u.abrQuality):F=E;var w=Math.max(0,F-D);u.placeholderBuffer=Math.min(u.placeholderBuffer,w)}}}function V(R){var u=(0,g.default)(c).create();if(!R||!R.hasOwnProperty("getMediaInfo")||!R.hasOwnProperty("getMediaType")||!R.hasOwnProperty("getScheduleController")||!R.hasOwnProperty("getStreamInfo")||!R.hasOwnProperty("getAbrController")||!R.hasOwnProperty("useBufferOccupancyABR"))return u;var D=R.getMediaInfo(),F=R.getMediaType(),w=R.getScheduleController(),O=R.getStreamInfo(),P=R.getAbrController(),B=P.getThroughputHistory(),x=O?O.id:null,ne=O&&O.manifestInfo&&O.manifestInfo.isDynamic,re=R.useBufferOccupancyABR();if(u.reason=u.reason||{},!re)return u;w.setTimeToLoadDelay(0);var G=q(R);if(G.state===p)return u;var fe=o.getCurrentBufferLevel(F),le=B.getAverageThroughput(F,ne),_e=B.getSafeAverageThroughput(F,ne),Me=B.getAverageLatency(F),Oe;if(u.reason.state=G.state,u.reason.throughput=le,u.reason.latency=Me,isNaN(le))return u;switch(G.state){case C:Oe=P.getQualityForBitrate(D,_e,x,Me),u.quality=Oe,u.reason.throughput=_e,G.placeholderBuffer=Math.max(0,$(G,Oe)-fe),G.lastQuality=Oe,!isNaN(G.lastSegmentDurationS)&&fe>=G.lastSegmentDurationS&&(G.state=v);break;case v:ae(G,F),Oe=Y(G,fe+G.placeholderBuffer);var Ne=P.getQualityForBitrate(D,_e,x,Me);Oe>G.lastQuality&&Oe>Ne&&(Oe=Math.max(Ne,G.lastQuality));var xe=Math.max(0,fe+G.placeholderBuffer-J(G,Oe));xe<=G.placeholderBuffer?(G.placeholderBuffer-=xe,xe=0):(xe-=G.placeholderBuffer,G.placeholderBuffer=0,Oe<P.getMaxAllowedIndexFor(F,x)?w.setTimeToLoadDelay(1e3*xe):xe=0),u.quality=Oe,u.reason.throughput=le,u.reason.latency=Me,u.reason.bufferLevel=fe,u.reason.placeholderBuffer=G.placeholderBuffer,u.reason.delay=xe,G.lastQuality=Oe;break;default:L.debug("BOLA ABR rule invoked in bad state."),u.quality=P.getQualityForBitrate(D,_e,x,Me),u.reason.state=G.state,u.reason.throughput=_e,u.reason.latency=Me,G.state=C,j(G)}return u}function te(){U={}}function z(){te(),A.off(T.default.BUFFER_EMPTY,K,S),A.off(T.default.PLAYBACK_SEEKING,ee,S),A.off(T.default.METRIC_ADDED,ue,S),A.off(T.default.QUALITY_CHANGE_REQUESTED,Z,S),A.off(T.default.FRAGMENT_LOADING_ABANDONED,H,S),A.off(_.default.MEDIA_FRAGMENT_LOADED,se,S)}return S={getMaxIndex:V,reset:z},k(),S}m.__dashjs_factory_name="BolaRule";const n=d.default.getClassFactory(m)},"./src/streaming/rules/abr/DroppedFramesRule.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});var I=e("./src/core/FactoryMaker.js"),g=e("./src/streaming/rules/SwitchRequest.js"),d=e("./src/core/Debug.js");function f(){var _=this.context,r,T,M=.15,p=375;function C(){T=(0,d.default)(_).getInstance().getLogger(r)}function v(E){var i=(0,g.default)(_).create();if(!E||!E.hasOwnProperty("getDroppedFramesHistory"))return i;var t=E.getDroppedFramesHistory(),m=E.getStreamInfo().id;if(t){var n=t.getFrameHistory(m);if(!n||n.length===0)return i;for(var h=0,c=0,o=g.default.NO_CHANGE,l=1;l<n.length;l++)if(n[l]&&(h=n[l].droppedVideoFrames,c=n[l].totalVideoFrames,c>p&&h/c>M)){o=l-1,T.debug("index: "+o+" Dropped Frames: "+h+" Total Frames: "+c);break}return(0,g.default)(_).create(o,{droppedFrames:h})}return i}return r={getMaxIndex:v},C(),r}f.__dashjs_factory_name="DroppedFramesRule";const y=I.default.getClassFactory(f)},"./src/streaming/rules/abr/InsufficientBufferRule.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>p});var I=e("./src/core/EventBus.js"),g=e("./src/core/events/Events.js"),d=e("./src/core/FactoryMaker.js"),f=e("./src/core/Debug.js"),y=e("./src/streaming/rules/SwitchRequest.js"),_=e("./src/streaming/constants/Constants.js"),r=e("./src/streaming/constants/MetricsConstants.js"),T=e("./src/streaming/MediaPlayerEvents.js");function M(C){C=C||{};var v=.5,E=2,i=this.context,t=(0,I.default)(i).getInstance(),m=C.dashMetrics,n,h,c;function o(){h=(0,f.default)(i).getInstance().getLogger(n),L(),t.on(T.default.PLAYBACK_SEEKING,U,n),t.on(g.default.BYTES_APPENDED_END_FRAGMENT,k,n)}function l(){if(!m||!m.hasOwnProperty("getCurrentBufferLevel")||!m.hasOwnProperty("getCurrentBufferState"))throw new Error(_.default.MISSING_CONFIG_ERROR)}function A(W){var b=(0,y.default)(i).create();if(!W||!W.hasOwnProperty("getMediaType"))return b;l();var j=W.getMediaType(),Q=m.getCurrentBufferState(j),q=W.getRepresentationInfo(),Y=q.fragmentDuration,J=W.getStreamInfo(),$=J?J.id:null,ae=W.getScheduleController(),K=J&&J.manifestInfo&&J.manifestInfo.isDynamic,ee=ae.getPlaybackController(),se=ee.getLowLatencyModeEnabled();if(S(se,j)||!Y)return b;if(Q&&Q.state===r.default.BUFFER_EMPTY)h.debug("["+j+"] Switch to index 0; buffer is empty."),b.quality=0,b.reason="InsufficientBufferRule: Buffer is empty";else{var ue=W.getMediaInfo(),oe=W.getAbrController(),Z=oe.getThroughputHistory(),H=m.getCurrentBufferLevel(j),V=Z.getAverageThroughput(j,K),te=Z.getAverageLatency(j),z=V*(H/Y)*v;b.quality=oe.getQualityForBitrate(ue,z,$,te),b.reason="InsufficientBufferRule: being conservative to avoid immediate rebuffering"}return b}function S(W,b){return!W&&c[b].ignoreCount>0}function L(){c={},c[_.default.VIDEO]={ignoreCount:E},c[_.default.AUDIO]={ignoreCount:E}}function U(){L()}function k(W){!isNaN(W.startTime)&&(W.mediaType===_.default.AUDIO||W.mediaType===_.default.VIDEO)&&c[W.mediaType].ignoreCount>0&&c[W.mediaType].ignoreCount--}function X(){L(),t.off(T.default.PLAYBACK_SEEKING,U,n),t.off(g.default.BYTES_APPENDED_END_FRAGMENT,k,n)}return n={getMaxIndex:A,reset:X},o(),n}M.__dashjs_factory_name="InsufficientBufferRule";const p=d.default.getClassFactory(M)},"./src/streaming/rules/abr/L2ARule.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>E});var I=e("./src/streaming/constants/MetricsConstants.js"),g=e("./src/streaming/rules/SwitchRequest.js"),d=e("./src/core/FactoryMaker.js"),f=e("./src/streaming/vo/metrics/HTTPRequest.js"),y=e("./src/core/EventBus.js"),_=e("./src/core/events/Events.js"),r=e("./src/core/Debug.js"),T=e("./src/streaming/constants/Constants.js"),M=0,p=1,C=2;function v(i){i=i||{};var t=this.context,m=i.dashMetrics,n=(0,y.default)(t).getInstance(),h,c,o,l;function A(){l=(0,r.default)(t).getInstance().getLogger(h),$(),n.on(_.default.PLAYBACK_SEEKING,X,h),n.on(_.default.MEDIA_FRAGMENT_LOADED,W,h),n.on(_.default.METRIC_ADDED,b,h),n.on(_.default.QUALITY_CHANGE_REQUESTED,Q,h)}function S(K){var ee={},se=K.getMediaInfo(),ue=se.bitrateList.map(function(oe){return oe.bandwidth/1e3});return ee.state=p,ee.bitrates=ue,ee.lastQuality=0,L(se),U(ee),ee}function L(K){!K||!K.type||(o[K.type]={},o[K.type].w=[],o[K.type].prev_w=[],o[K.type].Q=0,o[K.type].segment_request_start_s=0,o[K.type].segment_download_finish_s=0,o[K.type].B_target=1.5)}function U(K){K.placeholderBuffer=0,K.mostAdvancedSegmentStart=NaN,K.lastSegmentWasReplacement=!1,K.lastSegmentStart=NaN,K.lastSegmentDurationS=NaN,K.lastSegmentRequestTimeMs=NaN,K.lastSegmentFinishTimeMs=NaN}function k(K){var ee=K.getMediaType(),se=c[ee];return se||(se=S(K),c[ee]=se),se}function X(){for(var K in c)if(c.hasOwnProperty(K)){var ee=c[K];ee.state!==M&&(ee.state=p,U(ee))}}function W(K){if(K&&K.chunk&&K.chunk.mediaInfo){var ee=c[K.chunk.mediaInfo.type],se=o[K.chunk.mediaInfo.type];if(ee&&ee.state!==M){var ue=K.chunk.start;isNaN(ee.mostAdvancedSegmentStart)||ue>ee.mostAdvancedSegmentStart?(ee.mostAdvancedSegmentStart=ue,ee.lastSegmentWasReplacement=!1):ee.lastSegmentWasReplacement=!0,ee.lastSegmentStart=ue,ee.lastSegmentDurationS=K.chunk.duration,ee.lastQuality=K.chunk.quality,j(ee,se)}}}function b(K){if(K&&K.metric===I.default.HTTP_REQUEST&&K.value&&K.value.type===f.HTTPRequest.MEDIA_SEGMENT_TYPE&&K.value.trace&&K.value.trace.length){var ee=c[K.mediaType],se=o[K.mediaType];ee&&ee.state!==M&&(ee.lastSegmentRequestTimeMs=K.value.trequest.getTime(),ee.lastSegmentFinishTimeMs=K.value._tfinish.getTime(),j(ee,se))}}function j(K,ee){!isNaN(K.lastSegmentStart)&&!isNaN(K.lastSegmentRequestTimeMs)&&(ee.segment_request_start_s=.001*K.lastSegmentRequestTimeMs,ee.segment_download_finish_s=.001*K.lastSegmentFinishTimeMs,K.lastSegmentStart=NaN,K.lastSegmentRequestTimeMs=NaN)}function Q(K){if(K&&K.mediaType){var ee=c[K.mediaType];ee&&ee.state!==M&&(ee.abrQuality=K.newQuality)}}function q(K,ee){if(K.length!==ee.length)return-1;for(var se=0,ue=0;ue<K.length;ue++)se=se+K[ue]*ee[ue];return se}function Y(K){for(var ee=K.length,se=!1,ue=[],oe=0;oe<ee;++oe)ue[oe]=K[oe];for(var Z=K.sort(function(u,D){return D-u}),H=0,V=0,te=[],z=0;z<ee-1;++z)if(H=H+Z[z],V=(H-1)/(z+1),V>=Z[z+1]){se=!0;break}se||(V=(H+Z[ee-1]-1)/ee);for(var R=0;R<ee;++R)te[R]=Math.max(ue[R]-V,0);return te}function J(K){var ee=(0,g.default)(t).create(),se=4,ue=Math.pow(se,.99),oe=Math.max(Math.pow(se,1),ue*Math.sqrt(se)),Z=K.getMediaInfo(),H=K.getMediaType(),V=Z.bitrateList.map(function(Fe){return Fe.bandwidth}),te=V.length,z=K.getScheduleController(),R=K.getStreamInfo(),u=K.getAbrController(),D=u.getThroughputHistory(),F=R&&R.manifestInfo&&R.manifestInfo.isDynamic,w=K.useL2AABR(),O=m.getCurrentBufferLevel(H,!0),P=D.getSafeAverageThroughput(H,F),B=D.getAverageThroughput(H,F),x=2,ne=D.getAverageLatency(H),re=K.getVideoModel(),G,fe=re.getPlaybackRate();if(!K||!K.hasOwnProperty("getMediaInfo")||!K.hasOwnProperty("getMediaType")||!K.hasOwnProperty("getScheduleController")||!K.hasOwnProperty("getStreamInfo")||!K.hasOwnProperty("getAbrController")||!K.hasOwnProperty("useL2AABR")||(ee.reason=ee.reason||{},!w||H===T.default.AUDIO))return ee;z.setTimeToLoadDelay(0);var le=k(K);if(le.state===M)return ee;var _e=o[H];if(!_e||(ee.reason.state=le.state,ee.reason.throughput=B,ee.reason.latency=ne,isNaN(B)))return ee;switch(le.state){case p:if(G=u.getQualityForBitrate(Z,P,R.id,ne),ee.quality=G,ee.reason.throughput=P,le.lastQuality=G,!isNaN(le.lastSegmentDurationS)&&O>=_e.B_target){le.state=C,_e.Q=ue;for(var Me=0;Me<te;++Me)Me===le.lastQuality?_e.prev_w[Me]=1:_e.prev_w[Me]=0}break;case C:var Oe=[],Ne=m.getCurrentHttpRequest(H).trace.reduce(function(Fe,Be){return Fe+Be.d},0),xe=m.getCurrentHttpRequest(H).trace.reduce(function(Fe,Be){return Fe+Be.b[0]},0),Se=Math.round(8*xe/Ne);Se<1&&(Se=1);for(var me=le.lastSegmentDurationS,Ae=1,He=0;He<te;++He)V[He]=V[He]/1e3,fe*V[He]>Se&&(Ae=-1),_e.w[He]=_e.prev_w[He]+Ae*(me/(2*oe))*((_e.Q+ue)*(fe*V[He]/Se));_e.w=Y(_e.w);for(var Qe=0;Qe<te;++Qe)Oe[Qe]=_e.w[Qe]-_e.prev_w[Qe],_e.prev_w[Qe]=_e.w[Qe];_e.Q=Math.max(0,_e.Q-me+me*fe*((q(V,_e.prev_w)+q(V,Oe))/Se));for(var Je=[],ye=0;ye<te;++ye)Je[ye]=Math.abs(V[ye]-q(_e.w,V));G=Je.indexOf(Math.min.apply(Math,Je)),G>le.lastQuality&&V[le.lastQuality+1]<=Se&&(G=le.lastQuality+1),V[G]>=Se&&(_e.Q=x*Math.max(ue,_e.Q)),ee.quality=G,ee.reason.throughput=B,ee.reason.latency=ne,ee.reason.bufferLevel=O,le.lastQuality=ee.quality;break;default:l.debug("L2A ABR rule invoked in bad state."),ee.quality=u.getQualityForBitrate(Z,P,R.id,ne),ee.reason.state=le.state,ee.reason.throughput=P,ee.reason.latency=ne,le.state=p,U(le)}return ee}function $(){c={},o={}}function ae(){$(),n.off(_.default.PLAYBACK_SEEKING,X,h),n.off(_.default.MEDIA_FRAGMENT_LOADED,W,h),n.off(_.default.METRIC_ADDED,b,h),n.off(_.default.QUALITY_CHANGE_REQUESTED,Q,h)}return h={getMaxIndex:J,reset:ae},A(),h}v.__dashjs_factory_name="L2ARule";const E=d.default.getClassFactory(v)},"./src/streaming/rules/abr/SwitchHistoryRule.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});var I=e("./src/core/FactoryMaker.js"),g=e("./src/core/Debug.js"),d=e("./src/streaming/rules/SwitchRequest.js");function f(){var _=this.context,r,T,M=.075,p=6;function C(){T=(0,g.default)(_).getInstance().getLogger(r)}function v(E){for(var i=E?E.getSwitchHistory():null,t=i?i.getSwitchRequests():[],m=0,n=0,h=0,c=(0,d.default)(_).create(),o=0;o<t.length;o++)if(t[o]!==void 0&&(m+=t[o].drops,n+=t[o].noDrops,h+=t[o].dropSize,m+n>=p&&m/n>M)){c.quality=o>0&&t[o].drops>0?o-1:o,c.reason={index:c.quality,drops:m,noDrops:n,dropSize:h},T.debug("Switch history rule index: "+c.quality+" samples: "+(m+n)+" drops: "+m);break}return c}return r={getMaxIndex:v},C(),r}f.__dashjs_factory_name="SwitchHistoryRule";const y=I.default.getClassFactory(f)},"./src/streaming/rules/abr/ThroughputRule.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>_});var I=e("./src/core/FactoryMaker.js"),g=e("./src/streaming/rules/SwitchRequest.js"),d=e("./src/streaming/constants/Constants.js"),f=e("./src/streaming/constants/MetricsConstants.js");function y(r){r=r||{};var T=this.context,M=r.dashMetrics,p;function C(){if(!M||!M.hasOwnProperty("getCurrentBufferState"))throw new Error(d.default.MISSING_CONFIG_ERROR)}function v(i){var t=(0,g.default)(T).create();if(!i||!i.hasOwnProperty("getMediaInfo")||!i.hasOwnProperty("getMediaType")||!i.hasOwnProperty("useBufferOccupancyABR")||!i.hasOwnProperty("getAbrController")||!i.hasOwnProperty("getScheduleController"))return t;C();var m=i.getMediaInfo(),n=i.getMediaType(),h=M.getCurrentBufferState(n),c=i.getScheduleController(),o=i.getAbrController(),l=i.getStreamInfo(),A=l?l.id:null,S=l&&l.manifestInfo?l.manifestInfo.isDynamic:null,L=o.getThroughputHistory(),U=L.getSafeAverageThroughput(n,S),k=L.getAverageLatency(n),X=i.useBufferOccupancyABR();return isNaN(U)||!h||X||o.getAbandonmentStateFor(A,n)!==f.default.ABANDON_LOAD&&(h.state===f.default.BUFFER_LOADED||S)&&(t.quality=o.getQualityForBitrate(m,U,A,k),c.setTimeToLoadDelay(0),t.reason={throughput:U,latency:k}),t}function E(){}return p={getMaxIndex:v,reset:E},p}y.__dashjs_factory_name="ThroughputRule";const _=I.default.getClassFactory(y)},"./src/streaming/rules/abr/lolp/LearningAbrController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});var I=e("./src/core/FactoryMaker.js"),g=e("./src/core/Debug.js"),d={MANUAL:"manual_weight_selection",RANDOM:"random_weight_selection",DYNAMIC:"dynamic_weight_selection"};function f(){var _=this.context,r,T,M,p,C,v,E,i,t;function m(){T=(0,g.default)(_).getInstance().getLogger(r),h()}function n(){h()}function h(){M=null,p=1,C=100,v=0,E=null,i=null,t=d.DYNAMIC}function c(){var J=0;if(M)for(var $=0;$<M.length;$++){var ae=M[$];ae.state.throughput>J&&(J=ae.state.throughput)}return J}function o(J){var $=J.map(function(ae){return Math.pow(ae,2)}).reduce(function(ae,K){return ae+K});return Math.sqrt($)}function l(J,$,ae){var K=J.map(function(se,ue){return ae[ue]*Math.pow(se-$[ue],2)}).reduce(function(se,ue){return se+ue}),ee=K<0?-1:1;return ee*Math.sqrt(Math.abs(K))}function A(J,$){var ae=[J.state.throughput,J.state.latency,J.state.rebuffer,J.state.switch],K=[$.state.throughput,$.state.latency,$.state.rebuffer,$.state.switch];return l(ae,K,[1,1,1,1])}function S(J,$,ae){for(var K=0;K<$.length;K++){var ee=$[K],se=.1,ue=A(ee,J),oe=Math.exp(-1*Math.pow(ue,2)/(2*Math.pow(se,2)));L(ee,ae,oe)}}function L(J,$,ae){var K=J.state,ee=[.01,.01,.01,.01];K.throughput=K.throughput+($[0]-K.throughput)*ee[0]*ae,K.latency=K.latency+($[1]-K.latency)*ee[1]*ae,K.rebuffer=K.rebuffer+($[2]-K.rebuffer)*ee[2]*ae,K.switch=K.switch+($[3]-K.switch)*ee[3]*ae}function U(J,$){var ae=0,K=J;if(M)for(var ee=0;ee<M.length;ee++){var se=M[ee];se.bitrate<J.bitrate&&se.bitrate>ae&&$>se.bitrate&&(ae=se.bitrate,K=se)}return K}function k(J,$,ae,K,ee,se,ue){var oe=ae,Z=K,H=$,V=Q(J),te=$/p;te>1&&(te=c()),ae=ae/C;var z=0,R=0,u=0,D=1e4;T.debug("getNextQuality called throughput:".concat(te," latency:").concat(ae," bufferSize:").concat(K," currentQualityIndex:").concat(se," playbackRate:").concat(ee));var F=V[se],w=F.bitrate*ue.getSegmentDuration()/H,O=Math.max(0,w-Z);if(Z-w<ue.getMinBuffer())return T.debug("Buffer is low for bitrate= ".concat(F.bitrate," downloadTime=").concat(w," currentBuffer=").concat(Z," rebuffer=").concat(O)),U(F,H).qualityIndex;switch(t){case d.MANUAL:X();break;case d.RANDOM:W(V);break;case d.DYNAMIC:b(ue,V,oe,Z,O,H,ee);break;default:b(ue,V,oe,Z,O,H,ee)}for(var P=null,B=null,x=null,ne=0;ne<V.length;ne++){var re=V[ne],G=re.state,fe=[G.throughput,G.latency,G.rebuffer,G.switch],le=E.slice(),_e=ue.getNextBufferWithBitrate(re.bitrate,Z,H),Me=_e<ue.getMinBuffer();Me&&T.debug("Buffer is low for bitrate=".concat(re.bitrate," downloadTime=").concat(w," currentBuffer=").concat(Z," nextBuffer=").concat(_e)),(re.bitrate>$-D||Me)&&re.bitrate!==v&&(le[0]=100);var Oe=l(fe,[te,z,R,u],le);(P===null||Oe<P)&&(P=Oe,B=re.qualityIndex,x=re)}var Ne=Math.abs(F.bitrate-x.bitrate)/p;return S(F,V,[te,ae,O,Ne]),S(x,V,[te,z,R,Ne]),B}function X(){var J=.4,$=.4,ae=.4,K=.4;E=[J,$,ae,K]}function W(J){E=j(J.length,4)}function b(J,$,ae,K,ee,se,ue){E||(E=i[i.length-1]);var oe=J.findWeightVector($,ae,K,ee,se,ue);oe!==null&&oe!==-1&&(E=oe)}function j(J,$){for(var ae=[],K=Math.sqrt(2/J),ee=0;ee<$;ee++)ae.push(Math.random()*K);return E=ae,E}function Q(J){if(!M){M=[];var $=J.bitrateList,ae=[];v=$[0].bandwidth,$.forEach(function(se){ae.push(se.bandwidth),se.bandwidth<v&&(v=se.bandwidth)}),p=o(ae);for(var K=0;K<$.length;K++){var ee={qualityIndex:K,bitrate:$[K].bandwidth,state:{throughput:$[K].bandwidth/p,latency:0,rebuffer:0,switch:0}};M.push(ee)}i=Y(M)}return M}function q(J){for(var $=[],ae=0;ae<J;ae++){var K=[Math.random()*c(),Math.random(),Math.random(),Math.random()];$.push(K)}return $}function Y(J){var $=[],ae=q(Math.pow(J.length,2));$.push(ae[0]);for(var K=[1,1,1,1],ee=1;ee<J.length;ee++){for(var se=null,ue=null,oe=0;oe<ae.length;oe++){for(var Z=ae[oe],H=null,V=0;V<$.length;V++){var te=l(Z,$[V],K);(H===null||te<H)&&(H=te)}(ue===null||H>ue)&&(se=Z,ue=H)}$.push(se)}for(var z=null,R=null,u=0;u<$.length;u++){for(var D=0,F=0;F<$.length;F++)u!==F&&(D+=l($[u],$[F],K));(z===null||D>z)&&(z=D,R=u)}var w=[];for(w.push($[R]),$.splice(R,1);$.length>0;){for(var O=null,P=null,B=0;B<$.length;B++){var x=l(w[0],$[B],K);(O===null||x<O)&&(O=x,P=B)}w.push($[P]),$.splice(P,1)}return w}return r={getNextQuality:k,reset:n},m(),r}f.__dashjs_factory_name="LearningAbrController";const y=I.default.getClassFactory(f)},"./src/streaming/rules/abr/lolp/LoLpQoEEvaluator.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>f});var I=e("./src/core/FactoryMaker.js"),g=e("./src/streaming/rules/abr/lolp/QoeInfo.js");function d(){var y,_,r,T,M;function p(){C()}function C(){_=null,r=null,T=null,M=null}function v(c,o,l){_=E("segment",c,o,l),r=c,T=o,M=l}function E(c,o,l,A){var S=new g.default;return S.type=c,o?S.weights.bitrateReward=o:S.weights.bitrateReward=1,S.weights.bitrateSwitchPenalty=1,l?S.weights.rebufferPenalty=l:S.weights.rebufferPenalty=1e3,S.weights.latencyPenalty=[],S.weights.latencyPenalty.push({threshold:1.1,penalty:A*.05}),S.weights.latencyPenalty.push({threshold:1e8,penalty:l*.1}),A?S.weights.playbackSpeedPenalty=A:S.weights.playbackSpeedPenalty=200,S}function i(c,o,l,A){_&&t(c,o,l,A,_)}function t(c,o,l,A,S){S.bitrateWSum+=S.weights.bitrateReward*c,S.lastBitrate&&(S.bitrateSwitchWSum+=S.weights.bitrateSwitchPenalty*Math.abs(c-S.lastBitrate)),S.lastBitrate=c,S.rebufferWSum+=S.weights.rebufferPenalty*o;for(var L=0;L<S.weights.latencyPenalty.length;L++){var U=S.weights.latencyPenalty[L];if(l<=U.threshold){S.latencyWSum+=U.penalty*l;break}}S.playbackSpeedWSum+=S.weights.playbackSpeedPenalty*Math.abs(1-A),S.totalQoe=S.bitrateWSum-S.bitrateSwitchWSum-S.rebufferWSum-S.latencyWSum-S.playbackSpeedWSum}function m(){return _}function n(c,o,l,A){var S=null;return r&&T&&M&&(S=E("segment",r,T,M)),S?(t(c,o,l,A,S),S.totalQoe):0}function h(){C()}return y={setupPerSegmentQoe:v,logSegmentMetrics:i,getPerSegmentQoe:m,calculateSingleUseQoe:n,reset:h},p(),y}d.__dashjs_factory_name="LoLpQoeEvaluator";const f=I.default.getClassFactory(d)},"./src/streaming/rules/abr/lolp/LoLpRule.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>v});var I=e("./src/core/Debug.js"),g=e("./src/core/FactoryMaker.js"),d=e("./src/streaming/rules/abr/lolp/LearningAbrController.js"),f=e("./src/streaming/rules/abr/lolp/LoLpQoEEvaluator.js"),y=e("./src/streaming/rules/SwitchRequest.js"),_=e("./src/streaming/constants/MetricsConstants.js"),r=e("./src/streaming/rules/abr/lolp/LoLpWeightSelector.js"),T=e("./src/streaming/constants/Constants.js"),M=1.5,p=.3;function C(E){E=E||{};var i=E.dashMetrics,t=this.context,m,n,h,c;function o(){m=(0,I.default)(t).getInstance().getLogger(n),h=(0,d.default)(t).create(),c=(0,f.default)(t).create()}function l(L){try{var U=(0,y.default)(t).create(),k=L.getMediaInfo().type,X=L.getAbrController(),W=L.getStreamInfo(),b=X.getQualityFor(k,W.id),j=L.getMediaInfo(),Q=i.getCurrentBufferState(k),q=L.getScheduleController(),Y=i.getCurrentBufferLevel(k,!0),J=W&&W.manifestInfo?W.manifestInfo.isDynamic:null,$=q.getPlaybackController(),ae=$.getCurrentLiveLatency();if(!L.useLoLPABR()||k===T.default.AUDIO)return U;ae||(ae=0);var K=$.getPlaybackRate(),ee=X.getThroughputHistory(),se=ee.getSafeAverageThroughput(k,J);if(m.debug("Throughput ".concat(Math.round(se)," kbps")),isNaN(se)||!Q||X.getAbandonmentStateFor(W.id,k)===_.default.ABANDON_LOAD)return U;for(var ue=j.bitrateList,oe=L.getRepresentationInfo().fragmentDuration,Z=ue[0].bandwidth/1e3,H=ue[ue.length-1].bandwidth/1e3,V=0;V<ue.length;V++){var te=ue[V].bandwidth/1e3;te>H?H=te:te<Z&&(Z=te)}var z=ue[b].bandwidth,R=z/1e3,u=i.getCurrentHttpRequest(k,!0),D=(u.tresponse.getTime()-u.trequest.getTime())/1e3,F=D>oe?D-oe:0;c.setupPerSegmentQoe(oe,H,Z),c.logSegmentMetrics(R,F,ae,K);var w=(0,r.default)(t).create({targetLatency:M,bufferMin:p,segmentDuration:oe,qoeEvaluator:c});return U.quality=h.getNextQuality(j,se*1e3,ae,Y,K,b,w),U.reason={throughput:se,latency:ae},U.priority=y.default.PRIORITY.STRONG,q.setTimeToLoadDelay(0),U.quality!==b&&console.log("[TgcLearningRule]["+k+"] requesting switch to index: ",U.quality,"Average throughput",Math.round(se),"kbps"),U}catch(O){throw O}}function A(){h.reset(),c.reset()}function S(){A()}return n={getMaxIndex:l,reset:S},o(),n}C.__dashjs_factory_name="LoLPRule";const v=g.default.getClassFactory(C)},"./src/streaming/rules/abr/lolp/LoLpWeightSelector.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});var I=e("./src/core/FactoryMaker.js");function g(f){var y=f.targetLatency,_=f.bufferMin,r=f.segmentDuration,T=f.qoeEvaluator,M,p,C,v,E;function i(){t()}function t(){p=[.2,.4,.6,.8,1],C=4,v=h(p,C),E=0}function m(S,L,U,k,X,W){var b=null,j=null,Q=null,q=Math.abs(L-E);return S.forEach(function(Y){v.forEach(function(J){var $={throughput:J[0],latency:J[1],buffer:J[2],switch:J[3]},ae=Y.bitrate*r/X,K=A(U,ae),ee=Math.max(1e-5,ae-K),se;$.buffer===0?se=10:se=1/$.buffer;var ue=se*ee;$.latency===0?se=10:se=1/$.latency;var oe=se*Y.state.latency,Z=T.calculateSingleUseQoe(Y.bitrate,ue,oe,W);(b===null||Z>b)&&n(L,K,q)&&(b=Z,j=J,Q=Y.bitrate)})}),j===null&&Q===null&&(j=-1),E=L,j}function n(S,L,U){return S>y+U?!1:L>=_}function h(S,L){var U=S.map(function(X){return[X]}),k=function X(W,b,j){if(j===b)return W;for(var Q=W.length,q=0;q<Q;q++)for(var Y=W.shift(),J=0;J<S.length;J++)W.push(Y.concat(S[J]));return X(W,b,j+1)};return k(U,L,1)}function c(){return _}function o(){return r}function l(S,L,U){var k=S*r/U;return A(L,k)}function A(S,L){var U=o(),k;return L>U?k=S-U:k=S+U-L,k}return M={getMinBuffer:c,getSegmentDuration:o,getNextBufferWithBitrate:l,getNextBuffer:A,findWeightVector:m},i(),M}g.__dashjs_factory_name="LoLpWeightSelector";const d=I.default.getClassFactory(g)},"./src/streaming/rules/abr/lolp/QoeInfo.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.type=null,this.lastBitrate=null,this.weights={},this.weights.bitrateReward=null,this.weights.bitrateSwitchPenalty=null,this.weights.rebufferPenalty=null,this.weights.latencyPenalty=null,this.weights.playbackSpeedPenalty=null,this.bitrateWSum=0,this.bitrateSwitchWSum=0,this.rebufferWSum=0,this.latencyWSum=0,this.playbackSpeedWSum=0,this.totalQoe=0};const d=g},"./src/streaming/text/EmbeddedTextHtmlRender.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});var I=e("./src/core/FactoryMaker.js");function g(){var f=0,y;function _(E){for(var i="",t=0;t<E.length;++t){var m=E[t];i+=m.uchar}var n=i.length,h=i.replace(/^\s+/,"").length;return n-h}function r(E){return"left: "+E.x*3.125+"%; top: "+E.y1*6.66+"%; width: "+(100-E.x*3.125)+"%; height: "+Math.max(E.y2-1-E.y1,1)*6.66+"%; align-items: flex-start; overflow: visible; -webkit-writing-mode: horizontal-tb;"}function T(E){return E==="red"?"rgb(255, 0, 0)":E==="green"?"rgb(0, 255, 0)":E==="blue"?"rgb(0, 0, 255)":E==="cyan"?"rgb(0, 255, 255)":E==="magenta"?"rgb(255, 0, 255)":E==="yellow"?"rgb(255, 255, 0)":E==="white"?"rgb(255, 255, 255)":E==="black"?"rgb(0, 0, 0)":E}function M(E,i){var t=E.videoHeight/15;return i?"font-size: "+t+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; color: "+(i.foreground?T(i.foreground):"rgb(255, 255, 255)")+"; font-style: "+(i.italics?"italic":"normal")+"; text-decoration: "+(i.underline?"underline":"none")+"; white-space: pre; background-color: "+(i.background?T(i.background):"transparent")+";":"font-size: "+t+"px; font-family: Menlo, Consolas, 'Cutive Mono', monospace; justify-content: flex-start; text-align: left; color: rgb(255, 255, 255); font-style: normal; white-space: pre; line-height: normal; font-weight: normal; text-decoration: none; width: 100%; display: flex;"}function p(E){return E.replace(/^\s+/g,"")}function C(E){return E.replace(/\s+$/g,"")}function v(E,i,t,m){var n=null,h=null,c=!1,o=-1,l={start:i,end:t,spans:[]},A="style_cea608_white_black",S={},L={},U=[],k,X;for(k=0;k<15;++k){var W=m.rows[k],b="",j=null;if(W.isEmpty()===!1){var Q=_(W.chars);n===null&&(n={x:Q,y1:k,y2:k+1,p:[]}),Q!==o&&c&&(n.p.push(l),l={start:i,end:t,spans:[]},n.y2=k,n.name="region_"+n.x+"_"+n.y1+"_"+n.y2,S.hasOwnProperty(n.name)===!1?(U.push(n),S[n.name]=n):(h=S[n.name],h.p.contat(n.p)),n={x:Q,y1:k,y2:k+1,p:[]});for(var q=0;q<W.chars.length;++q){var Y=W.chars[q],J=Y.penState;if(j===null||!J.equals(j)){b.trim().length>0&&(l.spans.push({name:A,line:b,row:k}),b="");var $="style_cea608_"+J.foreground+"_"+J.background;J.underline&&($+="_underline"),J.italics&&($+="_italics"),L.hasOwnProperty($)||(L[$]=JSON.parse(JSON.stringify(J))),j=J,A=$}b+=Y.uchar}b.trim().length>0&&l.spans.push({name:A,line:b,row:k}),c=!0,o=Q}else c=!1,o=-1,n&&(n.p.push(l),l={start:i,end:t,spans:[]},n.y2=k,n.name="region_"+n.x+"_"+n.y1+"_"+n.y2,S.hasOwnProperty(n.name)===!1?(U.push(n),S[n.name]=n):(h=S[n.name],h.p.contat(n.p)),n=null)}n&&(n.p.push(l),n.y2=k+1,n.name="region_"+n.x+"_"+n.y1+"_"+n.y2,S.hasOwnProperty(n.name)===!1?(U.push(n),S[n.name]=n):(h=S[n.name],h.p.contat(n.p)),n=null);var ae=[];for(k=0;k<U.length;++k){var K=U[k],ee="sub_cea608_"+f++,se=document.createElement("div");se.id=ee;var ue=r(K);se.style.cssText="position: absolute; margin: 0; display: flex; box-sizing: border-box; pointer-events: none;"+ue;var oe=document.createElement("div");oe.className="paragraph bodyStyle",oe.style.cssText=M(E);var Z=document.createElement("div");Z.className="cueUniWrapper",Z.style.cssText="unicode-bidi: normal; direction: ltr;";for(var H=0;H<K.p.length;++H){var V=K.p[H],te=0;for(X=0;X<V.spans.length;++X){var z=V.spans[X];if(z.line.length>0){if(X!==0&&te!=z.row){var R=document.createElement("br");R.className="lineBreak",Z.appendChild(R)}var u=!1;te===z.row&&(u=!0),te=z.row;var D=L[z.name],F=document.createElement("span");F.className="spanPadding "+z.name+" customSpanColor",F.style.cssText=M(E,D),X!==0&&u?X===V.spans.length-1?F.textContent=C(z.line):F.textContent=z.line:V.spans.length>1&&X<V.spans.length-1&&z.row===V.spans[X+1].row?F.textContent=p(z.line):F.textContent=z.line.trim(),Z.appendChild(F)}}}oe.appendChild(Z),se.appendChild(oe);var w={bodyStyle:["%",90]};for(var O in L)L.hasOwnProperty(O)&&(w[O]=["%",90]);ae.push({type:"html",start:i,end:t,cueHTMLElement:se,cueID:ee,cellResolution:[32,15],isFromCEA608:!0,fontSize:w,lineHeight:{},linePadding:{}})}return ae}return y={createHTMLCaptionsFromScreen:v},y}g.__dashjs_factory_name="EmbeddedTextHtmlRender";const d=I.default.getSingletonFactory(g)},"./src/streaming/text/NotFragmentedTextBufferController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>p});var I=e("./src/core/EventBus.js"),g=e("./src/core/events/Events.js"),d=e("./src/core/FactoryMaker.js"),f=e("./src/streaming/utils/InitCache.js"),y=e("./src/streaming/SourceBufferSink.js"),_=e("./src/streaming/vo/DashJSError.js"),r=e("./src/core/errors/Errors.js"),T="NotFragmentedTextBufferController";function M(C){C=C||{};var v=this.context,E=(0,I.default)(v).getInstance(),i=C.textController,t=C.errHandler,m=C.streamInfo,n=C.type,h,c,o,l,A,S;function L(){o=!1,l=null,c=!1,S=(0,f.default)(v).getInstance(),E.on(g.default.INIT_FRAGMENT_LOADED,ue,h)}function U(){return T}function k(x){Q(x)}function X(x){return new Promise(function(ne,re){try{A=(0,y.default)(v).create({mediaSource:l,textController:i,eventBus:E}),A.initializeForFirstUse(m,x),o||(A.getBuffer()&&typeof A.getBuffer().initialize=="function"&&A.getBuffer().initialize(),o=!0),ne(A)}catch(G){t.error(new _.default(r.default.MEDIASOURCE_TYPE_UNSUPPORTED_CODE,r.default.MEDIASOURCE_TYPE_UNSUPPORTED_MESSAGE+n)),re(G)}})}function W(){return m.id}function b(){return n}function j(){return A}function Q(x){l=x}function q(){return l}function Y(){return!1}function J(){}function $(){return 0}function ae(){return c}function K(x){c!==x&&(c=x,c&&B(g.default.BUFFERING_COMPLETED))}function ee(x){E.off(g.default.INIT_FRAGMENT_LOADED,ue,h),!x&&A&&(A.abort(),A.reset(),A=null)}function se(x){return S.extract(m.id,x)!==null}function ue(x){!x.chunk.bytes||c||(S.save(x.chunk),A.append(x.chunk),K(!0))}function oe(){return null}function Z(){return!0}function H(){return[]}function V(){return Number.POSITIVE_INFINITY}function te(){return Promise.resolve()}function z(){}function R(){return Promise.resolve()}function u(){return Promise.resolve()}function D(){return c=!1,Promise.resolve()}function F(){return Promise.resolve()}function w(){}function O(){}function P(){return Promise.resolve()}function B(x,ne){var re=ne||{};E.trigger(x,re,{streamId:m.id,mediaType:n})}return h={initialize:k,getStreamId:W,getType:b,getBufferControllerType:U,createBufferSink:X,dischargePreBuffer:J,getBuffer:j,getBufferLevel:$,getRangeAt:oe,pruneBuffer:z,hasBufferAtTime:Z,getAllRangesWithSafetyFactor:H,getContinuousBufferTimeForTargetTime:V,setMediaSource:Q,getMediaSource:q,appendInitSegmentFromCache:se,getIsBufferingCompleted:ae,setIsBufferingCompleted:K,getIsPruningInProgress:Y,reset:ee,clearBuffers:te,prepareForPlaybackSeek:u,prepareForReplacementTrackSwitch:D,setSeekTarget:w,updateAppendWindow:F,pruneAllSafely:P,updateBufferTimestampOffset:R,segmentRequestingCompleted:O},L(),h}M.__dashjs_factory_name=T;const p=d.default.getClassFactory(M)},"./src/streaming/text/TextController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>E});var I=e("./src/streaming/constants/Constants.js"),g=e("./src/core/FactoryMaker.js"),d=e("./src/streaming/text/TextSourceBuffer.js"),f=e("./src/streaming/text/TextTracks.js"),y=e("./src/streaming/utils/VTTParser.js"),_=e("./src/streaming/utils/VttCustomRenderingParser.js"),r=e("./src/streaming/utils/TTMLParser.js"),T=e("./src/core/EventBus.js"),M=e("./src/core/events/Events.js"),p=e("./src/streaming/MediaPlayerEvents.js"),C=e("./src/streaming/utils/SupervisorTools.js");function v(i){var t=this.context,m=i.adapter,n=i.errHandler,h=i.manifestModel,c=i.mediaController,o=i.videoModel,l=i.settings,A,S,L,U,k,X,W,b,j,Q,q,Y;function J(){Q=!1,q=!1,Y=!1,k=(0,y.default)(t).getInstance(),X=(0,_.default)(t).getInstance(),W=(0,r.default)(t).getInstance(),b=(0,T.default)(t).getInstance(),P()}function $(){b.on(M.default.TEXT_TRACKS_QUEUE_INITIALIZED,Z,A),l.get().streaming.text.webvtt.customRenderingEnabled&&(b.on(M.default.PLAYBACK_TIME_UPDATED,H,A),b.on(M.default.PLAYBACK_SEEKING,V,A))}function ae(x){var ne=x.id,re=(0,f.default)(t).create({videoModel:o,settings:l,streamInfo:x});re.initialize(),U[ne]=re;var G=(0,d.default)(t).create({errHandler:n,adapter:m,manifestModel:h,mediaController:c,videoModel:o,textTracks:re,vttParser:k,vttCustomRenderingParser:X,ttmlParser:W,streamInfo:x,settings:l});G.initialize(),L[ne]=G,S[ne]={},S[ne].lastEnabledIndex=-1}function K(x){var ne=x.id;U[ne]&&U[ne].createTracks()}function ee(x,ne,re){var G=arguments.length>3&&arguments[3]!==void 0?arguments[3]:null,fe=x.id;L[fe]&&L[fe].addMediaInfos(ne,re,G)}function se(x){var ne=x.id;if(L&&L[ne])return L[ne]}function ue(){return j}function oe(x,ne){var re=x.id;L[re]&&L[re].addEmbeddedTrack(ne)}function Z(x){var ne=x.tracks,re=x.index,G=x.streamId,fe=l.get().streaming.text.defaultEnabled;if(fe===!1&&!z()||Y)u(G,-1);else{var le=c.getCurrentTrackFor(I.default.TEXT,G);if(le){var _e={lang:le.lang,role:le.roles[0],index:le.index,codec:le.codec,accessibility:le.accessibility[0]};ne.some(function(Me,Oe){if(c.matchSettings(_e,Me))return u(G,Oe),re=Oe,!0})}j=!1}S[G].lastEnabledIndex=re,b.trigger(p.default.TEXT_TRACKS_ADDED,{enabled:z(),index:re,tracks:ne,streamId:G}),q=!0}function H(x){try{var ne=x.streamId;if(!U[ne]||isNaN(x.time))return;U[ne].manualCueProcessing(x.time)}catch{}}function V(x){try{var ne=x.streamId;if(!U[ne])return;U[ne].disableManualTracks()}catch{}}function te(x,ne){(0,C.checkParameterType)(ne,"boolean"),z()!==ne&&(ne&&u(x,S[x].lastEnabledIndex),ne||(S[x].lastEnabledIndex=w(x),q?u(x,-1):Y=!0))}function z(){var x=!0;return j&&!Q&&(x=!1),x}function R(x){(0,C.checkParameterType)(x,"boolean"),Q=x}function u(x,ne){j=ne===-1,j&&c&&c.saveTextSettingsDisabled();var re=w(x);if(!(re===ne||!U[x])){U[x].disableManualTracks(),U[x].setModeForTrackIdx(re,I.default.TEXT_HIDDEN),U[x].setCurrentTrackIdx(ne),U[x].setModeForTrackIdx(ne,I.default.TEXT_SHOWING);var G=U[x].getCurrentTrackInfo();G&&G.isFragmented&&!G.isEmbedded?D(x,G,re):G&&!G.isFragmented&&F(x,G),c.setTrack(G)}}function D(x,ne,re){if(L[x])for(var G=L[x].getConfig(),fe=G.fragmentedTracks,le=0;le<fe.length;le++){var _e=fe[le];if(ne.lang===_e.lang&&(_e.id?ne.id===_e.id:ne.index===_e.index)){var Me=c.getCurrentTrackFor(I.default.TEXT,x);(_e.id?Me.id!==_e.id:Me.index!==_e.index)?(U[x].deleteCuesFromTrackIdx(re),L[x].setCurrentFragmentedTrackIdx(le)):re===-1&&b.trigger(M.default.SET_FRAGMENTED_TEXT_AFTER_DISABLED,{},{streamId:x,mediaType:I.default.TEXT})}}}function F(x,ne){b.trigger(M.default.SET_NON_FRAGMENTED_TEXT,{currentTrackInfo:ne},{streamId:x,mediaType:I.default.TEXT})}function w(x){return U[x].getCurrentTrackIdx()}function O(x){if(x){var ne=x.id;L[ne]&&L[ne].resetMediaInfos(),U[ne]&&U[ne].deleteAllTextTracks()}}function P(){L={},U={},S={},j=!0,q=!1,Y=!1}function B(){P(),b.off(M.default.TEXT_TRACKS_QUEUE_INITIALIZED,Z,A),l.get().streaming.text.webvtt.customRenderingEnabled&&(b.off(M.default.PLAYBACK_TIME_UPDATED,H,A),b.off(M.default.PLAYBACK_SEEKING,V,A)),Object.keys(L).forEach(function(x){L[x].resetEmbedded(),L[x].reset()})}return A={deactivateStream:O,initialize:$,initializeForStream:ae,createTracks:K,getTextSourceBuffer:se,getAllTracksAreDisabled:ue,addEmbeddedTrack:oe,enableText:te,isTextEnabled:z,setTextTrack:u,getCurrentTrackIdx:w,enableForcedTextStreaming:R,addMediaInfosToBuffer:ee,reset:B},J(),A}v.__dashjs_factory_name="TextController";const E=g.default.getClassFactory(v)},"./src/streaming/text/TextSourceBuffer.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>n});var I=e("./src/streaming/constants/Constants.js"),g=e("./src/streaming/vo/metrics/HTTPRequest.js"),d=e("./src/streaming/vo/TextTrackInfo.js"),f=e("./src/streaming/utils/BoxParser.js"),y=e("./src/streaming/utils/CustomTimeRanges.js"),_=e("./src/core/FactoryMaker.js"),r=e("./src/core/Debug.js"),T=e("./src/streaming/text/EmbeddedTextHtmlRender.js"),M=e("./node_modules/codem-isoboxer/dist/iso_boxer.js"),p=e("./externals/cea608-parser.js"),C=e.n(p),v=e("./src/core/EventBus.js"),E=e("./src/core/events/Events.js"),i=e("./src/streaming/vo/DashJSError.js"),t=e("./src/core/errors/Errors.js");function m(h){var c=h.errHandler,o=h.manifestModel,l=h.mediaController,A=h.videoModel,S=h.textTracks,L=h.vttParser,U=h.vttCustomRenderingParser,k=h.ttmlParser,X=h.streamInfo,W=h.settings,b=this.context,j=(0,v.default)(b).getInstance(),Q=!1,q,Y,J,$,ae,K,ee,se,ue,oe,Z,H,V,te,z,R;function u(){Y=(0,r.default)(b).getInstance().getLogger(q),J=(0,f.default)(b).getInstance(),w()}function D(){return X.id}function F(){K=null,se=NaN,ue=[],oe=null,ee=!1}function w(){F(),ae=[],$=null}function O(){Q||G()}function P(je,ge,ie){if(ae=ae.concat(ge),je===I.default.TEXT&&ge[0].isFragmented&&!ge[0].isEmbedded){K=ie,q.buffered=(0,y.default)(b).create(),ue=l.getTracksFor(I.default.TEXT,X.id).filter(function(We){return We.isFragmented});for(var he=l.getCurrentTrackFor(I.default.TEXT,X.id),De=0;De<ue.length;De++)if(ue[De]===he){Me(De);break}}for(var Ce=0;Ce<ge.length;Ce++)B(ge[Ce])}function B(je){var ge=new d.default,ie={subtitle:"subtitles",caption:"captions"};for(var he in je)ge[he]=je[he];ge.labels=je.labels,ge.defaultTrack=Ye(je),ge.isFragmented=je.isFragmented,ge.isEmbedded=!!je.isEmbedded,ge.isTTML=Oe(je),ge.kind=Ne(je,ie),S.addTextTrack(ge)}function x(){}function ne(){w(),ae=[],J=null}function re(je){var ge=je.chunk;ge.mediaInfo.embeddedCaptions&&xe(ge.bytes,ge)}function G(){H=[],Z=null,V=0,z=[],te=null,Q=!0,R=(0,T.default)(b).getInstance(),j.on(E.default.VIDEO_CHUNK_RECEIVED,re,q),j.on(E.default.BUFFER_CLEARED,nt,q)}function fe(){j.off(E.default.VIDEO_CHUNK_RECEIVED,re,q),j.off(E.default.BUFFER_CLEARED,nt,q),S&&S.deleteAllTextTracks(),Q=!1,H=[],z=[null,null],te=null}function le(je){if(Q&&je)if(je.id===I.default.CC1||je.id===I.default.CC3){for(var ge=0;ge<H.length;ge++)if(H[ge].id===je.id)return;H.push(je)}else Y.warn("Embedded track "+je.id+" not supported!")}function _e(){var je={fragmentModel:K,fragmentedTracks:ue,videoModel:A};return je}function Me(je){Z=je}function Oe(je){return je.codec&&je.codec.search(I.default.STPP)>=0||je.mimeType&&je.mimeType.search(I.default.TTML)>=0}function Ne(je,ge){var ie=je.roles&&je.roles.length>0?ge[je.roles[0]]:ge.caption;return ie=ie===ge.caption||ie===ge.subtitle?ie:ge.caption,ie}function xe(je,ge){var ie=ge.mediaInfo,he=ie.type,De=ie.mimeType,Ce=ie.codec||De;if(!Ce){Y.error("No text type defined");return}ie.codec.indexOf("application/mp4")!==-1?Se(je,ge,Ce):he===I.default.VIDEO?Qe(je,ge):He(je,ge,Ce)}function Se(je,ge,ie){var he,De;if(ge.segmentType==="InitializationSegment")ee=!0,se=J.getMediaTimescaleFromMoov(je);else{if(!ee)return;De=J.getSamplesInfo(je),he=De.sampleList,he.length>0&&(oe=he[0].cts-ge.start*se),ie.search(I.default.STPP)>=0?me(je,he,ie):Ae(je,he)}}function me(je,ge,ie){var he,De;for($=$!==null?$:Ze(ie),he=0;he<ge.length;he++){var Ce=ge[he],We=Ce.cts,Xe=Be(),Ve=Xe+We/se,rt=Ve+Ce.duration/se;q.buffered.add(Ve,rt);var ut=new DataView(je,Ce.offset,Ce.subSizes[0]),mt=M.Utils.dataViewToString(ut,I.default.UTF8),ve=[],Le=Ce.offset+Ce.subSizes[0];for(De=1;De<Ce.subSizes.length;De++){var Ge=new Uint8Array(je,Le,Ce.subSizes[De]),at=String.fromCharCode.apply(null,Ge);ve.push(at),Le+=Ce.subSizes[De]}try{var et=o.getValue(),lt=et.ttmlTimeIsRelative?We/se:0,vt=$.parse(mt,lt,We/se,(We+Ce.duration)/se,ve);S.addCaptions(Z,Xe,vt)}catch(Mt){K.removeExecutedRequestsBeforeTime(),this.remove(),Y.error("TTML parser error: "+Mt.message)}}}function Ae(je,ge){var ie,he,De,Ce=[];for(ie=0;ie<ge.length;ie++){var We=ge[ie];We.cts-=oe;var Xe=Be(),Ve=Xe+We.cts/se,rt=Ve+We.duration/se;q.buffered.add(Ve,rt);var ut=je.slice(We.offset,We.offset+We.size),mt=M.parseBuffer(ut);for(he=0;he<mt.boxes.length;he++){var ve=mt.boxes[he];if(Y.debug("VTT box1: "+ve.type),ve.type!=="vtte"&&ve.type==="vttc")for(Y.debug("VTT vttc boxes.length = "+ve.boxes.length),De=0;De<ve.boxes.length;De++){var Le=ve.boxes[De];if(Y.debug("VTT box2: "+Le.type),Le.type==="payl"){var Ge=Le.cue_text;Y.debug("VTT cue_text = "+Ge);var at=We.cts/se,et=(We.cts+We.duration)/se;Ce.push({start:at,end:et,data:Ge,styles:{}}),Y.debug("VTT "+at+"-"+et+" : "+Ge)}}}}Ce.length>0&&S.addCaptions(Z,0,Ce)}function He(je,ge,ie){var he,De,Ce=new DataView(je,0,je.byteLength);De=M.Utils.dataViewToString(Ce,I.default.UTF8);try{he=Ze(ie).parse(De,0),S.addCaptions(S.getCurrentTrackIdx(),0,he),q.buffered&&q.buffered.add(ge.start,ge.end)}catch(We){c.error(new i.default(t.default.TIMED_TEXT_ERROR_ID_PARSE_CODE,t.default.TIMED_TEXT_ERROR_MESSAGE_PARSE+We.message,De))}}function Qe(je,ge){var ie,he;if(ge.segmentType===g.HTTPRequest.INIT_SEGMENT_TYPE)V===0&&(V=J.getMediaTimescaleFromMoov(je));else if(ge.segmentType===g.HTTPRequest.MEDIA_SEGMENT_TYPE){if(V===0){Y.warn("CEA-608: No timescale for embeddedTextTrack yet");return}he=J.getSamplesInfo(je);var De=he.lastSequenceNumber;if(!z[0]&&!z[1]&&Je(),V){if(te!==null&&De!==te+he.numSequences)for(ie=0;ie<z.length;ie++)z[ie]&&z[ie].reset();for(var Ce=Fe(je,he.sampleList),We=0;We<z.length;We++){var Xe=Ce.fields[We],Ve=z[We];if(Ve)for(ie=0;ie<Xe.length;ie++)Ve.addData(Xe[ie][0]/V,Xe[ie][1])}te=De}}}function Je(){for(var je,ge=0;ge<H.length;ge++){if(je=S.getTrackIdxForId(H[ge].id),je===-1){Y.warn("CEA-608: data before track is ready.");return}var ie=ye(je);z[ge]=new(C()).Cea608Parser(ge+1,{newCue:ie},null)}}function ye(je){function ge(ie,he,De){var Ce;if(A.getTTMLRenderingDiv())Ce=R.createHTMLCaptionsFromScreen(A.getElement(),ie,he,De);else{var We=De.getDisplayText();Ce=[{start:ie,end:he,data:We,styles:{}}]}Ce&&S.addCaptions(je,0,Ce)}return ge}function Fe(je,ge){if(ge.length===0)return null;for(var ie={splits:[],fields:[[],[]]},he=new DataView(je),De=0;De<ge.length;De++)for(var Ce=ge[De],We=C().findCea608Nalus(he,Ce.offset,Ce.size),Xe=null,Ve=0,rt=0;rt<We.length;rt++)for(var ut=C().extractCea608DataFromRange(he,We[rt]),mt=0;mt<2;mt++)if(ut[mt].length>0){Ce.cts!==Xe?Ve=0:Ve+=1;var ve=Be();ie.fields[mt].push([Ce.cts+ve*V,ut[mt],Ve]),Xe=Ce.cts}return ie.fields.forEach(function(Ge){Ge.sort(function(at,et){return at[0]===et[0]?at[2]-et[2]:at[0]-et[0]})}),ie}function Be(){return isNaN(q.timestampOffset)?0:q.timestampOffset}function Ye(je){var ge=!1;return H.length>1&&je.isEmbedded?ge=je.id&&je.id===I.default.CC1:H.length===1?je.id&&typeof je.id=="string"&&je.id.substring(0,2)==="CC"&&(ge=!0):H.length===0&&(ge=je.index===ae[0].index),ge}function Ze(je){var ge;return je.search(I.default.VTT)>=0?ge=W.get().streaming.text.webvtt.customRenderingEnabled&&U?U:L:(je.search(I.default.TTML)>=0||je.search(I.default.STPP)>=0)&&(ge=k),ge}function tt(je,ge){je===void 0&&je===ge&&(je=q.buffered.start(0),ge=q.buffered.end(q.buffered.length-1)),q.buffered.remove(je,ge),S.deleteCuesFromTrackIdx(Z,je,ge)}function nt(je){H.forEach(function(ge){var ie=S.getTrackIdxForId(ge.id);ie>=0&&S.deleteCuesFromTrackIdx(ie,je.from,je.to)})}function ht(){ae=[]}return q={initialize:O,addMediaInfos:P,resetMediaInfos:ht,getStreamId:D,append:xe,abort:x,addEmbeddedTrack:le,resetEmbedded:fe,getConfig:_e,setCurrentFragmentedTrackIdx:Me,remove:tt,reset:ne},u(),q}m.__dashjs_factory_name="TextSourceBuffer";const n=_.default.getClassFactory(m)},"./src/streaming/text/TextTracks.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>E});var I=e("./src/streaming/constants/Constants.js"),g=e("./src/core/EventBus.js"),d=e("./src/core/events/Events.js"),f=e("./src/streaming/MediaPlayerEvents.js"),y=e("./src/core/FactoryMaker.js"),_=e("./src/core/Debug.js"),r=e("./node_modules/imsc/src/main/js/main.js");function T(i,t){var m;if(typeof Symbol>"u"||i[Symbol.iterator]==null){if(Array.isArray(i)||(m=M(i))||t&&i&&typeof i.length=="number"){m&&(i=m);var n=0,h=function(){};return{s:h,n:function(){return n>=i.length?{done:!0}:{done:!1,value:i[n++]}},e:function(S){throw S},f:h}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var c=!0,o=!1,l;return{s:function(){m=i[Symbol.iterator]()},n:function(){var S=m.next();return c=S.done,S},e:function(S){o=!0,l=S},f:function(){try{!c&&m.return!=null&&m.return()}finally{if(o)throw l}}}}function M(i,t){if(i){if(typeof i=="string")return p(i,t);var m=Object.prototype.toString.call(i).slice(8,-1);if(m==="Object"&&i.constructor&&(m=i.constructor.name),m==="Map"||m==="Set")return Array.from(i);if(m==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(m))return p(i,t)}}function p(i,t){(t==null||t>i.length)&&(t=i.length);for(var m=0,n=new Array(t);m<t;m++)n[m]=i[m];return n}var C=["text","images","embeddedImages","align","fontSize","id","isd","line","lineAlign","lineHeight","linePadding","position","positionAlign","region","size","snapToLines","vertical"];function v(i){var t=this.context,m=(0,g.default)(t).getInstance(),n=i.videoModel,h=i.streamInfo,c=i.settings,o,l,A,S,L,U,k,X,W,b,j,Q,q,Y,J,$,ae,K;function ee(){l=(0,_.default)(t).getInstance().getLogger(o)}function se(){typeof window>"u"||typeof navigator>"u"||(A=window.VTTCue||window.TextTrackCue,S=[],L=[],U=-1,k=0,X=0,W=0,b=0,j=null,Q=null,q=null,J=!1,ae=2147483647,$=null,document.fullscreenElement!==void 0?Y="fullscreenElement":document.webkitIsFullScreen!==void 0?Y="webkitIsFullScreen":document.msFullscreenElement?Y="msFullscreenElement":document.mozFullScreen&&(Y="mozFullScreen"))}function ue(){return h.id}function oe(ye){var Fe=ye.kind,Be=ye.id!==void 0?ye.id:ye.lang,Ye=ye.lang,Ze=ye.isTTML,tt=ye.isEmbedded,nt=n.addTextTrack(Fe,Be,Ye,Ze,tt);return nt}function Z(ye){S.push(ye)}function H(){S.sort(function(ht,je){return ht.index-je.index}),j=n.getTTMLRenderingDiv(),Q=n.getVttRenderingDiv();for(var ye=-1,Fe=0;Fe<S.length;Fe++){var Be=oe(S[Fe]);L.push(Be),S[Fe].defaultTrack&&(Be.default=!0,ye=Fe);var Ye=ne(Fe);Ye&&(Ye.mode=I.default.TEXT_SHOWING,j&&(S[Fe].isTTML||S[Fe].isEmbedded)?Ye.renderingType="html":Ye.renderingType="default"),F(Fe,0,S[Fe].captionData),m.trigger(f.default.TEXT_TRACK_ADDED)}if(fe.call(this,ye),ye>=0){var Ze=function ht(){var je=ne(ye);je&&je.renderingType==="html"&&te.call(this,je,!0),m.off(f.default.PLAYBACK_METADATA_LOADED,ht,this)};m.on(f.default.PLAYBACK_METADATA_LOADED,Ze,this);for(var tt=0;tt<S.length;tt++){var nt=ne(tt);nt&&(nt.mode=tt===ye?I.default.TEXT_SHOWING:I.default.TEXT_HIDDEN,nt.manualMode=tt===ye?I.default.TEXT_SHOWING:I.default.TEXT_HIDDEN)}}m.trigger(d.default.TEXT_TRACKS_QUEUE_INITIALIZED,{index:U,tracks:S,streamId:h.id})}function V(ye,Fe,Be,Ye,Ze,tt){var nt=ye/Fe,ht=Be/Ye,je=0,ge=0;nt>ht?(ge=Fe,je=ge/Ye*Be):(je=ye,ge=je/Be*Ye);var ie=0,he=0,De=0,Ce=0,We=je/ge;return We>Ze?(Ce=ge,De=ge*Ze):(De=je,Ce=je/Ze),ie=(ye-De)/2,he=(Fe-Ce)/2,tt?{x:ie+De*.1,y:he+Ce*.1,w:De*.8,h:Ce*.8}:{x:ie,y:he,w:De,h:Ce}}function te(ye,Fe){var Be=n.getClientWidth(),Ye=n.getClientHeight(),Ze=n.getVideoWidth(),tt=n.getVideoHeight(),nt=n.getVideoRelativeOffsetTop(),ht=n.getVideoRelativeOffsetLeft();if(Ze!==0&&tt!==0){var je=Ze/tt,ge=!1;ye.isFromCEA608&&(je=1.1666666666666667,ge=!0);var ie=V.call(this,Be,Ye,Ze,tt,je,ge),he=ie.w,De=ie.h,Ce=ie.x,We=ie.y;if(he!=W||De!=b||Ce!=k||We!=X||Fe){if(k=Ce+ht,X=We+nt,W=he,b=De,j){var Xe=j.style;Xe&&(Xe.left=k+"px",Xe.top=X+"px",Xe.width=W+"px",Xe.height=b+"px",Xe.zIndex=Y&&document[Y]||J?ae:null,m.trigger(f.default.CAPTION_CONTAINER_RESIZE))}var Ve=ye.activeCues;if(Ve)for(var rt=Ve.length,ut=0;ut<rt;++ut){var mt=Ve[ut];mt.scaleCue(mt)}}}}function z(ye){var Fe=W,Be=b,Ye,Ze,tt,nt,ht;if(ye.cellResolution){var je=[Fe/ye.cellResolution[0],Be/ye.cellResolution[1]];if(ye.linePadding){for(Ye in ye.linePadding)if(ye.linePadding.hasOwnProperty(Ye)){var ge=ye.linePadding[Ye];Ze=(ge*je[0]).toString();for(var ie=document.getElementsByClassName("spanPadding"),he=0;he<ie.length;he++)ie[he].style.cssText=ie[he].style.cssText.replace(/(padding-left\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+Ze),ie[he].style.cssText=ie[he].style.cssText.replace(/(padding-right\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+Ze)}}if(ye.fontSize){for(Ye in ye.fontSize)if(ye.fontSize.hasOwnProperty(Ye)){ye.fontSize[Ye][0]==="%"?tt=ye.fontSize[Ye][1]/100:ye.fontSize[Ye][0]==="c"&&(tt=ye.fontSize[Ye][1]),Ze=(tt*je[1]).toString(),Ye!=="defaultFontSize"?ht=document.getElementsByClassName(Ye):ht=document.getElementsByClassName("paragraph");for(var De=0;De<ht.length;De++)ht[De].style.cssText=ht[De].style.cssText.replace(/(font-size\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+Ze)}if(ye.lineHeight){for(Ye in ye.lineHeight)if(ye.lineHeight.hasOwnProperty(Ye)){ye.lineHeight[Ye][0]==="%"?nt=ye.lineHeight[Ye][1]/100:ye.fontSize[Ye][0]==="c"&&(nt=ye.lineHeight[Ye][1]),Ze=(nt*je[1]).toString(),ht=document.getElementsByClassName(Ye);for(var Ce=0;Ce<ht.length;Ce++)ht[Ce].style.cssText=ht[Ce].style.cssText.replace(/(line-height\s*:\s*)[\d.,]+(?=\s*px)/gi,"$1"+Ze)}}}}if(ye.isd){var We=document.getElementById(ye.cueID);We&&j.removeChild(We),R(ye)}}function R(ye){if(j){var Fe=document.createElement("div");j.appendChild(Fe),$=(0,r.renderHTML)(ye.isd,Fe,function(Be){var Ye=/^(urn:)(mpeg:[a-z0-9][a-z0-9-]{0,31}:)(subs:)([0-9]+)$/,Ze=/^#(.*)$/;if(Ye.test(Be)){var tt=Ye.exec(Be),nt=parseInt(tt[4],10)-1,ht=btoa(ye.images[nt]),je="data:image/png;base64,"+ht;return je}else if(Ze.test(Be)){var ge=Ze.exec(Be),ie=ge[1],he="data:image/png;base64,"+ye.embeddedImages[ie];return he}else return null},j.clientHeight,j.clientWidth,!1,function(Be){l.info("renderCaption :",Be)},$,!0),Fe.id=ye.cueID,m.trigger(f.default.CAPTION_RENDERED,{captionDiv:Fe,currentTrackIdx:U})}}function u(ye,Fe){if(!c.get().streaming.text.extendSegmentedCues||!Fe.cues||Fe.cues.length===0)return!1;var Be=Fe.cues[Fe.cues.length-1];return Be.endTime!==ye.startTime||!D(Be,ye,C)?!1:(Be.endTime=ye.endTime,!0)}function D(ye,Fe,Be){for(var Ye=0;Ye<Be.length;Ye++){var Ze=Be[Ye];if(JSON.stringify(ye[Ze])!==JSON.stringify(Fe[Ze]))return!1}return!0}function F(ye,Fe,Be){var Ye=ne(ye);if(Ye&&!(!Array.isArray(Be)||Be.length===0))for(var Ze=0;Ze<Be.length;Ze++){var tt=void 0,nt=Be[Ze];Ye.cellResolution=nt.cellResolution,Ye.isFromCEA608=nt.isFromCEA608,!isNaN(nt.start)&&!isNaN(nt.end)&&(tt=nt.type==="html"&&j?w(nt,Fe,Ye):nt.data?O(nt,Fe,Ye):null);try{tt?_e(Ye,tt)||(c.get().streaming.text.webvtt.customRenderingEnabled?(Ye.manualCueList||(Ye.manualCueList=[]),Ye.manualCueList.push(tt)):u(tt,Ye)||Ye.addCue(tt)):l.error("Impossible to display subtitles. You might have missed setting a TTML rendering div via player.attachTTMLRenderingDiv(TTMLRenderingDiv)")}catch(ht){throw Oe(Ye),Ye.addCue(tt),ht}}}function w(ye,Fe,Be){var Ye=this,Ze=new A(ye.start+Fe,ye.end+Fe,"");return Ze.cueHTMLElement=ye.cueHTMLElement,Ze.isd=ye.isd,Ze.images=ye.images,Ze.embeddedImages=ye.embeddedImages,Ze.cueID=ye.cueID,Ze.scaleCue=z.bind(Ye),Ze.cellResolution=ye.cellResolution,Ze.lineHeight=ye.lineHeight,Ze.linePadding=ye.linePadding,Ze.fontSize=ye.fontSize,j.style.left=k+"px",j.style.top=X+"px",j.style.width=W+"px",j.style.height=b+"px",Ze.onenter=function(){Be.mode===I.default.TEXT_SHOWING&&(this.isd?(R(this),l.debug("Cue enter id:"+this.cueID)):(j.appendChild(this.cueHTMLElement),z.call(Ye,this),m.trigger(f.default.CAPTION_RENDERED,{captionDiv:this.cueHTMLElement,currentTrackIdx:U})))},Ze.onexit=function(){if(j)for(var tt=j.childNodes,nt=0;nt<tt.length;++nt)tt[nt].id===this.cueID&&(l.debug("Cue exit id:"+tt[nt].id),j.removeChild(tt[nt]),--nt)},Ze}function O(ye,Fe,Be){var Ye=new A(ye.start-Fe,ye.end-Fe,ye.data);if(Ye.cueID="".concat(Ye.startTime,"_").concat(Ye.endTime),Ye.isActive=!1,ye.styles)try{ye.styles.align!==void 0&&"align"in Ye&&(Ye.align=ye.styles.align),ye.styles.line!==void 0&&"line"in Ye&&(Ye.line=ye.styles.line),ye.styles.position!==void 0&&"position"in Ye&&(Ye.position=ye.styles.position),ye.styles.size!==void 0&&"size"in Ye&&(Ye.size=ye.styles.size)}catch(Ze){l.error(Ze)}return Ye.onenter=function(){Be.mode===I.default.TEXT_SHOWING&&m.trigger(f.default.CAPTION_RENDERED,{currentTrackIdx:U})},Ye}function P(ye){var Fe=x();if(Fe&&Fe.length>0){var Be=Fe[0],Ye=Be.manualCueList;Ye&&Ye.length>0&&Ye.forEach(function(Ze){if(Ze.startTime<=ye&&Ze.endTime>=ye&&!Ze.isActive)Ze.isActive=!0,WebVTT.processCues(window,[Ze],Q,Ze.cueID);else if(Ze.isActive&&(Ze.startTime>ye||Ze.endTime<ye)&&(Ze.isActive=!1,Q))for(var tt=Q.childNodes,nt=0;nt<tt.length;++nt)tt[nt].id===Ze.cueID&&(Q.removeChild(tt[nt]),--nt)})}}function B(){var ye=x();if(ye&&ye.length>0){var Fe=ye[0],Be=Fe.manualCueList;Be&&Be.length>0&&Be.forEach(function(Ye){if(Ye.isActive&&(Ye.isActive=!1,Q))for(var Ze=Q.childNodes,tt=0;tt<Ze.length;++tt)Ze[tt].id===Ye.cueID&&(Q.removeChild(Ze[tt]),--tt)})}}function x(){var ye=n.getTextTracks(),Fe=[],Be=T(ye),Ye;try{for(Be.s();!(Ye=Be.n()).done;){var Ze=Ye.value;Ze.manualMode===I.default.TEXT_SHOWING&&Fe.push(Ze)}}catch(tt){Be.e(tt)}finally{Be.f()}return Fe}function ne(ye){return ye>=0&&S[ye]?n.getTextTrack(S[ye].kind,S[ye].id,S[ye].lang,S[ye].isTTML,S[ye].isEmbedded):null}function re(){return U}function G(ye){for(var Fe=-1,Be=0;Be<S.length;Be++)if(S[Be].id===ye){Fe=Be;break}return Fe}function fe(ye){var Fe=this;if(ye!==U){U=ye;var Be=ne(U);le.call(this,Be),q&&(clearInterval(q),q=null),Be&&Be.renderingType==="html"&&(te.call(this,Be,!0),window.ResizeObserver?(K=new window.ResizeObserver(function(){te.call(Fe,Be,!0)}),K.observe(n.getElement())):q=setInterval(te.bind(this,Be),500))}}function le(ye){He.call(this),ye?ye.renderingType==="html"?me.call(this):Ae.call(this):Ae.call(this)}function _e(ye,Fe){if(!ye.cues)return!1;for(var Be=0;Be<ye.cues.length;Be++)if(ye.cues[Be].startTime===Fe.startTime&&ye.cues[Be].endTime===Fe.endTime)return!0;return!1}function Me(ye,Fe,Be){var Ye=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;return(isNaN(Fe)||(Ye?ye.startTime:ye.endTime)>=Fe)&&(isNaN(Be)||(Ye?ye.endTime:ye.startTime)<=Be)}function Oe(ye,Fe,Be){var Ye=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!0;if(ye.cues)for(var Ze=ye.cues,tt=Ze.length-1,nt=tt;nt>=0;nt--)Me(Ze[nt],Fe,Be,Ye)&&(Ze[nt].onexit&&Ze[nt].onexit(),ye.removeCue(Ze[nt]))}function Ne(ye,Fe,Be){var Ye=ne(ye);Ye&&Oe(Ye,Fe,Be)}function xe(){for(var ye=L?L.length:0,Fe=0;Fe<ye;Fe++){var Be=ne(Fe);Be&&Oe.call(this,Be,h.start,h.start+h.duration,!1)}L=[],S=[],q&&(clearInterval(q),q=null),K&&n&&(K.unobserve(n.getElement()),K=null),U=-1,He.call(this)}function Se(ye){n.removeChild(L[ye]),L.splice(ye,1)}function me(){var ye=document.getElementById("native-cue-style");if(!ye){ye=document.createElement("style"),ye.id="native-cue-style",document.head.appendChild(ye);var Fe=ye.sheet,Be=n.getElement();try{Be&&(Be.id?Fe.insertRule("#"+Be.id+"::cue {background: transparent}",0):Be.classList.length!==0?Fe.insertRule("."+Be.className+"::cue {background: transparent}",0):Fe.insertRule("video::cue {background: transparent}",0))}catch(Ye){l.info(""+Ye.message)}}}function Ae(){var ye=document.getElementById("native-cue-style");ye&&document.head.removeChild(ye)}function He(){if(j)for(;j.firstChild;)j.removeChild(j.firstChild)}function Qe(ye,Fe){var Be=ne(ye);Be&&Be.mode!==Fe&&(Be.mode=Fe),Be&&Be.manualMode!==Fe&&(Be.manualMode=Fe)}function Je(){return S[U]}return o={initialize:se,getStreamId:ue,addTextTrack:Z,addCaptions:F,createTracks:H,getCurrentTrackIdx:re,setCurrentTrackIdx:fe,getTrackIdxForId:G,getCurrentTrackInfo:Je,setModeForTrackIdx:Qe,deleteCuesFromTrackIdx:Ne,deleteAllTextTracks:xe,deleteTextTrack:Se,manualCueProcessing:P,disableManualTracks:B},ee(),o}v.__dashjs_factory_name="TextTracks";const E=y.default.getClassFactory(v)},"./src/streaming/thumbnail/ThumbnailController.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>T});var I=e("./src/core/FactoryMaker.js"),g=e("./src/streaming/constants/Constants.js"),d=e("./src/streaming/vo/Thumbnail.js"),f=e("./src/streaming/thumbnail/ThumbnailTracks.js"),y=e("./src/streaming/vo/BitrateInfo.js"),_=e("./src/dash/utils/SegmentsUtils.js");function r(M){var p=this.context,C=M.streamInfo,v,E;function i(){A(),E=(0,f.default)(p).create({streamInfo:C,adapter:M.adapter,baseURLController:M.baseURLController,timelineConverter:M.timelineConverter,debug:M.debug,eventBus:M.eventBus,events:M.events,dashConstants:M.dashConstants,dashMetrics:M.dashMetrics,segmentBaseController:M.segmentBaseController})}function t(){E.addTracks();var S=E.getTracks();S&&S.length>0&&c(0)}function m(){return C.id}function n(S,L){if(typeof L=="function"){var U=E.getCurrentTrack(),k,X;if(!U||U.segmentDuration<=0||S===void 0||S===null){L(null);return}X=E.getThumbnailRequestForTime(S),X&&(U.segmentDuration=X.duration),k=S%U.segmentDuration;var W=Math.floor(k*U.tilesHor*U.tilesVert/U.segmentDuration),b=new d.default;if(b.width=Math.floor(U.widthPerTile),b.height=Math.floor(U.heightPerTile),b.x=Math.floor(W%U.tilesHor)*U.widthPerTile,b.y=Math.floor(W/U.tilesHor)*U.heightPerTile,"readThumbnail"in U)return U.readThumbnail(S,function(Q){b.url=Q,L(b)});if(X)b.url=X.url,U.segmentDuration=NaN;else{var j=Math.floor(S/U.segmentDuration);b.url=h(U,j)}L(b)}}function h(S,L){var U=L+S.startNumber,k=(0,_.replaceTokenForTemplate)(S.templateUrl,"Number",U);return k=(0,_.replaceTokenForTemplate)(k,"Time",(U-1)*S.segmentDuration*S.timescale),k=(0,_.replaceTokenForTemplate)(k,"Bandwidth",S.bandwidth),(0,_.unescapeDollarsInTemplate)(k)}function c(S){E.setTrackByIndex(S)}function o(){return E.getCurrentTrackIndex()}function l(){var S=E.getTracks(),L=0;return S.map(function(U){var k=new y.default;return k.mediaType=g.default.IMAGE,k.qualityIndex=L++,k.bitrate=U.bitrate,k.width=U.width,k.height=U.height,k})}function A(){E&&E.reset()}return v={getStreamId:m,initialize:t,provide:n,setTrackByIndex:c,getCurrentTrackIndex:o,getBitrateList:l,reset:A},i(),v}r.__dashjs_factory_name="ThumbnailController";const T=I.default.getClassFactory(r)},"./src/streaming/thumbnail/ThumbnailTracks.js":(ce,N,e)=>{e.r(N),e.d(N,{THUMBNAILS_SCHEME_ID_URIS:()=>C,default:()=>E});var I=e("./src/streaming/constants/Constants.js"),g=e("./src/dash/constants/DashConstants.js"),d=e("./src/core/FactoryMaker.js"),f=e("./src/streaming/vo/ThumbnailTrackInfo.js"),y=e("./src/streaming/utils/URLUtils.js"),_=e("./src/dash/utils/SegmentsUtils.js"),r=e("./src/streaming/utils/BoxParser.js"),T=e("./src/streaming/net/XHRLoader.js"),M=e("./src/dash/DashHandler.js"),p=e("./src/dash/controllers/SegmentsController.js"),C=["http://dashif.org/thumbnail_tile","http://dashif.org/guidelines/thumbnail_tile"];function v(i){var t=this.context,m=i.adapter,n=i.baseURLController,h=i.streamInfo,c=i.timelineConverter,o=i.debug,l=i.eventBus,A=i.events,S=i.dashConstants,L=(0,y.default)(t).getInstance(),U,k,X,W,b,j,Q,q;function Y(){V(),Q=(0,T.default)(t).create({}),q=(0,r.default)(t).getInstance(),j=(0,p.default)(t).create({events:A,eventBus:l,streamInfo:h,timelineConverter:c,dashConstants:S,dashMetrics:i.dashMetrics,segmentBaseController:i.segmentBaseController,type:I.default.IMAGE}),X=(0,M.default)(t).create({streamInfo:h,type:I.default.IMAGE,timelineConverter:c,segmentsController:j,baseURLController:n,debug:o,eventBus:l,events:A,dashConstants:S,urlUtils:L}),X.initialize(m?m.getIsDynamic():!1)}function J(){if(!(!h||!m)&&(b=m.getMediaInfoForType(h,I.default.IMAGE),!!b)){var te=m.getVoRepresentations(b);te&&te.length>0&&te.forEach(function(z){(z.segmentInfoType===g.default.SEGMENT_TEMPLATE&&z.segmentDuration>0&&z.media||z.segmentInfoType===g.default.SEGMENT_TIMELINE)&&$(z),z.segmentInfoType===g.default.SEGMENT_BASE&&$(z,!0)}),k.length>0&&k.sort(function(z,R){return z.bitrate-R.bitrate})}}function $(te,z){var R=new f.default;R.id=te.id,R.bitrate=te.bandwidth,R.width=te.width,R.height=te.height,R.tilesHor=1,R.tilesVert=1,te.essentialProperties&&te.essentialProperties.forEach(function(u){if(C.indexOf(u.schemeIdUri)>=0&&u.value){var D=u.value.split("x");D.length===2&&!isNaN(D[0])&&!isNaN(D[1])&&(R.tilesHor=parseInt(D[0],10),R.tilesVert=parseInt(D[1],10))}}),z?j.updateSegmentData(te).then(function(u){ae(R,te,u)}):(R.startNumber=te.startNumber,R.segmentDuration=te.segmentDuration,R.timescale=te.timescale,R.templateUrl=ee(te)),R.tilesHor>0&&R.tilesVert>0&&(R.widthPerTile=R.width/R.tilesHor,R.heightPerTile=R.height/R.tilesVert,k.push(R))}function ae(te,z,R){var u=[],D=K(R,z);z.segments=D,te.segmentDuration=z.segments[0].duration,te.readThumbnail=function(F,w){var O=null;u.some(function(P){if(P.start<=F&&P.end>F)return O=P.url,!0}),O?w(O):z.segments.some(function(P){if(P.mediaStartTime<=F&&P.mediaStartTime+P.duration>F){var B=n.resolve(z.path);return Q.load({method:"get",url:B.url,request:{range:P.mediaRange,responseType:"arraybuffer"},onload:function(ne){var re=q.getSamplesInfo(ne.target.response),G=new Blob([ne.target.response.slice(re.sampleList[0].offset,re.sampleList[0].offset+re.sampleList[0].size)],{type:"image/jpeg"}),fe=window.URL.createObjectURL(G);u.push({start:P.mediaStartTime,end:P.mediaStartTime+P.duration,url:fe}),w&&w(fe)}}),!0}})}}function K(te,z){var R=[],u=0,D,F,w,O;for(D=0,F=te.segments.length;D<F;D++)w=te.segments[D],O=(0,_.getTimeBasedSegment)(c,m.getIsDynamic(),z,w.startTime,w.duration,w.timescale,w.media,w.mediaRange,u),O&&(R.push(O),O=null,u++);return R}function ee(te){var z=L.isRelative(te.media)?L.resolve(te.media,n.resolve(te.path).url):te.media;return z?(0,_.replaceIDForTemplate)(z,te.id):""}function se(){return k}function ue(){return W}function oe(){return W<0?null:k[W]}function Z(te){!k||k.length===0||(te>=k.length&&(te=k.length-1),W=te)}function H(te){for(var z,R=m.getVoRepresentations(b),u=0;u<R.length;u++)if(k[W].id===R[u].id){z=R[u];break}return X.getSegmentRequestForTime(b,z,te)}function V(){k=[],W=-1,b=null}return U={getTracks:se,addTracks:J,reset:V,setTrackByIndex:Z,getCurrentTrack:oe,getCurrentTrackIndex:ue,getThumbnailRequestForTime:H},Y(),U}v.__dashjs_factory_name="ThumbnailTracks";const E=d.default.getClassFactory(v)},"./src/streaming/utils/BaseURLSelector.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>E});var I=e("./src/core/errors/Errors.js"),g=e("./src/core/EventBus.js"),d=e("./src/core/events/Events.js"),f=e("./src/streaming/controllers/BlacklistController.js"),y=e("./src/streaming/utils/baseUrlResolution/DVBSelector.js"),_=e("./src/streaming/utils/baseUrlResolution/BasicSelector.js"),r=e("./src/core/FactoryMaker.js"),T=e("./src/streaming/vo/DashJSError.js"),M=e("./src/streaming/utils/SupervisorTools.js"),p=e("./src/streaming/utils/baseUrlResolution/ContentSteeringSelector.js"),C=e("./src/core/Settings.js");function v(){var i=this.context,t=(0,g.default)(i).getInstance(),m=(0,C.default)(i).getInstance(),n,h,c,o,l,A;function S(){h=(0,f.default)(i).create({updateEventName:d.default.SERVICE_LOCATION_BLACKLIST_CHANGED,addBlacklistEventName:d.default.SERVICE_LOCATION_BLACKLIST_ADD}),c=(0,_.default)(i).create({blacklistController:h}),o=(0,y.default)(i).create({blacklistController:h}),l=(0,p.default)(i).create(),l.setConfig({blacklistController:h}),A=c}function L(W){W.selector&&(A=W.selector),W.contentSteeringSelector&&(l=W.contentSteeringSelector)}function U(W){(0,M.checkParameterType)(W,"boolean"),A=W?o:c}function k(W){if(W){if(m.get().streaming.applyContentSteering){var b=l.selectBaseUrlIndex(W);!isNaN(b)&&b!==-1&&(W.selectedIdx=b)}if(!isNaN(W.selectedIdx))return W.baseUrls[W.selectedIdx];var j=A.select(W.baseUrls);if(!j){t.trigger(d.default.URL_RESOLUTION_FAILED,{error:new T.default(I.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_CODE,I.default.URL_RESOLUTION_FAILED_GENERIC_ERROR_MESSAGE)}),A===c&&X();return}return W.selectedIdx=W.baseUrls.indexOf(j),j}}function X(){h.reset()}return n={chooseSelector:U,select:k,reset:X,setConfig:L},S(),n}v.__dashjs_factory_name="BaseURLSelector";const E=r.default.getClassFactory(v)},"./src/streaming/utils/BoxParser.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>r});var I=e("./src/core/Debug.js"),g=e("./src/streaming/utils/IsoFile.js"),d=e("./src/core/FactoryMaker.js"),f=e("./node_modules/codem-isoboxer/dist/iso_boxer.js"),y=e("./src/streaming/vo/IsoBoxSearchInfo.js");function _(){var T,M,p=this.context;function C(){T=(0,I.default)(p).getInstance().getLogger(M)}function v(o){if(!o)return null;o.fileStart===void 0&&(o.fileStart=0);var l=f.parseBuffer(o),A=(0,g.default)(p).create();return A.setData(l),A}function E(o,l,A){if(A===void 0&&(A=0),!l||A+8>=l.byteLength)return new y.default(0,!1);for(var S=l instanceof ArrayBuffer?new Uint8Array(l):l,L,U=0;A<S.byteLength;){var k=m(S,A),X=n(S,A+4);if(k===0)break;A+k<=S.byteLength&&(o.indexOf(X)>=0?L=new y.default(A,!0,k):U=A+k),A+=k}return L||new y.default(U,!1)}function i(o){if(!o||o.byteLength===0)return{sampleList:[],lastSequenceNumber:NaN,totalDuration:NaN,numSequences:NaN};var l=v(o),A=l.getBoxes("moof"),S=l.getBoxes("mfhd"),L,U,k,X,W,b,j,Q,q,Y,J,$,ae,K,ee,se,ue;se=l.getBoxes("moof").length,ee=S[S.length-1].sequence_number,k=0,b=[];var oe=-1,Z=-1;for(J=0;J<A.length;J++){var H=A[J],V=H.getChildBoxes("traf");for(q=0;q<V.length;q++){var te=V[q],z=te.getChildBox("tfhd"),R=te.getChildBox("tfdt");W=R.baseMediaDecodeTime;var u=te.getChildBoxes("trun"),D=te.getChildBoxes("subs");for(Y=0;Y<u.length;Y++){var F=u[Y];for(k=F.sample_count,K=(z.base_data_offset||0)+(F.data_offset||0),Q=0;Q<k;Q++){j=F.samples[Q],L=j.sample_duration!==void 0?j.sample_duration:z.default_sample_duration,X=j.sample_size!==void 0?j.sample_size:z.default_sample_size,U=j.sample_composition_time_offset!==void 0?j.sample_composition_time_offset:0;var w={dts:W,cts:W+U,duration:L,offset:H.offset+K,size:X,subSizes:[X]};if(D)for($=0;$<D.length;$++){var O=D[$];if(oe<O.entry_count-1&&Q>Z&&(oe++,Z+=O.entries[oe].sample_delta),Q==Z){w.subSizes=[];var P=O.entries[oe];for(ae=0;ae<P.subsample_count;ae++)w.subSizes.push(P.subsamples[ae].subsample_size)}}b.push(w),K+=X,W+=L}}ue=W-R.baseMediaDecodeTime}}return{sampleList:b,lastSequenceNumber:ee,totalDuration:ue,numSequences:se}}function t(o){var l=v(o),A=l?l.getBox("mdhd"):void 0;return A?A.timescale:NaN}function m(o,l){return o[l+3]>>>0|o[l+2]<<8>>>0|o[l+1]<<16>>>0|o[l]<<24>>>0}function n(o,l){return String.fromCharCode(o[l++])+String.fromCharCode(o[l++])+String.fromCharCode(o[l++])+String.fromCharCode(o[l])}function h(o){var l=null,A,S,L=v(o);if(!L)return l;var U=L.getBox("ftyp"),k=L.getBox("moov");return T.debug("Searching for initialization."),k&&k.isComplete&&(A=U?U.offset:k.offset,S=k.offset+k.size-1,l=A+"-"+S,T.debug("Found the initialization.  Range: "+l)),l}function c(o,l,A){if(A===void 0&&(A=0),!l||A+8>=l.byteLength)return new y.default(0,!1);for(var S=l instanceof ArrayBuffer?new Uint8Array(l):l,L,U=0;A<S.byteLength;){var k=m(S,A),X=n(S,A+4);if(k===0)break;A+k<=S.byteLength&&(o.indexOf(X)>=0?L=new y.default(A,!0,k,X):U=A+k),A+=k}return L||new y.default(U,!1)}return M={parse:v,findLastTopIsoBoxCompleted:E,getMediaTimescaleFromMoov:t,getSamplesInfo:i,findInitRange:h,parsePayload:c},C(),M}_.__dashjs_factory_name="BoxParser";const r=d.default.getSingletonFactory(_)},"./src/streaming/utils/Capabilities.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>r,supportsMediaSource:()=>y});var I=e("./src/core/FactoryMaker.js"),g=e("./src/streaming/thumbnail/ThumbnailTracks.js"),d=e("./src/streaming/constants/Constants.js"),f=[{codec:"avc1",compatibleCodecs:["avc3"]},{codec:"avc3",compatibleCodecs:["avc1"]}];function y(){var T="WebKitMediaSource"in window,M="MediaSource"in window;return T||M}function _(){var T,M,p;function C(){p=!1}function v(l){l&&l.settings&&(M=l.settings)}function E(){return p}function i(l){p=l}function t(l,A){return A!==d.default.AUDIO&&A!==d.default.VIDEO?Promise.resolve(!0):m(l,A)?h(l,A):n(l)}function m(l,A){return M.get().streaming.capabilities.useMediaCapabilitiesApi&&navigator.mediaCapabilities&&navigator.mediaCapabilities.decodingInfo&&(l.codec&&A===d.default.AUDIO||A===d.default.VIDEO&&l.codec&&l.width&&l.height&&l.bitrate&&l.framerate)}function n(l){return new Promise(function(A){if(!l||!l.codec){A(!1);return}var S=l.codec;if(l.width&&l.height&&(S+=';width="'+l.width+'";height="'+l.height+'"'),"MediaSource"in window&&MediaSource.isTypeSupported(S)){A(!0);return}else if("WebKitMediaSource"in window&&WebKitMediaSource.isTypeSupported(S)){A(!0);return}A(!1)})}function h(l,A){return new Promise(function(S){if(!l||!l.codec){S(!1);return}var L={type:"media-source"};L[A]={},L[A].contentType=l.codec,L[A].width=l.width,L[A].height=l.height,L[A].bitrate=parseInt(l.bitrate),L[A].framerate=parseFloat(l.framerate),navigator.mediaCapabilities.decodingInfo(L).then(function(U){S(U.supported)}).catch(function(){S(!1)})})}function c(l){try{return g.THUMBNAILS_SCHEME_ID_URIS.indexOf(l.schemeIdUri)!==-1}catch{return!0}}function o(l,A){for(var S=l.split(".")[0],L=A.indexOf(S)===0,U,k=0;k<f.length;k++)if(f[k].codec===S){U=f[k];break}return U?L||U.compatibleCodecs.some(function(X){return A.indexOf(X)===0}):L}return T={setConfig:v,supportsMediaSource:y,supportsEncryptedMedia:E,supportsCodec:t,setEncryptedMediaSupported:i,supportsEssentialProperty:c,codecRootCompatibleWithCodec:o},C(),T}_.__dashjs_factory_name="Capabilities";const r=I.default.getSingletonFactory(_)},"./src/streaming/utils/CapabilitiesFilter.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>r});var I=e("./src/core/FactoryMaker.js"),g=e("./src/core/Debug.js"),d=e("./src/streaming/constants/Constants.js"),f=e("./src/core/EventBus.js"),y=e("./src/core/events/Events.js");function _(){var T=this.context,M=(0,f.default)(T).getInstance(),p,C,v,E,i,t;function m(){t=(0,g.default)(T).getInstance().getLogger(p)}function n(X){X&&(X.adapter&&(C=X.adapter),X.capabilities&&(v=X.capabilities),X.settings&&(E=X.settings),X.customParametersModel&&(i=X.customParametersModel))}function h(X){return new Promise(function(W){var b=[];b.push(c(d.default.VIDEO,X)),b.push(c(d.default.AUDIO,X)),Promise.all(b).then(function(){E.get().streaming.capabilities.filterUnsupportedEssentialProperties&&U(X),k(X),W()}).catch(function(){W()})})}function c(X,W){if(!W||!W.Period_asArray||W.Period_asArray.length===0)return Promise.resolve();var b=[];return W.Period_asArray.forEach(function(j){b.push(o(j,X))}),Promise.all(b)}function o(X,W){return new Promise(function(b){if(!X||!X.AdaptationSet_asArray||X.AdaptationSet_asArray.length===0){b();return}var j=[];X.AdaptationSet_asArray.forEach(function(Q){C.getIsTypeOf(Q,W)&&j.push(l(Q,W))}),Promise.all(j).then(function(){X.AdaptationSet_asArray=X.AdaptationSet_asArray.filter(function(Q){var q=Q.Representation_asArray&&Q.Representation_asArray.length>0;return q||(M.trigger(y.default.ADAPTATION_SET_REMOVED_NO_CAPABILITIES,{adaptationSet:Q}),t.warn("AdaptationSet has been removed because of no supported Representation")),q}),b()}).catch(function(){b()})})}function l(X,W){return new Promise(function(b){if(!X.Representation_asArray||X.Representation_asArray.length===0){b();return}var j=[],Q=[];X.Representation_asArray.forEach(function(q,Y){var J=C.getCodec(X,Y,!1),$=A(W,q,J);Q.push($),j.push(v.supportsCodec($,W))}),Promise.all(j).then(function(q){X.Representation_asArray=X.Representation_asArray.filter(function(Y,J){return q[J]||t.debug("[Stream] Codec ".concat(Q[J].codec," not supported ")),q[J]}),b()}).catch(function(){b()})})}function A(X,W,b){switch(X){case d.default.VIDEO:return S(W,b);case d.default.AUDIO:return L(W,b);default:return null}}function S(X,W){var b=X.width||null,j=X.height||null,Q=X.frameRate||null,q=X.bandwidth||null;return{codec:W,width:b,height:j,framerate:Q,bitrate:q}}function L(X,W){var b=X.audioSamplingRate||null,j=X.bandwidth||null;return{codec:W,bitrate:j,samplerate:b}}function U(X){!X||!X.Period_asArray||X.Period_asArray.length===0||X.Period_asArray.forEach(function(W){W.AdaptationSet_asArray=W.AdaptationSet_asArray.filter(function(b){return!b.Representation_asArray||b.Representation_asArray.length===0?!0:(b.Representation_asArray=b.Representation_asArray.filter(function(j){var Q=C.getEssentialPropertiesForRepresentation(j);if(Q&&Q.length>0)for(var q=0;q<Q.length;){if(!v.supportsEssentialProperty(Q[q]))return t.debug("[Stream] EssentialProperty not supported: "+Q[q].schemeIdUri),!1;q+=1}return!0}),b.Representation_asArray&&b.Representation_asArray.length>0)})})}function k(X){var W=i.getCustomCapabilitiesFilters();!W||W.length===0||!X||!X.Period_asArray||X.Period_asArray.length===0||X.Period_asArray.forEach(function(b){b.AdaptationSet_asArray=b.AdaptationSet_asArray.filter(function(j){return!j.Representation_asArray||j.Representation_asArray.length===0?!0:(j.Representation_asArray=j.Representation_asArray.filter(function(Q){return!W.some(function(q){return!q(Q)})}),j.Representation_asArray&&j.Representation_asArray.length>0)})})}return p={setConfig:n,filterUnsupportedFeatures:h},m(),p}_.__dashjs_factory_name="CapabilitiesFilter";const r=I.default.getSingletonFactory(_)},"./src/streaming/utils/CustomTimeRanges.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>f});var I=e("./src/core/FactoryMaker.js"),g=e("./src/streaming/utils/SupervisorTools.js");function d(){var y=[],_=0;function r(E,i){var t=0;for(t=0;t<this.customTimeRangeArray.length&&E>this.customTimeRangeArray[t].start;t++);for(this.customTimeRangeArray.splice(t,0,{start:E,end:i}),t=0;t<this.customTimeRangeArray.length-1;t++)this.mergeRanges(t,t+1)&&t--;this.length=this.customTimeRangeArray.length}function T(){this.customTimeRangeArray=[],this.length=0}function M(E,i){for(var t=0;t<this.customTimeRangeArray.length;t++)if(E<=this.customTimeRangeArray[t].start&&i>=this.customTimeRangeArray[t].end)this.customTimeRangeArray.splice(t,1),t--;else if(E>this.customTimeRangeArray[t].start&&i<this.customTimeRangeArray[t].end){this.customTimeRangeArray.splice(t+1,0,{start:i,end:this.customTimeRangeArray[t].end}),this.customTimeRangeArray[t].end=E;break}else E>this.customTimeRangeArray[t].start&&E<this.customTimeRangeArray[t].end?this.customTimeRangeArray[t].end=E:i>this.customTimeRangeArray[t].start&&i<this.customTimeRangeArray[t].end&&(this.customTimeRangeArray[t].start=i);this.length=this.customTimeRangeArray.length}function p(E,i){var t=this.customTimeRangeArray[E],m=this.customTimeRangeArray[i];return t.start<=m.start&&m.start<=t.end&&t.end<=m.end?(t.end=m.end,this.customTimeRangeArray.splice(i,1),!0):m.start<=t.start&&t.start<=m.end&&m.end<=t.end?(t.start=m.start,this.customTimeRangeArray.splice(i,1),!0):m.start<=t.start&&t.start<=m.end&&t.end<=m.end?(this.customTimeRangeArray.splice(E,1),!0):t.start<=m.start&&m.start<=t.end&&m.end<=t.end?(this.customTimeRangeArray.splice(i,1),!0):!1}function C(E){return(0,g.checkInteger)(E),E>=this.customTimeRangeArray.length||E<0?NaN:this.customTimeRangeArray[E].start}function v(E){return(0,g.checkInteger)(E),E>=this.customTimeRangeArray.length||E<0?NaN:this.customTimeRangeArray[E].end}return{customTimeRangeArray:y,length:_,add:r,clear:T,remove:M,mergeRanges:p,start:C,end:v}}d.__dashjs_factory_name="CustomTimeRanges";const f=I.default.getClassFactory(d)},"./src/streaming/utils/DOMStorage.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>E});var I=e("./src/core/FactoryMaker.js"),g=e("./src/core/Debug.js"),d=e("./src/streaming/constants/Constants.js"),f=[{oldKey:"dashjs_vbitrate",newKey:"dashjs_video_bitrate"},{oldKey:"dashjs_abitrate",newKey:"dashjs_audio_bitrate"},{oldKey:"dashjs_vsettings",newKey:"dashjs_video_settings"},{oldKey:"dashjs_asettings",newKey:"dashjs_audio_settings"}],y="dashjs_?_bitrate",_="dashjs_?_settings",r="localStorage",T="sessionStorage",M="lastBitrate",p="lastMediaSettings";function C(i){i=i||{};var t=this.context,m=i.settings,n,h,c;function o(){h=(0,g.default)(t).getInstance().getLogger(n),A()}function l(j){if(c!==void 0)return c;c=!1;var Q="1",q="1",Y;try{typeof window<"u"&&(Y=window[j])}catch(J){return h.warn("DOMStorage access denied: "+J.message),c}if(!Y||j!==r&&j!==T)return c;try{Y.setItem(Q,q),Y.removeItem(Q),c=!0}catch(J){h.warn("DOMStorage is supported, but cannot be used: "+J.message)}return c}function A(){l(r)&&f.forEach(function(j){var Q=localStorage.getItem(j.oldKey);if(Q){localStorage.removeItem(j.oldKey);try{localStorage.setItem(j.newKey,Q)}catch(q){h.error(q.message)}}})}function S(){var j=6e5;return Math.round(new Date().getTime()/j)*j}function L(j,Q){return l(j)&&m.get().streaming[Q+"CachingInfo"].enabled}function U(){if(!m)throw new Error(d.default.MISSING_CONFIG_ERROR)}function k(j){if(U(),!m.get().streaming.lastMediaSettingsCachingInfo.enabled)return null;var Q=null;if(L(r,p)){var q=_.replace(/\?/,j);try{var Y=JSON.parse(localStorage.getItem(q))||{},J=new Date().getTime()-parseInt(Y.timestamp,10)>=m.get().streaming.lastMediaSettingsCachingInfo.ttl||!1;Q=Y.settings,J&&(localStorage.removeItem(q),Q=null)}catch{return null}}return Q}function X(j){if(U(),!m.get().streaming.lastBitrateCachingInfo.enabled)return NaN;var Q=NaN;if(L(r,M)){var q=y.replace(/\?/,j);try{var Y=JSON.parse(localStorage.getItem(q))||{},J=new Date().getTime()-parseInt(Y.timestamp,10)>=m.get().streaming.lastBitrateCachingInfo.ttl||!1,$=parseFloat(Y.bitrate);!isNaN($)&&!J?(Q=$,h.debug("Last saved bitrate for "+j+" was "+$)):J&&localStorage.removeItem(q)}catch{return null}}return Q}function W(j,Q){if(L(r,p)){var q=_.replace(/\?/,j);try{localStorage.setItem(q,JSON.stringify({settings:Q,timestamp:S()}))}catch(Y){h.error(Y.message)}}}function b(j,Q){if(L(r,M)&&Q){var q=y.replace(/\?/,j);try{localStorage.setItem(q,JSON.stringify({bitrate:Q.toFixed(3),timestamp:S()}))}catch(Y){h.error(Y.message)}}}return n={getSavedBitrateSettings:X,setSavedBitrateSettings:b,getSavedMediaSettings:k,setSavedMediaSettings:W},o(),n}C.__dashjs_factory_name="DOMStorage";var v=I.default.getSingletonFactory(C);const E=v},"./src/streaming/utils/DefaultURLUtils.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});var I=e("./src/core/FactoryMaker.js");function g(){var f,y=/^[a-z][a-z0-9+\-_.]*:/i,_=/^https?:\/\//i,r=/^https:\/\//i,T=/^([a-z][a-z0-9+\-_.]*:\/\/[^\/]+)\/?/i,M=function(L,U){try{return new window.URL(L,U).toString()}catch{return L}},p=function(L,U){var k=v;if(!U||!m(L))return L;n(L)&&(k=E),h(L)&&(k=t);var X=k(U),W=X.charAt(X.length-1)!=="/"&&L.charAt(0)!=="/"?"/":"";return[X,L].join(W)};function C(){try{var S=new window.URL("x","http://y");f=M}catch{}finally{f=f||p}}function v(S){var L=S.indexOf("/"),U=S.lastIndexOf("/");return L!==-1?U===L+1?S:(S.indexOf("?")!==-1&&(S=S.substring(0,S.indexOf("?"))),S.substring(0,U+1)):""}function E(S){var L=S.match(T);return L?L[1]:""}function i(S){var L=/^(?:\w+\:\/\/)?([^\/]+)(.*)$/.exec(S);return L[2].substring(1)}function t(S){var L=S.match(y);return L?L[0]:""}function m(S){return!y.test(S)}function n(S){return m(S)&&S.charAt(0)==="/"}function h(S){return S.indexOf("//")===0}function c(S){return _.test(S)}function o(S){return r.test(S)}function l(S,L){return f(S,L)}C();var A={parseBaseUrl:v,parseOrigin:E,parseScheme:t,isRelative:m,isPathAbsolute:n,isSchemeRelative:h,isHTTPURL:c,isHTTPS:o,removeHostname:i,resolve:l};return A}g.__dashjs_factory_name="DefaultURLUtils";const d=I.default.getSingletonFactory(g)},"./src/streaming/utils/EBMLParser.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});var I=e("./src/core/FactoryMaker.js");function g(f){f=f||{};var y,_=new DataView(f.data),r=0;function T(){return r}function M(h){r=h}function p(h,c){var o=!0,l=0,A,S;if(c===void 0&&(c=!1),h.tag>16777215?(_.getUint32(r)!==h.tag&&(o=!1),l=4):h.tag>65535?(A=_.getUint16(r),S=_.getUint8(r+2),A*256+S!==h.tag&&(o=!1),l=3):h.tag>255?(_.getUint16(r)!==h.tag&&(o=!1),l=2):(_.getUint8(r)!==h.tag&&(o=!1),l=1),!o&&h.required&&!c)throw new Error("required tag not found");return o&&(r+=l),o}function C(h,c){var o=p(h,c);return o&&i(),o}function v(h){var c;return p(h),c=i(),y[h.parse](c)}function E(h,c){var o=p(h,c),l;return o&&(l=i(),r+=l),o}function i(h){var c=1,o=128,l=8,A=-1,S=0,L=_.getUint8(r),U=0;for(U=0;U<l;U+=1){if((L&o)===o){S=h===void 0?L&~o:L,A=U;break}o>>=1}for(U=0;U<A;U+=1,c+=1)S=S<<8|255&_.getUint8(r+c);return r+=c,S}function t(h){var c;switch(h){case 4:c=_.getFloat32(r),r+=4;break;case 8:c=_.getFloat64(r),r+=8;break}return c}function m(h){for(var c=0,o=0;o<h;o+=1)c<<=8,c|=_.getUint8(r+o)&255;return r+=h,c}function n(){return r<_.byteLength}return y={getPos:T,setPos:M,consumeTag:p,consumeTagAndSize:C,parseTag:v,skipOverElement:E,getMatroskaCodedNum:i,getMatroskaFloat:t,getMatroskaUint:m,moreData:n},y}g.__dashjs_factory_name="EBMLParser";const d=I.default.getClassFactory(g)},"./src/streaming/utils/ErrorHandler.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});var I=e("./src/core/EventBus.js"),g=e("./src/core/events/Events.js"),d=e("./src/core/FactoryMaker.js");function f(){var _,r=this.context,T=(0,I.default)(r).getInstance();function M(p){T.trigger(g.default.ERROR,{error:p})}return _={error:M},_}f.__dashjs_factory_name="ErrorHandler";const y=d.default.getSingletonFactory(f)},"./src/streaming/utils/InitCache.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});var I=e("./src/core/FactoryMaker.js");function g(){var f={};function y(M){var p=M.streamId,C=M.representationId;f[p]=f[p]||{},f[p][C]=M}function _(M,p){return f&&f[M]&&f[M][p]?f[M][p]:null}function r(){f={}}var T={save:y,extract:_,reset:r};return T}g.__dashjs_factory_name="InitCache";const d=I.default.getSingletonFactory(g)},"./src/streaming/utils/IsoFile.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>f});var I=e("./src/streaming/vo/IsoBox.js"),g=e("./src/core/FactoryMaker.js");function d(){var y,_;function r(v){return!v||!_||!_.boxes||_.boxes.length===0||typeof _.fetch!="function"?null:C(_.fetch(v))}function T(v){var E=[];if(!v||!_||typeof _.fetchAll!="function")return E;for(var i=_.fetchAll(v),t,m=0,n=i.length;m<n;m++)t=C(i[m]),t&&E.push(t);return E}function M(v){_=v}function p(){if(!_||!_.boxes||!_.boxes.length)return null;var v=_.boxes[_.boxes.length-1].type,E=T(v);return E.length>0?E[E.length-1]:null}function C(v){if(!v)return null;var E=new I.default(v);return v.hasOwnProperty("_incomplete")&&(E.isComplete=!v._incomplete),E}return y={getBox:r,getBoxes:T,setData:M,getLastBox:p},y}d.__dashjs_factory_name="IsoFile";const f=g.default.getClassFactory(d)},"./src/streaming/utils/ObjectUtils.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});var I=e("./src/core/FactoryMaker.js"),g=e("./node_modules/fast-deep-equal/index.js"),d=e.n(g);function f(){var _;function r(T,M){return d()(T,M)}return _={areEqual:r},_}f.__dashjs_factory_name="ObjectUtils";const y=I.default.getSingletonFactory(f)},"./src/streaming/utils/RequestModifier.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>f,modifyRequest:()=>g});var I=e("./src/core/FactoryMaker.js");function g(y,_){var r={url:y.url,method:y.method,headers:Object.assign({},y.headers),credentials:y.withCredentials?"include":void 0};return Promise.resolve(_.modifyRequest(r)).then(function(){return Object.assign(y,r,{withCredentials:r.credentials==="include"})})}function d(){var y;function _(T){return T}function r(T,M){return M.url,T}return y={modifyRequest:null,modifyRequestURL:_,modifyRequestHeader:r},y}d.__dashjs_factory_name="RequestModifier";const f=I.default.getSingletonFactory(d)},"./src/streaming/utils/SegmentResponseModifier.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});var I=e("./src/core/FactoryMaker.js");function g(){var f;function y(_){return Promise.resolve(_)}return f={modifyResponseAsync:y},f}g.__dashjs_factory_name="SegmentResponseModifier";const d=I.default.getSingletonFactory(g)},"./src/streaming/utils/SupervisorTools.js":(ce,N,e)=>{e.r(N),e.d(N,{checkInteger:()=>f,checkIsVideoOrAudioType:()=>_,checkParameterType:()=>d,checkRange:()=>y});var I=e("./src/streaming/constants/Constants.js");function g(r){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(M){return typeof M}:g=function(M){return M&&typeof Symbol=="function"&&M.constructor===Symbol&&M!==Symbol.prototype?"symbol":typeof M},g(r)}function d(r,T){if(g(r)!==T)throw I.default.BAD_ARGUMENT_ERROR}function f(r){var T=r!==null&&!isNaN(r)&&r%1===0;if(!T)throw I.default.BAD_ARGUMENT_ERROR+" : argument is not an integer"}function y(r,T,M){if(r<T||r>M)throw I.default.BAD_ARGUMENT_ERROR+" : argument out of range"}function _(r){if(typeof r!="string"||r!==I.default.AUDIO&&r!==I.default.VIDEO)throw I.default.BAD_ARGUMENT_ERROR}},"./src/streaming/utils/TTMLParser.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>M});var I=e("./src/core/FactoryMaker.js"),g=e("./src/core/Debug.js"),d=e("./src/core/EventBus.js"),f=e("./src/core/events/Events.js"),y=e("./node_modules/imsc/src/main/js/main.js"),_=e("./src/streaming/MediaPlayerEvents.js"),r=e("./src/streaming/constants/ConformanceViolationConstants.js");function T(){var p=this.context,C=(0,d.default)(p).getInstance(),v,E,i=0;function t(){E=(0,g.default)(p).getInstance().getLogger(v)}function m(){var h="cue_TTML_"+i;return i++,h}function n(h,c,o,l,A){var S="",L=[],U,k,X,W={},b={},j="",Q="",q={onOpenTag:function(K,ee,se){if(se[" imagetype"]&&!se[" imageType"]&&(C.trigger(_.default.CONFORMANCE_VIOLATION,{level:r.default.LEVELS.ERROR,event:r.default.EVENTS.NON_COMPLIANT_SMPTE_IMAGE_ATTRIBUTE}),se[" imageType"]=se[" imagetype"]),ee==="image"&&(K==="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt"||K==="http://www.smpte-ra.org/schemas/2052-1/2013/smpte-tt")){if(!se[" imageType"]||se[" imageType"].value!=="PNG"){E.warn("smpte-tt imageType != PNG. Discarded");return}j=se["http://www.w3.org/XML/1998/namespace id"].value}},onCloseTag:function(){j&&(b[j]=Q.trim()),Q="",j=""},onText:function(K){j&&(Q=Q+K)}};if(!h)throw S="no ttml data to parse",new Error(S);W.data=h,C.trigger(f.default.TTML_TO_PARSE,W);var Y=(0,y.fromXML)(W.data,function(ae){S=ae},q);C.trigger(f.default.TTML_PARSED,{ttmlString:W.data,ttmlDoc:Y});var J=Y.getMediaTimeEvents();for(X=0;X<J.length;X++){var $=(0,y.generateISD)(Y,J[X],function(ae){S=ae});$.contents.some(function(ae){return ae.contents.length})&&(U=J[X]+c<o?o:J[X]+c,k=J[X+1]+c>l?l:J[X+1]+c,U<k&&L.push({start:U,end:k,type:"html",cueID:m(),isd:$,images:A,embeddedImages:b}))}if(S!=="")throw E.error(S),new Error(S);return L}return v={parse:n},t(),v}T.__dashjs_factory_name="TTMLParser";const M=I.default.getSingletonFactory(T)},"./src/streaming/utils/URLUtils.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});var I=e("./src/core/FactoryMaker.js"),g=e("./src/streaming/utils/DefaultURLUtils.js");function d(){var _,r,T=[],M=this.context;function p(L){var U;for(U=0;U<T.length;U++){var k=T[U].regex;if(k.test(L))return T[U].utils}return r}function C(){r=(0,g.default)(M).getInstance()}function v(L,U){T.push({regex:L,utils:U})}function E(L,U,k){var X=p(k||U);return X&&typeof X[L]=="function"?X[L](U,k):r[L](U,k)}function i(L){return E("parseBaseUrl",L)}function t(L){return E("parseOrigin",L)}function m(L){return E("removeHostname",L)}function n(L){return E("parseScheme",L)}function h(L){return E("isRelative",L)}function c(L){return E("isPathAbsolute",L)}function o(L){return E("isSchemeRelative",L)}function l(L){return E("isHTTPURL",L)}function A(L){return E("isHTTPS",L)}function S(L,U){return E("resolve",L,U)}return C(),_={registerUrlRegex:v,parseBaseUrl:i,parseOrigin:t,parseScheme:n,isRelative:h,isPathAbsolute:c,isSchemeRelative:o,isHTTPURL:l,isHTTPS:A,removeHostname:m,resolve:S},_}d.__dashjs_factory_name="URLUtils";var f=I.default.getSingletonFactory(d);const y=f},"./src/streaming/utils/VTTParser.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});var I=e("./src/core/FactoryMaker.js"),g=e("./src/core/Debug.js"),d="WEBVTT";function f(){var _=this.context,r,T,M,p,C,v;function E(){T=(0,g.default)(_).getInstance().getLogger(r),M=/(?:\r\n|\r|\n)/gm,p=/-->/,C=/(^[\s]+|[\s]+$)/g,v=/\s\b/g}function i(c){var o=[],l,A;if(!c)return o;c=c.split(M),l=c.length,A=-1;for(var S=0;S<l;S++){var L=c[S];if(L.length>0&&L!==d&&L.match(p)){var U=m(L),k=U.cuePoints,X=U.styles,W=h(c,S+1),b=t(k[0].replace(C,"")),j=t(k[1].replace(C,""));!isNaN(b)&&!isNaN(j)&&b>=A&&j>b?W!==""?(A=b,o.push({start:b,end:j,data:W,styles:X})):T.error("Skipping cue due to empty/malformed cue text"):T.error("Skipping cue due to incorrect cue timing")}}return o}function t(c){var o=c.split(":"),l=o.length-1;return c=parseInt(o[l-1],10)*60+parseFloat(o[l]),l===2&&(c+=parseInt(o[0],10)*3600),c}function m(c){var o=c.split(p),l=o[1].split(v);return l.shift(),o[1]=l[0],l.shift(),{cuePoints:o,styles:n(l)}}function n(c){var o={};return c.forEach(function(l){if(l.split(/:/).length>1){var A=l.split(/:/)[1];A&&A.search(/%/)!=-1&&(A=parseInt(A.replace(/%/,""),10)),(l.match(/align/)||l.match(/A/))&&(o.align=A),(l.match(/line/)||l.match(/L/))&&(o.line=A),(l.match(/position/)||l.match(/P/))&&(o.position=A),(l.match(/size/)||l.match(/S/))&&(o.size=A)}}),o}function h(c,o){for(var l=o,A="",S="",L;c[l]!==""&&l<c.length;)l++;if(L=l-o,L>1)for(var U=0;U<L;U++)if(S=c[o+U],!S.match(p))A+=S,U!==L-1&&(A+=`
`);else{A="";break}else S=c[o],S.match(p)||(A=S);return A}return r={parse:i},E(),r}f.__dashjs_factory_name="VTTParser";const y=I.default.getSingletonFactory(f)},"./src/streaming/utils/VttCustomRenderingParser.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});var I=e("./src/core/FactoryMaker.js");function g(){var f,y;function _(){try{window&&window.WebVTT&&window.WebVTT.Parser&&(y=new window.WebVTT.Parser(window,window.vttjs,window.WebVTT.StringDecoder()))}catch{}}function r(T){var M=[];return y.oncue=function(p){p.start=p.startTime,p.end=p.endTime,p.data=p.text,p.styles={align:p.align,line:p.line,position:p.position,size:p.size},M.push(p)},y.parse(T),M}return f={parse:r},_(),f}g.__dashjs_factory_name="VttCustomRenderingParser";const d=I.default.getSingletonFactory(g)},"./src/streaming/utils/baseUrlResolution/BasicSelector.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});var I=e("./src/core/FactoryMaker.js");function g(f){f=f||{};var y,_=f.blacklistController;function r(T){var M=0,p;return T&&T.some(function(C,v){return M=v,!_.contains(C.serviceLocation)})&&(p=T[M]),p}return y={select:r},y}g.__dashjs_factory_name="BasicSelector";const d=I.default.getClassFactory(g)},"./src/streaming/utils/baseUrlResolution/ContentSteeringSelector.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>f});var I=e("./src/core/FactoryMaker.js"),g=e("./src/dash/controllers/ContentSteeringController.js");function d(){var y=this.context,_,r,T;function M(){r=(0,g.default)(y).getInstance()}function p(E){E.blacklistController&&(T=E.blacklistController),E.contentSteeringController&&(r=E.contentSteeringController)}function C(E){var i=NaN;if(isNaN(E.selectedIdx)){var t=r.getSteeringDataFromManifest();t&&t.defaultServiceLocation&&(i=v([t.defaultServiceLocation],E.baseUrls))}var m=r.getCurrentSteeringResponseData();return E.baseUrls&&E.baseUrls.length&&m&&m.serviceLocationPriority&&m.serviceLocationPriority.length&&(i=v(m.serviceLocationPriority,E.baseUrls)),i}function v(){for(var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],t=0,m=NaN,n=function(){var o=E[t],l=i.findIndex(function(A){return A.serviceLocation&&A.serviceLocation===o});if(l!==-1&&!T.contains(i[l].serviceLocation))return m=l,"break";t+=1};t<E.length;){var h=n();if(h==="break")break}return m}return _={selectBaseUrlIndex:C,setConfig:p},M(),_}d.__dashjs_factory_name="ContentSteeringSelector";const f=I.default.getClassFactory(d)},"./src/streaming/utils/baseUrlResolution/DVBSelector.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});var I=e("./src/core/FactoryMaker.js");function g(f){f=f||{};var y,_=f.blacklistController;function r(p){var C=[],v=function(t){return!(C.length&&t.dvb_priority&&C.indexOf(t.dvb_priority)!==-1)},E=function(t){return _.contains(t.serviceLocation)?(t.dvb_priority&&C.push(t.dvb_priority),!1):!0};return p.filter(E).filter(v)}function T(p){var C=function(c,o){var l=c.dvb_priority-o.dvb_priority;return isNaN(l)?0:l},v=function(c,o,l){return!o||l[0].dvb_priority&&c.dvb_priority&&l[0].dvb_priority===c.dvb_priority},E=0,i=[],t=0,m,n;if(n=p.sort(C).filter(v),n.length)return n.length>1&&(n.forEach(function(h){E+=h.dvb_weight,i.push(E)}),m=Math.floor(Math.random()*(E-1)),i.every(function(h,c){return t=c,!(m<h)})),n[t]}function M(p){return p&&T(r(p))}return y={select:M},y}g.__dashjs_factory_name="DVBSelector";const d=I.default.getClassFactory(g)},"./src/streaming/vo/BitrateInfo.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.mediaType=null,this.bitrate=null,this.width=null,this.height=null,this.scanType=null,this.qualityIndex=NaN};const d=g},"./src/streaming/vo/DashJSError.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(y,_,r){I(this,f),this.code=y||null,this.message=_||null,this.data=r||null};const d=g},"./src/streaming/vo/DataChunk.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.streamId=null,this.mediaInfo=null,this.segmentType=null,this.quality=NaN,this.index=NaN,this.bytes=null,this.start=NaN,this.end=NaN,this.duration=NaN,this.representationId=null,this.endFragment=null};const d=g},"./src/streaming/vo/FragmentRequest.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>_});var I=e("./src/streaming/vo/metrics/HTTPRequest.js");function g(r,T){if(!(r instanceof T))throw new TypeError("Cannot call a class as a function")}function d(r,T){for(var M=0;M<T.length;M++){var p=T[M];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(r,p.key,p)}}function f(r,T,M){return T&&d(r.prototype,T),M&&d(r,M),r}var y=function(){function r(T){g(this,r),this.action=r.ACTION_DOWNLOAD,this.startTime=NaN,this.mediaStartTime=NaN,this.mediaType=null,this.mediaInfo=null,this.type=null,this.duration=NaN,this.timescale=NaN,this.range=null,this.url=T||null,this.serviceLocation=null,this.requestStartDate=null,this.firstByteDate=null,this.requestEndDate=null,this.quality=NaN,this.index=NaN,this.availabilityStartTime=null,this.availabilityEndTime=null,this.wallStartTime=null,this.bytesLoaded=NaN,this.bytesTotal=NaN,this.delayLoadingTime=NaN,this.responseType="arraybuffer",this.representationId=null}return f(r,[{key:"isInitializationRequest",value:function(){return this.type&&this.type===I.HTTPRequest.INIT_SEGMENT_TYPE}},{key:"setInfo",value:function(M){this.type=M&&M.init?I.HTTPRequest.INIT_SEGMENT_TYPE:I.HTTPRequest.MEDIA_SEGMENT_TYPE,this.url=M&&M.url?M.url:null,this.range=M&&M.range?M.range.start+"-"+M.range.end:null,this.mediaType=M&&M.mediaType?M.mediaType:null}}]),r}();y.ACTION_DOWNLOAD="download",y.ACTION_COMPLETE="complete";const _=y},"./src/streaming/vo/HeadRequest.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>v});var I=e("./src/streaming/vo/FragmentRequest.js");function g(E){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(t){return typeof t}:g=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(E)}function d(E,i){if(!(E instanceof i))throw new TypeError("Cannot call a class as a function")}function f(E,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");E.prototype=Object.create(i&&i.prototype,{constructor:{value:E,writable:!0,configurable:!0}}),i&&y(E,i)}function y(E,i){return y=Object.setPrototypeOf||function(m,n){return m.__proto__=n,m},y(E,i)}function _(E){var i=M();return function(){var m=p(E),n;if(i){var h=p(this).constructor;n=Reflect.construct(m,arguments,h)}else n=m.apply(this,arguments);return r(this,n)}}function r(E,i){return i&&(g(i)==="object"||typeof i=="function")?i:T(E)}function T(E){if(E===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E}function M(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function p(E){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},p(E)}var C=function(E){f(t,E);var i=_(t);function t(m){var n;return d(this,t),n=i.call(this,m),n.checkForExistenceOnly=!0,n}return t}(I.default);const v=C},"./src/streaming/vo/IsoBox.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>y});function I(_,r){if(!(_ instanceof r))throw new TypeError("Cannot call a class as a function")}function g(_,r){for(var T=0;T<r.length;T++){var M=r[T];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(_,M.key,M)}}function d(_,r,T){return r&&g(_.prototype,r),T&&g(_,T),_}var f=function(){function _(r){if(I(this,_),this.offset=r._offset,this.type=r.type,this.size=r.size,this.boxes=[],r.boxes)for(var T=0;T<r.boxes.length;T++)this.boxes.push(new _(r.boxes[T]));switch(this.isComplete=!0,r.type){case"sidx":if(this.timescale=r.timescale,this.earliest_presentation_time=r.earliest_presentation_time,this.first_offset=r.first_offset,this.references=r.references,r.references){this.references=[];for(var M=0;M<r.references.length;M++){var p={reference_type:r.references[M].reference_type,referenced_size:r.references[M].referenced_size,subsegment_duration:r.references[M].subsegment_duration};this.references.push(p)}}break;case"emsg":this.id=r.id,this.version=r.version===1?1:0,this.value=r.value,this.timescale=r.timescale,this.scheme_id_uri=r.scheme_id_uri,this.presentation_time_delta=r.version===1?r.presentation_time:r.presentation_time_delta,this.event_duration=r.event_duration,this.message_data=r.message_data;break;case"mdhd":this.timescale=r.timescale;break;case"mfhd":this.sequence_number=r.sequence_number;break;case"subs":this.entry_count=r.entry_count,this.entries=r.entries;break;case"tfhd":this.base_data_offset=r.base_data_offset,this.sample_description_index=r.sample_description_index,this.default_sample_duration=r.default_sample_duration,this.default_sample_size=r.default_sample_size,this.default_sample_flags=r.default_sample_flags,this.flags=r.flags;break;case"tfdt":this.version=r.version,this.baseMediaDecodeTime=r.baseMediaDecodeTime,this.flags=r.flags;break;case"trun":if(this.sample_count=r.sample_count,this.first_sample_flags=r.first_sample_flags,this.data_offset=r.data_offset,this.flags=r.flags,this.samples=r.samples,r.samples){this.samples=[];for(var C=0,v=r.samples.length;C<v;C++){var E={sample_size:r.samples[C].sample_size,sample_duration:r.samples[C].sample_duration,sample_composition_time_offset:r.samples[C].sample_composition_time_offset};this.samples.push(E)}}break}}return d(_,[{key:"getChildBox",value:function(T){for(var M=0;M<this.boxes.length;M++)if(this.boxes[M].type===T)return this.boxes[M]}},{key:"getChildBoxes",value:function(T){for(var M=[],p=0;p<this.boxes.length;p++)this.boxes[p].type===T&&M.push(this.boxes[p]);return M}}]),_}();const y=f},"./src/streaming/vo/IsoBoxSearchInfo.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(y,_,r){I(this,f),this.lastCompletedOffset=y,this.found=_,this.size=r};const d=g},"./src/streaming/vo/MetricsList.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.TcpList=[],this.HttpList=[],this.RepSwitchList=[],this.BufferLevel=[],this.BufferState=[],this.PlayList=[],this.DroppedFrames=[],this.SchedulingInfo=[],this.DVRInfo=[],this.ManifestUpdate=[],this.RequestsQueue=null,this.DVBErrors=[]};const d=g},"./src/streaming/vo/TextRequest.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>E});var I=e("./src/streaming/constants/Constants.js"),g=e("./src/streaming/vo/FragmentRequest.js");function d(i){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?d=function(m){return typeof m}:d=function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},d(i)}function f(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}function y(i,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(t&&t.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),t&&_(i,t)}function _(i,t){return _=Object.setPrototypeOf||function(n,h){return n.__proto__=h,n},_(i,t)}function r(i){var t=p();return function(){var n=C(i),h;if(t){var c=C(this).constructor;h=Reflect.construct(n,arguments,c)}else h=n.apply(this,arguments);return T(this,h)}}function T(i,t){return t&&(d(t)==="object"||typeof t=="function")?t:M(i)}function M(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}function p(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function C(i){return C=Object.setPrototypeOf?Object.getPrototypeOf:function(m){return m.__proto__||Object.getPrototypeOf(m)},C(i)}var v=function(i){y(m,i);var t=r(m);function m(n,h){var c;return f(this,m),c=t.call(this),c.url=n||null,c.type=h||null,c.mediaType=I.default.STREAM,c.responseType="",c}return m}(g.default);const E=v},"./src/streaming/vo/TextTrackInfo.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>v});var I=e("./src/dash/vo/MediaInfo.js");function g(E){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?g=function(t){return typeof t}:g=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},g(E)}function d(E,i){if(!(E instanceof i))throw new TypeError("Cannot call a class as a function")}function f(E,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");E.prototype=Object.create(i&&i.prototype,{constructor:{value:E,writable:!0,configurable:!0}}),i&&y(E,i)}function y(E,i){return y=Object.setPrototypeOf||function(m,n){return m.__proto__=n,m},y(E,i)}function _(E){var i=M();return function(){var m=p(E),n;if(i){var h=p(this).constructor;n=Reflect.construct(m,arguments,h)}else n=m.apply(this,arguments);return r(this,n)}}function r(E,i){return i&&(g(i)==="object"||typeof i=="function")?i:T(E)}function T(E){if(E===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E}function M(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function p(E){return p=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},p(E)}var C=function(E){f(t,E);var i=_(t);function t(){var m;return d(this,t),m=i.call(this),m.captionData=null,m.label=null,m.defaultTrack=!1,m.kind=null,m.isFragmented=!1,m.isEmbedded=!1,m.isTTML=null,m}return t}(I.default);const v=C},"./src/streaming/vo/Thumbnail.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.url=null,this.width=null,this.height=null,this.x=null,this.y=null};const d=g},"./src/streaming/vo/ThumbnailTrackInfo.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.bitrate=0,this.width=0,this.height=0,this.tilesHor=0,this.tilesVert=0,this.widthPerTile=0,this.heightPerTile=0,this.startNumber=0,this.segmentDuration=0,this.timescale=0,this.templateUrl="",this.id=""};const d=g},"./src/streaming/vo/URIFragmentData.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.t=null,this.xywh=null,this.track=null,this.id=null,this.s=null,this.r=null};const d=g},"./src/streaming/vo/metrics/BufferLevel.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.t=null,this.level=null};const d=g},"./src/streaming/vo/metrics/BufferState.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>f});var I=e("./src/streaming/constants/MetricsConstants.js");function g(y,_){if(!(y instanceof _))throw new TypeError("Cannot call a class as a function")}var d=function y(){g(this,y),this.target=null,this.state=I.default.BUFFER_EMPTY};const f=d},"./src/streaming/vo/metrics/DVRInfo.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.time=null,this.range=null,this.manifestInfo=null};const d=g},"./src/streaming/vo/metrics/DroppedFrames.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.time=null,this.droppedFrames=null};const d=g},"./src/streaming/vo/metrics/HTTPRequest.js":(ce,N,e)=>{e.r(N),e.d(N,{HTTPRequest:()=>g,HTTPRequestTrace:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.tcpid=null,this.type=null,this.url=null,this.actualurl=null,this.range=null,this.trequest=null,this.tresponse=null,this.responsecode=null,this.interval=null,this.trace=[],this.cmsd=null,this._stream=null,this._tfinish=null,this._mediaduration=null,this._quality=null,this._responseHeaders=null,this._serviceLocation=null,this._fileLoaderType=null},d=function f(){I(this,f),this.s=null,this.d=null,this.b=[]};g.GET="GET",g.HEAD="HEAD",g.MPD_TYPE="MPD",g.XLINK_EXPANSION_TYPE="XLinkExpansion",g.INIT_SEGMENT_TYPE="InitializationSegment",g.INDEX_SEGMENT_TYPE="IndexSegment",g.MEDIA_SEGMENT_TYPE="MediaSegment",g.BITSTREAM_SWITCHING_SEGMENT_TYPE="BitstreamSwitchingSegment",g.MSS_FRAGMENT_INFO_SEGMENT_TYPE="FragmentInfoSegment",g.DVB_REPORTING_TYPE="DVBReporting",g.LICENSE="license",g.CONTENT_STEERING_TYPE="ContentSteering",g.OTHER_TYPE="other"},"./src/streaming/vo/metrics/ManifestUpdate.js":(ce,N,e)=>{e.r(N),e.d(N,{ManifestUpdate:()=>g,ManifestUpdateRepresentationInfo:()=>f,ManifestUpdateStreamInfo:()=>d});function I(y,_){if(!(y instanceof _))throw new TypeError("Cannot call a class as a function")}var g=function y(){I(this,y),this.mediaType=null,this.type=null,this.requestTime=null,this.fetchTime=null,this.availabilityStartTime=null,this.presentationStartTime=0,this.clientTimeOffset=0,this.currentTime=null,this.buffered=null,this.latency=0,this.streamInfo=[],this.representationInfo=[]},d=function y(){I(this,y),this.id=null,this.index=null,this.start=null,this.duration=null},f=function y(){I(this,y),this.id=null,this.index=null,this.mediaType=null,this.streamIndex=null,this.presentationTimeOffset=null,this.startNumber=null,this.fragmentInfoType=null}},"./src/streaming/vo/metrics/PlayList.js":(ce,N,e)=>{e.r(N),e.d(N,{PlayList:()=>g,PlayListTrace:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.start=null,this.mstart=null,this.starttype=null,this.trace=[]};g.INITIAL_PLAYOUT_START_REASON="initial_playout",g.SEEK_START_REASON="seek",g.RESUME_FROM_PAUSE_START_REASON="resume",g.METRICS_COLLECTION_START_REASON="metrics_collection_start";var d=function f(){I(this,f),this.representationid=null,this.subreplevel=null,this.start=null,this.mstart=null,this.duration=null,this.playbackspeed=null,this.stopreason=null};d.REPRESENTATION_SWITCH_STOP_REASON="representation_switch",d.REBUFFERING_REASON="rebuffering",d.USER_REQUEST_STOP_REASON="user_request",d.END_OF_PERIOD_STOP_REASON="end_of_period",d.END_OF_CONTENT_STOP_REASON="end_of_content",d.METRICS_COLLECTION_STOP_REASON="metrics_collection_end",d.FAILURE_STOP_REASON="failure"},"./src/streaming/vo/metrics/RepresentationSwitch.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.t=null,this.mt=null,this.to=null,this.lto=null};const d=g},"./src/streaming/vo/metrics/RequestsQueue.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.loadingRequests=[],this.executedRequests=[]};const d=g},"./src/streaming/vo/metrics/SchedulingInfo.js":(ce,N,e)=>{e.r(N),e.d(N,{default:()=>d});function I(f,y){if(!(f instanceof y))throw new TypeError("Cannot call a class as a function")}var g=function f(){I(this,f),this.mediaType=null,this.t=null,this.type=null,this.startTime=null,this.availabilityStartTime=null,this.duration=null,this.quality=null,this.range=null,this.state=null};const d=g},"./node_modules/bcp-47-match/index.js":(ce,N)=>{N.basicFilter=d(e,!0),N.extendedFilter=d(I,!0),N.lookup=d(g);function e(y,_){return _==="*"||y===_||y.indexOf(_+"-")>-1}function I(y,_){var r=y.split("-"),T=_.split("-"),M=0,p=0;if(T[p]!=="*"&&r[M]!==T[p])return!1;for(M++,p++;p<T.length;){if(T[p]==="*"){p++;continue}if(!r[M])return!1;if(r[M]===T[p]){M++,p++;continue}if(r[M].length===1)return!1;M++}return!0}function g(y,_){for(var r=_,T;;){if(r==="*"||y===r)return!0;if(T=r.lastIndexOf("-"),T<0)return!1;r.charAt(T-2)==="-"&&(T-=2),r=r.slice(0,T)}}function d(y,_){return r;function r(T,M){for(var p=f(T,"tag"),C=f(M??"*","range"),v=[],E=-1,i,t,m;++E<C.length;)if(i=C[E].toLowerCase(),!(!_&&i==="*")){for(t=-1,m=[];++t<p.length;)if(y(p[t].toLowerCase(),i)){if(!_)return p[t];v.push(p[t])}else m.push(p[t]);p=m}return _?v:void 0}}function f(y,_){var r=y&&typeof y=="string"?[y]:y;if(!r||typeof r!="object"||!("length"in r))throw new Error("Invalid "+_+" `"+r+"`, expected non-empty string");return r}},"./node_modules/bcp-47-normalize/index.js":(ce,N,e)=>{ce.exports=e("./node_modules/bcp-47-normalize/lib/index.js")},"./node_modules/bcp-47-normalize/lib/index.js":(ce,N,e)=>{var I=e("./node_modules/bcp-47/index.js"),g=e("./node_modules/bcp-47-match/index.js"),d=e("./node_modules/bcp-47-normalize/lib/matches.json"),f=e("./node_modules/bcp-47-normalize/lib/fields.json"),y=e("./node_modules/bcp-47-normalize/lib/defaults.json"),_=e("./node_modules/bcp-47-normalize/lib/many.json");ce.exports=p;var r={}.hasOwnProperty,T=new Intl.Collator,M={variants:[],extensions:[],privateuse:[],irregular:null,regular:null};function p(t,m){var n=m||{},h=I.parse(String(t||"").toLowerCase(),n),c=I.stringify(h),o=-1,l;if(!c)return c;for(;++o<d.length;)g.extendedFilter(c,d[o].from).length&&(C(h,d[o].from,d[o].to),c=I.stringify(h));for(o=-1;++o<f.length;)v(h,f[o].from.field,f[o].from.value)&&E(h,f[o].to.field,f[o].to.value);for(c=I.stringify(Object.assign({},h,M)),o=-1;++o<y.length;)c===y[o]&&(C(h,y[o],y[o].split("-").slice(0,-1).join("-")),c=I.stringify(Object.assign({},h,M)));if(h.extensions.sort(i),n.warning)for(l in _)r.call(_[l],h[l])&&n.warning("Deprecated "+l+" `"+h[l]+"`, expected one of `"+_[l][h[l]].join("`, `")+"`",null,7);return h.script&&(h.script=h.script.charAt(0).toUpperCase()+h.script.slice(1)),h.region&&(h.region=h.region.toUpperCase()),I.stringify(h)}function C(t,m,n){var h=I.parse(m),c=I.parse(n),o=[],l;for(l in h)h[l]&&h[l].length&&v(t,l,h[l])&&o.push(l);for(l in c)c[l]&&c[l].length&&(o.indexOf(l)>-1||!t[l]||!t[l].length)&&E(t,l,c[l])}function v(t,m,n){var h=!1,c,o,l,A;if(n){if(c=t[m],o=c,c&&typeof c=="object")for(o=[],l=-1;++l<c.length;)A=c[l],n.indexOf(A)<0?o.push(A):h=!0;else c===n&&(o=null,h=!0);t[m]=o}return h}function E(t,m,n){var h=t[m],c,o,l;if(h&&typeof h=="object")for(c=[].concat(n),o=-1;++o<c.length;)l=c[o],h.indexOf(l)<0&&h.push(l);else t[m]=n}function i(t,m){return T.compare(t.singleton,m.singleton)}},"./node_modules/bcp-47/index.js":(ce,N,e)=>{N.parse=e("./node_modules/bcp-47/lib/parse.js"),N.stringify=e("./node_modules/bcp-47/lib/stringify.js")},"./node_modules/bcp-47/lib/parse.js":(ce,N,e)=>{var I=e("./node_modules/is-alphanumerical/index.js"),g=e("./node_modules/is-alphabetical/index.js"),d=e("./node_modules/is-decimal/index.js"),f=e("./node_modules/bcp-47/lib/regular.json"),y=e("./node_modules/bcp-47/lib/normalize.json");ce.exports=r;var _={}.hasOwnProperty;function r(M,p){var C=p||{},v=T(),E=String(M),i=E.toLowerCase(),t=0,m,n,h;if(M==null)throw new Error("Expected string, got `"+M+"`");if(_.call(y,i))return(C.normalize==null||C.normalize)&&y[i]?r(y[i]):(v[f.indexOf(i)===-1?"irregular":"regular"]=E,v);for(;g(i.charCodeAt(t))&&t<9;)t++;if(t>1&&t<9){if(v.language=E.slice(0,t),t<4)for(n=0;i.charCodeAt(t)===45&&g(i.charCodeAt(t+1))&&g(i.charCodeAt(t+2))&&g(i.charCodeAt(t+3))&&!g(i.charCodeAt(t+4));){if(n>2)return c(t,3,"Too many extended language subtags, expected at most 3 subtags");v.extendedLanguageSubtags.push(E.slice(t+1,t+4)),t+=4,n++}for(i.charCodeAt(t)===45&&g(i.charCodeAt(t+1))&&g(i.charCodeAt(t+2))&&g(i.charCodeAt(t+3))&&g(i.charCodeAt(t+4))&&!g(i.charCodeAt(t+5))&&(v.script=E.slice(t+1,t+5),t+=5),i.charCodeAt(t)===45&&(g(i.charCodeAt(t+1))&&g(i.charCodeAt(t+2))&&!g(i.charCodeAt(t+3))?(v.region=E.slice(t+1,t+3),t+=3):d(i.charCodeAt(t+1))&&d(i.charCodeAt(t+2))&&d(i.charCodeAt(t+3))&&!d(i.charCodeAt(t+4))&&(v.region=E.slice(t+1,t+4),t+=4));i.charCodeAt(t)===45;){for(h=m=t+1;I(i.charCodeAt(h));){if(h-m>7)return c(h,1,"Too long variant, expected at most 8 characters");h++}if(h-m>4||h-m>3&&d(i.charCodeAt(m)))v.variants.push(E.slice(m,h)),t=h;else break}for(;i.charCodeAt(t)===45&&!(i.charCodeAt(t+1)===120||!I(i.charCodeAt(t+1))||i.charCodeAt(t+2)!==45||!I(i.charCodeAt(t+3)));){for(h=t+2,n=0;i.charCodeAt(h)===45&&I(i.charCodeAt(h+1))&&I(i.charCodeAt(h+2));)for(m=h+1,h=m+2,n++;I(i.charCodeAt(h));){if(h-m>7)return c(h,2,"Too long extension, expected at most 8 characters");h++}if(!n)return c(h,4,"Empty extension, extensions must have at least 2 characters of content");v.extensions.push({singleton:E.charAt(t+1),extensions:E.slice(t+3,h).split("-")}),t=h}}else t=0;if(t===0&&i.charCodeAt(t)===120||i.charCodeAt(t)===45&&i.charCodeAt(t+1)===120)for(h=t=t?t+2:1;i.charCodeAt(h)===45&&I(i.charCodeAt(h+1));){for(h=m=t+1;I(i.charCodeAt(h));){if(h-m>7)return c(h,5,"Too long private-use area, expected at most 8 characters");h++}v.privateuse.push(E.slice(t+1,h)),t=h}if(t!==E.length)return c(t,6,"Found superfluous content after tag");return v;function c(o,l,A){return C.warning&&C.warning(A,l,o),C.forgiving?v:T()}}function T(){return{language:null,extendedLanguageSubtags:[],script:null,region:null,variants:[],extensions:[],privateuse:[],irregular:null,regular:null}}},"./node_modules/bcp-47/lib/stringify.js":ce=>{ce.exports=N;function N(e){var I=e||{},g=[],d,f,y;if(I.irregular||I.regular)return I.irregular||I.regular;if(I.language)for(g=g.concat(I.language,I.extendedLanguageSubtags||[],I.script||[],I.region||[],I.variants||[]),d=I.extensions||[],f=-1;++f<d.length;)y=d[f],y.singleton&&y.extensions&&y.extensions.length&&(g=g.concat(y.singleton,y.extensions));return I.privateuse&&I.privateuse.length&&(g=g.concat("x",I.privateuse)),g.join("-")}},"./node_modules/buffer/index.js":(ce,N,e)=>{/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var I=e("./node_modules/buffer/node_modules/base64-js/index.js"),g=e("./node_modules/buffer/node_modules/ieee754/index.js"),d=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;N.Buffer=r,N.SlowBuffer=h,N.INSPECT_MAX_BYTES=50;var f=2147483647;N.kMaxLength=f,r.TYPED_ARRAY_SUPPORT=y(),!r.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function y(){try{var O=new Uint8Array(1),P={foo:function(){return 42}};return Object.setPrototypeOf(P,Uint8Array.prototype),Object.setPrototypeOf(O,P),O.foo()===42}catch{return!1}}Object.defineProperty(r.prototype,"parent",{enumerable:!0,get:function(){if(r.isBuffer(this))return this.buffer}}),Object.defineProperty(r.prototype,"offset",{enumerable:!0,get:function(){if(r.isBuffer(this))return this.byteOffset}});function _(O){if(O>f)throw new RangeError('The value "'+O+'" is invalid for option "size"');var P=new Uint8Array(O);return Object.setPrototypeOf(P,r.prototype),P}function r(O,P,B){if(typeof O=="number"){if(typeof P=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return C(O)}return T(O,P,B)}r.poolSize=8192;function T(O,P,B){if(typeof O=="string")return v(O,P);if(ArrayBuffer.isView(O))return i(O);if(O==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof O);if(D(O,ArrayBuffer)||O&&D(O.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(D(O,SharedArrayBuffer)||O&&D(O.buffer,SharedArrayBuffer)))return t(O,P,B);if(typeof O=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var x=O.valueOf&&O.valueOf();if(x!=null&&x!==O)return r.from(x,P,B);var ne=m(O);if(ne)return ne;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof O[Symbol.toPrimitive]=="function")return r.from(O[Symbol.toPrimitive]("string"),P,B);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof O)}r.from=function(O,P,B){return T(O,P,B)},Object.setPrototypeOf(r.prototype,Uint8Array.prototype),Object.setPrototypeOf(r,Uint8Array);function M(O){if(typeof O!="number")throw new TypeError('"size" argument must be of type number');if(O<0)throw new RangeError('The value "'+O+'" is invalid for option "size"')}function p(O,P,B){return M(O),O<=0?_(O):P!==void 0?typeof B=="string"?_(O).fill(P,B):_(O).fill(P):_(O)}r.alloc=function(O,P,B){return p(O,P,B)};function C(O){return M(O),_(O<0?0:n(O)|0)}r.allocUnsafe=function(O){return C(O)},r.allocUnsafeSlow=function(O){return C(O)};function v(O,P){if((typeof P!="string"||P==="")&&(P="utf8"),!r.isEncoding(P))throw new TypeError("Unknown encoding: "+P);var B=c(O,P)|0,x=_(B),ne=x.write(O,P);return ne!==B&&(x=x.slice(0,ne)),x}function E(O){for(var P=O.length<0?0:n(O.length)|0,B=_(P),x=0;x<P;x+=1)B[x]=O[x]&255;return B}function i(O){if(D(O,Uint8Array)){var P=new Uint8Array(O);return t(P.buffer,P.byteOffset,P.byteLength)}return E(O)}function t(O,P,B){if(P<0||O.byteLength<P)throw new RangeError('"offset" is outside of buffer bounds');if(O.byteLength<P+(B||0))throw new RangeError('"length" is outside of buffer bounds');var x;return P===void 0&&B===void 0?x=new Uint8Array(O):B===void 0?x=new Uint8Array(O,P):x=new Uint8Array(O,P,B),Object.setPrototypeOf(x,r.prototype),x}function m(O){if(r.isBuffer(O)){var P=n(O.length)|0,B=_(P);return B.length===0||O.copy(B,0,0,P),B}if(O.length!==void 0)return typeof O.length!="number"||F(O.length)?_(0):E(O);if(O.type==="Buffer"&&Array.isArray(O.data))return E(O.data)}function n(O){if(O>=f)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+f.toString(16)+" bytes");return O|0}function h(O){return+O!=O&&(O=0),r.alloc(+O)}r.isBuffer=function(P){return P!=null&&P._isBuffer===!0&&P!==r.prototype},r.compare=function(P,B){if(D(P,Uint8Array)&&(P=r.from(P,P.offset,P.byteLength)),D(B,Uint8Array)&&(B=r.from(B,B.offset,B.byteLength)),!r.isBuffer(P)||!r.isBuffer(B))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(P===B)return 0;for(var x=P.length,ne=B.length,re=0,G=Math.min(x,ne);re<G;++re)if(P[re]!==B[re]){x=P[re],ne=B[re];break}return x<ne?-1:ne<x?1:0},r.isEncoding=function(P){switch(String(P).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.concat=function(P,B){if(!Array.isArray(P))throw new TypeError('"list" argument must be an Array of Buffers');if(P.length===0)return r.alloc(0);var x;if(B===void 0)for(B=0,x=0;x<P.length;++x)B+=P[x].length;var ne=r.allocUnsafe(B),re=0;for(x=0;x<P.length;++x){var G=P[x];if(D(G,Uint8Array))re+G.length>ne.length?r.from(G).copy(ne,re):Uint8Array.prototype.set.call(ne,G,re);else if(r.isBuffer(G))G.copy(ne,re);else throw new TypeError('"list" argument must be an Array of Buffers');re+=G.length}return ne};function c(O,P){if(r.isBuffer(O))return O.length;if(ArrayBuffer.isView(O)||D(O,ArrayBuffer))return O.byteLength;if(typeof O!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof O);var B=O.length,x=arguments.length>2&&arguments[2]===!0;if(!x&&B===0)return 0;for(var ne=!1;;)switch(P){case"ascii":case"latin1":case"binary":return B;case"utf8":case"utf-8":return V(O).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B*2;case"hex":return B>>>1;case"base64":return R(O).length;default:if(ne)return x?-1:V(O).length;P=(""+P).toLowerCase(),ne=!0}}r.byteLength=c;function o(O,P,B){var x=!1;if((P===void 0||P<0)&&(P=0),P>this.length||((B===void 0||B>this.length)&&(B=this.length),B<=0)||(B>>>=0,P>>>=0,B<=P))return"";for(O||(O="utf8");;)switch(O){case"hex":return $(this,P,B);case"utf8":case"utf-8":return j(this,P,B);case"ascii":return Y(this,P,B);case"latin1":case"binary":return J(this,P,B);case"base64":return b(this,P,B);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ae(this,P,B);default:if(x)throw new TypeError("Unknown encoding: "+O);O=(O+"").toLowerCase(),x=!0}}r.prototype._isBuffer=!0;function l(O,P,B){var x=O[P];O[P]=O[B],O[B]=x}r.prototype.swap16=function(){var P=this.length;if(P%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var B=0;B<P;B+=2)l(this,B,B+1);return this},r.prototype.swap32=function(){var P=this.length;if(P%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var B=0;B<P;B+=4)l(this,B,B+3),l(this,B+1,B+2);return this},r.prototype.swap64=function(){var P=this.length;if(P%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var B=0;B<P;B+=8)l(this,B,B+7),l(this,B+1,B+6),l(this,B+2,B+5),l(this,B+3,B+4);return this},r.prototype.toString=function(){var P=this.length;return P===0?"":arguments.length===0?j(this,0,P):o.apply(this,arguments)},r.prototype.toLocaleString=r.prototype.toString,r.prototype.equals=function(P){if(!r.isBuffer(P))throw new TypeError("Argument must be a Buffer");return this===P?!0:r.compare(this,P)===0},r.prototype.inspect=function(){var P="",B=N.INSPECT_MAX_BYTES;return P=this.toString("hex",0,B).replace(/(.{2})/g,"$1 ").trim(),this.length>B&&(P+=" ... "),"<Buffer "+P+">"},d&&(r.prototype[d]=r.prototype.inspect),r.prototype.compare=function(P,B,x,ne,re){if(D(P,Uint8Array)&&(P=r.from(P,P.offset,P.byteLength)),!r.isBuffer(P))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof P);if(B===void 0&&(B=0),x===void 0&&(x=P?P.length:0),ne===void 0&&(ne=0),re===void 0&&(re=this.length),B<0||x>P.length||ne<0||re>this.length)throw new RangeError("out of range index");if(ne>=re&&B>=x)return 0;if(ne>=re)return-1;if(B>=x)return 1;if(B>>>=0,x>>>=0,ne>>>=0,re>>>=0,this===P)return 0;for(var G=re-ne,fe=x-B,le=Math.min(G,fe),_e=this.slice(ne,re),Me=P.slice(B,x),Oe=0;Oe<le;++Oe)if(_e[Oe]!==Me[Oe]){G=_e[Oe],fe=Me[Oe];break}return G<fe?-1:fe<G?1:0};function A(O,P,B,x,ne){if(O.length===0)return-1;if(typeof B=="string"?(x=B,B=0):B>2147483647?B=2147483647:B<-2147483648&&(B=-2147483648),B=+B,F(B)&&(B=ne?0:O.length-1),B<0&&(B=O.length+B),B>=O.length){if(ne)return-1;B=O.length-1}else if(B<0)if(ne)B=0;else return-1;if(typeof P=="string"&&(P=r.from(P,x)),r.isBuffer(P))return P.length===0?-1:S(O,P,B,x,ne);if(typeof P=="number")return P=P&255,typeof Uint8Array.prototype.indexOf=="function"?ne?Uint8Array.prototype.indexOf.call(O,P,B):Uint8Array.prototype.lastIndexOf.call(O,P,B):S(O,[P],B,x,ne);throw new TypeError("val must be string, number or Buffer")}function S(O,P,B,x,ne){var re=1,G=O.length,fe=P.length;if(x!==void 0&&(x=String(x).toLowerCase(),x==="ucs2"||x==="ucs-2"||x==="utf16le"||x==="utf-16le")){if(O.length<2||P.length<2)return-1;re=2,G/=2,fe/=2,B/=2}function le(xe,Se){return re===1?xe[Se]:xe.readUInt16BE(Se*re)}var _e;if(ne){var Me=-1;for(_e=B;_e<G;_e++)if(le(O,_e)===le(P,Me===-1?0:_e-Me)){if(Me===-1&&(Me=_e),_e-Me+1===fe)return Me*re}else Me!==-1&&(_e-=_e-Me),Me=-1}else for(B+fe>G&&(B=G-fe),_e=B;_e>=0;_e--){for(var Oe=!0,Ne=0;Ne<fe;Ne++)if(le(O,_e+Ne)!==le(P,Ne)){Oe=!1;break}if(Oe)return _e}return-1}r.prototype.includes=function(P,B,x){return this.indexOf(P,B,x)!==-1},r.prototype.indexOf=function(P,B,x){return A(this,P,B,x,!0)},r.prototype.lastIndexOf=function(P,B,x){return A(this,P,B,x,!1)};function L(O,P,B,x){B=Number(B)||0;var ne=O.length-B;x?(x=Number(x),x>ne&&(x=ne)):x=ne;var re=P.length;x>re/2&&(x=re/2);for(var G=0;G<x;++G){var fe=parseInt(P.substr(G*2,2),16);if(F(fe))return G;O[B+G]=fe}return G}function U(O,P,B,x){return u(V(P,O.length-B),O,B,x)}function k(O,P,B,x){return u(te(P),O,B,x)}function X(O,P,B,x){return u(R(P),O,B,x)}function W(O,P,B,x){return u(z(P,O.length-B),O,B,x)}r.prototype.write=function(P,B,x,ne){if(B===void 0)ne="utf8",x=this.length,B=0;else if(x===void 0&&typeof B=="string")ne=B,x=this.length,B=0;else if(isFinite(B))B=B>>>0,isFinite(x)?(x=x>>>0,ne===void 0&&(ne="utf8")):(ne=x,x=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var re=this.length-B;if((x===void 0||x>re)&&(x=re),P.length>0&&(x<0||B<0)||B>this.length)throw new RangeError("Attempt to write outside buffer bounds");ne||(ne="utf8");for(var G=!1;;)switch(ne){case"hex":return L(this,P,B,x);case"utf8":case"utf-8":return U(this,P,B,x);case"ascii":case"latin1":case"binary":return k(this,P,B,x);case"base64":return X(this,P,B,x);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return W(this,P,B,x);default:if(G)throw new TypeError("Unknown encoding: "+ne);ne=(""+ne).toLowerCase(),G=!0}},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function b(O,P,B){return P===0&&B===O.length?I.fromByteArray(O):I.fromByteArray(O.slice(P,B))}function j(O,P,B){B=Math.min(O.length,B);for(var x=[],ne=P;ne<B;){var re=O[ne],G=null,fe=re>239?4:re>223?3:re>191?2:1;if(ne+fe<=B){var le,_e,Me,Oe;switch(fe){case 1:re<128&&(G=re);break;case 2:le=O[ne+1],(le&192)===128&&(Oe=(re&31)<<6|le&63,Oe>127&&(G=Oe));break;case 3:le=O[ne+1],_e=O[ne+2],(le&192)===128&&(_e&192)===128&&(Oe=(re&15)<<12|(le&63)<<6|_e&63,Oe>2047&&(Oe<55296||Oe>57343)&&(G=Oe));break;case 4:le=O[ne+1],_e=O[ne+2],Me=O[ne+3],(le&192)===128&&(_e&192)===128&&(Me&192)===128&&(Oe=(re&15)<<18|(le&63)<<12|(_e&63)<<6|Me&63,Oe>65535&&Oe<1114112&&(G=Oe))}}G===null?(G=65533,fe=1):G>65535&&(G-=65536,x.push(G>>>10&1023|55296),G=56320|G&1023),x.push(G),ne+=fe}return q(x)}var Q=4096;function q(O){var P=O.length;if(P<=Q)return String.fromCharCode.apply(String,O);for(var B="",x=0;x<P;)B+=String.fromCharCode.apply(String,O.slice(x,x+=Q));return B}function Y(O,P,B){var x="";B=Math.min(O.length,B);for(var ne=P;ne<B;++ne)x+=String.fromCharCode(O[ne]&127);return x}function J(O,P,B){var x="";B=Math.min(O.length,B);for(var ne=P;ne<B;++ne)x+=String.fromCharCode(O[ne]);return x}function $(O,P,B){var x=O.length;(!P||P<0)&&(P=0),(!B||B<0||B>x)&&(B=x);for(var ne="",re=P;re<B;++re)ne+=w[O[re]];return ne}function ae(O,P,B){for(var x=O.slice(P,B),ne="",re=0;re<x.length-1;re+=2)ne+=String.fromCharCode(x[re]+x[re+1]*256);return ne}r.prototype.slice=function(P,B){var x=this.length;P=~~P,B=B===void 0?x:~~B,P<0?(P+=x,P<0&&(P=0)):P>x&&(P=x),B<0?(B+=x,B<0&&(B=0)):B>x&&(B=x),B<P&&(B=P);var ne=this.subarray(P,B);return Object.setPrototypeOf(ne,r.prototype),ne};function K(O,P,B){if(O%1!==0||O<0)throw new RangeError("offset is not uint");if(O+P>B)throw new RangeError("Trying to access beyond buffer length")}r.prototype.readUintLE=r.prototype.readUIntLE=function(P,B,x){P=P>>>0,B=B>>>0,x||K(P,B,this.length);for(var ne=this[P],re=1,G=0;++G<B&&(re*=256);)ne+=this[P+G]*re;return ne},r.prototype.readUintBE=r.prototype.readUIntBE=function(P,B,x){P=P>>>0,B=B>>>0,x||K(P,B,this.length);for(var ne=this[P+--B],re=1;B>0&&(re*=256);)ne+=this[P+--B]*re;return ne},r.prototype.readUint8=r.prototype.readUInt8=function(P,B){return P=P>>>0,B||K(P,1,this.length),this[P]},r.prototype.readUint16LE=r.prototype.readUInt16LE=function(P,B){return P=P>>>0,B||K(P,2,this.length),this[P]|this[P+1]<<8},r.prototype.readUint16BE=r.prototype.readUInt16BE=function(P,B){return P=P>>>0,B||K(P,2,this.length),this[P]<<8|this[P+1]},r.prototype.readUint32LE=r.prototype.readUInt32LE=function(P,B){return P=P>>>0,B||K(P,4,this.length),(this[P]|this[P+1]<<8|this[P+2]<<16)+this[P+3]*16777216},r.prototype.readUint32BE=r.prototype.readUInt32BE=function(P,B){return P=P>>>0,B||K(P,4,this.length),this[P]*16777216+(this[P+1]<<16|this[P+2]<<8|this[P+3])},r.prototype.readIntLE=function(P,B,x){P=P>>>0,B=B>>>0,x||K(P,B,this.length);for(var ne=this[P],re=1,G=0;++G<B&&(re*=256);)ne+=this[P+G]*re;return re*=128,ne>=re&&(ne-=Math.pow(2,8*B)),ne},r.prototype.readIntBE=function(P,B,x){P=P>>>0,B=B>>>0,x||K(P,B,this.length);for(var ne=B,re=1,G=this[P+--ne];ne>0&&(re*=256);)G+=this[P+--ne]*re;return re*=128,G>=re&&(G-=Math.pow(2,8*B)),G},r.prototype.readInt8=function(P,B){return P=P>>>0,B||K(P,1,this.length),this[P]&128?(255-this[P]+1)*-1:this[P]},r.prototype.readInt16LE=function(P,B){P=P>>>0,B||K(P,2,this.length);var x=this[P]|this[P+1]<<8;return x&32768?x|4294901760:x},r.prototype.readInt16BE=function(P,B){P=P>>>0,B||K(P,2,this.length);var x=this[P+1]|this[P]<<8;return x&32768?x|4294901760:x},r.prototype.readInt32LE=function(P,B){return P=P>>>0,B||K(P,4,this.length),this[P]|this[P+1]<<8|this[P+2]<<16|this[P+3]<<24},r.prototype.readInt32BE=function(P,B){return P=P>>>0,B||K(P,4,this.length),this[P]<<24|this[P+1]<<16|this[P+2]<<8|this[P+3]},r.prototype.readFloatLE=function(P,B){return P=P>>>0,B||K(P,4,this.length),g.read(this,P,!0,23,4)},r.prototype.readFloatBE=function(P,B){return P=P>>>0,B||K(P,4,this.length),g.read(this,P,!1,23,4)},r.prototype.readDoubleLE=function(P,B){return P=P>>>0,B||K(P,8,this.length),g.read(this,P,!0,52,8)},r.prototype.readDoubleBE=function(P,B){return P=P>>>0,B||K(P,8,this.length),g.read(this,P,!1,52,8)};function ee(O,P,B,x,ne,re){if(!r.isBuffer(O))throw new TypeError('"buffer" argument must be a Buffer instance');if(P>ne||P<re)throw new RangeError('"value" argument is out of bounds');if(B+x>O.length)throw new RangeError("Index out of range")}r.prototype.writeUintLE=r.prototype.writeUIntLE=function(P,B,x,ne){if(P=+P,B=B>>>0,x=x>>>0,!ne){var re=Math.pow(2,8*x)-1;ee(this,P,B,x,re,0)}var G=1,fe=0;for(this[B]=P&255;++fe<x&&(G*=256);)this[B+fe]=P/G&255;return B+x},r.prototype.writeUintBE=r.prototype.writeUIntBE=function(P,B,x,ne){if(P=+P,B=B>>>0,x=x>>>0,!ne){var re=Math.pow(2,8*x)-1;ee(this,P,B,x,re,0)}var G=x-1,fe=1;for(this[B+G]=P&255;--G>=0&&(fe*=256);)this[B+G]=P/fe&255;return B+x},r.prototype.writeUint8=r.prototype.writeUInt8=function(P,B,x){return P=+P,B=B>>>0,x||ee(this,P,B,1,255,0),this[B]=P&255,B+1},r.prototype.writeUint16LE=r.prototype.writeUInt16LE=function(P,B,x){return P=+P,B=B>>>0,x||ee(this,P,B,2,65535,0),this[B]=P&255,this[B+1]=P>>>8,B+2},r.prototype.writeUint16BE=r.prototype.writeUInt16BE=function(P,B,x){return P=+P,B=B>>>0,x||ee(this,P,B,2,65535,0),this[B]=P>>>8,this[B+1]=P&255,B+2},r.prototype.writeUint32LE=r.prototype.writeUInt32LE=function(P,B,x){return P=+P,B=B>>>0,x||ee(this,P,B,4,4294967295,0),this[B+3]=P>>>24,this[B+2]=P>>>16,this[B+1]=P>>>8,this[B]=P&255,B+4},r.prototype.writeUint32BE=r.prototype.writeUInt32BE=function(P,B,x){return P=+P,B=B>>>0,x||ee(this,P,B,4,4294967295,0),this[B]=P>>>24,this[B+1]=P>>>16,this[B+2]=P>>>8,this[B+3]=P&255,B+4},r.prototype.writeIntLE=function(P,B,x,ne){if(P=+P,B=B>>>0,!ne){var re=Math.pow(2,8*x-1);ee(this,P,B,x,re-1,-re)}var G=0,fe=1,le=0;for(this[B]=P&255;++G<x&&(fe*=256);)P<0&&le===0&&this[B+G-1]!==0&&(le=1),this[B+G]=(P/fe>>0)-le&255;return B+x},r.prototype.writeIntBE=function(P,B,x,ne){if(P=+P,B=B>>>0,!ne){var re=Math.pow(2,8*x-1);ee(this,P,B,x,re-1,-re)}var G=x-1,fe=1,le=0;for(this[B+G]=P&255;--G>=0&&(fe*=256);)P<0&&le===0&&this[B+G+1]!==0&&(le=1),this[B+G]=(P/fe>>0)-le&255;return B+x},r.prototype.writeInt8=function(P,B,x){return P=+P,B=B>>>0,x||ee(this,P,B,1,127,-128),P<0&&(P=255+P+1),this[B]=P&255,B+1},r.prototype.writeInt16LE=function(P,B,x){return P=+P,B=B>>>0,x||ee(this,P,B,2,32767,-32768),this[B]=P&255,this[B+1]=P>>>8,B+2},r.prototype.writeInt16BE=function(P,B,x){return P=+P,B=B>>>0,x||ee(this,P,B,2,32767,-32768),this[B]=P>>>8,this[B+1]=P&255,B+2},r.prototype.writeInt32LE=function(P,B,x){return P=+P,B=B>>>0,x||ee(this,P,B,4,2147483647,-2147483648),this[B]=P&255,this[B+1]=P>>>8,this[B+2]=P>>>16,this[B+3]=P>>>24,B+4},r.prototype.writeInt32BE=function(P,B,x){return P=+P,B=B>>>0,x||ee(this,P,B,4,2147483647,-2147483648),P<0&&(P=4294967295+P+1),this[B]=P>>>24,this[B+1]=P>>>16,this[B+2]=P>>>8,this[B+3]=P&255,B+4};function se(O,P,B,x,ne,re){if(B+x>O.length)throw new RangeError("Index out of range");if(B<0)throw new RangeError("Index out of range")}function ue(O,P,B,x,ne){return P=+P,B=B>>>0,ne||se(O,P,B,4),g.write(O,P,B,x,23,4),B+4}r.prototype.writeFloatLE=function(P,B,x){return ue(this,P,B,!0,x)},r.prototype.writeFloatBE=function(P,B,x){return ue(this,P,B,!1,x)};function oe(O,P,B,x,ne){return P=+P,B=B>>>0,ne||se(O,P,B,8),g.write(O,P,B,x,52,8),B+8}r.prototype.writeDoubleLE=function(P,B,x){return oe(this,P,B,!0,x)},r.prototype.writeDoubleBE=function(P,B,x){return oe(this,P,B,!1,x)},r.prototype.copy=function(P,B,x,ne){if(!r.isBuffer(P))throw new TypeError("argument should be a Buffer");if(x||(x=0),!ne&&ne!==0&&(ne=this.length),B>=P.length&&(B=P.length),B||(B=0),ne>0&&ne<x&&(ne=x),ne===x||P.length===0||this.length===0)return 0;if(B<0)throw new RangeError("targetStart out of bounds");if(x<0||x>=this.length)throw new RangeError("Index out of range");if(ne<0)throw new RangeError("sourceEnd out of bounds");ne>this.length&&(ne=this.length),P.length-B<ne-x&&(ne=P.length-B+x);var re=ne-x;return this===P&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(B,x,ne):Uint8Array.prototype.set.call(P,this.subarray(x,ne),B),re},r.prototype.fill=function(P,B,x,ne){if(typeof P=="string"){if(typeof B=="string"?(ne=B,B=0,x=this.length):typeof x=="string"&&(ne=x,x=this.length),ne!==void 0&&typeof ne!="string")throw new TypeError("encoding must be a string");if(typeof ne=="string"&&!r.isEncoding(ne))throw new TypeError("Unknown encoding: "+ne);if(P.length===1){var re=P.charCodeAt(0);(ne==="utf8"&&re<128||ne==="latin1")&&(P=re)}}else typeof P=="number"?P=P&255:typeof P=="boolean"&&(P=Number(P));if(B<0||this.length<B||this.length<x)throw new RangeError("Out of range index");if(x<=B)return this;B=B>>>0,x=x===void 0?this.length:x>>>0,P||(P=0);var G;if(typeof P=="number")for(G=B;G<x;++G)this[G]=P;else{var fe=r.isBuffer(P)?P:r.from(P,ne),le=fe.length;if(le===0)throw new TypeError('The value "'+P+'" is invalid for argument "value"');for(G=0;G<x-B;++G)this[G+B]=fe[G%le]}return this};var Z=/[^+/0-9A-Za-z-_]/g;function H(O){if(O=O.split("=")[0],O=O.trim().replace(Z,""),O.length<2)return"";for(;O.length%4!==0;)O=O+"=";return O}function V(O,P){P=P||1/0;for(var B,x=O.length,ne=null,re=[],G=0;G<x;++G){if(B=O.charCodeAt(G),B>55295&&B<57344){if(!ne){if(B>56319){(P-=3)>-1&&re.push(239,191,189);continue}else if(G+1===x){(P-=3)>-1&&re.push(239,191,189);continue}ne=B;continue}if(B<56320){(P-=3)>-1&&re.push(239,191,189),ne=B;continue}B=(ne-55296<<10|B-56320)+65536}else ne&&(P-=3)>-1&&re.push(239,191,189);if(ne=null,B<128){if((P-=1)<0)break;re.push(B)}else if(B<2048){if((P-=2)<0)break;re.push(B>>6|192,B&63|128)}else if(B<65536){if((P-=3)<0)break;re.push(B>>12|224,B>>6&63|128,B&63|128)}else if(B<1114112){if((P-=4)<0)break;re.push(B>>18|240,B>>12&63|128,B>>6&63|128,B&63|128)}else throw new Error("Invalid code point")}return re}function te(O){for(var P=[],B=0;B<O.length;++B)P.push(O.charCodeAt(B)&255);return P}function z(O,P){for(var B,x,ne,re=[],G=0;G<O.length&&!((P-=2)<0);++G)B=O.charCodeAt(G),x=B>>8,ne=B%256,re.push(ne),re.push(x);return re}function R(O){return I.toByteArray(H(O))}function u(O,P,B,x){for(var ne=0;ne<x&&!(ne+B>=P.length||ne>=O.length);++ne)P[ne+B]=O[ne];return ne}function D(O,P){return O instanceof P||O!=null&&O.constructor!=null&&O.constructor.name!=null&&O.constructor.name===P.name}function F(O){return O!==O}var w=function(){for(var O="0123456789abcdef",P=new Array(256),B=0;B<16;++B)for(var x=B*16,ne=0;ne<16;++ne)P[x+ne]=O[B]+O[ne];return P}()},"./node_modules/buffer/node_modules/base64-js/index.js":(ce,N)=>{N.byteLength=r,N.toByteArray=M,N.fromByteArray=v;for(var e=[],I=[],g=typeof Uint8Array<"u"?Uint8Array:Array,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=0,y=d.length;f<y;++f)e[f]=d[f],I[d.charCodeAt(f)]=f;I["-".charCodeAt(0)]=62,I["_".charCodeAt(0)]=63;function _(E){var i=E.length;if(i%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=E.indexOf("=");t===-1&&(t=i);var m=t===i?0:4-t%4;return[t,m]}function r(E){var i=_(E),t=i[0],m=i[1];return(t+m)*3/4-m}function T(E,i,t){return(i+t)*3/4-t}function M(E){var i,t=_(E),m=t[0],n=t[1],h=new g(T(E,m,n)),c=0,o=n>0?m-4:m,l;for(l=0;l<o;l+=4)i=I[E.charCodeAt(l)]<<18|I[E.charCodeAt(l+1)]<<12|I[E.charCodeAt(l+2)]<<6|I[E.charCodeAt(l+3)],h[c++]=i>>16&255,h[c++]=i>>8&255,h[c++]=i&255;return n===2&&(i=I[E.charCodeAt(l)]<<2|I[E.charCodeAt(l+1)]>>4,h[c++]=i&255),n===1&&(i=I[E.charCodeAt(l)]<<10|I[E.charCodeAt(l+1)]<<4|I[E.charCodeAt(l+2)]>>2,h[c++]=i>>8&255,h[c++]=i&255),h}function p(E){return e[E>>18&63]+e[E>>12&63]+e[E>>6&63]+e[E&63]}function C(E,i,t){for(var m,n=[],h=i;h<t;h+=3)m=(E[h]<<16&16711680)+(E[h+1]<<8&65280)+(E[h+2]&255),n.push(p(m));return n.join("")}function v(E){for(var i,t=E.length,m=t%3,n=[],h=16383,c=0,o=t-m;c<o;c+=h)n.push(C(E,c,c+h>o?o:c+h));return m===1?(i=E[t-1],n.push(e[i>>2]+e[i<<4&63]+"==")):m===2&&(i=(E[t-2]<<8)+E[t-1],n.push(e[i>>10]+e[i>>4&63]+e[i<<2&63]+"=")),n.join("")}},"./node_modules/buffer/node_modules/ieee754/index.js":(ce,N)=>{/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */N.read=function(e,I,g,d,f){var y,_,r=f*8-d-1,T=(1<<r)-1,M=T>>1,p=-7,C=g?f-1:0,v=g?-1:1,E=e[I+C];for(C+=v,y=E&(1<<-p)-1,E>>=-p,p+=r;p>0;y=y*256+e[I+C],C+=v,p-=8);for(_=y&(1<<-p)-1,y>>=-p,p+=d;p>0;_=_*256+e[I+C],C+=v,p-=8);if(y===0)y=1-M;else{if(y===T)return _?NaN:(E?-1:1)*(1/0);_=_+Math.pow(2,d),y=y-M}return(E?-1:1)*_*Math.pow(2,y-d)},N.write=function(e,I,g,d,f,y){var _,r,T,M=y*8-f-1,p=(1<<M)-1,C=p>>1,v=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,E=d?0:y-1,i=d?1:-1,t=I<0||I===0&&1/I<0?1:0;for(I=Math.abs(I),isNaN(I)||I===1/0?(r=isNaN(I)?1:0,_=p):(_=Math.floor(Math.log(I)/Math.LN2),I*(T=Math.pow(2,-_))<1&&(_--,T*=2),_+C>=1?I+=v/T:I+=v*Math.pow(2,1-C),I*T>=2&&(_++,T/=2),_+C>=p?(r=0,_=p):_+C>=1?(r=(I*T-1)*Math.pow(2,f),_=_+C):(r=I*Math.pow(2,C-1)*Math.pow(2,f),_=0));f>=8;e[g+E]=r&255,E+=i,r/=256,f-=8);for(_=_<<f|r,M+=f;M>0;e[g+E]=_&255,E+=i,_/=256,M-=8);e[g+E-i]|=t*128}},"./node_modules/codem-isoboxer/dist/iso_boxer.js":(ce,N)=>{/*! codem-isoboxer v0.3.6 https://github.com/madebyhiro/codem-isoboxer/blob/master/LICENSE.txt */var e={};e.parseBuffer=function(d){return new I(d).parse()},e.addBoxProcessor=function(d,f){typeof d!="string"||typeof f!="function"||(g.prototype._boxProcessors[d]=f)},e.createFile=function(){return new I},e.createBox=function(d,f,y){var _=g.create(d);return f&&f.append(_,y),_},e.createFullBox=function(d,f,y){var _=e.createBox(d,f,y);return _.version=0,_.flags=0,_},e.Utils={},e.Utils.dataViewToString=function(d,f){var y=f||"utf-8";if(typeof TextDecoder<"u")return new TextDecoder(y).decode(d);var _=[],r=0;if(y==="utf-8")for(;r<d.byteLength;){var T=d.getUint8(r++);T<128||(T<224?(T=(T&31)<<6,T|=d.getUint8(r++)&63):T<240?(T=(T&15)<<12,T|=(d.getUint8(r++)&63)<<6,T|=d.getUint8(r++)&63):(T=(T&7)<<18,T|=(d.getUint8(r++)&63)<<12,T|=(d.getUint8(r++)&63)<<6,T|=d.getUint8(r++)&63)),_.push(String.fromCharCode(T))}else for(;r<d.byteLength;)_.push(String.fromCharCode(d.getUint8(r++)));return _.join("")},e.Utils.utf8ToByteArray=function(d){var f,y;if(typeof TextEncoder<"u")f=new TextEncoder().encode(d);else for(f=[],y=0;y<d.length;++y){var _=d.charCodeAt(y);_<128?f.push(_):_<2048?(f.push(192|_>>6),f.push(128|63&_)):_<65536?(f.push(224|_>>12),f.push(128|63&_>>6),f.push(128|63&_)):(f.push(240|_>>18),f.push(128|63&_>>12),f.push(128|63&_>>6),f.push(128|63&_))}return f},e.Utils.appendBox=function(d,f,y){if(f._offset=d._cursor.offset,f._root=d._root?d._root:d,f._raw=d._raw,f._parent=d,y!==-1){if(y==null){d.boxes.push(f);return}var _=-1,r;if(typeof y=="number")_=y;else{if(typeof y=="string")r=y;else if(typeof y=="object"&&y.type)r=y.type;else{d.boxes.push(f);return}for(var T=0;T<d.boxes.length;T++)if(r===d.boxes[T].type){_=T+1;break}}d.boxes.splice(_,0,f)}},N.parseBuffer=e.parseBuffer,N.addBoxProcessor=e.addBoxProcessor,N.createFile=e.createFile,N.createBox=e.createBox,N.createFullBox=e.createFullBox,N.Utils=e.Utils,e.Cursor=function(d){this.offset=typeof d>"u"?0:d};var I=function(d){this._cursor=new e.Cursor,this.boxes=[],d&&(this._raw=new DataView(d))};I.prototype.fetch=function(d){var f=this.fetchAll(d,!0);return f.length?f[0]:null},I.prototype.fetchAll=function(d,f){var y=[];return I._sweep.call(this,d,y,f),y},I.prototype.parse=function(){for(this._cursor.offset=0,this.boxes=[];this._cursor.offset<this._raw.byteLength;){var d=g.parse(this);if(typeof d.type>"u")break;this.boxes.push(d)}return this},I._sweep=function(d,f,y){this.type&&this.type==d&&f.push(this);for(var _ in this.boxes){if(f.length&&y)return;I._sweep.call(this.boxes[_],d,f,y)}},I.prototype.write=function(){var d=0,f;for(f=0;f<this.boxes.length;f++)d+=this.boxes[f].getLength(!1);var y=new Uint8Array(d);for(this._rawo=new DataView(y.buffer),this.bytes=y,this._cursor.offset=0,f=0;f<this.boxes.length;f++)this.boxes[f].write();return y.buffer},I.prototype.append=function(d,f){e.Utils.appendBox(this,d,f)};var g=function(){this._cursor=new e.Cursor};g.parse=function(d){var f=new g;return f._offset=d._cursor.offset,f._root=d._root?d._root:d,f._raw=d._raw,f._parent=d,f._parseBox(),d._cursor.offset=f._raw.byteOffset+f._raw.byteLength,f},g.create=function(d){var f=new g;return f.type=d,f.boxes=[],f},g.prototype._boxContainers=["dinf","edts","mdia","meco","mfra","minf","moof","moov","mvex","stbl","strk","traf","trak","tref","udta","vttc","sinf","schi","encv","enca"],g.prototype._boxProcessors={},g.prototype._procField=function(d,f,y){this._parsing?this[d]=this._readField(f,y):this._writeField(f,y,this[d])},g.prototype._procFieldArray=function(d,f,y,_){var r;if(this._parsing)for(this[d]=[],r=0;r<f;r++)this[d][r]=this._readField(y,_);else for(r=0;r<this[d].length;r++)this._writeField(y,_,this[d][r])},g.prototype._procFullBox=function(){this._procField("version","uint",8),this._procField("flags","uint",24)},g.prototype._procEntries=function(d,f,y){var _;if(this._parsing)for(this[d]=[],_=0;_<f;_++)this[d].push({}),y.call(this,this[d][_]);else for(_=0;_<f;_++)y.call(this,this[d][_])},g.prototype._procSubEntries=function(d,f,y,_){var r;if(this._parsing)for(d[f]=[],r=0;r<y;r++)d[f].push({}),_.call(this,d[f][r]);else for(r=0;r<y;r++)_.call(this,d[f][r])},g.prototype._procEntryField=function(d,f,y,_){this._parsing?d[f]=this._readField(y,_):this._writeField(y,_,d[f])},g.prototype._procSubBoxes=function(d,f){var y;if(this._parsing)for(this[d]=[],y=0;y<f;y++)this[d].push(g.parse(this));else for(y=0;y<f;y++)this._rawo?this[d][y].write():this.size+=this[d][y].getLength()},g.prototype._readField=function(d,f){switch(d){case"uint":return this._readUint(f);case"int":return this._readInt(f);case"template":return this._readTemplate(f);case"string":return f===-1?this._readTerminatedString():this._readString(f);case"data":return this._readData(f);case"utf8":return this._readUTF8String();default:return-1}},g.prototype._readInt=function(d){var f=null,y=this._cursor.offset-this._raw.byteOffset;switch(d){case 8:f=this._raw.getInt8(y);break;case 16:f=this._raw.getInt16(y);break;case 32:f=this._raw.getInt32(y);break;case 64:var _=this._raw.getInt32(y),r=this._raw.getInt32(y+4);f=_*Math.pow(2,32)+r;break}return this._cursor.offset+=d>>3,f},g.prototype._readUint=function(d){var f=null,y=this._cursor.offset-this._raw.byteOffset,_,r;switch(d){case 8:f=this._raw.getUint8(y);break;case 16:f=this._raw.getUint16(y);break;case 24:_=this._raw.getUint16(y),r=this._raw.getUint8(y+2),f=(_<<8)+r;break;case 32:f=this._raw.getUint32(y);break;case 64:_=this._raw.getUint32(y),r=this._raw.getUint32(y+4),f=_*Math.pow(2,32)+r;break}return this._cursor.offset+=d>>3,f},g.prototype._readString=function(d){for(var f="",y=0;y<d;y++){var _=this._readUint(8);f+=String.fromCharCode(_)}return f},g.prototype._readTemplate=function(d){var f=this._readUint(d/2),y=this._readUint(d/2);return f+y/Math.pow(2,d/2)},g.prototype._readTerminatedString=function(){for(var d="";this._cursor.offset-this._offset<this._raw.byteLength;){var f=this._readUint(8);if(f===0)break;d+=String.fromCharCode(f)}return d},g.prototype._readData=function(d){var f=d>0?d:this._raw.byteLength-(this._cursor.offset-this._offset);if(f>0){var y=new Uint8Array(this._raw.buffer,this._cursor.offset,f);return this._cursor.offset+=f,y}else return null},g.prototype._readUTF8String=function(){var d=this._raw.byteLength-(this._cursor.offset-this._offset),f=null;return d>0&&(f=new DataView(this._raw.buffer,this._cursor.offset,d),this._cursor.offset+=d),f&&e.Utils.dataViewToString(f)},g.prototype._parseBox=function(){if(this._parsing=!0,this._cursor.offset=this._offset,this._offset+8>this._raw.buffer.byteLength){this._root._incomplete=!0;return}switch(this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this.size){case 0:this._raw=new DataView(this._raw.buffer,this._offset,this._raw.byteLength-this._cursor.offset+8);break;case 1:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.largesize);break;default:this._offset+this.size>this._raw.buffer.byteLength?(this._incomplete=!0,this._root._incomplete=!0):this._raw=new DataView(this._raw.buffer,this._offset,this.size)}this._incomplete||(this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1?this._parseContainerBox():this._data=this._readData())},g.prototype._parseFullBox=function(){this.version=this._readUint(8),this.flags=this._readUint(24)},g.prototype._parseContainerBox=function(){for(this.boxes=[];this._cursor.offset-this._raw.byteOffset<this._raw.byteLength;)this.boxes.push(g.parse(this))},g.prototype.append=function(d,f){e.Utils.appendBox(this,d,f)},g.prototype.getLength=function(){if(this._parsing=!1,this._rawo=null,this.size=0,this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1)for(var d=0;d<this.boxes.length;d++)this.size+=this.boxes[d].getLength();return this._data&&this._writeData(this._data),this.size},g.prototype.write=function(){switch(this._parsing=!1,this._cursor.offset=this._parent._cursor.offset,this.size){case 0:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.parent._rawo.byteLength-this._cursor.offset);break;case 1:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.largesize);break;default:this._rawo=new DataView(this._parent._rawo.buffer,this._cursor.offset,this.size)}if(this._procField("size","uint",32),this._procField("type","string",4),this.size===1&&this._procField("largesize","uint",64),this.type==="uuid"&&this._procFieldArray("usertype",16,"uint",8),this._boxProcessors[this.type]&&this._boxProcessors[this.type].call(this),this._boxContainers.indexOf(this.type)!==-1)for(var d=0;d<this.boxes.length;d++)this.boxes[d].write();return this._data&&this._writeData(this._data),this._parent._cursor.offset+=this.size,this.size},g.prototype._writeInt=function(d,f){if(this._rawo){var y=this._cursor.offset-this._rawo.byteOffset;switch(d){case 8:this._rawo.setInt8(y,f);break;case 16:this._rawo.setInt16(y,f);break;case 32:this._rawo.setInt32(y,f);break;case 64:var _=Math.floor(f/Math.pow(2,32)),r=f-_*Math.pow(2,32);this._rawo.setUint32(y,_),this._rawo.setUint32(y+4,r);break}this._cursor.offset+=d>>3}else this.size+=d>>3},g.prototype._writeUint=function(d,f){if(this._rawo){var y=this._cursor.offset-this._rawo.byteOffset,_,r;switch(d){case 8:this._rawo.setUint8(y,f);break;case 16:this._rawo.setUint16(y,f);break;case 24:_=(f&16776960)>>8,r=f&255,this._rawo.setUint16(y,_),this._rawo.setUint8(y+2,r);break;case 32:this._rawo.setUint32(y,f);break;case 64:_=Math.floor(f/Math.pow(2,32)),r=f-_*Math.pow(2,32),this._rawo.setUint32(y,_),this._rawo.setUint32(y+4,r);break}this._cursor.offset+=d>>3}else this.size+=d>>3},g.prototype._writeString=function(d,f){for(var y=0;y<d;y++)this._writeUint(8,f.charCodeAt(y))},g.prototype._writeTerminatedString=function(d){if(d.length!==0){for(var f=0;f<d.length;f++)this._writeUint(8,d.charCodeAt(f));this._writeUint(8,0)}},g.prototype._writeTemplate=function(d,f){var y=Math.floor(f),_=(f-y)*Math.pow(2,d/2);this._writeUint(d/2,y),this._writeUint(d/2,_)},g.prototype._writeData=function(d){var f;if(d)if(this._rawo){if(d instanceof Array){for(var y=this._cursor.offset-this._rawo.byteOffset,f=0;f<d.length;f++)this._rawo.setInt8(y+f,d[f]);this._cursor.offset+=d.length}d instanceof Uint8Array&&(this._root.bytes.set(d,this._cursor.offset),this._cursor.offset+=d.length)}else this.size+=d.length},g.prototype._writeUTF8String=function(d){var f=e.Utils.utf8ToByteArray(d);if(this._rawo)for(var y=new DataView(this._rawo.buffer,this._cursor.offset,f.length),_=0;_<f.length;_++)y.setUint8(_,f[_]);else this.size+=f.length},g.prototype._writeField=function(d,f,y){switch(d){case"uint":this._writeUint(f,y);break;case"int":this._writeInt(f,y);break;case"template":this._writeTemplate(f,y);break;case"string":f==-1?this._writeTerminatedString(y):this._writeString(f,y);break;case"data":this._writeData(y);break;case"utf8":this._writeUTF8String(y);break}},g.prototype._boxProcessors.avc1=g.prototype._boxProcessors.encv=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procField("pre_defined1","uint",16),this._procField("reserved2","uint",16),this._procFieldArray("pre_defined2",3,"uint",32),this._procField("width","uint",16),this._procField("height","uint",16),this._procField("horizresolution","template",32),this._procField("vertresolution","template",32),this._procField("reserved3","uint",32),this._procField("frame_count","uint",16),this._procFieldArray("compressorname",32,"uint",8),this._procField("depth","uint",16),this._procField("pre_defined3","int",16),this._procField("config","data",-1)},g.prototype._boxProcessors.dref=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},g.prototype._boxProcessors.elst=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(d){this._procEntryField(d,"segment_duration","uint",this.version===1?64:32),this._procEntryField(d,"media_time","int",this.version===1?64:32),this._procEntryField(d,"media_rate_integer","int",16),this._procEntryField(d,"media_rate_fraction","int",16)})},g.prototype._boxProcessors.emsg=function(){this._procFullBox(),this.version==1?(this._procField("timescale","uint",32),this._procField("presentation_time","uint",64),this._procField("event_duration","uint",32),this._procField("id","uint",32),this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1)):(this._procField("scheme_id_uri","string",-1),this._procField("value","string",-1),this._procField("timescale","uint",32),this._procField("presentation_time_delta","uint",32),this._procField("event_duration","uint",32),this._procField("id","uint",32)),this._procField("message_data","data",-1)},g.prototype._boxProcessors.free=g.prototype._boxProcessors.skip=function(){this._procField("data","data",-1)},g.prototype._boxProcessors.frma=function(){this._procField("data_format","uint",32)},g.prototype._boxProcessors.ftyp=g.prototype._boxProcessors.styp=function(){this._procField("major_brand","string",4),this._procField("minor_version","uint",32);var d=-1;this._parsing&&(d=(this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset))/4),this._procFieldArray("compatible_brands",d,"string",4)},g.prototype._boxProcessors.hdlr=function(){this._procFullBox(),this._procField("pre_defined","uint",32),this._procField("handler_type","string",4),this._procFieldArray("reserved",3,"uint",32),this._procField("name","string",-1)},g.prototype._boxProcessors.mdat=function(){this._procField("data","data",-1)},g.prototype._boxProcessors.mdhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",this.version==1?64:32),!this._parsing&&typeof this.language=="string"&&(this.language=this.language.charCodeAt(0)-96<<10|this.language.charCodeAt(1)-96<<5|this.language.charCodeAt(2)-96),this._procField("language","uint",16),this._parsing&&(this.language=String.fromCharCode((this.language>>10&31)+96,(this.language>>5&31)+96,(this.language&31)+96)),this._procField("pre_defined","uint",16)},g.prototype._boxProcessors.mehd=function(){this._procFullBox(),this._procField("fragment_duration","uint",this.version==1?64:32)},g.prototype._boxProcessors.mfhd=function(){this._procFullBox(),this._procField("sequence_number","uint",32)},g.prototype._boxProcessors.mfro=function(){this._procFullBox(),this._procField("mfra_size","uint",32)},g.prototype._boxProcessors.mp4a=g.prototype._boxProcessors.enca=function(){this._procFieldArray("reserved1",6,"uint",8),this._procField("data_reference_index","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procField("channelcount","uint",16),this._procField("samplesize","uint",16),this._procField("pre_defined","uint",16),this._procField("reserved3","uint",16),this._procField("samplerate","template",32),this._procField("esds","data",-1)},g.prototype._boxProcessors.mvhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("timescale","uint",32),this._procField("duration","uint",this.version==1?64:32),this._procField("rate","template",32),this._procField("volume","template",16),this._procField("reserved1","uint",16),this._procFieldArray("reserved2",2,"uint",32),this._procFieldArray("matrix",9,"template",32),this._procFieldArray("pre_defined",6,"uint",32),this._procField("next_track_ID","uint",32)},g.prototype._boxProcessors.payl=function(){this._procField("cue_text","utf8")},g.prototype._boxProcessors.pssh=function(){this._procFullBox(),this._procFieldArray("SystemID",16,"uint",8),this._procField("DataSize","uint",32),this._procFieldArray("Data",this.DataSize,"uint",8)},g.prototype._boxProcessors.schm=function(){this._procFullBox(),this._procField("scheme_type","uint",32),this._procField("scheme_version","uint",32),this.flags&1&&this._procField("scheme_uri","string",-1)},g.prototype._boxProcessors.sdtp=function(){this._procFullBox();var d=-1;this._parsing&&(d=this._raw.byteLength-(this._cursor.offset-this._raw.byteOffset)),this._procFieldArray("sample_dependency_table",d,"uint",8)},g.prototype._boxProcessors.sidx=function(){this._procFullBox(),this._procField("reference_ID","uint",32),this._procField("timescale","uint",32),this._procField("earliest_presentation_time","uint",this.version==1?64:32),this._procField("first_offset","uint",this.version==1?64:32),this._procField("reserved","uint",16),this._procField("reference_count","uint",16),this._procEntries("references",this.reference_count,function(d){this._parsing||(d.reference=(d.reference_type&1)<<31,d.reference|=d.referenced_size&2147483647,d.sap=(d.starts_with_SAP&1)<<31,d.sap|=(d.SAP_type&3)<<28,d.sap|=d.SAP_delta_time&268435455),this._procEntryField(d,"reference","uint",32),this._procEntryField(d,"subsegment_duration","uint",32),this._procEntryField(d,"sap","uint",32),this._parsing&&(d.reference_type=d.reference>>31&1,d.referenced_size=d.reference&2147483647,d.starts_with_SAP=d.sap>>31&1,d.SAP_type=d.sap>>28&7,d.SAP_delta_time=d.sap&268435455)})},g.prototype._boxProcessors.smhd=function(){this._procFullBox(),this._procField("balance","uint",16),this._procField("reserved","uint",16)},g.prototype._boxProcessors.ssix=function(){this._procFullBox(),this._procField("subsegment_count","uint",32),this._procEntries("subsegments",this.subsegment_count,function(d){this._procEntryField(d,"ranges_count","uint",32),this._procSubEntries(d,"ranges",d.ranges_count,function(f){this._procEntryField(f,"level","uint",8),this._procEntryField(f,"range_size","uint",24)})})},g.prototype._boxProcessors.stsd=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procSubBoxes("entries",this.entry_count)},g.prototype._boxProcessors.subs=function(){this._procFullBox(),this._procField("entry_count","uint",32),this._procEntries("entries",this.entry_count,function(d){this._procEntryField(d,"sample_delta","uint",32),this._procEntryField(d,"subsample_count","uint",16),this._procSubEntries(d,"subsamples",d.subsample_count,function(f){this._procEntryField(f,"subsample_size","uint",this.version===1?32:16),this._procEntryField(f,"subsample_priority","uint",8),this._procEntryField(f,"discardable","uint",8),this._procEntryField(f,"codec_specific_parameters","uint",32)})})},g.prototype._boxProcessors.tenc=function(){this._procFullBox(),this._procField("default_IsEncrypted","uint",24),this._procField("default_IV_size","uint",8),this._procFieldArray("default_KID",16,"uint",8)},g.prototype._boxProcessors.tfdt=function(){this._procFullBox(),this._procField("baseMediaDecodeTime","uint",this.version==1?64:32)},g.prototype._boxProcessors.tfhd=function(){this._procFullBox(),this._procField("track_ID","uint",32),this.flags&1&&this._procField("base_data_offset","uint",64),this.flags&2&&this._procField("sample_description_offset","uint",32),this.flags&8&&this._procField("default_sample_duration","uint",32),this.flags&16&&this._procField("default_sample_size","uint",32),this.flags&32&&this._procField("default_sample_flags","uint",32)},g.prototype._boxProcessors.tfra=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._parsing||(this.reserved=0,this.reserved|=(this.length_size_of_traf_num&48)<<4,this.reserved|=(this.length_size_of_trun_num&12)<<2,this.reserved|=this.length_size_of_sample_num&3),this._procField("reserved","uint",32),this._parsing&&(this.length_size_of_traf_num=(this.reserved&48)>>4,this.length_size_of_trun_num=(this.reserved&12)>>2,this.length_size_of_sample_num=this.reserved&3),this._procField("number_of_entry","uint",32),this._procEntries("entries",this.number_of_entry,function(d){this._procEntryField(d,"time","uint",this.version===1?64:32),this._procEntryField(d,"moof_offset","uint",this.version===1?64:32),this._procEntryField(d,"traf_number","uint",(this.length_size_of_traf_num+1)*8),this._procEntryField(d,"trun_number","uint",(this.length_size_of_trun_num+1)*8),this._procEntryField(d,"sample_number","uint",(this.length_size_of_sample_num+1)*8)})},g.prototype._boxProcessors.tkhd=function(){this._procFullBox(),this._procField("creation_time","uint",this.version==1?64:32),this._procField("modification_time","uint",this.version==1?64:32),this._procField("track_ID","uint",32),this._procField("reserved1","uint",32),this._procField("duration","uint",this.version==1?64:32),this._procFieldArray("reserved2",2,"uint",32),this._procField("layer","uint",16),this._procField("alternate_group","uint",16),this._procField("volume","template",16),this._procField("reserved3","uint",16),this._procFieldArray("matrix",9,"template",32),this._procField("width","template",32),this._procField("height","template",32)},g.prototype._boxProcessors.trex=function(){this._procFullBox(),this._procField("track_ID","uint",32),this._procField("default_sample_description_index","uint",32),this._procField("default_sample_duration","uint",32),this._procField("default_sample_size","uint",32),this._procField("default_sample_flags","uint",32)},g.prototype._boxProcessors.trun=function(){this._procFullBox(),this._procField("sample_count","uint",32),this.flags&1&&this._procField("data_offset","int",32),this.flags&4&&this._procField("first_sample_flags","uint",32),this._procEntries("samples",this.sample_count,function(d){this.flags&256&&this._procEntryField(d,"sample_duration","uint",32),this.flags&512&&this._procEntryField(d,"sample_size","uint",32),this.flags&1024&&this._procEntryField(d,"sample_flags","uint",32),this.flags&2048&&this._procEntryField(d,"sample_composition_time_offset",this.version===1?"int":"uint",32)})},g.prototype._boxProcessors["url "]=g.prototype._boxProcessors["urn "]=function(){this._procFullBox(),this.type==="urn "&&this._procField("name","string",-1),this._procField("location","string",-1)},g.prototype._boxProcessors.vlab=function(){this._procField("source_label","utf8")},g.prototype._boxProcessors.vmhd=function(){this._procFullBox(),this._procField("graphicsmode","uint",16),this._procFieldArray("opcolor",3,"uint",16)},g.prototype._boxProcessors.vttC=function(){this._procField("config","utf8")},g.prototype._boxProcessors.vtte=function(){}},"./node_modules/es6-promise/auto.js":(ce,N,e)=>{ce.exports=e("./node_modules/es6-promise/dist/es6-promise.js").polyfill()},"./node_modules/es6-promise/dist/es6-promise.js":function(ce,N,e){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */(function(I,g){ce.exports=g()})(this,function(){function I(G){var fe=typeof G;return G!==null&&(fe==="object"||fe==="function")}function g(G){return typeof G=="function"}var d=void 0;Array.isArray?d=Array.isArray:d=function(G){return Object.prototype.toString.call(G)==="[object Array]"};var f=d,y=0,_=void 0,r=void 0,T=function(fe,le){l[y]=fe,l[y+1]=le,y+=2,y===2&&(r?r(A):L())};function M(G){r=G}function p(G){T=G}var C=typeof window<"u"?window:void 0,v=C||{},E=v.MutationObserver||v.WebKitMutationObserver,i=typeof self>"u"&&typeof process<"u"&&{}.toString.call(process)==="[object process]",t=typeof Uint8ClampedArray<"u"&&typeof importScripts<"u"&&typeof MessageChannel<"u";function m(){return function(){return process.nextTick(A)}}function n(){return typeof _<"u"?function(){_(A)}:o()}function h(){var G=0,fe=new E(A),le=document.createTextNode("");return fe.observe(le,{characterData:!0}),function(){le.data=G=++G%2}}function c(){var G=new MessageChannel;return G.port1.onmessage=A,function(){return G.port2.postMessage(0)}}function o(){var G=setTimeout;return function(){return G(A,1)}}var l=new Array(1e3);function A(){for(var G=0;G<y;G+=2){var fe=l[G],le=l[G+1];fe(le),l[G]=void 0,l[G+1]=void 0}y=0}function S(){try{var G=Function("return this")().require("vertx");return _=G.runOnLoop||G.runOnContext,n()}catch{return o()}}var L=void 0;i?L=m():E?L=h():t?L=c():C===void 0?L=S():L=o();function U(G,fe){var le=this,_e=new this.constructor(W);_e[X]===void 0&&u(_e);var Me=le._state;if(Me){var Oe=arguments[Me-1];T(function(){return V(Me,_e,Oe,le._result)})}else Z(le,_e,G,fe);return _e}function k(G){var fe=this;if(G&&typeof G=="object"&&G.constructor===fe)return G;var le=new fe(W);return ee(le,G),le}var X=Math.random().toString(36).substring(2);function W(){}var b=void 0,j=1,Q=2;function q(){return new TypeError("You cannot resolve a promise with itself")}function Y(){return new TypeError("A promises callback cannot return that same promise.")}function J(G,fe,le,_e){try{G.call(fe,le,_e)}catch(Me){return Me}}function $(G,fe,le){T(function(_e){var Me=!1,Oe=J(le,fe,function(Ne){Me||(Me=!0,fe!==Ne?ee(_e,Ne):ue(_e,Ne))},function(Ne){Me||(Me=!0,oe(_e,Ne))},"Settle: "+(_e._label||" unknown promise"));!Me&&Oe&&(Me=!0,oe(_e,Oe))},G)}function ae(G,fe){fe._state===j?ue(G,fe._result):fe._state===Q?oe(G,fe._result):Z(fe,void 0,function(le){return ee(G,le)},function(le){return oe(G,le)})}function K(G,fe,le){fe.constructor===G.constructor&&le===U&&fe.constructor.resolve===k?ae(G,fe):le===void 0?ue(G,fe):g(le)?$(G,fe,le):ue(G,fe)}function ee(G,fe){if(G===fe)oe(G,q());else if(I(fe)){var le=void 0;try{le=fe.then}catch(_e){oe(G,_e);return}K(G,fe,le)}else ue(G,fe)}function se(G){G._onerror&&G._onerror(G._result),H(G)}function ue(G,fe){G._state===b&&(G._result=fe,G._state=j,G._subscribers.length!==0&&T(H,G))}function oe(G,fe){G._state===b&&(G._state=Q,G._result=fe,T(se,G))}function Z(G,fe,le,_e){var Me=G._subscribers,Oe=Me.length;G._onerror=null,Me[Oe]=fe,Me[Oe+j]=le,Me[Oe+Q]=_e,Oe===0&&G._state&&T(H,G)}function H(G){var fe=G._subscribers,le=G._state;if(fe.length!==0){for(var _e=void 0,Me=void 0,Oe=G._result,Ne=0;Ne<fe.length;Ne+=3)_e=fe[Ne],Me=fe[Ne+le],_e?V(le,_e,Me,Oe):Me(Oe);G._subscribers.length=0}}function V(G,fe,le,_e){var Me=g(le),Oe=void 0,Ne=void 0,xe=!0;if(Me){try{Oe=le(_e)}catch(Se){xe=!1,Ne=Se}if(fe===Oe){oe(fe,Y());return}}else Oe=_e;fe._state!==b||(Me&&xe?ee(fe,Oe):xe===!1?oe(fe,Ne):G===j?ue(fe,Oe):G===Q&&oe(fe,Oe))}function te(G,fe){try{fe(function(_e){ee(G,_e)},function(_e){oe(G,_e)})}catch(le){oe(G,le)}}var z=0;function R(){return z++}function u(G){G[X]=z++,G._state=void 0,G._result=void 0,G._subscribers=[]}function D(){return new Error("Array Methods must be provided an Array")}var F=function(){function G(fe,le){this._instanceConstructor=fe,this.promise=new fe(W),this.promise[X]||u(this.promise),f(le)?(this.length=le.length,this._remaining=le.length,this._result=new Array(this.length),this.length===0?ue(this.promise,this._result):(this.length=this.length||0,this._enumerate(le),this._remaining===0&&ue(this.promise,this._result))):oe(this.promise,D())}return G.prototype._enumerate=function(le){for(var _e=0;this._state===b&&_e<le.length;_e++)this._eachEntry(le[_e],_e)},G.prototype._eachEntry=function(le,_e){var Me=this._instanceConstructor,Oe=Me.resolve;if(Oe===k){var Ne=void 0,xe=void 0,Se=!1;try{Ne=le.then}catch(Ae){Se=!0,xe=Ae}if(Ne===U&&le._state!==b)this._settledAt(le._state,_e,le._result);else if(typeof Ne!="function")this._remaining--,this._result[_e]=le;else if(Me===ne){var me=new Me(W);Se?oe(me,xe):K(me,le,Ne),this._willSettleAt(me,_e)}else this._willSettleAt(new Me(function(Ae){return Ae(le)}),_e)}else this._willSettleAt(Oe(le),_e)},G.prototype._settledAt=function(le,_e,Me){var Oe=this.promise;Oe._state===b&&(this._remaining--,le===Q?oe(Oe,Me):this._result[_e]=Me),this._remaining===0&&ue(Oe,this._result)},G.prototype._willSettleAt=function(le,_e){var Me=this;Z(le,void 0,function(Oe){return Me._settledAt(j,_e,Oe)},function(Oe){return Me._settledAt(Q,_e,Oe)})},G}();function w(G){return new F(this,G).promise}function O(G){var fe=this;return f(G)?new fe(function(le,_e){for(var Me=G.length,Oe=0;Oe<Me;Oe++)fe.resolve(G[Oe]).then(le,_e)}):new fe(function(le,_e){return _e(new TypeError("You must pass an array to race."))})}function P(G){var fe=this,le=new fe(W);return oe(le,G),le}function B(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function x(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}var ne=function(){function G(fe){this[X]=R(),this._result=this._state=void 0,this._subscribers=[],W!==fe&&(typeof fe!="function"&&B(),this instanceof G?te(this,fe):x())}return G.prototype.catch=function(le){return this.then(null,le)},G.prototype.finally=function(le){var _e=this,Me=_e.constructor;return g(le)?_e.then(function(Oe){return Me.resolve(le()).then(function(){return Oe})},function(Oe){return Me.resolve(le()).then(function(){throw Oe})}):_e.then(le,le)},G}();ne.prototype.then=U,ne.all=w,ne.race=O,ne.resolve=k,ne.reject=P,ne._setScheduler=M,ne._setAsap=p,ne._asap=T;function re(){var G=void 0;if(typeof e.g<"u")G=e.g;else if(typeof self<"u")G=self;else try{G=Function("return this")()}catch{throw new Error("polyfill failed because global object is unavailable in this environment")}var fe=G.Promise;if(fe){var le=null;try{le=Object.prototype.toString.call(fe.resolve())}catch{}if(le==="[object Promise]"&&!fe.cast)return}G.Promise=ne}return ne.polyfill=re,ne.Promise=ne,ne})},"./node_modules/events/events.js":ce=>{var N=typeof Reflect=="object"?Reflect:null,e=N&&typeof N.apply=="function"?N.apply:function(o,l,A){return Function.prototype.apply.call(o,l,A)},I;N&&typeof N.ownKeys=="function"?I=N.ownKeys:Object.getOwnPropertySymbols?I=function(o){return Object.getOwnPropertyNames(o).concat(Object.getOwnPropertySymbols(o))}:I=function(o){return Object.getOwnPropertyNames(o)};function g(c){console&&console.warn&&console.warn(c)}var d=Number.isNaN||function(o){return o!==o};function f(){f.init.call(this)}ce.exports=f,ce.exports.once=m,f.EventEmitter=f,f.prototype._events=void 0,f.prototype._eventsCount=0,f.prototype._maxListeners=void 0;var y=10;function _(c){if(typeof c!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof c)}Object.defineProperty(f,"defaultMaxListeners",{enumerable:!0,get:function(){return y},set:function(c){if(typeof c!="number"||c<0||d(c))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+c+".");y=c}}),f.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},f.prototype.setMaxListeners=function(o){if(typeof o!="number"||o<0||d(o))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+o+".");return this._maxListeners=o,this};function r(c){return c._maxListeners===void 0?f.defaultMaxListeners:c._maxListeners}f.prototype.getMaxListeners=function(){return r(this)},f.prototype.emit=function(o){for(var l=[],A=1;A<arguments.length;A++)l.push(arguments[A]);var S=o==="error",L=this._events;if(L!==void 0)S=S&&L.error===void 0;else if(!S)return!1;if(S){var U;if(l.length>0&&(U=l[0]),U instanceof Error)throw U;var k=new Error("Unhandled error."+(U?" ("+U.message+")":""));throw k.context=U,k}var X=L[o];if(X===void 0)return!1;if(typeof X=="function")e(X,this,l);else for(var W=X.length,b=E(X,W),A=0;A<W;++A)e(b[A],this,l);return!0};function T(c,o,l,A){var S,L,U;if(_(l),L=c._events,L===void 0?(L=c._events=Object.create(null),c._eventsCount=0):(L.newListener!==void 0&&(c.emit("newListener",o,l.listener?l.listener:l),L=c._events),U=L[o]),U===void 0)U=L[o]=l,++c._eventsCount;else if(typeof U=="function"?U=L[o]=A?[l,U]:[U,l]:A?U.unshift(l):U.push(l),S=r(c),S>0&&U.length>S&&!U.warned){U.warned=!0;var k=new Error("Possible EventEmitter memory leak detected. "+U.length+" "+String(o)+" listeners added. Use emitter.setMaxListeners() to increase limit");k.name="MaxListenersExceededWarning",k.emitter=c,k.type=o,k.count=U.length,g(k)}return c}f.prototype.addListener=function(o,l){return T(this,o,l,!1)},f.prototype.on=f.prototype.addListener,f.prototype.prependListener=function(o,l){return T(this,o,l,!0)};function M(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function p(c,o,l){var A={fired:!1,wrapFn:void 0,target:c,type:o,listener:l},S=M.bind(A);return S.listener=l,A.wrapFn=S,S}f.prototype.once=function(o,l){return _(l),this.on(o,p(this,o,l)),this},f.prototype.prependOnceListener=function(o,l){return _(l),this.prependListener(o,p(this,o,l)),this},f.prototype.removeListener=function(o,l){var A,S,L,U,k;if(_(l),S=this._events,S===void 0)return this;if(A=S[o],A===void 0)return this;if(A===l||A.listener===l)--this._eventsCount===0?this._events=Object.create(null):(delete S[o],S.removeListener&&this.emit("removeListener",o,A.listener||l));else if(typeof A!="function"){for(L=-1,U=A.length-1;U>=0;U--)if(A[U]===l||A[U].listener===l){k=A[U].listener,L=U;break}if(L<0)return this;L===0?A.shift():i(A,L),A.length===1&&(S[o]=A[0]),S.removeListener!==void 0&&this.emit("removeListener",o,k||l)}return this},f.prototype.off=f.prototype.removeListener,f.prototype.removeAllListeners=function(o){var l,A,S;if(A=this._events,A===void 0)return this;if(A.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):A[o]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete A[o]),this;if(arguments.length===0){var L=Object.keys(A),U;for(S=0;S<L.length;++S)U=L[S],U!=="removeListener"&&this.removeAllListeners(U);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(l=A[o],typeof l=="function")this.removeListener(o,l);else if(l!==void 0)for(S=l.length-1;S>=0;S--)this.removeListener(o,l[S]);return this};function C(c,o,l){var A=c._events;if(A===void 0)return[];var S=A[o];return S===void 0?[]:typeof S=="function"?l?[S.listener||S]:[S]:l?t(S):E(S,S.length)}f.prototype.listeners=function(o){return C(this,o,!0)},f.prototype.rawListeners=function(o){return C(this,o,!1)},f.listenerCount=function(c,o){return typeof c.listenerCount=="function"?c.listenerCount(o):v.call(c,o)},f.prototype.listenerCount=v;function v(c){var o=this._events;if(o!==void 0){var l=o[c];if(typeof l=="function")return 1;if(l!==void 0)return l.length}return 0}f.prototype.eventNames=function(){return this._eventsCount>0?I(this._events):[]};function E(c,o){for(var l=new Array(o),A=0;A<o;++A)l[A]=c[A];return l}function i(c,o){for(;o+1<c.length;o++)c[o]=c[o+1];c.pop()}function t(c){for(var o=new Array(c.length),l=0;l<o.length;++l)o[l]=c[l].listener||c[l];return o}function m(c,o){return new Promise(function(l,A){function S(U){c.removeListener(o,L),A(U)}function L(){typeof c.removeListener=="function"&&c.removeListener("error",S),l([].slice.call(arguments))}h(c,o,L,{once:!0}),o!=="error"&&n(c,S,{once:!0})})}function n(c,o,l){typeof c.on=="function"&&h(c,"error",o,l)}function h(c,o,l,A){if(typeof c.on=="function")A.once?c.once(o,l):c.on(o,l);else if(typeof c.addEventListener=="function")c.addEventListener(o,function S(L){A.once&&c.removeEventListener(o,S),l(L)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof c)}},"./node_modules/fast-deep-equal/index.js":ce=>{var N=Array.isArray,e=Object.keys,I=Object.prototype.hasOwnProperty;ce.exports=function g(d,f){if(d===f)return!0;if(d&&f&&typeof d=="object"&&typeof f=="object"){var y=N(d),_=N(f),r,T,M;if(y&&_){if(T=d.length,T!=f.length)return!1;for(r=T;r--!==0;)if(!g(d[r],f[r]))return!1;return!0}if(y!=_)return!1;var p=d instanceof Date,C=f instanceof Date;if(p!=C)return!1;if(p&&C)return d.getTime()==f.getTime();var v=d instanceof RegExp,E=f instanceof RegExp;if(v!=E)return!1;if(v&&E)return d.toString()==f.toString();var i=e(d);if(T=i.length,T!==e(f).length)return!1;for(r=T;r--!==0;)if(!I.call(f,i[r]))return!1;for(r=T;r--!==0;)if(M=i[r],!g(d[M],f[M]))return!1;return!0}return d!==d&&f!==f}},"./node_modules/imsc/src/main/js/doc.js":(ce,N,e)=>{(function(I,g,d,f,y){I.fromXML=function(R,u,D){var F=g.parser(!0,{xmlns:!0}),w=[],O=[],P=[],B=0,x=null;F.onclosetag=function(le){if(w[0]instanceof p)for(var _e in w[0].styles)ue(w[0],w[0].styles[_e],u);else if(w[0]instanceof A||w[0]instanceof S){if(w[0].contents.length>1){var Me=[w[0].contents[0]],Oe;for(Oe=1;Oe<w[0].contents.length;Oe++)w[0].contents[Oe]instanceof L&&Me[Me.length-1]instanceof L?Me[Me.length-1].text+=w[0].contents[Oe].text:Me.push(w[0].contents[Oe]);w[0].contents=Me}w[0]instanceof S&&w[0].contents.length===1&&w[0].contents[0]instanceof L&&(w[0].text=w[0].contents[0].text,delete w[0].contents)}else w[0]instanceof r&&(w[0].node.uri===d.ns_tt&&w[0].node.local==="metadata"?B--:B>0&&D&&"onCloseTag"in D&&D.onCloseTag());P.shift(),O.shift(),w.shift()},F.ontext=function(le){if(w[0]!==void 0)if(w[0]instanceof S||w[0]instanceof A){var _e=new L;_e.initFromText(x,w[0],le,P[0],u),w[0].contents.push(_e)}else w[0]instanceof r&&B>0&&D&&"onText"in D&&D.onText(le)},F.onopentag=function(le){var _e=le.attributes["xml:space"];_e?P.unshift(_e.value):P.length===0?P.unshift("default"):P.unshift(P[0]);var Me=le.attributes["xml:lang"];if(Me?O.unshift(Me.value):O.length===0?O.unshift(""):O.unshift(O[0]),le.uri===d.ns_tt)if(le.local==="tt")x!==null&&te(u,"Two <tt> elements at ("+this.line+","+this.column+")"),x=new T,x.initFromNode(le,u),w.unshift(x);else if(le.local==="head")w[0]instanceof T||te(u,"Parent of <head> element is not <tt> at ("+this.line+","+this.column+")"),x.head!==null&&te("Second <head> element at ("+this.line+","+this.column+")"),x.head=new M,w.unshift(x.head);else if(le.local==="styling")w[0]instanceof M||te(u,"Parent of <styling> element is not <head> at ("+this.line+","+this.column+")"),x.head.styling!==null&&te("Second <styling> element at ("+this.line+","+this.column+")"),x.head.styling=new p,w.unshift(x.head.styling);else if(le.local==="style"){var Oe;w[0]instanceof p?(Oe=new C,Oe.initFromNode(le,u),Oe.id?x.head.styling.styles[Oe.id]=Oe:V(u,"<style> element missing @id attribute"),w.unshift(Oe)):w[0]instanceof k?(Oe=new C,Oe.initFromNode(le,u),Z(Oe.styleAttrs,w[0].styleAttrs),w.unshift(Oe)):te(u,"Parent of <style> element is not <styling> or <region> at ("+this.line+","+this.column+")")}else if(le.local==="layout")w[0]instanceof M||te(u,"Parent of <layout> element is not <head> at "+this.line+","+this.column+")"),x.head.layout!==null&&te(u,"Second <layout> element at "+this.line+","+this.column+")"),x.head.layout=new v,w.unshift(x.head.layout);else if(le.local==="region"){w[0]instanceof v||te(u,"Parent of <region> element is not <layout> at "+this.line+","+this.column+")");var Ne=new k;Ne.initFromNode(x,le,u),!Ne.id||Ne.id in x.head.layout.regions?V(u,"Ignoring <region> with duplicate or missing @id at "+this.line+","+this.column+")"):x.head.layout.regions[Ne.id]=Ne,w.unshift(Ne)}else if(le.local==="body"){w[0]instanceof T||te(u,"Parent of <body> element is not <tt> at "+this.line+","+this.column+")"),x.body!==null&&te(u,"Second <body> element at "+this.line+","+this.column+")");var xe=new o;xe.initFromNode(x,le,u),x.body=xe,w.unshift(xe)}else if(le.local==="div"){w[0]instanceof l||w[0]instanceof o||te(u,"Parent of <div> element is not <body> or <div> at "+this.line+","+this.column+")");var Se=new l;Se.initFromNode(x,w[0],le,u),w[0].contents.push(Se),w.unshift(Se)}else if(le.local==="p"){w[0]instanceof l||te(u,"Parent of <p> element is not <div> at "+this.line+","+this.column+")");var me=new A;me.initFromNode(x,w[0],le,u),w[0].contents.push(me),w.unshift(me)}else if(le.local==="span"){w[0]instanceof S||w[0]instanceof A||te(u,"Parent of <span> element is not <span> or <p> at "+this.line+","+this.column+")");var Ae=new S;Ae.initFromNode(x,w[0],le,P[0],u),w[0].contents.push(Ae),w.unshift(Ae)}else if(le.local==="br"){w[0]instanceof S||w[0]instanceof A||te(u,"Parent of <br> element is not <span> or <p> at "+this.line+","+this.column+")");var He=new U;He.initFromNode(x,w[0],le,u),w[0].contents.push(He),w.unshift(He)}else if(le.local==="set"){w[0]instanceof S||w[0]instanceof A||w[0]instanceof l||w[0]instanceof o||w[0]instanceof k||w[0]instanceof U||te(u,"Parent of <set> element is not a content element or a region at "+this.line+","+this.column+")");var Qe=new X;Qe.initFromNode(x,w[0],le,u),w[0].sets.push(Qe),w.unshift(Qe)}else w.unshift(new r(le));else w.unshift(new r(le));if(w[0]instanceof r){if(le.uri===d.ns_tt&&le.local==="metadata")B++;else if(B>0&&D&&"onOpenTag"in D){var Je=[];for(var ye in le.attributes)Je[le.attributes[ye].uri+" "+le.attributes[ye].local]={uri:le.attributes[ye].uri,local:le.attributes[ye].local,value:le.attributes[ye].value};D.onOpenTag(le.uri,le.local,Je)}}},F.write(R).close(),x.head!==null?delete x.head.styling:x.head=new M,x.head.layout===null&&(x.head.layout=new v);var ne=!1;for(var re in x.head.layout.regions){ne=!0;break}if(!ne){var G=k.prototype.createDefaultRegion();x.head.layout.regions[G.id]=G}for(var fe in x.head.layout.regions)_(x,x.head.layout.regions[fe],null,null);return x.body&&_(x,x.body,null,null),x};function _(R,u,D,F){var w=F&&F.timeContainer==="seq",O=0;F&&(w&&D?O=D.end:O=F.begin),u.begin=u.explicit_begin?u.explicit_begin+O:O;var P=u.begin,B=null;for(var x in u.sets)_(R,u.sets[x],B,u),u.timeContainer==="seq"?P=u.sets[x].end:P=Math.max(P,u.sets[x].end),B=u.sets[x];if(!("contents"in u))w?P=u.begin:P=Number.POSITIVE_INFINITY;else for(var ne in u.contents)_(R,u.contents[ne],B,u),u.timeContainer==="seq"?P=u.contents[ne].end:P=Math.max(P,u.contents[ne].end),B=u.contents[ne];u.explicit_end!==null&&u.explicit_dur!==null?u.end=Math.min(u.begin+u.explicit_dur,O+u.explicit_end):u.explicit_end===null&&u.explicit_dur!==null?u.end=u.begin+u.explicit_dur:u.explicit_end!==null&&u.explicit_dur===null?u.end=O+u.explicit_end:u.end=P,delete u.explicit_begin,delete u.explicit_dur,delete u.explicit_end,R._registerEvent(u)}function r(R){this.node=R}function T(){this.events=[],this.head=null,this.body=null}T.prototype.initFromNode=function(R,u){this.cellResolution=$(R,u);var D=ae(R,u);this.effectiveFrameRate=D.effectiveFrameRate,this.tickRate=D.tickRate,this.aspectRatio=J(R,u);var F=Y(R,d.ns_ttp,"timeBase");F!==null&&F!=="media"&&te(u,"Unsupported time base");var w=K(R,u);w===null?this.pxDimensions={h:480,w:640}:((w.h.unit!=="px"||w.w.unit!=="px")&&te(u,"Extent on TT must be in px or absent"),this.pxDimensions={h:w.h.value,w:w.w.value})},T.prototype._registerEvent=function(R){if(!(R.end<=R.begin)){var u=z(this.events,R.begin);if(u.found||this.events.splice(u.index,0,R.begin),R.end!==Number.POSITIVE_INFINITY){var D=z(this.events,R.end);D.found||this.events.splice(D.index,0,R.end)}}},T.prototype.getMediaTimeRange=function(){return[this.events[0],this.events[this.events.length-1]]},T.prototype.getMediaTimeEvents=function(){return this.events};function M(){this.styling=null,this.layout=null}function p(){this.styles={}}function C(){this.id=null,this.styleAttrs=null,this.styleRefs=null}C.prototype.initFromNode=function(R,u){this.id=W(R),this.styleAttrs=q(R,u),this.styleRefs=Q(R)};function v(){this.regions={}}function E(R){this.kind=R}function i(R){this.id=R}i.prototype.initFromNode=function(R,u,D,F){this.id=W(D)};function t(R){this.regionID=R}t.prototype.initFromNode=function(R,u,D,F){this.regionID=b(D)};function m(R){this.styleAttrs=R}m.prototype.initFromNode=function(R,u,D,F){this.styleAttrs=q(D,F),R.head!==null&&R.head.styling!==null&&oe(R.head.styling,Q(D),this.styleAttrs,F)};function n(R){this.sets=R}n.prototype.initFromNode=function(R,u,D,F){this.sets=[]};function h(R){this.contents=R}h.prototype.initFromNode=function(R,u,D,F){this.contents=[]};function c(R,u,D){this.explicit_begin=R,this.explicit_end=u,this.explicit_dur=D}c.prototype.initFromNode=function(R,u,D,F){var w=se(R,u,D,F);this.explicit_begin=w.explicit_begin,this.explicit_end=w.explicit_end,this.explicit_dur=w.explicit_dur,this.timeContainer=j(D,F)};function o(){E.call(this,"body")}o.prototype.initFromNode=function(R,u,D){m.prototype.initFromNode.call(this,R,null,u,D),c.prototype.initFromNode.call(this,R,null,u,D),n.prototype.initFromNode.call(this,R,null,u,D),t.prototype.initFromNode.call(this,R,null,u,D),h.prototype.initFromNode.call(this,R,null,u,D)};function l(){E.call(this,"div")}l.prototype.initFromNode=function(R,u,D,F){m.prototype.initFromNode.call(this,R,u,D,F),c.prototype.initFromNode.call(this,R,u,D,F),n.prototype.initFromNode.call(this,R,u,D,F),t.prototype.initFromNode.call(this,R,u,D,F),h.prototype.initFromNode.call(this,R,u,D,F)};function A(){E.call(this,"p")}A.prototype.initFromNode=function(R,u,D,F){m.prototype.initFromNode.call(this,R,u,D,F),c.prototype.initFromNode.call(this,R,u,D,F),n.prototype.initFromNode.call(this,R,u,D,F),t.prototype.initFromNode.call(this,R,u,D,F),h.prototype.initFromNode.call(this,R,u,D,F)};function S(){E.call(this,"span")}S.prototype.initFromNode=function(R,u,D,F,w){m.prototype.initFromNode.call(this,R,u,D,w),c.prototype.initFromNode.call(this,R,u,D,w),n.prototype.initFromNode.call(this,R,u,D,w),t.prototype.initFromNode.call(this,R,u,D,w),h.prototype.initFromNode.call(this,R,u,D,w),this.space=F};function L(){E.call(this,"span")}L.prototype.initFromText=function(R,u,D,F,w){c.prototype.initFromNode.call(this,R,u,null,w),this.text=D,this.space=F};function U(){E.call(this,"br")}U.prototype.initFromNode=function(R,u,D,F){t.prototype.initFromNode.call(this,R,u,D,F),c.prototype.initFromNode.call(this,R,u,D,F)};function k(){}k.prototype.createDefaultRegion=function(){var R=new k;return i.call(R,""),m.call(R,{}),n.call(R,[]),c.call(R,0,Number.POSITIVE_INFINITY,null),R},k.prototype.initFromNode=function(R,u,D){i.prototype.initFromNode.call(this,R,null,u,D),m.prototype.initFromNode.call(this,R,null,u,D),c.prototype.initFromNode.call(this,R,null,u,D),n.prototype.initFromNode.call(this,R,null,u,D),R.head!==null&&R.head.styling!==null&&oe(R.head.styling,Q(u),this.styleAttrs,D)};function X(){}X.prototype.initFromNode=function(R,u,D,F){c.prototype.initFromNode.call(this,R,u,D,F);var w=q(D,F);this.qname=null,this.value=null;for(var O in w){if(this.qname){V(F,"More than one style specified on set");break}this.qname=O,this.value=w[O]}};function W(R){return R&&"xml:id"in R.attributes&&R.attributes["xml:id"].value||null}function b(R){return R&&"region"in R.attributes?R.attributes.region.value:""}function j(R,u){var D=R&&"timeContainer"in R.attributes?R.attributes.timeContainer.value:null;return!D||D==="par"?"par":D==="seq"?"seq":(V(u,"Illegal value of timeContainer (assuming 'par')"),"par")}function Q(R){return R&&"style"in R.attributes?R.attributes.style.value.split(" "):[]}function q(R,u){var D={};if(R!==null)for(var F in R.attributes){var w=R.attributes[F].uri+" "+R.attributes[F].local,O=f.byQName[w];if(O!==void 0){var P=O.parse(R.attributes[F].value);P!==null?(D[w]=P,O===f.byName.zIndex&&H(u,"zIndex attribute present but not used by IMSC1 since regions do not overlap")):V(u,"Cannot parse styling attribute "+w+" --> "+R.attributes[F].value)}}return D}function Y(R,u,D){for(var F in R.attributes)if(R.attributes[F].uri===u&&R.attributes[F].local===D)return R.attributes[F].value;return null}function J(R,u){var D=Y(R,d.ns_ittp,"aspectRatio"),F=null;if(D!==null){var w=/(\d+) (\d+)/,O=w.exec(D);if(O!==null){var P=parseInt(O[1]),B=parseInt(O[2]);P!==0&&B!==0?F=P/B:V(u,"Illegal aspectRatio values (ignoring)")}else V(u,"Malformed aspectRatio attribute (ignoring)")}return F}function $(R,u){var D=Y(R,d.ns_ttp,"cellResolution"),F=15,w=32;if(D!==null){var O=/(\d+) (\d+)/,P=O.exec(D);P!==null?(w=parseInt(P[1]),F=parseInt(P[2])):H(u,"Malformed cellResolution value (using initial value instead)")}return{w,h:F}}function ae(R,u){var D=Y(R,d.ns_ttp,"frameRate"),F=30,w;if(D!==null){var O=/(\d+)/;w=O.exec(D),w!==null?F=parseInt(w[1]):H(u,"Malformed frame rate attribute (using initial value instead)")}var P=Y(R,d.ns_ttp,"frameRateMultiplier"),B=1;if(P!==null){var x=/(\d+) (\d+)/;w=x.exec(P),w!==null?B=parseInt(w[1])/parseInt(w[2]):H(u,"Malformed frame rate multiplier attribute (using initial value instead)")}var ne=B*F,re=1,G=Y(R,d.ns_ttp,"tickRate");if(G===null)D!==null&&(re=ne);else{var fe=/(\d+)/;w=fe.exec(G),w!==null?re=parseInt(w[1]):H(u,"Malformed tick rate attribute (using initial value instead)")}return{effectiveFrameRate:ne,tickRate:re}}function K(R,u){var D=Y(R,d.ns_tts,"extent");if(D===null)return null;var F=D.split(" ");if(F.length!==2)return H(u,"Malformed extent (ignoring)"),null;var w=y.parseLength(F[0]),O=y.parseLength(F[1]);return!O||!w?(H(u,"Malformed extent values (ignoring)"),null):{h:O,w}}function ee(R,u,D){var F=/^(\d{2,}):(\d\d):(\d\d(?:\.\d+)?)$/,w=/^(\d{2,}):(\d\d):(\d\d)\:(\d{2,})$/,O=/^(\d+(?:\.\d+)?)f$/,P=/^(\d+(?:\.\d+)?)t$/,B=/^(\d+(?:\.\d+)?)ms$/,x=/^(\d+(?:\.\d+)?)s$/,ne=/^(\d+(?:\.\d+)?)h$/,re=/^(\d+(?:\.\d+)?)m$/,G,fe=null;return(G=O.exec(D))!==null?u!==null&&(fe=parseFloat(G[1])/u):(G=P.exec(D))!==null?R!==null&&(fe=parseFloat(G[1])/R):(G=B.exec(D))!==null?fe=parseFloat(G[1])/1e3:(G=x.exec(D))!==null?fe=parseFloat(G[1]):(G=ne.exec(D))!==null?fe=parseFloat(G[1])*3600:(G=re.exec(D))!==null?fe=parseFloat(G[1])*60:(G=F.exec(D))!==null?fe=parseInt(G[1])*3600+parseInt(G[2])*60+parseFloat(G[3]):(G=w.exec(D))!==null&&u!==null&&(fe=parseInt(G[1])*3600+parseInt(G[2])*60+parseInt(G[3])+(G[4]===null?0:parseInt(G[4])/u)),fe}function se(R,u,D,F){var w=null;D&&"begin"in D.attributes&&(w=ee(R.tickRate,R.effectiveFrameRate,D.attributes.begin.value),w===null&&H(F,"Malformed begin value "+D.attributes.begin.value+" (using 0)"));var O=null;D&&"dur"in D.attributes&&(O=ee(R.tickRate,R.effectiveFrameRate,D.attributes.dur.value),O===null&&H(F,"Malformed dur value "+D.attributes.dur.value+" (ignoring)"));var P=null;return D&&"end"in D.attributes&&(P=ee(R.tickRate,R.effectiveFrameRate,D.attributes.end.value),P===null&&H(F,"Malformed end value (ignoring)")),{explicit_begin:w,explicit_end:P,explicit_dur:O}}function ue(R,u,D){for(;u.styleRefs.length>0;){var F=u.styleRefs.pop();if(!(F in R.styles)){V(D,"Non-existant style id referenced");continue}ue(R,R.styles[F],D),Z(R.styles[F].styleAttrs,u.styleAttrs)}}function oe(R,u,D,F){for(var w=u.length-1;w>=0;w--){var O=u[w];if(!(O in R.styles)){V(F,"Non-existant style id referenced");continue}Z(R.styles[O].styleAttrs,D)}}function Z(R,u){for(var D in R)D in u||(u[D]=R[D])}function H(R,u){if(R&&R.warn&&R.warn(u))throw u}function V(R,u){if(R&&R.error&&R.error(u))throw u}function te(R,u){throw R&&R.fatal&&R.fatal(u),u}function z(R,u){for(var D=0,F=R.length-1,w;D<=F;){w=Math.floor((D+F)/2);var O=R[w];if(O<u)D=w+1;else if(O>u)F=w-1;else return{found:!0,index:w}}return{found:!1,index:D}}})(N,typeof sax>"u"?e("./node_modules/sax/lib/sax.js"):sax,typeof imscNames>"u"?e("./node_modules/imsc/src/main/js/names.js"):imscNames,typeof imscStyles>"u"?e("./node_modules/imsc/src/main/js/styles.js"):imscStyles,typeof imscUtils>"u"?e("./node_modules/imsc/src/main/js/utils.js"):imscUtils)},"./node_modules/imsc/src/main/js/html.js":(ce,N,e)=>{(function(I,g,d){I.render=function(n,h,c,o,l,A,S,L,U){var k=o||h.clientHeight,X=l||h.clientWidth;if(n.aspectRatio!==null){var W=k*n.aspectRatio;W>X?k=Math.round(X/n.aspectRatio):X=W}var b=document.createElement("div");b.style.position="relative",b.style.width=X+"px",b.style.height=k+"px",b.style.margin="auto",b.style.top=0,b.style.bottom=0,b.style.left=0,b.style.right=0,b.style.zIndex=0;var j={h:k,w:X,regionH:null,regionW:null,imgResolver:c,displayForcedOnlyMode:A||!1,isd:n,errorHandler:S,previousISDState:L,enableRollUp:U||!1,currentISDState:{},flg:null,lp:null,mra:null,ipd:null,bpd:null};h.appendChild(b);for(var Q in n.contents)f(j,b,n.contents[Q]);return j.currentISDState};function f(n,h,c){var o;if(c.kind==="region"?(o=document.createElement("div"),o.style.position="absolute"):c.kind==="body"||c.kind==="div"?o=document.createElement("div"):c.kind==="p"?o=document.createElement("p"):c.kind==="span"?o=document.createElement("span"):c.kind==="br"&&(o=document.createElement("br")),!o){m(n.errorHandler,"Error processing ISD element kind: "+c.kind);return}o.style.margin="0";for(var l in E){var A=E[l],S=c.styleAttrs[A.qname];S!==void 0&&A.map!==null&&A.map(n,o,c,S)}var L=o;if(c.kind==="region"){var U=c.styleAttrs[d.byName.writingMode.qname];U==="lrtb"||U==="lr"?(n.ipd="lr",n.bpd="tb"):U==="rltb"||U==="rl"?(n.ipd="rl",n.bpd="tb"):U==="tblr"?(n.ipd="tb",n.bpd="lr"):(U==="tbrl"||U==="tb")&&(n.ipd="tb",n.bpd="rl")}var k=c.styleAttrs[d.byName.linePadding.qname];if(k&&k>0){var X=Math.ceil(k*n.h)+"px";n.bpd==="tb"?(L.style.paddingLeft=X,L.style.paddingRight=X):(L.style.paddingTop=X,L.style.paddingBottom=X),n.lp=k}var W=c.styleAttrs[d.byName.multiRowAlign.qname];if(W&&W!=="auto"){var b=document.createElement("span");b.style.display="inline-block",b.style.textAlign=W,o.appendChild(b),L=b,n.mra=W}if(c.styleAttrs[d.byName.fillLineGap.qname]&&(n.flg=!0),c.kind==="span"&&c.text)if(n.lp||n.mra||n.flg)for(var j="",Q=0;Q<c.text.length;Q++){j+=c.text.charAt(Q);var q=c.text.charCodeAt(Q);if(q<55296||q>56319||Q===c.text.length){var Y=document.createElement("span");Y.textContent=j,o.appendChild(Y),j=""}}else o.textContent=c.text;h.appendChild(o);for(var J in c.contents)f(n,L,c.contents[J]);var $=[];if((n.lp||n.mra||n.flg)&&c.kind==="p"&&(p(n,L,$,null),n.mra&&(_($),n.mra=null),n.lp&&(y($,n.lp*n.h,n),n.lp=null),n.flg)){var ae=M(L.getBoundingClientRect(),n);r($,ae.before,ae.after,n),n.flg=null}if(c.kind==="region"&&(p(n,L,$),n.bpd==="tb"&&n.enableRollUp&&c.contents.length>0&&c.styleAttrs[d.byName.displayAlign.qname]==="after")){var K=c.id===""?"_":c.id,ee=new T(K,$);if(n.currentISDState[ee.id]=ee,n.previousISDState&&ee.id in n.previousISDState&&n.previousISDState[ee.id].plist.length>0&&ee.plist.length>1&&ee.plist[ee.plist.length-2].text===n.previousISDState[ee.id].plist[n.previousISDState[ee.id].plist.length-1].text){var se=o.firstElementChild,ue=ee.plist[ee.plist.length-1].after-ee.plist[ee.plist.length-1].before;se.style.bottom="-"+ue+"px",se.style.transition="transform 0.4s",se.style.position="relative",se.style.transform="translateY(-"+ue+"px)"}}}function y(n,h,c){for(var o in n){var l=n[o].elements.length,A=n[o].elements[n[o].start_elem],S=n[o].elements[n[o].end_elem],L=Math.ceil(h)+"px",U="-"+Math.ceil(h)+"px";l!==0&&(c.ipd==="lr"?(A.node.style.borderLeftColor=A.bgcolor||"#00000000",A.node.style.borderLeftStyle="solid",A.node.style.borderLeftWidth=L,A.node.style.marginLeft=U):c.ipd==="rl"?(A.node.style.borderRightColor=A.bgcolor||"#00000000",A.node.style.borderRightStyle="solid",A.node.style.borderRightWidth=L,A.node.style.marginRight=U):c.ipd==="tb"&&(A.node.style.borderTopColor=A.bgcolor||"#00000000",A.node.style.borderTopStyle="solid",A.node.style.borderTopWidth=L,A.node.style.marginTop=U),c.ipd==="lr"?(S.node.style.borderRightColor=S.bgcolor||"#00000000",S.node.style.borderRightStyle="solid",S.node.style.borderRightWidth=L,S.node.style.marginRight=U):c.ipd==="rl"?(S.node.style.borderLeftColor=S.bgcolor||"#00000000",S.node.style.borderLeftStyle="solid",S.node.style.borderLeftWidth=L,S.node.style.marginLeft=U):c.ipd==="tb"&&(S.node.style.borderBottomColor=S.bgcolor||"#00000000",S.node.style.borderBottomStyle="solid",S.node.style.borderBottomWidth=L,S.node.style.marginBottom=U))}}function _(n){for(var h=0;h<n.length-1;h++){var c=n[h].elements.length;if(c!==0&&n[h].br===!1){var o=document.createElement("br"),l=n[h].elements[c-1].node;l.parentElement.insertBefore(o,l.nextSibling)}}}function r(n,h,c,o){for(var l=Math.sign(c-h),A=0;A<=n.length;A++){var S;A===0?S=h:A===n.length?S=c:S=(n[A].before+n[A-1].after)/2;var L,U;if(A>0)for(var k=0;k<n[A-1].elements.length;k++)n[A-1].elements[k].bgcolor!==null&&(U=n[A-1].elements[k],l*(U.after-S)<0&&(L=Math.ceil(Math.abs(S-U.after))+"px",U.node.style.backgroundColor=U.bgcolor,o.bpd==="lr"?U.node.style.paddingRight=L:o.bpd==="rl"?U.node.style.paddingLeft=L:o.bpd==="tb"&&(U.node.style.paddingBottom=L)));if(A<n.length)for(var X=0;X<n[A].elements.length;X++)U=n[A].elements[X],U.bgcolor!==null&&l*(U.before-S)>0&&(L=Math.ceil(Math.abs(U.before-S))+"px",U.node.style.backgroundColor=U.bgcolor,o.bpd==="lr"?U.node.style.paddingLeft=L:o.bpd==="rl"?U.node.style.paddingRight=L:o.bpd==="tb"&&(U.node.style.paddingTop=L))}}function T(n,h){this.id=n,this.plist=h}function M(n,h){var c={before:null,after:null,start:null,end:null};return h.bpd==="tb"?(c.before=n.top,c.after=n.bottom,h.ipd==="lr"?(c.start=n.left,c.end=n.right):(c.start=n.right,c.end=n.left)):h.bpd==="lr"?(c.before=n.left,c.after=n.right,c.start=n.top,c.end=n.bottom):h.bpd==="rl"&&(c.before=n.right,c.after=n.left,c.start=n.top,c.end=n.bottom),c}function p(n,h,c,o){var l=h.style.backgroundColor||o;if(h.childElementCount===0)if(h.localName==="span"){var A=h.getBoundingClientRect();if(A.height===0||A.width===0)return;var S=M(A,n);if(c.length===0||!C(S.before,S.after,c[c.length-1].before,c[c.length-1].after))c.push({before:S.before,after:S.after,start:S.start,end:S.end,start_elem:0,end_elem:0,elements:[],text:"",br:!1});else{var L=Math.sign(S.after-S.before),U=Math.sign(S.end-S.start);L*(S.before-c[c.length-1].before)<0&&(c[c.length-1].before=S.before),L*(S.after-c[c.length-1].after)>0&&(c[c.length-1].after=S.after),U*(S.start-c[c.length-1].start)<0&&(c[c.length-1].start=S.start,c[c.length-1].start_elem=c[c.length-1].elements.length),U*(S.end-c[c.length-1].end)>0&&(c[c.length-1].end=S.end,c[c.length-1].end_elem=c[c.length-1].elements.length)}c[c.length-1].text+=h.textContent,c[c.length-1].elements.push({node:h,bgcolor:l,before:S.before,after:S.after})}else h.localName==="br"&&c.length!==0&&(c[c.length-1].br=!0);else for(var k=h.firstChild;k;)k.nodeType===Node.ELEMENT_NODE&&p(n,k,c,l),k=k.nextSibling}function C(n,h,c,o){return h<o&&n>c||o<=h&&c>=n}function v(n,h){this.qname=n,this.map=h}var E=[new v("http://www.w3.org/ns/ttml#styling backgroundColor",function(n,h,c,o){o[3]!==0&&(h.style.backgroundColor="rgba("+o[0].toString()+","+o[1].toString()+","+o[2].toString()+","+(o[3]/255).toString()+")")}),new v("http://www.w3.org/ns/ttml#styling color",function(n,h,c,o){h.style.color="rgba("+o[0].toString()+","+o[1].toString()+","+o[2].toString()+","+(o[3]/255).toString()+")"}),new v("http://www.w3.org/ns/ttml#styling direction",function(n,h,c,o){h.style.direction=o}),new v("http://www.w3.org/ns/ttml#styling display",function(n,h,c,o){}),new v("http://www.w3.org/ns/ttml#styling displayAlign",function(n,h,c,o){h.style.display="flex",h.style.flexDirection="column",o==="before"?h.style.justifyContent="flex-start":o==="center"?h.style.justifyContent="center":o==="after"&&(h.style.justifyContent="flex-end")}),new v("http://www.w3.org/ns/ttml#styling extent",function(n,h,c,o){n.regionH=o.h*n.h,n.regionW=o.w*n.w;var l=0,A=0,S=c.styleAttrs["http://www.w3.org/ns/ttml#styling padding"];S&&(l=(S[0]+S[2])*n.h,A=(S[1]+S[3])*n.w),h.style.height=n.regionH-l+"px",h.style.width=n.regionW-A+"px"}),new v("http://www.w3.org/ns/ttml#styling fontFamily",function(n,h,c,o){var l=[];for(var A in o)o[A]==="monospaceSerif"?(l.push("Courier New"),l.push('"Liberation Mono"'),l.push("Courier"),l.push("monospace")):o[A]==="proportionalSansSerif"?(l.push("Arial"),l.push("Helvetica"),l.push('"Liberation Sans"'),l.push("sans-serif")):o[A]==="monospace"?l.push("monospace"):o[A]==="sansSerif"?l.push("sans-serif"):o[A]==="serif"?l.push("serif"):o[A]==="monospaceSansSerif"?(l.push("Consolas"),l.push("monospace")):o[A]==="proportionalSerif"?l.push("serif"):l.push(o[A]);h.style.fontFamily=l.join(",")}),new v("http://www.w3.org/ns/ttml#styling fontSize",function(n,h,c,o){h.style.fontSize=o*n.h+"px"}),new v("http://www.w3.org/ns/ttml#styling fontStyle",function(n,h,c,o){h.style.fontStyle=o}),new v("http://www.w3.org/ns/ttml#styling fontWeight",function(n,h,c,o){h.style.fontWeight=o}),new v("http://www.w3.org/ns/ttml#styling lineHeight",function(n,h,c,o){o==="normal"?h.style.lineHeight="normal":h.style.lineHeight=o*n.h+"px"}),new v("http://www.w3.org/ns/ttml#styling opacity",function(n,h,c,o){h.style.opacity=o}),new v("http://www.w3.org/ns/ttml#styling origin",function(n,h,c,o){h.style.top=o.h*n.h+"px",h.style.left=o.w*n.w+"px"}),new v("http://www.w3.org/ns/ttml#styling overflow",function(n,h,c,o){h.style.overflow=o}),new v("http://www.w3.org/ns/ttml#styling padding",function(n,h,c,o){var l=[];l[0]=o[0]*n.h+"px",l[1]=o[3]*n.w+"px",l[2]=o[2]*n.h+"px",l[3]=o[1]*n.w+"px",h.style.padding=l.join(" ")}),new v("http://www.w3.org/ns/ttml#styling showBackground",null),new v("http://www.w3.org/ns/ttml#styling textAlign",function(n,h,c,o){var l,A=c.styleAttrs[d.byName.direction.qname];o==="start"?l=A==="rtl"?"right":"left":o==="end"?l=A==="rtl"?"left":"right":l=o,h.style.textAlign=l}),new v("http://www.w3.org/ns/ttml#styling textDecoration",function(n,h,c,o){h.style.textDecoration=o.join(" ").replace("lineThrough","line-through")}),new v("http://www.w3.org/ns/ttml#styling textOutline",function(n,h,c,o){o==="none"?h.style.textShadow="":h.style.textShadow="rgba("+o.color[0].toString()+","+o.color[1].toString()+","+o.color[2].toString()+","+(o.color[3]/255).toString()+") 0px 0px "+o.thickness*n.h+"px"}),new v("http://www.w3.org/ns/ttml#styling unicodeBidi",function(n,h,c,o){var l;o==="bidiOverride"?l="bidi-override":l=o,h.style.unicodeBidi=l}),new v("http://www.w3.org/ns/ttml#styling visibility",function(n,h,c,o){h.style.visibility=o}),new v("http://www.w3.org/ns/ttml#styling wrapOption",function(n,h,c,o){o==="wrap"?c.space==="preserve"?h.style.whiteSpace="pre-wrap":h.style.whiteSpace="normal":c.space==="preserve"?h.style.whiteSpace="pre":h.style.whiteSpace="noWrap"}),new v("http://www.w3.org/ns/ttml#styling writingMode",function(n,h,c,o){o==="lrtb"||o==="lr"||o==="rltb"||o==="rl"?h.style.writingMode="horizontal-tb":o==="tblr"?h.style.writingMode="vertical-lr":(o==="tbrl"||o==="tb")&&(h.style.writingMode="vertical-rl")}),new v("http://www.w3.org/ns/ttml#styling zIndex",function(n,h,c,o){h.style.zIndex=o}),new v("http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt backgroundImage",function(n,h,c,o){if(n.imgResolver!==null&&o!==null){var l=document.createElement("img"),A=n.imgResolver(o,l);A&&(l.src=A),l.height=n.regionH,l.width=n.regionW,h.appendChild(l)}}),new v("http://www.w3.org/ns/ttml/profile/imsc1#styling forcedDisplay",function(n,h,c,o){n.displayForcedOnlyMode&&o===!1&&(h.style.visibility="hidden")})],i={};for(var t in E)i[E[t].qname]=E[t];function m(n,h){if(n&&n.error&&n.error(h))throw h}})(N,typeof imscNames>"u"?e("./node_modules/imsc/src/main/js/names.js"):imscNames,typeof imscStyles>"u"?e("./node_modules/imsc/src/main/js/styles.js"):imscStyles)},"./node_modules/imsc/src/main/js/isd.js":(ce,N,e)=>{(function(I,g,d){I.generateISD=function(p,C,v){var E=new r(p),i={};for(var t in p.head.layout.regions){var m=f(p,C,p.head.layout.regions[t],p.body,null,"",p.head.layout.regions[t],v,i);m!==null&&E.contents.push(m.element)}return E};function f(p,C,v,E,i,t,m,n,h){if(C<m.begin||C>=m.end)return null;var c="regionID"in m&&m.regionID!==""?m.regionID:t;if(i!==null&&c!==v.id&&(!("contents"in m)||"contents"in m&&m.contents.length===0||c!==""))return null;var o=new T(m);for(var l in m.sets)C<m.sets[l].begin||C>=m.sets[l].end||(o.styleAttrs[m.sets[l].qname]=m.sets[l].value);var A={};for(var S in o.styleAttrs)if(A[S]=!0,S===d.byName.writingMode.qname&&!(d.byName.direction.qname in o.styleAttrs)){var L=o.styleAttrs[S];L==="lrtb"||L==="lr"?o.styleAttrs[d.byName.direction.qname]="ltr":(L==="rltb"||L==="rl")&&(o.styleAttrs[d.byName.direction.qname]="rtl")}if(i!==null)for(var U in d.all){var k=d.all[U];if(k.qname===d.byName.textDecoration.qname){var X=i.styleAttrs[k.qname],W=o.styleAttrs[k.qname],b=[];W===void 0?b=X:W.indexOf("none")===-1?((W.indexOf("noUnderline")===-1&&X.indexOf("underline")!==-1||W.indexOf("underline")!==-1)&&b.push("underline"),(W.indexOf("noLineThrough")===-1&&X.indexOf("lineThrough")!==-1||W.indexOf("lineThrough")!==-1)&&b.push("lineThrough"),(W.indexOf("noOverline")===-1&&X.indexOf("overline")!==-1||W.indexOf("overline")!==-1)&&b.push("overline")):b.push("none"),o.styleAttrs[k.qname]=b}else k.inherit&&k.qname in i.styleAttrs&&!(k.qname in o.styleAttrs)&&(o.styleAttrs[k.qname]=i.styleAttrs[k.qname])}for(var j in d.all){var Q=d.all[j];Q.qname in o.styleAttrs||(o.kind==="region"||Q.inherit===!1&&Q.initial!==null)&&(o.styleAttrs[Q.qname]=Q.parse(Q.initial),A[Q.qname]=!0)}for(var q in d.all){var Y=d.all[q];if(Y.qname in A&&Y.compute!==null){var J=Y.compute(p,i,o,o.styleAttrs[Y.qname],h);J!==null?o.styleAttrs[Y.qname]=J:M(n,"Style '"+Y.qname+"' on element '"+o.kind+"' cannot be computed")}}if(o.styleAttrs[d.byName.display.qname]==="none")return null;var $;i===null?E===null?$=[]:$=[E]:"contents"in m&&($=m.contents);for(var ae in $){var K=f(p,C,v,E,o,c,$[ae],n,h);K!==null&&o.contents.push(K.element)}for(var ee in o.styleAttrs){var se=d.byQName[ee];se.applies.indexOf(o.kind)===-1&&delete o.styleAttrs[ee]}if(o.kind==="span"&&o.text&&o.space==="default"){var ue=o.text.replace(/\s+/g," ");o.text=ue}if(o.kind==="p"){var oe=[];y(o,oe);for(var Z=0,H="after_br",V=0;;)if(H==="after_br")Z>=oe.length||oe[Z].kind==="br"?(H="before_br",V=Z,Z--):(oe[Z].space!=="preserve"&&(oe[Z].text=oe[Z].text.replace(/^\s+/g,"")),oe[Z].text.length>0?(H="looking_br",Z++):oe.splice(Z,1));else if(H==="before_br")if(Z<0||oe[Z].kind==="br"){if(H="after_br",Z=V+1,Z>=oe.length)break}else if(oe[Z].space!=="preserve"&&(oe[Z].text=oe[Z].text.replace(/\s+$/g,"")),oe[Z].text.length>0){if(H="after_br",Z=V+1,Z>=oe.length)break}else oe.splice(Z,1),Z--;else Z>=oe.length||oe[Z].kind==="br"?(H="before_br",V=Z,Z--):Z++;_(o)}return o.kind==="div"&&d.byName.backgroundImage.qname in o.styleAttrs||o.kind==="br"||"contents"in o&&o.contents.length>0||o.kind==="span"&&o.text!==null||o.kind==="region"&&o.styleAttrs[d.byName.showBackground.qname]==="always"?{region_id:c,element:o}:null}function y(p,C){if("contents"in p)for(var v in p.contents)y(p.contents[v],C);else C.push(p)}function _(p){if(p.kind==="br")return!1;if("text"in p)return p.text.length===0;if("contents"in p){for(var C=p.contents.length;C--;)_(p.contents[C])&&p.contents.splice(C,1);return p.contents.length===0}}function r(p){this.contents=[],this.aspectRatio=p.aspectRatio}function T(p){this.kind=p.kind||"region",p.id&&(this.id=p.id),this.styleAttrs={};for(var C in p.styleAttrs)this.styleAttrs[C]=p.styleAttrs[C];"text"in p?this.text=p.text:p.kind!=="br"&&(this.contents=[]),"space"in p&&(this.space=p.space)}function M(p,C){if(p&&p.error&&p.error(C))throw C}})(N,typeof imscNames>"u"?e("./node_modules/imsc/src/main/js/names.js"):imscNames,typeof imscStyles>"u"?e("./node_modules/imsc/src/main/js/styles.js"):imscStyles)},"./node_modules/imsc/src/main/js/main.js":(ce,N,e)=>{N.generateISD=e("./node_modules/imsc/src/main/js/isd.js").generateISD,N.fromXML=e("./node_modules/imsc/src/main/js/doc.js").fromXML,N.renderHTML=e("./node_modules/imsc/src/main/js/html.js").render},"./node_modules/imsc/src/main/js/names.js":(ce,N)=>{(function(e){e.ns_tt="http://www.w3.org/ns/ttml",e.ns_tts="http://www.w3.org/ns/ttml#styling",e.ns_ttp="http://www.w3.org/ns/ttml#parameter",e.ns_xml="http://www.w3.org/XML/1998/namespace",e.ns_itts="http://www.w3.org/ns/ttml/profile/imsc1#styling",e.ns_ittp="http://www.w3.org/ns/ttml/profile/imsc1#parameter",e.ns_smpte="http://www.smpte-ra.org/schemas/2052-1/2010/smpte-tt",e.ns_ebutts="urn:ebu:tt:style"})(N)},"./node_modules/imsc/src/main/js/styles.js":(ce,N,e)=>{(function(I,g,d){function f(r,T,M,p,C,v,E,i){this.name=T,this.ns=r,this.qname=r+" "+T,this.inherit=C,this.animatable=v,this.initial=M,this.applies=p,this.parse=E,this.compute=i}I.all=[new f(g.ns_tts,"backgroundColor","transparent",["body","div","p","region","span"],!1,!0,d.parseColor,null),new f(g.ns_tts,"color","white",["span"],!0,!0,d.parseColor,null),new f(g.ns_tts,"direction","ltr",["p","span"],!0,!0,function(r){return r},null),new f(g.ns_tts,"display","auto",["body","div","p","region","span"],!1,!0,function(r){return r},null),new f(g.ns_tts,"displayAlign","before",["region"],!1,!0,function(r){return r},null),new f(g.ns_tts,"extent","auto",["tt","region"],!1,!0,function(r){if(r==="auto")return r;var T=r.split(" ");if(T.length!==2)return null;var M=d.parseLength(T[0]),p=d.parseLength(T[1]);return!p||!M?null:{h:p,w:M}},function(r,T,M,p,C){var v,E;if(p==="auto")v=1;else if(p.h.unit==="%")v=p.h.value/100;else if(p.h.unit==="px")v=p.h.value/r.pxDimensions.h;else return null;if(p==="auto")E=1;else if(p.w.unit==="%")E=p.w.value/100;else if(p.w.unit==="px")E=p.w.value/r.pxDimensions.w;else return null;return{h:v,w:E}}),new f(g.ns_tts,"fontFamily","default",["span"],!0,!0,function(r){var T=r.split(","),M=[];for(var p in T)T[p].charAt(0)!=="'"&&T[p].charAt(0)!=='"'&&T[p]==="default"?M.push("monospaceSerif"):M.push(T[p]);return M},null),new f(g.ns_tts,"fontSize","1c",["span"],!0,!0,d.parseLength,function(r,T,M,p,C){var v;if(p.unit==="%")T!==null?v=T.styleAttrs[I.byName.fontSize.qname]*p.value/100:v=p.value/100/r.cellResolution.h;else if(p.unit==="em")T!==null?v=T.styleAttrs[I.byName.fontSize.qname]*p.value:v=p.value/r.cellResolution.h;else if(p.unit==="c")v=p.value/r.cellResolution.h;else if(p.unit==="px")v=p.value/r.pxDimensions.h;else return null;return v}),new f(g.ns_tts,"fontStyle","normal",["span"],!0,!0,function(r){return r},null),new f(g.ns_tts,"fontWeight","normal",["span"],!0,!0,function(r){return r},null),new f(g.ns_tts,"lineHeight","normal",["p"],!0,!0,function(r){return r==="normal"?r:d.parseLength(r)},function(r,T,M,p,C){var v;if(p==="normal")v=p;else if(p.unit==="%")v=M.styleAttrs[I.byName.fontSize.qname]*p.value/100;else if(p.unit==="em")v=M.styleAttrs[I.byName.fontSize.qname]*p.value;else if(p.unit==="c")v=p.value/r.cellResolution.h;else if(p.unit==="px")v=p.value/r.pxDimensions.h;else return null;return v}),new f(g.ns_tts,"opacity",1,["region"],!1,!0,parseFloat,null),new f(g.ns_tts,"origin","auto",["region"],!1,!0,function(r){if(r==="auto")return r;var T=r.split(" ");if(T.length!==2)return null;var M=d.parseLength(T[0]),p=d.parseLength(T[1]);return!p||!M?null:{h:p,w:M}},function(r,T,M,p,C){var v,E;if(p==="auto")v=0;else if(p.h.unit==="%")v=p.h.value/100;else if(p.h.unit==="px")v=p.h.value/r.pxDimensions.h;else return null;if(p==="auto")E=0;else if(p.w.unit==="%")E=p.w.value/100;else if(p.w.unit==="px")E=p.w.value/r.pxDimensions.w;else return null;return{h:v,w:E}}),new f(g.ns_tts,"overflow","hidden",["region"],!1,!0,function(r){return r},null),new f(g.ns_tts,"padding","0px",["region"],!1,!0,function(r){var T=r.split(" ");if(T.length>4)return null;var M=[];for(var p in T){var C=d.parseLength(T[p]);if(!C)return null;M.push(C)}return M},function(r,T,M,p,C){var v;if(p.length===1)v=[p[0],p[0],p[0],p[0]];else if(p.length===2)v=[p[0],p[1],p[0],p[1]];else if(p.length===3)v=[p[0],p[1],p[2],p[1]];else if(p.length===4)v=[p[0],p[1],p[2],p[3]];else return null;var E=M.styleAttrs[I.byName.writingMode.qname];if(E==="lrtb"||E==="lr")v=[v[0],v[3],v[2],v[1]];else if(E==="rltb"||E==="rl")v=[v[0],v[1],v[2],v[3]];else if(E==="tblr")v=[v[3],v[0],v[1],v[2]];else if(E==="tbrl"||E==="tb")v=[v[3],v[2],v[1],v[0]];else return null;var i=[];for(var t in v)if(v[t].value===0)i[t]=0;else if(v[t].unit==="%")t==="0"||t==="2"?i[t]=M.styleAttrs[I.byName.extent.qname].h*v[t].value/100:i[t]=M.styleAttrs[I.byName.extent.qname].w*v[t].value/100;else if(v[t].unit==="em")i[t]=M.styleAttrs[I.byName.fontSize.qname]*v[t].value;else if(v[t].unit==="c")i[t]=v[t].value/r.cellResolution.h;else if(v[t].unit==="px")t==="0"||t==="2"?i[t]=v[t].value/r.pxDimensions.h:i[t]=v[t].value/r.pxDimensions.w;else return null;return i}),new f(g.ns_tts,"showBackground","always",["region"],!1,!0,function(r){return r},null),new f(g.ns_tts,"textAlign","start",["p"],!0,!0,function(r){return r},function(r,T,M,p,C){return p==="left"?"start":p==="right"?"end":p}),new f(g.ns_tts,"textDecoration","none",["span"],!0,!0,function(r){return r.split(" ")},null),new f(g.ns_tts,"textOutline","none",["span"],!0,!0,function(r){if(r==="none")return r;var T={},M=r.split(" ");if(M.length===0||M.length>2)return null;var p=d.parseColor(M[0]);if(T.color=p,p!==null&&M.shift(),M.length!==1)return null;var C=d.parseLength(M[0]);return C?(T.thickness=C,T):null},function(r,T,M,p,C){if(p==="none")return p;var v={};if(p.color===null?v.color=M.styleAttrs[I.byName.color.qname]:v.color=p.color,p.thickness.unit==="%")v.thickness=M.styleAttrs[I.byName.fontSize.qname]*p.thickness.value/100;else if(p.thickness.unit==="em")v.thickness=M.styleAttrs[I.byName.fontSize.qname]*p.thickness.value;else if(p.thickness.unit==="c")v.thickness=p.thickness.value/r.cellResolution.h;else if(p.thickness.unit==="px")v.thickness=p.thickness.value/r.pxDimensions.h;else return null;return v}),new f(g.ns_tts,"unicodeBidi","normal",["span","p"],!1,!0,function(r){return r},null),new f(g.ns_tts,"visibility","visible",["body","div","p","region","span"],!0,!0,function(r){return r},null),new f(g.ns_tts,"wrapOption","wrap",["span"],!0,!0,function(r){return r},null),new f(g.ns_tts,"writingMode","lrtb",["region"],!1,!0,function(r){return r},null),new f(g.ns_tts,"zIndex","auto",["region"],!1,!0,function(r){var T;return r==="auto"?T=r:(T=parseInt(r),isNaN(T)&&(T=null)),T},null),new f(g.ns_ebutts,"linePadding","0c",["p"],!0,!1,d.parseLength,function(r,T,M,p,C){return p.unit==="c"?p.value/r.cellResolution.h:null}),new f(g.ns_ebutts,"multiRowAlign","auto",["p"],!0,!1,function(r){return r},null),new f(g.ns_smpte,"backgroundImage",null,["div"],!1,!1,function(r){return r},null),new f(g.ns_itts,"forcedDisplay","false",["body","div","p","region","span"],!0,!0,function(r){return r==="true"},null),new f(g.ns_itts,"fillLineGap","false",["p"],!0,!0,function(r){return r==="true"},null)],I.byQName={};for(var y in I.all)I.byQName[I.all[y].qname]=I.all[y];I.byName={};for(var _ in I.all)I.byName[I.all[_].name]=I.all[_]})(N,typeof imscNames>"u"?e("./node_modules/imsc/src/main/js/names.js"):imscNames,typeof imscUtils>"u"?e("./node_modules/imsc/src/main/js/utils.js"):imscUtils)},"./node_modules/imsc/src/main/js/utils.js":(ce,N)=>{(function(e){var I=/#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})?/,g=/rgb\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,d=/rgba\(\s*(\d+),\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/,f={transparent:[0,0,0,0],black:[0,0,0,255],silver:[192,192,192,255],gray:[128,128,128,255],white:[255,255,255,255],maroon:[128,0,0,255],red:[255,0,0,255],purple:[128,0,128,255],fuchsia:[255,0,255,255],magenta:[255,0,255,255],green:[0,128,0,255],lime:[0,255,0,255],olive:[128,128,0,255],yellow:[255,255,0,255],navy:[0,0,128,255],blue:[0,0,255,255],teal:[0,128,128,255],aqua:[0,255,255,255],cyan:[0,255,255,255]};e.parseColor=function(_){var r,T=null,M=f[_.toLowerCase()];return M!==void 0?T=M:(r=I.exec(_))!==null?T=[parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16),r[4]!==void 0?parseInt(r[4],16):255]:(r=g.exec(_))!==null?T=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3]),255]:(r=d.exec(_))!==null&&(T=[parseInt(r[1]),parseInt(r[2]),parseInt(r[3]),parseInt(r[4])]),T};var y=/^((?:\+|\-)?\d*(?:\.\d+)?)(px|em|c|%)$/;e.parseLength=function(_){var r,T=null;return(r=y.exec(_))!==null&&(T={value:parseFloat(r[1]),unit:r[2]}),T}})(N)},"./node_modules/is-alphabetical/index.js":ce=>{ce.exports=N;function N(e){var I=typeof e=="string"?e.charCodeAt(0):e;return I>=97&&I<=122||I>=65&&I<=90}},"./node_modules/is-alphanumerical/index.js":(ce,N,e)=>{var I=e("./node_modules/is-alphabetical/index.js"),g=e("./node_modules/is-decimal/index.js");ce.exports=d;function d(f){return I(f)||g(f)}},"./node_modules/is-decimal/index.js":ce=>{ce.exports=N;function N(e){var I=typeof e=="string"?e.charCodeAt(0):e;return I>=48&&I<=57}},"./node_modules/path-browserify/index.js":ce=>{function N(d){if(typeof d!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(d))}function e(d,f){for(var y="",_=0,r=-1,T=0,M,p=0;p<=d.length;++p){if(p<d.length)M=d.charCodeAt(p);else{if(M===47)break;M=47}if(M===47){if(!(r===p-1||T===1))if(r!==p-1&&T===2){if(y.length<2||_!==2||y.charCodeAt(y.length-1)!==46||y.charCodeAt(y.length-2)!==46){if(y.length>2){var C=y.lastIndexOf("/");if(C!==y.length-1){C===-1?(y="",_=0):(y=y.slice(0,C),_=y.length-1-y.lastIndexOf("/")),r=p,T=0;continue}}else if(y.length===2||y.length===1){y="",_=0,r=p,T=0;continue}}f&&(y.length>0?y+="/..":y="..",_=2)}else y.length>0?y+="/"+d.slice(r+1,p):y=d.slice(r+1,p),_=p-r-1;r=p,T=0}else M===46&&T!==-1?++T:T=-1}return y}function I(d,f){var y=f.dir||f.root,_=f.base||(f.name||"")+(f.ext||"");return y?y===f.root?y+_:y+d+_:_}var g={resolve:function(){for(var f="",y=!1,_,r=arguments.length-1;r>=-1&&!y;r--){var T;r>=0?T=arguments[r]:(_===void 0&&(_=process.cwd()),T=_),N(T),T.length!==0&&(f=T+"/"+f,y=T.charCodeAt(0)===47)}return f=e(f,!y),y?f.length>0?"/"+f:"/":f.length>0?f:"."},normalize:function(f){if(N(f),f.length===0)return".";var y=f.charCodeAt(0)===47,_=f.charCodeAt(f.length-1)===47;return f=e(f,!y),f.length===0&&!y&&(f="."),f.length>0&&_&&(f+="/"),y?"/"+f:f},isAbsolute:function(f){return N(f),f.length>0&&f.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var f,y=0;y<arguments.length;++y){var _=arguments[y];N(_),_.length>0&&(f===void 0?f=_:f+="/"+_)}return f===void 0?".":g.normalize(f)},relative:function(f,y){if(N(f),N(y),f===y||(f=g.resolve(f),y=g.resolve(y),f===y))return"";for(var _=1;_<f.length&&f.charCodeAt(_)===47;++_);for(var r=f.length,T=r-_,M=1;M<y.length&&y.charCodeAt(M)===47;++M);for(var p=y.length,C=p-M,v=T<C?T:C,E=-1,i=0;i<=v;++i){if(i===v){if(C>v){if(y.charCodeAt(M+i)===47)return y.slice(M+i+1);if(i===0)return y.slice(M+i)}else T>v&&(f.charCodeAt(_+i)===47?E=i:i===0&&(E=0));break}var t=f.charCodeAt(_+i),m=y.charCodeAt(M+i);if(t!==m)break;t===47&&(E=i)}var n="";for(i=_+E+1;i<=r;++i)(i===r||f.charCodeAt(i)===47)&&(n.length===0?n+="..":n+="/..");return n.length>0?n+y.slice(M+E):(M+=E,y.charCodeAt(M)===47&&++M,y.slice(M))},_makeLong:function(f){return f},dirname:function(f){if(N(f),f.length===0)return".";for(var y=f.charCodeAt(0),_=y===47,r=-1,T=!0,M=f.length-1;M>=1;--M)if(y=f.charCodeAt(M),y===47){if(!T){r=M;break}}else T=!1;return r===-1?_?"/":".":_&&r===1?"//":f.slice(0,r)},basename:function(f,y){if(y!==void 0&&typeof y!="string")throw new TypeError('"ext" argument must be a string');N(f);var _=0,r=-1,T=!0,M;if(y!==void 0&&y.length>0&&y.length<=f.length){if(y.length===f.length&&y===f)return"";var p=y.length-1,C=-1;for(M=f.length-1;M>=0;--M){var v=f.charCodeAt(M);if(v===47){if(!T){_=M+1;break}}else C===-1&&(T=!1,C=M+1),p>=0&&(v===y.charCodeAt(p)?--p===-1&&(r=M):(p=-1,r=C))}return _===r?r=C:r===-1&&(r=f.length),f.slice(_,r)}else{for(M=f.length-1;M>=0;--M)if(f.charCodeAt(M)===47){if(!T){_=M+1;break}}else r===-1&&(T=!1,r=M+1);return r===-1?"":f.slice(_,r)}},extname:function(f){N(f);for(var y=-1,_=0,r=-1,T=!0,M=0,p=f.length-1;p>=0;--p){var C=f.charCodeAt(p);if(C===47){if(!T){_=p+1;break}continue}r===-1&&(T=!1,r=p+1),C===46?y===-1?y=p:M!==1&&(M=1):y!==-1&&(M=-1)}return y===-1||r===-1||M===0||M===1&&y===r-1&&y===_+1?"":f.slice(y,r)},format:function(f){if(f===null||typeof f!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof f);return I("/",f)},parse:function(f){N(f);var y={root:"",dir:"",base:"",ext:"",name:""};if(f.length===0)return y;var _=f.charCodeAt(0),r=_===47,T;r?(y.root="/",T=1):T=0;for(var M=-1,p=0,C=-1,v=!0,E=f.length-1,i=0;E>=T;--E){if(_=f.charCodeAt(E),_===47){if(!v){p=E+1;break}continue}C===-1&&(v=!1,C=E+1),_===46?M===-1?M=E:i!==1&&(i=1):M!==-1&&(i=-1)}return M===-1||C===-1||i===0||i===1&&M===C-1&&M===p+1?C!==-1&&(p===0&&r?y.base=y.name=f.slice(1,C):y.base=y.name=f.slice(p,C)):(p===0&&r?(y.name=f.slice(1,M),y.base=f.slice(1,C)):(y.name=f.slice(p,M),y.base=f.slice(p,C)),y.ext=f.slice(M,C)),p>0?y.dir=f.slice(0,p-1):r&&(y.dir="/"),y},sep:"/",delimiter:":",win32:null,posix:null};g.posix=g,ce.exports=g},"./node_modules/safe-buffer/index.js":(ce,N,e)=>{var I=e("./node_modules/buffer/index.js"),g=I.Buffer;function d(y,_){for(var r in y)_[r]=y[r]}g.from&&g.alloc&&g.allocUnsafe&&g.allocUnsafeSlow?ce.exports=I:(d(I,N),N.Buffer=f);function f(y,_,r){return g(y,_,r)}d(g,f),f.from=function(y,_,r){if(typeof y=="number")throw new TypeError("Argument must not be a number");return g(y,_,r)},f.alloc=function(y,_,r){if(typeof y!="number")throw new TypeError("Argument must be a number");var T=g(y);return _!==void 0?typeof r=="string"?T.fill(_,r):T.fill(_):T.fill(0),T},f.allocUnsafe=function(y){if(typeof y!="number")throw new TypeError("Argument must be a number");return g(y)},f.allocUnsafeSlow=function(y){if(typeof y!="number")throw new TypeError("Argument must be a number");return I.SlowBuffer(y)}},"./node_modules/sax/lib/sax.js":(ce,N,e)=>{(function(I){I.parser=function(R,u){return new d(R,u)},I.SAXParser=d,I.SAXStream=p,I.createStream=M,I.MAX_BUFFER_LENGTH=65536;var g=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];I.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function d(R,u){if(!(this instanceof d))return new d(R,u);var D=this;y(D),D.q=D.c="",D.bufferCheckPosition=I.MAX_BUFFER_LENGTH,D.opt=u||{},D.opt.lowercase=D.opt.lowercase||D.opt.lowercasetags,D.looseCase=D.opt.lowercase?"toLowerCase":"toUpperCase",D.tags=[],D.closed=D.closedRoot=D.sawRoot=!1,D.tag=D.error=null,D.strict=!!R,D.noscript=!!(R||D.opt.noscript),D.state=b.BEGIN,D.strictEntities=D.opt.strictEntities,D.ENTITIES=D.strictEntities?Object.create(I.XML_ENTITIES):Object.create(I.ENTITIES),D.attribList=[],D.opt.xmlns&&(D.ns=Object.create(o)),D.trackPosition=D.opt.position!==!1,D.trackPosition&&(D.position=D.line=D.column=0),Q(D,"onready")}Object.create||(Object.create=function(R){function u(){}u.prototype=R;var D=new u;return D}),Object.keys||(Object.keys=function(R){var u=[];for(var D in R)R.hasOwnProperty(D)&&u.push(D);return u});function f(R){for(var u=Math.max(I.MAX_BUFFER_LENGTH,10),D=0,F=0,w=g.length;F<w;F++){var O=R[g[F]].length;if(O>u)switch(g[F]){case"textNode":Y(R);break;case"cdata":q(R,"oncdata",R.cdata),R.cdata="";break;case"script":q(R,"onscript",R.script),R.script="";break;default:$(R,"Max buffer length exceeded: "+g[F])}D=Math.max(D,O)}var P=I.MAX_BUFFER_LENGTH-D;R.bufferCheckPosition=P+R.position}function y(R){for(var u=0,D=g.length;u<D;u++)R[g[u]]=""}function _(R){Y(R),R.cdata!==""&&(q(R,"oncdata",R.cdata),R.cdata=""),R.script!==""&&(q(R,"onscript",R.script),R.script="")}d.prototype={end:function(){ae(this)},write:z,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){_(this)}};var r;try{r=e("./node_modules/stream-browserify/index.js").Stream}catch{r=function(){}}var T=I.EVENTS.filter(function(R){return R!=="error"&&R!=="end"});function M(R,u){return new p(R,u)}function p(R,u){if(!(this instanceof p))return new p(R,u);r.apply(this),this._parser=new d(R,u),this.writable=!0,this.readable=!0;var D=this;this._parser.onend=function(){D.emit("end")},this._parser.onerror=function(F){D.emit("error",F),D._parser.error=null},this._decoder=null,T.forEach(function(F){Object.defineProperty(D,"on"+F,{get:function(){return D._parser["on"+F]},set:function(w){if(!w)return D.removeAllListeners(F),D._parser["on"+F]=w,w;D.on(F,w)},enumerable:!0,configurable:!1})})}p.prototype=Object.create(r.prototype,{constructor:{value:p}}),p.prototype.write=function(R){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(R)){if(!this._decoder){var u=e("./node_modules/string_decoder/lib/string_decoder.js").StringDecoder;this._decoder=new u("utf8")}R=this._decoder.write(R)}return this._parser.write(R.toString()),this.emit("data",R),!0},p.prototype.end=function(R){return R&&R.length&&this.write(R),this._parser.end(),!0},p.prototype.on=function(R,u){var D=this;return!D._parser["on"+R]&&T.indexOf(R)!==-1&&(D._parser["on"+R]=function(){var F=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);F.splice(0,0,R),D.emit.apply(D,F)}),r.prototype.on.call(D,R,u)};var C=`\r
	 `,v="0124356789",E="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",i=`'"`,t=C+">",m="[CDATA[",n="DOCTYPE",h="http://www.w3.org/XML/1998/namespace",c="http://www.w3.org/2000/xmlns/",o={xml:h,xmlns:c};C=U(C),v=U(v),E=U(E);var l=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,A=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,S=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,L=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;i=U(i),t=U(t);function U(R){return R.split("").reduce(function(u,D){return u[D]=!0,u},{})}function k(R){return Object.prototype.toString.call(R)==="[object RegExp]"}function X(R,u){return k(R)?!!u.match(R):R[u]}function W(R,u){return!X(R,u)}var b=0;I.STATE={BEGIN:b++,BEGIN_WHITESPACE:b++,TEXT:b++,TEXT_ENTITY:b++,OPEN_WAKA:b++,SGML_DECL:b++,SGML_DECL_QUOTED:b++,DOCTYPE:b++,DOCTYPE_QUOTED:b++,DOCTYPE_DTD:b++,DOCTYPE_DTD_QUOTED:b++,COMMENT_STARTING:b++,COMMENT:b++,COMMENT_ENDING:b++,COMMENT_ENDED:b++,CDATA:b++,CDATA_ENDING:b++,CDATA_ENDING_2:b++,PROC_INST:b++,PROC_INST_BODY:b++,PROC_INST_ENDING:b++,OPEN_TAG:b++,OPEN_TAG_SLASH:b++,ATTRIB:b++,ATTRIB_NAME:b++,ATTRIB_NAME_SAW_WHITE:b++,ATTRIB_VALUE:b++,ATTRIB_VALUE_QUOTED:b++,ATTRIB_VALUE_CLOSED:b++,ATTRIB_VALUE_UNQUOTED:b++,ATTRIB_VALUE_ENTITY_Q:b++,ATTRIB_VALUE_ENTITY_U:b++,CLOSE_TAG:b++,CLOSE_TAG_SAW_WHITE:b++,SCRIPT:b++,SCRIPT_ENDING:b++},I.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},I.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(I.ENTITIES).forEach(function(R){var u=I.ENTITIES[R],D=typeof u=="number"?String.fromCharCode(u):u;I.ENTITIES[R]=D});for(var j in I.STATE)I.STATE[I.STATE[j]]=j;b=I.STATE;function Q(R,u,D){R[u]&&R[u](D)}function q(R,u,D){R.textNode&&Y(R),Q(R,u,D)}function Y(R){R.textNode=J(R.opt,R.textNode),R.textNode&&Q(R,"ontext",R.textNode),R.textNode=""}function J(R,u){return R.trim&&(u=u.trim()),R.normalize&&(u=u.replace(/\s+/g," ")),u}function $(R,u){return Y(R),R.trackPosition&&(u+=`
Line: `+R.line+`
Column: `+R.column+`
Char: `+R.c),u=new Error(u),R.error=u,Q(R,"onerror",u),R}function ae(R){return R.sawRoot&&!R.closedRoot&&K(R,"Unclosed root tag"),R.state!==b.BEGIN&&R.state!==b.BEGIN_WHITESPACE&&R.state!==b.TEXT&&$(R,"Unexpected end"),Y(R),R.c="",R.closed=!0,Q(R,"onend"),d.call(R,R.strict,R.opt),R}function K(R,u){if(typeof R!="object"||!(R instanceof d))throw new Error("bad call to strictFail");R.strict&&$(R,u)}function ee(R){R.strict||(R.tagName=R.tagName[R.looseCase]());var u=R.tags[R.tags.length-1]||R,D=R.tag={name:R.tagName,attributes:{}};R.opt.xmlns&&(D.ns=u.ns),R.attribList.length=0,q(R,"onopentagstart",D)}function se(R,u){var D=R.indexOf(":"),F=D<0?["",R]:R.split(":"),w=F[0],O=F[1];return u&&R==="xmlns"&&(w="xmlns",O=""),{prefix:w,local:O}}function ue(R){if(R.strict||(R.attribName=R.attribName[R.looseCase]()),R.attribList.indexOf(R.attribName)!==-1||R.tag.attributes.hasOwnProperty(R.attribName)){R.attribName=R.attribValue="";return}if(R.opt.xmlns){var u=se(R.attribName,!0),D=u.prefix,F=u.local;if(D==="xmlns")if(F==="xml"&&R.attribValue!==h)K(R,"xml: prefix must be bound to "+h+`
Actual: `+R.attribValue);else if(F==="xmlns"&&R.attribValue!==c)K(R,"xmlns: prefix must be bound to "+c+`
Actual: `+R.attribValue);else{var w=R.tag,O=R.tags[R.tags.length-1]||R;w.ns===O.ns&&(w.ns=Object.create(O.ns)),w.ns[F]=R.attribValue}R.attribList.push([R.attribName,R.attribValue])}else R.tag.attributes[R.attribName]=R.attribValue,q(R,"onattribute",{name:R.attribName,value:R.attribValue});R.attribName=R.attribValue=""}function oe(R,u){if(R.opt.xmlns){var D=R.tag,F=se(R.tagName);D.prefix=F.prefix,D.local=F.local,D.uri=D.ns[F.prefix]||"",D.prefix&&!D.uri&&(K(R,"Unbound namespace prefix: "+JSON.stringify(R.tagName)),D.uri=F.prefix);var w=R.tags[R.tags.length-1]||R;D.ns&&w.ns!==D.ns&&Object.keys(D.ns).forEach(function(Me){q(R,"onopennamespace",{prefix:Me,uri:D.ns[Me]})});for(var O=0,P=R.attribList.length;O<P;O++){var B=R.attribList[O],x=B[0],ne=B[1],re=se(x,!0),G=re.prefix,fe=re.local,le=G===""?"":D.ns[G]||"",_e={name:x,value:ne,prefix:G,local:fe,uri:le};G&&G!=="xmlns"&&!le&&(K(R,"Unbound namespace prefix: "+JSON.stringify(G)),_e.uri=G),R.tag.attributes[x]=_e,q(R,"onattribute",_e)}R.attribList.length=0}R.tag.isSelfClosing=!!u,R.sawRoot=!0,R.tags.push(R.tag),q(R,"onopentag",R.tag),u||(!R.noscript&&R.tagName.toLowerCase()==="script"?R.state=b.SCRIPT:R.state=b.TEXT,R.tag=null,R.tagName=""),R.attribName=R.attribValue="",R.attribList.length=0}function Z(R){if(!R.tagName){K(R,"Weird empty close tag."),R.textNode+="</>",R.state=b.TEXT;return}if(R.script){if(R.tagName!=="script"){R.script+="</"+R.tagName+">",R.tagName="",R.state=b.SCRIPT;return}q(R,"onscript",R.script),R.script=""}var u=R.tags.length,D=R.tagName;R.strict||(D=D[R.looseCase]());for(var F=D;u--;){var w=R.tags[u];if(w.name!==F)K(R,"Unexpected close tag");else break}if(u<0){K(R,"Unmatched closing tag: "+R.tagName),R.textNode+="</"+R.tagName+">",R.state=b.TEXT;return}R.tagName=D;for(var O=R.tags.length;O-- >u;){var P=R.tag=R.tags.pop();R.tagName=R.tag.name,q(R,"onclosetag",R.tagName);var B={};for(var x in P.ns)B[x]=P.ns[x];var ne=R.tags[R.tags.length-1]||R;R.opt.xmlns&&P.ns!==ne.ns&&Object.keys(P.ns).forEach(function(re){var G=P.ns[re];q(R,"onclosenamespace",{prefix:re,uri:G})})}u===0&&(R.closedRoot=!0),R.tagName=R.attribValue=R.attribName="",R.attribList.length=0,R.state=b.TEXT}function H(R){var u=R.entity,D=u.toLowerCase(),F,w="";return R.ENTITIES[u]?R.ENTITIES[u]:R.ENTITIES[D]?R.ENTITIES[D]:(u=D,u.charAt(0)==="#"&&(u.charAt(1)==="x"?(u=u.slice(2),F=parseInt(u,16),w=F.toString(16)):(u=u.slice(1),F=parseInt(u,10),w=F.toString(10))),u=u.replace(/^0+/,""),w.toLowerCase()!==u?(K(R,"Invalid character entity"),"&"+R.entity+";"):String.fromCodePoint(F))}function V(R,u){u==="<"?(R.state=b.OPEN_WAKA,R.startTagPosition=R.position):W(C,u)&&(K(R,"Non-whitespace before first tag."),R.textNode=u,R.state=b.TEXT)}function te(R,u){var D="";return u<R.length&&(D=R.charAt(u)),D}function z(R){var u=this;if(this.error)throw this.error;if(u.closed)return $(u,"Cannot write after close. Assign an onready handler.");if(R===null)return ae(u);typeof R=="object"&&(R=R.toString());for(var D=0,F="";F=te(R,D++),u.c=F,!!F;)switch(u.trackPosition&&(u.position++,F===`
`?(u.line++,u.column=0):u.column++),u.state){case b.BEGIN:if(u.state=b.BEGIN_WHITESPACE,F==="\uFEFF")continue;V(u,F);continue;case b.BEGIN_WHITESPACE:V(u,F);continue;case b.TEXT:if(u.sawRoot&&!u.closedRoot){for(var w=D-1;F&&F!=="<"&&F!=="&";)F=te(R,D++),F&&u.trackPosition&&(u.position++,F===`
`?(u.line++,u.column=0):u.column++);u.textNode+=R.substring(w,D-1)}F==="<"&&!(u.sawRoot&&u.closedRoot&&!u.strict)?(u.state=b.OPEN_WAKA,u.startTagPosition=u.position):(W(C,F)&&(!u.sawRoot||u.closedRoot)&&K(u,"Text data outside of root node."),F==="&"?u.state=b.TEXT_ENTITY:u.textNode+=F);continue;case b.SCRIPT:F==="<"?u.state=b.SCRIPT_ENDING:u.script+=F;continue;case b.SCRIPT_ENDING:F==="/"?u.state=b.CLOSE_TAG:(u.script+="<"+F,u.state=b.SCRIPT);continue;case b.OPEN_WAKA:if(F==="!")u.state=b.SGML_DECL,u.sgmlDecl="";else if(!X(C,F))if(X(l,F))u.state=b.OPEN_TAG,u.tagName=F;else if(F==="/")u.state=b.CLOSE_TAG,u.tagName="";else if(F==="?")u.state=b.PROC_INST,u.procInstName=u.procInstBody="";else{if(K(u,"Unencoded <"),u.startTagPosition+1<u.position){var O=u.position-u.startTagPosition;F=new Array(O).join(" ")+F}u.textNode+="<"+F,u.state=b.TEXT}continue;case b.SGML_DECL:(u.sgmlDecl+F).toUpperCase()===m?(q(u,"onopencdata"),u.state=b.CDATA,u.sgmlDecl="",u.cdata=""):u.sgmlDecl+F==="--"?(u.state=b.COMMENT,u.comment="",u.sgmlDecl=""):(u.sgmlDecl+F).toUpperCase()===n?(u.state=b.DOCTYPE,(u.doctype||u.sawRoot)&&K(u,"Inappropriately located doctype declaration"),u.doctype="",u.sgmlDecl=""):F===">"?(q(u,"onsgmldeclaration",u.sgmlDecl),u.sgmlDecl="",u.state=b.TEXT):(X(i,F)&&(u.state=b.SGML_DECL_QUOTED),u.sgmlDecl+=F);continue;case b.SGML_DECL_QUOTED:F===u.q&&(u.state=b.SGML_DECL,u.q=""),u.sgmlDecl+=F;continue;case b.DOCTYPE:F===">"?(u.state=b.TEXT,q(u,"ondoctype",u.doctype),u.doctype=!0):(u.doctype+=F,F==="["?u.state=b.DOCTYPE_DTD:X(i,F)&&(u.state=b.DOCTYPE_QUOTED,u.q=F));continue;case b.DOCTYPE_QUOTED:u.doctype+=F,F===u.q&&(u.q="",u.state=b.DOCTYPE);continue;case b.DOCTYPE_DTD:u.doctype+=F,F==="]"?u.state=b.DOCTYPE:X(i,F)&&(u.state=b.DOCTYPE_DTD_QUOTED,u.q=F);continue;case b.DOCTYPE_DTD_QUOTED:u.doctype+=F,F===u.q&&(u.state=b.DOCTYPE_DTD,u.q="");continue;case b.COMMENT:F==="-"?u.state=b.COMMENT_ENDING:u.comment+=F;continue;case b.COMMENT_ENDING:F==="-"?(u.state=b.COMMENT_ENDED,u.comment=J(u.opt,u.comment),u.comment&&q(u,"oncomment",u.comment),u.comment=""):(u.comment+="-"+F,u.state=b.COMMENT);continue;case b.COMMENT_ENDED:F!==">"?(K(u,"Malformed comment"),u.comment+="--"+F,u.state=b.COMMENT):u.state=b.TEXT;continue;case b.CDATA:F==="]"?u.state=b.CDATA_ENDING:u.cdata+=F;continue;case b.CDATA_ENDING:F==="]"?u.state=b.CDATA_ENDING_2:(u.cdata+="]"+F,u.state=b.CDATA);continue;case b.CDATA_ENDING_2:F===">"?(u.cdata&&q(u,"oncdata",u.cdata),q(u,"onclosecdata"),u.cdata="",u.state=b.TEXT):F==="]"?u.cdata+="]":(u.cdata+="]]"+F,u.state=b.CDATA);continue;case b.PROC_INST:F==="?"?u.state=b.PROC_INST_ENDING:X(C,F)?u.state=b.PROC_INST_BODY:u.procInstName+=F;continue;case b.PROC_INST_BODY:if(!u.procInstBody&&X(C,F))continue;F==="?"?u.state=b.PROC_INST_ENDING:u.procInstBody+=F;continue;case b.PROC_INST_ENDING:F===">"?(q(u,"onprocessinginstruction",{name:u.procInstName,body:u.procInstBody}),u.procInstName=u.procInstBody="",u.state=b.TEXT):(u.procInstBody+="?"+F,u.state=b.PROC_INST_BODY);continue;case b.OPEN_TAG:X(A,F)?u.tagName+=F:(ee(u),F===">"?oe(u):F==="/"?u.state=b.OPEN_TAG_SLASH:(W(C,F)&&K(u,"Invalid character in tag name"),u.state=b.ATTRIB));continue;case b.OPEN_TAG_SLASH:F===">"?(oe(u,!0),Z(u)):(K(u,"Forward-slash in opening tag not followed by >"),u.state=b.ATTRIB);continue;case b.ATTRIB:if(X(C,F))continue;F===">"?oe(u):F==="/"?u.state=b.OPEN_TAG_SLASH:X(l,F)?(u.attribName=F,u.attribValue="",u.state=b.ATTRIB_NAME):K(u,"Invalid attribute name");continue;case b.ATTRIB_NAME:F==="="?u.state=b.ATTRIB_VALUE:F===">"?(K(u,"Attribute without value"),u.attribValue=u.attribName,ue(u),oe(u)):X(C,F)?u.state=b.ATTRIB_NAME_SAW_WHITE:X(A,F)?u.attribName+=F:K(u,"Invalid attribute name");continue;case b.ATTRIB_NAME_SAW_WHITE:if(F==="=")u.state=b.ATTRIB_VALUE;else{if(X(C,F))continue;K(u,"Attribute without value"),u.tag.attributes[u.attribName]="",u.attribValue="",q(u,"onattribute",{name:u.attribName,value:""}),u.attribName="",F===">"?oe(u):X(l,F)?(u.attribName=F,u.state=b.ATTRIB_NAME):(K(u,"Invalid attribute name"),u.state=b.ATTRIB)}continue;case b.ATTRIB_VALUE:if(X(C,F))continue;X(i,F)?(u.q=F,u.state=b.ATTRIB_VALUE_QUOTED):(K(u,"Unquoted attribute value"),u.state=b.ATTRIB_VALUE_UNQUOTED,u.attribValue=F);continue;case b.ATTRIB_VALUE_QUOTED:if(F!==u.q){F==="&"?u.state=b.ATTRIB_VALUE_ENTITY_Q:u.attribValue+=F;continue}ue(u),u.q="",u.state=b.ATTRIB_VALUE_CLOSED;continue;case b.ATTRIB_VALUE_CLOSED:X(C,F)?u.state=b.ATTRIB:F===">"?oe(u):F==="/"?u.state=b.OPEN_TAG_SLASH:X(l,F)?(K(u,"No whitespace between attributes"),u.attribName=F,u.attribValue="",u.state=b.ATTRIB_NAME):K(u,"Invalid attribute name");continue;case b.ATTRIB_VALUE_UNQUOTED:if(W(t,F)){F==="&"?u.state=b.ATTRIB_VALUE_ENTITY_U:u.attribValue+=F;continue}ue(u),F===">"?oe(u):u.state=b.ATTRIB;continue;case b.CLOSE_TAG:if(u.tagName)F===">"?Z(u):X(A,F)?u.tagName+=F:u.script?(u.script+="</"+u.tagName,u.tagName="",u.state=b.SCRIPT):(W(C,F)&&K(u,"Invalid tagname in closing tag"),u.state=b.CLOSE_TAG_SAW_WHITE);else{if(X(C,F))continue;W(l,F)?u.script?(u.script+="</"+F,u.state=b.SCRIPT):K(u,"Invalid tagname in closing tag."):u.tagName=F}continue;case b.CLOSE_TAG_SAW_WHITE:if(X(C,F))continue;F===">"?Z(u):K(u,"Invalid characters in closing tag");continue;case b.TEXT_ENTITY:case b.ATTRIB_VALUE_ENTITY_Q:case b.ATTRIB_VALUE_ENTITY_U:var P,B;switch(u.state){case b.TEXT_ENTITY:P=b.TEXT,B="textNode";break;case b.ATTRIB_VALUE_ENTITY_Q:P=b.ATTRIB_VALUE_QUOTED,B="attribValue";break;case b.ATTRIB_VALUE_ENTITY_U:P=b.ATTRIB_VALUE_UNQUOTED,B="attribValue";break}F===";"?(u[B]+=H(u),u.entity="",u.state=P):X(u.entity.length?L:S,F)?u.entity+=F:(K(u,"Invalid character in entity name"),u[B]+="&"+u.entity+F,u.entity="",u.state=P);continue;default:throw new Error(u,"Unknown state: "+u.state)}return u.position>=u.bufferCheckPosition&&f(u),u}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var R=String.fromCharCode,u=Math.floor,D=function(){var F=16384,w=[],O,P,B=-1,x=arguments.length;if(!x)return"";for(var ne="";++B<x;){var re=Number(arguments[B]);if(!isFinite(re)||re<0||re>1114111||u(re)!==re)throw RangeError("Invalid code point: "+re);re<=65535?w.push(re):(re-=65536,O=(re>>10)+55296,P=re%1024+56320,w.push(O,P)),(B+1===x||w.length>F)&&(ne+=R.apply(null,w),w.length=0)}return ne};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:D,configurable:!0,writable:!0}):String.fromCodePoint=D}()})(N)},"./node_modules/stream-browserify/index.js":(ce,N,e)=>{ce.exports=d;var I=e("./node_modules/events/events.js").EventEmitter,g=e("./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js");g(d,I),d.Readable=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_readable.js"),d.Writable=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_writable.js"),d.Duplex=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js"),d.Transform=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_transform.js"),d.PassThrough=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_passthrough.js"),d.finished=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/end-of-stream.js"),d.pipeline=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/pipeline.js"),d.Stream=d;function d(){I.call(this)}d.prototype.pipe=function(f,y){var _=this;function r(i){f.writable&&f.write(i)===!1&&_.pause&&_.pause()}_.on("data",r);function T(){_.readable&&_.resume&&_.resume()}f.on("drain",T),!f._isStdio&&(!y||y.end!==!1)&&(_.on("end",p),_.on("close",C));var M=!1;function p(){M||(M=!0,f.end())}function C(){M||(M=!0,typeof f.destroy=="function"&&f.destroy())}function v(i){if(E(),I.listenerCount(this,"error")===0)throw i}_.on("error",v),f.on("error",v);function E(){_.removeListener("data",r),f.removeListener("drain",T),_.removeListener("end",p),_.removeListener("close",C),_.removeListener("error",v),f.removeListener("error",v),_.removeListener("end",E),_.removeListener("close",E),f.removeListener("close",E)}return _.on("end",E),_.on("close",E),f.on("close",E),f.emit("pipe",_),f}},"./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js":ce=>{typeof Object.create=="function"?ce.exports=function(e,I){I&&(e.super_=I,e.prototype=Object.create(I.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:ce.exports=function(e,I){if(I){e.super_=I;var g=function(){};g.prototype=I.prototype,e.prototype=new g,e.prototype.constructor=e}}},"./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js":ce=>{function N(_,r){_.prototype=Object.create(r.prototype),_.prototype.constructor=_,_.__proto__=r}var e={};function I(_,r,T){T||(T=Error);function M(C,v,E){return typeof r=="string"?r:r(C,v,E)}var p=function(C){N(v,C);function v(E,i,t){return C.call(this,M(E,i,t))||this}return v}(T);p.prototype.name=T.name,p.prototype.code=_,e[_]=p}function g(_,r){if(Array.isArray(_)){var T=_.length;return _=_.map(function(M){return String(M)}),T>2?"one of ".concat(r," ").concat(_.slice(0,T-1).join(", "),", or ")+_[T-1]:T===2?"one of ".concat(r," ").concat(_[0]," or ").concat(_[1]):"of ".concat(r," ").concat(_[0])}else return"of ".concat(r," ").concat(String(_))}function d(_,r,T){return _.substr(!T||T<0?0:+T,r.length)===r}function f(_,r,T){return(T===void 0||T>_.length)&&(T=_.length),_.substring(T-r.length,T)===r}function y(_,r,T){return typeof T!="number"&&(T=0),T+r.length>_.length?!1:_.indexOf(r,T)!==-1}I("ERR_INVALID_OPT_VALUE",function(_,r){return'The value "'+r+'" is invalid for option "'+_+'"'},TypeError),I("ERR_INVALID_ARG_TYPE",function(_,r,T){var M;typeof r=="string"&&d(r,"not ")?(M="must not be",r=r.replace(/^not /,"")):M="must be";var p;if(f(_," argument"))p="The ".concat(_," ").concat(M," ").concat(g(r,"type"));else{var C=y(_,".")?"property":"argument";p='The "'.concat(_,'" ').concat(C," ").concat(M," ").concat(g(r,"type"))}return p+=". Received type ".concat(typeof T),p},TypeError),I("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),I("ERR_METHOD_NOT_IMPLEMENTED",function(_){return"The "+_+" method is not implemented"}),I("ERR_STREAM_PREMATURE_CLOSE","Premature close"),I("ERR_STREAM_DESTROYED",function(_){return"Cannot call "+_+" after a stream was destroyed"}),I("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),I("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),I("ERR_STREAM_WRITE_AFTER_END","write after end"),I("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),I("ERR_UNKNOWN_ENCODING",function(_){return"Unknown encoding: "+_},TypeError),I("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),ce.exports.codes=e},"./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js":(ce,N,e)=>{var I=Object.keys||function(p){var C=[];for(var v in p)C.push(v);return C};ce.exports=r;var g=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_readable.js"),d=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_writable.js");e("./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js")(r,g);for(var f=I(d.prototype),y=0;y<f.length;y++){var _=f[y];r.prototype[_]||(r.prototype[_]=d.prototype[_])}function r(p){if(!(this instanceof r))return new r(p);g.call(this,p),d.call(this,p),this.allowHalfOpen=!0,p&&(p.readable===!1&&(this.readable=!1),p.writable===!1&&(this.writable=!1),p.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",T)))}Object.defineProperty(r.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(r.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(r.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function T(){this._writableState.ended||process.nextTick(M,this)}function M(p){p.end()}Object.defineProperty(r.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(C){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=C,this._writableState.destroyed=C)}})},"./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_passthrough.js":(ce,N,e)=>{ce.exports=g;var I=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_transform.js");e("./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js")(g,I);function g(d){if(!(this instanceof g))return new g(d);I.call(this,d)}g.prototype._transform=function(d,f,y){y(null,d)}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_readable.js":(ce,N,e)=>{ce.exports=k;var I;k.ReadableState=U,e("./node_modules/events/events.js").EventEmitter;var g=function(D,F){return D.listeners(F).length},d=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/stream-browser.js"),f=e("./node_modules/buffer/index.js").Buffer,y=e.g.Uint8Array||function(){};function _(u){return f.from(u)}function r(u){return f.isBuffer(u)||u instanceof y}var T=e("?19e6"),M;T&&T.debuglog?M=T.debuglog("stream"):M=function(){};var p=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/buffer_list.js"),C=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/destroy.js"),v=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/state.js"),E=v.getHighWaterMark,i=e("./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js").codes,t=i.ERR_INVALID_ARG_TYPE,m=i.ERR_STREAM_PUSH_AFTER_EOF,n=i.ERR_METHOD_NOT_IMPLEMENTED,h=i.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,c,o,l;e("./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js")(k,d);var A=C.errorOrDestroy,S=["error","close","destroy","pause","resume"];function L(u,D,F){if(typeof u.prependListener=="function")return u.prependListener(D,F);!u._events||!u._events[D]?u.on(D,F):Array.isArray(u._events[D])?u._events[D].unshift(F):u._events[D]=[F,u._events[D]]}function U(u,D,F){I=I||e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js"),u=u||{},typeof F!="boolean"&&(F=D instanceof I),this.objectMode=!!u.objectMode,F&&(this.objectMode=this.objectMode||!!u.readableObjectMode),this.highWaterMark=E(this,u,"readableHighWaterMark",F),this.buffer=new p,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=u.emitClose!==!1,this.autoDestroy=!!u.autoDestroy,this.destroyed=!1,this.defaultEncoding=u.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,u.encoding&&(c||(c=e("./node_modules/string_decoder/lib/string_decoder.js").StringDecoder),this.decoder=new c(u.encoding),this.encoding=u.encoding)}function k(u){if(I=I||e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js"),!(this instanceof k))return new k(u);var D=this instanceof I;this._readableState=new U(u,this,D),this.readable=!0,u&&(typeof u.read=="function"&&(this._read=u.read),typeof u.destroy=="function"&&(this._destroy=u.destroy)),d.call(this)}Object.defineProperty(k.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(D){this._readableState&&(this._readableState.destroyed=D)}}),k.prototype.destroy=C.destroy,k.prototype._undestroy=C.undestroy,k.prototype._destroy=function(u,D){D(u)},k.prototype.push=function(u,D){var F=this._readableState,w;return F.objectMode?w=!0:typeof u=="string"&&(D=D||F.defaultEncoding,D!==F.encoding&&(u=f.from(u,D),D=""),w=!0),X(this,u,D,!1,w)},k.prototype.unshift=function(u){return X(this,u,null,!0,!1)};function X(u,D,F,w,O){M("readableAddChunk",D);var P=u._readableState;if(D===null)P.reading=!1,Y(u,P);else{var B;if(O||(B=b(P,D)),B)A(u,B);else if(P.objectMode||D&&D.length>0)if(typeof D!="string"&&!P.objectMode&&Object.getPrototypeOf(D)!==f.prototype&&(D=_(D)),w)P.endEmitted?A(u,new h):W(u,P,D,!0);else if(P.ended)A(u,new m);else{if(P.destroyed)return!1;P.reading=!1,P.decoder&&!F?(D=P.decoder.write(D),P.objectMode||D.length!==0?W(u,P,D,!1):ae(u,P)):W(u,P,D,!1)}else w||(P.reading=!1,ae(u,P))}return!P.ended&&(P.length<P.highWaterMark||P.length===0)}function W(u,D,F,w){D.flowing&&D.length===0&&!D.sync?(D.awaitDrain=0,u.emit("data",F)):(D.length+=D.objectMode?1:F.length,w?D.buffer.unshift(F):D.buffer.push(F),D.needReadable&&J(u)),ae(u,D)}function b(u,D){var F;return!r(D)&&typeof D!="string"&&D!==void 0&&!u.objectMode&&(F=new t("chunk",["string","Buffer","Uint8Array"],D)),F}k.prototype.isPaused=function(){return this._readableState.flowing===!1},k.prototype.setEncoding=function(u){c||(c=e("./node_modules/string_decoder/lib/string_decoder.js").StringDecoder);var D=new c(u);this._readableState.decoder=D,this._readableState.encoding=this._readableState.decoder.encoding;for(var F=this._readableState.buffer.head,w="";F!==null;)w+=D.write(F.data),F=F.next;return this._readableState.buffer.clear(),w!==""&&this._readableState.buffer.push(w),this._readableState.length=w.length,this};var j=1073741824;function Q(u){return u>=j?u=j:(u--,u|=u>>>1,u|=u>>>2,u|=u>>>4,u|=u>>>8,u|=u>>>16,u++),u}function q(u,D){return u<=0||D.length===0&&D.ended?0:D.objectMode?1:u!==u?D.flowing&&D.length?D.buffer.head.data.length:D.length:(u>D.highWaterMark&&(D.highWaterMark=Q(u)),u<=D.length?u:D.ended?D.length:(D.needReadable=!0,0))}k.prototype.read=function(u){M("read",u),u=parseInt(u,10);var D=this._readableState,F=u;if(u!==0&&(D.emittedReadable=!1),u===0&&D.needReadable&&((D.highWaterMark!==0?D.length>=D.highWaterMark:D.length>0)||D.ended))return M("read: emitReadable",D.length,D.ended),D.length===0&&D.ended?te(this):J(this),null;if(u=q(u,D),u===0&&D.ended)return D.length===0&&te(this),null;var w=D.needReadable;M("need readable",w),(D.length===0||D.length-u<D.highWaterMark)&&(w=!0,M("length less than watermark",w)),D.ended||D.reading?(w=!1,M("reading or ended",w)):w&&(M("do read"),D.reading=!0,D.sync=!0,D.length===0&&(D.needReadable=!0),this._read(D.highWaterMark),D.sync=!1,D.reading||(u=q(F,D)));var O;return u>0?O=V(u,D):O=null,O===null?(D.needReadable=D.length<=D.highWaterMark,u=0):(D.length-=u,D.awaitDrain=0),D.length===0&&(D.ended||(D.needReadable=!0),F!==u&&D.ended&&te(this)),O!==null&&this.emit("data",O),O};function Y(u,D){if(M("onEofChunk"),!D.ended){if(D.decoder){var F=D.decoder.end();F&&F.length&&(D.buffer.push(F),D.length+=D.objectMode?1:F.length)}D.ended=!0,D.sync?J(u):(D.needReadable=!1,D.emittedReadable||(D.emittedReadable=!0,$(u)))}}function J(u){var D=u._readableState;M("emitReadable",D.needReadable,D.emittedReadable),D.needReadable=!1,D.emittedReadable||(M("emitReadable",D.flowing),D.emittedReadable=!0,process.nextTick($,u))}function $(u){var D=u._readableState;M("emitReadable_",D.destroyed,D.length,D.ended),!D.destroyed&&(D.length||D.ended)&&(u.emit("readable"),D.emittedReadable=!1),D.needReadable=!D.flowing&&!D.ended&&D.length<=D.highWaterMark,H(u)}function ae(u,D){D.readingMore||(D.readingMore=!0,process.nextTick(K,u,D))}function K(u,D){for(;!D.reading&&!D.ended&&(D.length<D.highWaterMark||D.flowing&&D.length===0);){var F=D.length;if(M("maybeReadMore read 0"),u.read(0),F===D.length)break}D.readingMore=!1}k.prototype._read=function(u){A(this,new n("_read()"))},k.prototype.pipe=function(u,D){var F=this,w=this._readableState;switch(w.pipesCount){case 0:w.pipes=u;break;case 1:w.pipes=[w.pipes,u];break;default:w.pipes.push(u);break}w.pipesCount+=1,M("pipe count=%d opts=%j",w.pipesCount,D);var O=(!D||D.end!==!1)&&u!==process.stdout&&u!==process.stderr,P=O?x:Oe;w.endEmitted?process.nextTick(P):F.once("end",P),u.on("unpipe",B);function B(Ne,xe){M("onunpipe"),Ne===F&&xe&&xe.hasUnpiped===!1&&(xe.hasUnpiped=!0,G())}function x(){M("onend"),u.end()}var ne=ee(F);u.on("drain",ne);var re=!1;function G(){M("cleanup"),u.removeListener("close",_e),u.removeListener("finish",Me),u.removeListener("drain",ne),u.removeListener("error",le),u.removeListener("unpipe",B),F.removeListener("end",x),F.removeListener("end",Oe),F.removeListener("data",fe),re=!0,w.awaitDrain&&(!u._writableState||u._writableState.needDrain)&&ne()}F.on("data",fe);function fe(Ne){M("ondata");var xe=u.write(Ne);M("dest.write",xe),xe===!1&&((w.pipesCount===1&&w.pipes===u||w.pipesCount>1&&R(w.pipes,u)!==-1)&&!re&&(M("false write response, pause",w.awaitDrain),w.awaitDrain++),F.pause())}function le(Ne){M("onerror",Ne),Oe(),u.removeListener("error",le),g(u,"error")===0&&A(u,Ne)}L(u,"error",le);function _e(){u.removeListener("finish",Me),Oe()}u.once("close",_e);function Me(){M("onfinish"),u.removeListener("close",_e),Oe()}u.once("finish",Me);function Oe(){M("unpipe"),F.unpipe(u)}return u.emit("pipe",F),w.flowing||(M("pipe resume"),F.resume()),u};function ee(u){return function(){var F=u._readableState;M("pipeOnDrain",F.awaitDrain),F.awaitDrain&&F.awaitDrain--,F.awaitDrain===0&&g(u,"data")&&(F.flowing=!0,H(u))}}k.prototype.unpipe=function(u){var D=this._readableState,F={hasUnpiped:!1};if(D.pipesCount===0)return this;if(D.pipesCount===1)return u&&u!==D.pipes?this:(u||(u=D.pipes),D.pipes=null,D.pipesCount=0,D.flowing=!1,u&&u.emit("unpipe",this,F),this);if(!u){var w=D.pipes,O=D.pipesCount;D.pipes=null,D.pipesCount=0,D.flowing=!1;for(var P=0;P<O;P++)w[P].emit("unpipe",this,{hasUnpiped:!1});return this}var B=R(D.pipes,u);return B===-1?this:(D.pipes.splice(B,1),D.pipesCount-=1,D.pipesCount===1&&(D.pipes=D.pipes[0]),u.emit("unpipe",this,F),this)},k.prototype.on=function(u,D){var F=d.prototype.on.call(this,u,D),w=this._readableState;return u==="data"?(w.readableListening=this.listenerCount("readable")>0,w.flowing!==!1&&this.resume()):u==="readable"&&!w.endEmitted&&!w.readableListening&&(w.readableListening=w.needReadable=!0,w.flowing=!1,w.emittedReadable=!1,M("on readable",w.length,w.reading),w.length?J(this):w.reading||process.nextTick(ue,this)),F},k.prototype.addListener=k.prototype.on,k.prototype.removeListener=function(u,D){var F=d.prototype.removeListener.call(this,u,D);return u==="readable"&&process.nextTick(se,this),F},k.prototype.removeAllListeners=function(u){var D=d.prototype.removeAllListeners.apply(this,arguments);return(u==="readable"||u===void 0)&&process.nextTick(se,this),D};function se(u){var D=u._readableState;D.readableListening=u.listenerCount("readable")>0,D.resumeScheduled&&!D.paused?D.flowing=!0:u.listenerCount("data")>0&&u.resume()}function ue(u){M("readable nexttick read 0"),u.read(0)}k.prototype.resume=function(){var u=this._readableState;return u.flowing||(M("resume"),u.flowing=!u.readableListening,oe(this,u)),u.paused=!1,this};function oe(u,D){D.resumeScheduled||(D.resumeScheduled=!0,process.nextTick(Z,u,D))}function Z(u,D){M("resume",D.reading),D.reading||u.read(0),D.resumeScheduled=!1,u.emit("resume"),H(u),D.flowing&&!D.reading&&u.read(0)}k.prototype.pause=function(){return M("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(M("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function H(u){var D=u._readableState;for(M("flow",D.flowing);D.flowing&&u.read()!==null;);}k.prototype.wrap=function(u){var D=this,F=this._readableState,w=!1;u.on("end",function(){if(M("wrapped end"),F.decoder&&!F.ended){var B=F.decoder.end();B&&B.length&&D.push(B)}D.push(null)}),u.on("data",function(B){if(M("wrapped data"),F.decoder&&(B=F.decoder.write(B)),!(F.objectMode&&B==null)&&!(!F.objectMode&&(!B||!B.length))){var x=D.push(B);x||(w=!0,u.pause())}});for(var O in u)this[O]===void 0&&typeof u[O]=="function"&&(this[O]=function(x){return function(){return u[x].apply(u,arguments)}}(O));for(var P=0;P<S.length;P++)u.on(S[P],this.emit.bind(this,S[P]));return this._read=function(B){M("wrapped _read",B),w&&(w=!1,u.resume())},this},typeof Symbol=="function"&&(k.prototype[Symbol.asyncIterator]=function(){return o===void 0&&(o=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/async_iterator.js")),o(this)}),Object.defineProperty(k.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(k.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(k.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(D){this._readableState&&(this._readableState.flowing=D)}}),k._fromList=V,Object.defineProperty(k.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function V(u,D){if(D.length===0)return null;var F;return D.objectMode?F=D.buffer.shift():!u||u>=D.length?(D.decoder?F=D.buffer.join(""):D.buffer.length===1?F=D.buffer.first():F=D.buffer.concat(D.length),D.buffer.clear()):F=D.buffer.consume(u,D.decoder),F}function te(u){var D=u._readableState;M("endReadable",D.endEmitted),D.endEmitted||(D.ended=!0,process.nextTick(z,D,u))}function z(u,D){if(M("endReadableNT",u.endEmitted,u.length),!u.endEmitted&&u.length===0&&(u.endEmitted=!0,D.readable=!1,D.emit("end"),u.autoDestroy)){var F=D._writableState;(!F||F.autoDestroy&&F.finished)&&D.destroy()}}typeof Symbol=="function"&&(k.from=function(u,D){return l===void 0&&(l=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/from-browser.js")),l(k,u,D)});function R(u,D){for(var F=0,w=u.length;F<w;F++)if(u[F]===D)return F;return-1}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_transform.js":(ce,N,e)=>{ce.exports=T;var I=e("./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js").codes,g=I.ERR_METHOD_NOT_IMPLEMENTED,d=I.ERR_MULTIPLE_CALLBACK,f=I.ERR_TRANSFORM_ALREADY_TRANSFORMING,y=I.ERR_TRANSFORM_WITH_LENGTH_0,_=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js");e("./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js")(T,_);function r(C,v){var E=this._transformState;E.transforming=!1;var i=E.writecb;if(i===null)return this.emit("error",new d);E.writechunk=null,E.writecb=null,v!=null&&this.push(v),i(C);var t=this._readableState;t.reading=!1,(t.needReadable||t.length<t.highWaterMark)&&this._read(t.highWaterMark)}function T(C){if(!(this instanceof T))return new T(C);_.call(this,C),this._transformState={afterTransform:r.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,C&&(typeof C.transform=="function"&&(this._transform=C.transform),typeof C.flush=="function"&&(this._flush=C.flush)),this.on("prefinish",M)}function M(){var C=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(v,E){p(C,v,E)}):p(this,null,null)}T.prototype.push=function(C,v){return this._transformState.needTransform=!1,_.prototype.push.call(this,C,v)},T.prototype._transform=function(C,v,E){E(new g("_transform()"))},T.prototype._write=function(C,v,E){var i=this._transformState;if(i.writecb=E,i.writechunk=C,i.writeencoding=v,!i.transforming){var t=this._readableState;(i.needTransform||t.needReadable||t.length<t.highWaterMark)&&this._read(t.highWaterMark)}},T.prototype._read=function(C){var v=this._transformState;v.writechunk!==null&&!v.transforming?(v.transforming=!0,this._transform(v.writechunk,v.writeencoding,v.afterTransform)):v.needTransform=!0},T.prototype._destroy=function(C,v){_.prototype._destroy.call(this,C,function(E){v(E)})};function p(C,v,E){if(v)return C.emit("error",v);if(E!=null&&C.push(E),C._writableState.length)throw new y;if(C._transformState.transforming)throw new f;return C.push(null)}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_writable.js":(ce,N,e)=>{ce.exports=U;function I(H){var V=this;this.next=null,this.entry=null,this.finish=function(){Z(V,H)}}var g;U.WritableState=S;var d={deprecate:e("./node_modules/util-deprecate/browser.js")},f=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/stream-browser.js"),y=e("./node_modules/buffer/index.js").Buffer,_=e.g.Uint8Array||function(){};function r(H){return y.from(H)}function T(H){return y.isBuffer(H)||H instanceof _}var M=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/destroy.js"),p=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/state.js"),C=p.getHighWaterMark,v=e("./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js").codes,E=v.ERR_INVALID_ARG_TYPE,i=v.ERR_METHOD_NOT_IMPLEMENTED,t=v.ERR_MULTIPLE_CALLBACK,m=v.ERR_STREAM_CANNOT_PIPE,n=v.ERR_STREAM_DESTROYED,h=v.ERR_STREAM_NULL_VALUES,c=v.ERR_STREAM_WRITE_AFTER_END,o=v.ERR_UNKNOWN_ENCODING,l=M.errorOrDestroy;e("./node_modules/stream-browserify/node_modules/inherits/inherits_browser.js")(U,f);function A(){}function S(H,V,te){g=g||e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js"),H=H||{},typeof te!="boolean"&&(te=V instanceof g),this.objectMode=!!H.objectMode,te&&(this.objectMode=this.objectMode||!!H.writableObjectMode),this.highWaterMark=C(this,H,"writableHighWaterMark",te),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var z=H.decodeStrings===!1;this.decodeStrings=!z,this.defaultEncoding=H.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(R){Y(V,R)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=H.emitClose!==!1,this.autoDestroy=!!H.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new I(this)}S.prototype.getBuffer=function(){for(var V=this.bufferedRequest,te=[];V;)te.push(V),V=V.next;return te},function(){try{Object.defineProperty(S.prototype,"buffer",{get:d.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var L;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(L=Function.prototype[Symbol.hasInstance],Object.defineProperty(U,Symbol.hasInstance,{value:function(V){return L.call(this,V)?!0:this!==U?!1:V&&V._writableState instanceof S}})):L=function(V){return V instanceof this};function U(H){g=g||e("./node_modules/stream-browserify/node_modules/readable-stream/lib/_stream_duplex.js");var V=this instanceof g;if(!V&&!L.call(U,this))return new U(H);this._writableState=new S(H,this,V),this.writable=!0,H&&(typeof H.write=="function"&&(this._write=H.write),typeof H.writev=="function"&&(this._writev=H.writev),typeof H.destroy=="function"&&(this._destroy=H.destroy),typeof H.final=="function"&&(this._final=H.final)),f.call(this)}U.prototype.pipe=function(){l(this,new m)};function k(H,V){var te=new c;l(H,te),process.nextTick(V,te)}function X(H,V,te,z){var R;return te===null?R=new h:typeof te!="string"&&!V.objectMode&&(R=new E("chunk",["string","Buffer"],te)),R?(l(H,R),process.nextTick(z,R),!1):!0}U.prototype.write=function(H,V,te){var z=this._writableState,R=!1,u=!z.objectMode&&T(H);return u&&!y.isBuffer(H)&&(H=r(H)),typeof V=="function"&&(te=V,V=null),u?V="buffer":V||(V=z.defaultEncoding),typeof te!="function"&&(te=A),z.ending?k(this,te):(u||X(this,z,H,te))&&(z.pendingcb++,R=b(this,z,u,H,V,te)),R},U.prototype.cork=function(){this._writableState.corked++},U.prototype.uncork=function(){var H=this._writableState;H.corked&&(H.corked--,!H.writing&&!H.corked&&!H.bufferProcessing&&H.bufferedRequest&&ae(this,H))},U.prototype.setDefaultEncoding=function(V){if(typeof V=="string"&&(V=V.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((V+"").toLowerCase())>-1))throw new o(V);return this._writableState.defaultEncoding=V,this},Object.defineProperty(U.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function W(H,V,te){return!H.objectMode&&H.decodeStrings!==!1&&typeof V=="string"&&(V=y.from(V,te)),V}Object.defineProperty(U.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function b(H,V,te,z,R,u){if(!te){var D=W(V,z,R);z!==D&&(te=!0,R="buffer",z=D)}var F=V.objectMode?1:z.length;V.length+=F;var w=V.length<V.highWaterMark;if(w||(V.needDrain=!0),V.writing||V.corked){var O=V.lastBufferedRequest;V.lastBufferedRequest={chunk:z,encoding:R,isBuf:te,callback:u,next:null},O?O.next=V.lastBufferedRequest:V.bufferedRequest=V.lastBufferedRequest,V.bufferedRequestCount+=1}else j(H,V,!1,F,z,R,u);return w}function j(H,V,te,z,R,u,D){V.writelen=z,V.writecb=D,V.writing=!0,V.sync=!0,V.destroyed?V.onwrite(new n("write")):te?H._writev(R,V.onwrite):H._write(R,u,V.onwrite),V.sync=!1}function Q(H,V,te,z,R){--V.pendingcb,te?(process.nextTick(R,z),process.nextTick(ue,H,V),H._writableState.errorEmitted=!0,l(H,z)):(R(z),H._writableState.errorEmitted=!0,l(H,z),ue(H,V))}function q(H){H.writing=!1,H.writecb=null,H.length-=H.writelen,H.writelen=0}function Y(H,V){var te=H._writableState,z=te.sync,R=te.writecb;if(typeof R!="function")throw new t;if(q(te),V)Q(H,te,z,V,R);else{var u=K(te)||H.destroyed;!u&&!te.corked&&!te.bufferProcessing&&te.bufferedRequest&&ae(H,te),z?process.nextTick(J,H,te,u,R):J(H,te,u,R)}}function J(H,V,te,z){te||$(H,V),V.pendingcb--,z(),ue(H,V)}function $(H,V){V.length===0&&V.needDrain&&(V.needDrain=!1,H.emit("drain"))}function ae(H,V){V.bufferProcessing=!0;var te=V.bufferedRequest;if(H._writev&&te&&te.next){var z=V.bufferedRequestCount,R=new Array(z),u=V.corkedRequestsFree;u.entry=te;for(var D=0,F=!0;te;)R[D]=te,te.isBuf||(F=!1),te=te.next,D+=1;R.allBuffers=F,j(H,V,!0,V.length,R,"",u.finish),V.pendingcb++,V.lastBufferedRequest=null,u.next?(V.corkedRequestsFree=u.next,u.next=null):V.corkedRequestsFree=new I(V),V.bufferedRequestCount=0}else{for(;te;){var w=te.chunk,O=te.encoding,P=te.callback,B=V.objectMode?1:w.length;if(j(H,V,!1,B,w,O,P),te=te.next,V.bufferedRequestCount--,V.writing)break}te===null&&(V.lastBufferedRequest=null)}V.bufferedRequest=te,V.bufferProcessing=!1}U.prototype._write=function(H,V,te){te(new i("_write()"))},U.prototype._writev=null,U.prototype.end=function(H,V,te){var z=this._writableState;return typeof H=="function"?(te=H,H=null,V=null):typeof V=="function"&&(te=V,V=null),H!=null&&this.write(H,V),z.corked&&(z.corked=1,this.uncork()),z.ending||oe(this,z,te),this},Object.defineProperty(U.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function K(H){return H.ending&&H.length===0&&H.bufferedRequest===null&&!H.finished&&!H.writing}function ee(H,V){H._final(function(te){V.pendingcb--,te&&l(H,te),V.prefinished=!0,H.emit("prefinish"),ue(H,V)})}function se(H,V){!V.prefinished&&!V.finalCalled&&(typeof H._final=="function"&&!V.destroyed?(V.pendingcb++,V.finalCalled=!0,process.nextTick(ee,H,V)):(V.prefinished=!0,H.emit("prefinish")))}function ue(H,V){var te=K(V);if(te&&(se(H,V),V.pendingcb===0&&(V.finished=!0,H.emit("finish"),V.autoDestroy))){var z=H._readableState;(!z||z.autoDestroy&&z.endEmitted)&&H.destroy()}return te}function oe(H,V,te){V.ending=!0,ue(H,V),te&&(V.finished?process.nextTick(te):H.once("finish",te)),V.ended=!0,H.writable=!1}function Z(H,V,te){var z=H.entry;for(H.entry=null;z;){var R=z.callback;V.pendingcb--,R(te),z=z.next}V.corkedRequestsFree.next=H}Object.defineProperty(U.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(V){this._writableState&&(this._writableState.destroyed=V)}}),U.prototype.destroy=M.destroy,U.prototype._undestroy=M.undestroy,U.prototype._destroy=function(H,V){V(H)}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/async_iterator.js":(ce,N,e)=>{var I;function g(h,c,o){return c in h?Object.defineProperty(h,c,{value:o,enumerable:!0,configurable:!0,writable:!0}):h[c]=o,h}var d=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/end-of-stream.js"),f=Symbol("lastResolve"),y=Symbol("lastReject"),_=Symbol("error"),r=Symbol("ended"),T=Symbol("lastPromise"),M=Symbol("handlePromise"),p=Symbol("stream");function C(h,c){return{value:h,done:c}}function v(h){var c=h[f];if(c!==null){var o=h[p].read();o!==null&&(h[T]=null,h[f]=null,h[y]=null,c(C(o,!1)))}}function E(h){process.nextTick(v,h)}function i(h,c){return function(o,l){h.then(function(){if(c[r]){o(C(void 0,!0));return}c[M](o,l)},l)}}var t=Object.getPrototypeOf(function(){}),m=Object.setPrototypeOf((I={get stream(){return this[p]},next:function(){var c=this,o=this[_];if(o!==null)return Promise.reject(o);if(this[r])return Promise.resolve(C(void 0,!0));if(this[p].destroyed)return new Promise(function(L,U){process.nextTick(function(){c[_]?U(c[_]):L(C(void 0,!0))})});var l=this[T],A;if(l)A=new Promise(i(l,this));else{var S=this[p].read();if(S!==null)return Promise.resolve(C(S,!1));A=new Promise(this[M])}return this[T]=A,A}},g(I,Symbol.asyncIterator,function(){return this}),g(I,"return",function(){var c=this;return new Promise(function(o,l){c[p].destroy(null,function(A){if(A){l(A);return}o(C(void 0,!0))})})}),I),t),n=function(c){var o,l=Object.create(m,(o={},g(o,p,{value:c,writable:!0}),g(o,f,{value:null,writable:!0}),g(o,y,{value:null,writable:!0}),g(o,_,{value:null,writable:!0}),g(o,r,{value:c._readableState.endEmitted,writable:!0}),g(o,M,{value:function(S,L){var U=l[p].read();U?(l[T]=null,l[f]=null,l[y]=null,S(C(U,!1))):(l[f]=S,l[y]=L)},writable:!0}),o));return l[T]=null,d(c,function(A){if(A&&A.code!=="ERR_STREAM_PREMATURE_CLOSE"){var S=l[y];S!==null&&(l[T]=null,l[f]=null,l[y]=null,S(A)),l[_]=A;return}var L=l[f];L!==null&&(l[T]=null,l[f]=null,l[y]=null,L(C(void 0,!0))),l[r]=!0}),c.on("readable",E.bind(null,l)),l};ce.exports=n},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/buffer_list.js":(ce,N,e)=>{function I(E,i){var t=Object.keys(E);if(Object.getOwnPropertySymbols){var m=Object.getOwnPropertySymbols(E);i&&(m=m.filter(function(n){return Object.getOwnPropertyDescriptor(E,n).enumerable})),t.push.apply(t,m)}return t}function g(E){for(var i=1;i<arguments.length;i++){var t=arguments[i]!=null?arguments[i]:{};i%2?I(Object(t),!0).forEach(function(m){d(E,m,t[m])}):Object.getOwnPropertyDescriptors?Object.defineProperties(E,Object.getOwnPropertyDescriptors(t)):I(Object(t)).forEach(function(m){Object.defineProperty(E,m,Object.getOwnPropertyDescriptor(t,m))})}return E}function d(E,i,t){return i in E?Object.defineProperty(E,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):E[i]=t,E}function f(E,i){if(!(E instanceof i))throw new TypeError("Cannot call a class as a function")}function y(E,i){for(var t=0;t<i.length;t++){var m=i[t];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(E,m.key,m)}}function _(E,i,t){return i&&y(E.prototype,i),t&&y(E,t),E}var r=e("./node_modules/buffer/index.js"),T=r.Buffer,M=e("?3e83"),p=M.inspect,C=p&&p.custom||"inspect";function v(E,i,t){T.prototype.copy.call(E,i,t)}ce.exports=function(){function E(){f(this,E),this.head=null,this.tail=null,this.length=0}return _(E,[{key:"push",value:function(t){var m={data:t,next:null};this.length>0?this.tail.next=m:this.head=m,this.tail=m,++this.length}},{key:"unshift",value:function(t){var m={data:t,next:this.head};this.length===0&&(this.tail=m),this.head=m,++this.length}},{key:"shift",value:function(){if(this.length!==0){var t=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,t}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(t){if(this.length===0)return"";for(var m=this.head,n=""+m.data;m=m.next;)n+=t+m.data;return n}},{key:"concat",value:function(t){if(this.length===0)return T.alloc(0);for(var m=T.allocUnsafe(t>>>0),n=this.head,h=0;n;)v(n.data,m,h),h+=n.data.length,n=n.next;return m}},{key:"consume",value:function(t,m){var n;return t<this.head.data.length?(n=this.head.data.slice(0,t),this.head.data=this.head.data.slice(t)):t===this.head.data.length?n=this.shift():n=m?this._getString(t):this._getBuffer(t),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(t){var m=this.head,n=1,h=m.data;for(t-=h.length;m=m.next;){var c=m.data,o=t>c.length?c.length:t;if(o===c.length?h+=c:h+=c.slice(0,t),t-=o,t===0){o===c.length?(++n,m.next?this.head=m.next:this.head=this.tail=null):(this.head=m,m.data=c.slice(o));break}++n}return this.length-=n,h}},{key:"_getBuffer",value:function(t){var m=T.allocUnsafe(t),n=this.head,h=1;for(n.data.copy(m),t-=n.data.length;n=n.next;){var c=n.data,o=t>c.length?c.length:t;if(c.copy(m,m.length-t,0,o),t-=o,t===0){o===c.length?(++h,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=c.slice(o));break}++h}return this.length-=h,m}},{key:C,value:function(t,m){return p(this,g({},m,{depth:0,customInspect:!1}))}}]),E}()},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/destroy.js":ce=>{function N(y,_){var r=this,T=this._readableState&&this._readableState.destroyed,M=this._writableState&&this._writableState.destroyed;return T||M?(_?_(y):y&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(d,this,y)):process.nextTick(d,this,y)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(y||null,function(p){!_&&p?r._writableState?r._writableState.errorEmitted?process.nextTick(I,r):(r._writableState.errorEmitted=!0,process.nextTick(e,r,p)):process.nextTick(e,r,p):_?(process.nextTick(I,r),_(p)):process.nextTick(I,r)}),this)}function e(y,_){d(y,_),I(y)}function I(y){y._writableState&&!y._writableState.emitClose||y._readableState&&!y._readableState.emitClose||y.emit("close")}function g(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function d(y,_){y.emit("error",_)}function f(y,_){var r=y._readableState,T=y._writableState;r&&r.autoDestroy||T&&T.autoDestroy?y.destroy(_):y.emit("error",_)}ce.exports={destroy:N,undestroy:g,errorOrDestroy:f}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/end-of-stream.js":(ce,N,e)=>{var I=e("./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js").codes.ERR_STREAM_PREMATURE_CLOSE;function g(_){var r=!1;return function(){if(!r){r=!0;for(var T=arguments.length,M=new Array(T),p=0;p<T;p++)M[p]=arguments[p];_.apply(this,M)}}}function d(){}function f(_){return _.setHeader&&typeof _.abort=="function"}function y(_,r,T){if(typeof r=="function")return y(_,null,r);r||(r={}),T=g(T||d);var M=r.readable||r.readable!==!1&&_.readable,p=r.writable||r.writable!==!1&&_.writable,C=function(){_.writable||E()},v=_._writableState&&_._writableState.finished,E=function(){p=!1,v=!0,M||T.call(_)},i=_._readableState&&_._readableState.endEmitted,t=function(){M=!1,i=!0,p||T.call(_)},m=function(o){T.call(_,o)},n=function(){var o;if(M&&!i)return(!_._readableState||!_._readableState.ended)&&(o=new I),T.call(_,o);if(p&&!v)return(!_._writableState||!_._writableState.ended)&&(o=new I),T.call(_,o)},h=function(){_.req.on("finish",E)};return f(_)?(_.on("complete",E),_.on("abort",n),_.req?h():_.on("request",h)):p&&!_._writableState&&(_.on("end",C),_.on("close",C)),_.on("end",t),_.on("finish",E),r.error!==!1&&_.on("error",m),_.on("close",n),function(){_.removeListener("complete",E),_.removeListener("abort",n),_.removeListener("request",h),_.req&&_.req.removeListener("finish",E),_.removeListener("end",C),_.removeListener("close",C),_.removeListener("finish",E),_.removeListener("end",t),_.removeListener("error",m),_.removeListener("close",n)}}ce.exports=y},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/from-browser.js":ce=>{ce.exports=function(){throw new Error("Readable.from is not available in the browser")}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/pipeline.js":(ce,N,e)=>{var I;function g(E){var i=!1;return function(){i||(i=!0,E.apply(void 0,arguments))}}var d=e("./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js").codes,f=d.ERR_MISSING_ARGS,y=d.ERR_STREAM_DESTROYED;function _(E){if(E)throw E}function r(E){return E.setHeader&&typeof E.abort=="function"}function T(E,i,t,m){m=g(m);var n=!1;E.on("close",function(){n=!0}),I===void 0&&(I=e("./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/end-of-stream.js")),I(E,{readable:i,writable:t},function(c){if(c)return m(c);n=!0,m()});var h=!1;return function(c){if(!n&&!h){if(h=!0,r(E))return E.abort();if(typeof E.destroy=="function")return E.destroy();m(c||new y("pipe"))}}}function M(E){E()}function p(E,i){return E.pipe(i)}function C(E){return!E.length||typeof E[E.length-1]!="function"?_:E.pop()}function v(){for(var E=arguments.length,i=new Array(E),t=0;t<E;t++)i[t]=arguments[t];var m=C(i);if(Array.isArray(i[0])&&(i=i[0]),i.length<2)throw new f("streams");var n,h=i.map(function(c,o){var l=o<i.length-1,A=o>0;return T(c,l,A,function(S){n||(n=S),S&&h.forEach(M),!l&&(h.forEach(M),m(n))})});return i.reduce(p)}ce.exports=v},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/state.js":(ce,N,e)=>{var I=e("./node_modules/stream-browserify/node_modules/readable-stream/errors-browser.js").codes.ERR_INVALID_OPT_VALUE;function g(f,y,_){return f.highWaterMark!=null?f.highWaterMark:y?f[_]:null}function d(f,y,_,r){var T=g(y,r,_);if(T!=null){if(!(isFinite(T)&&Math.floor(T)===T)||T<0){var M=r?_:"highWaterMark";throw new I(M,T)}return Math.floor(T)}return f.objectMode?16:16384}ce.exports={getHighWaterMark:d}},"./node_modules/stream-browserify/node_modules/readable-stream/lib/internal/streams/stream-browser.js":(ce,N,e)=>{ce.exports=e("./node_modules/events/events.js").EventEmitter},"./node_modules/string_decoder/lib/string_decoder.js":(ce,N,e)=>{var I=e("./node_modules/safe-buffer/index.js").Buffer,g=I.isEncoding||function(h){switch(h=""+h,h&&h.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function d(h){if(!h)return"utf8";for(var c;;)switch(h){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return h;default:if(c)return;h=(""+h).toLowerCase(),c=!0}}function f(h){var c=d(h);if(typeof c!="string"&&(I.isEncoding===g||!g(h)))throw new Error("Unknown encoding: "+h);return c||h}N.StringDecoder=y;function y(h){this.encoding=f(h);var c;switch(this.encoding){case"utf16le":this.text=v,this.end=E,c=4;break;case"utf8":this.fillLast=M,c=4;break;case"base64":this.text=i,this.end=t,c=3;break;default:this.write=m,this.end=n;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=I.allocUnsafe(c)}y.prototype.write=function(h){if(h.length===0)return"";var c,o;if(this.lastNeed){if(c=this.fillLast(h),c===void 0)return"";o=this.lastNeed,this.lastNeed=0}else o=0;return o<h.length?c?c+this.text(h,o):this.text(h,o):c||""},y.prototype.end=C,y.prototype.text=p,y.prototype.fillLast=function(h){if(this.lastNeed<=h.length)return h.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);h.copy(this.lastChar,this.lastTotal-this.lastNeed,0,h.length),this.lastNeed-=h.length};function _(h){return h<=127?0:h>>5===6?2:h>>4===14?3:h>>3===30?4:h>>6===2?-1:-2}function r(h,c,o){var l=c.length-1;if(l<o)return 0;var A=_(c[l]);return A>=0?(A>0&&(h.lastNeed=A-1),A):--l<o||A===-2?0:(A=_(c[l]),A>=0?(A>0&&(h.lastNeed=A-2),A):--l<o||A===-2?0:(A=_(c[l]),A>=0?(A>0&&(A===2?A=0:h.lastNeed=A-3),A):0))}function T(h,c,o){if((c[0]&192)!==128)return h.lastNeed=0,"�";if(h.lastNeed>1&&c.length>1){if((c[1]&192)!==128)return h.lastNeed=1,"�";if(h.lastNeed>2&&c.length>2&&(c[2]&192)!==128)return h.lastNeed=2,"�"}}function M(h){var c=this.lastTotal-this.lastNeed,o=T(this,h);if(o!==void 0)return o;if(this.lastNeed<=h.length)return h.copy(this.lastChar,c,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);h.copy(this.lastChar,c,0,h.length),this.lastNeed-=h.length}function p(h,c){var o=r(this,h,c);if(!this.lastNeed)return h.toString("utf8",c);this.lastTotal=o;var l=h.length-(o-this.lastNeed);return h.copy(this.lastChar,0,l),h.toString("utf8",c,l)}function C(h){var c=h&&h.length?this.write(h):"";return this.lastNeed?c+"�":c}function v(h,c){if((h.length-c)%2===0){var o=h.toString("utf16le",c);if(o){var l=o.charCodeAt(o.length-1);if(l>=55296&&l<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=h[h.length-2],this.lastChar[1]=h[h.length-1],o.slice(0,-1)}return o}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=h[h.length-1],h.toString("utf16le",c,h.length-1)}function E(h){var c=h&&h.length?this.write(h):"";if(this.lastNeed){var o=this.lastTotal-this.lastNeed;return c+this.lastChar.toString("utf16le",0,o)}return c}function i(h,c){var o=(h.length-c)%3;return o===0?h.toString("base64",c):(this.lastNeed=3-o,this.lastTotal=3,o===1?this.lastChar[0]=h[h.length-1]:(this.lastChar[0]=h[h.length-2],this.lastChar[1]=h[h.length-1]),h.toString("base64",c,h.length-o))}function t(h){var c=h&&h.length?this.write(h):"";return this.lastNeed?c+this.lastChar.toString("base64",0,3-this.lastNeed):c}function m(h){return h.toString(this.encoding)}function n(h){return h&&h.length?this.write(h):""}},"./node_modules/ua-parser-js/src/ua-parser.js":function(ce,N,e){var I;(function(g,d){var f="1.0.2",y="",_="?",r="function",T="undefined",M="object",p="string",C="major",v="model",E="name",i="type",t="vendor",m="version",n="architecture",h="console",c="mobile",o="tablet",l="smarttv",A="wearable",S="embedded",L=255,U="Amazon",k="Apple",X="ASUS",W="BlackBerry",b="Browser",j="Chrome",Q="Edge",q="Firefox",Y="Google",J="Huawei",$="LG",ae="Microsoft",K="Motorola",ee="Opera",se="Samsung",ue="Sony",oe="Xiaomi",Z="Zebra",H="Facebook",V=function(G,fe){var le={};for(var _e in G)fe[_e]&&fe[_e].length%2===0?le[_e]=fe[_e].concat(G[_e]):le[_e]=G[_e];return le},te=function(G){for(var fe={},le=0;le<G.length;le++)fe[G[le].toUpperCase()]=G[le];return fe},z=function(G,fe){return typeof G===p?R(fe).indexOf(R(G))!==-1:!1},R=function(G){return G.toLowerCase()},u=function(G){return typeof G===p?G.replace(/[^\d\.]/g,y).split(".")[0]:d},D=function(G,fe){if(typeof G===p)return G=G.replace(/^\s\s*/,y).replace(/\s\s*$/,y),typeof fe===T?G:G.substring(0,L)},F=function(G,fe){for(var le=0,_e,Me,Oe,Ne,xe,Se;le<fe.length&&!xe;){var me=fe[le],Ae=fe[le+1];for(_e=Me=0;_e<me.length&&!xe;)if(xe=me[_e++].exec(G),xe)for(Oe=0;Oe<Ae.length;Oe++)Se=xe[++Me],Ne=Ae[Oe],typeof Ne===M&&Ne.length>0?Ne.length===2?typeof Ne[1]==r?this[Ne[0]]=Ne[1].call(this,Se):this[Ne[0]]=Ne[1]:Ne.length===3?typeof Ne[1]===r&&!(Ne[1].exec&&Ne[1].test)?this[Ne[0]]=Se?Ne[1].call(this,Se,Ne[2]):d:this[Ne[0]]=Se?Se.replace(Ne[1],Ne[2]):d:Ne.length===4&&(this[Ne[0]]=Se?Ne[3].call(this,Se.replace(Ne[1],Ne[2])):d):this[Ne]=Se||d;le+=2}},w=function(G,fe){for(var le in fe)if(typeof fe[le]===M&&fe[le].length>0){for(var _e=0;_e<fe[le].length;_e++)if(z(fe[le][_e],G))return le===_?d:le}else if(z(fe[le],G))return le===_?d:le;return G},O={"1.0":"/8","1.2":"/1","1.3":"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"},P={ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2","8.1":"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"},B={browser:[[/\b(?:crmo|crios)\/([\w\.]+)/i],[m,[E,"Chrome"]],[/edg(?:e|ios|a)?\/([\w\.]+)/i],[m,[E,"Edge"]],[/(opera mini)\/([-\w\.]+)/i,/(opera [mobiletab]{3,6})\b.+version\/([-\w\.]+)/i,/(opera)(?:.+version\/|[\/ ]+)([\w\.]+)/i],[E,m],[/opios[\/ ]+([\w\.]+)/i],[m,[E,ee+" Mini"]],[/\bopr\/([\w\.]+)/i],[m,[E,ee]],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/ ]?([\w\.]*)/i,/(avant |iemobile|slim)(?:browser)?[\/ ]?([\w\.]*)/i,/(ba?idubrowser)[\/ ]?([\w\.]+)/i,/(?:ms|\()(ie) ([\w\.]+)/i,/(flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon|rekonq|puffin|brave|whale|qqbrowserlite|qq)\/([-\w\.]+)/i,/(weibo)__([\d\.]+)/i],[E,m],[/(?:\buc? ?browser|(?:juc.+)ucweb)[\/ ]?([\w\.]+)/i],[m,[E,"UC"+b]],[/\bqbcore\/([\w\.]+)/i],[m,[E,"WeChat(Win) Desktop"]],[/micromessenger\/([\w\.]+)/i],[m,[E,"WeChat"]],[/konqueror\/([\w\.]+)/i],[m,[E,"Konqueror"]],[/trident.+rv[: ]([\w\.]{1,9})\b.+like gecko/i],[m,[E,"IE"]],[/yabrowser\/([\w\.]+)/i],[m,[E,"Yandex"]],[/(avast|avg)\/([\w\.]+)/i],[[E,/(.+)/,"$1 Secure "+b],m],[/\bfocus\/([\w\.]+)/i],[m,[E,q+" Focus"]],[/\bopt\/([\w\.]+)/i],[m,[E,ee+" Touch"]],[/coc_coc\w+\/([\w\.]+)/i],[m,[E,"Coc Coc"]],[/dolfin\/([\w\.]+)/i],[m,[E,"Dolphin"]],[/coast\/([\w\.]+)/i],[m,[E,ee+" Coast"]],[/miuibrowser\/([\w\.]+)/i],[m,[E,"MIUI "+b]],[/fxios\/([-\w\.]+)/i],[m,[E,q]],[/\bqihu|(qi?ho?o?|360)browser/i],[[E,"360 "+b]],[/(oculus|samsung|sailfish)browser\/([\w\.]+)/i],[[E,/(.+)/,"$1 "+b],m],[/(comodo_dragon)\/([\w\.]+)/i],[[E,/_/g," "],m],[/(electron)\/([\w\.]+) safari/i,/(tesla)(?: qtcarbrowser|\/(20\d\d\.[-\w\.]+))/i,/m?(qqbrowser|baiduboxapp|2345Explorer)[\/ ]?([\w\.]+)/i],[E,m],[/(metasr)[\/ ]?([\w\.]+)/i,/(lbbrowser)/i],[E],[/((?:fban\/fbios|fb_iab\/fb4a)(?!.+fbav)|;fbav\/([\w\.]+);)/i],[[E,H],m],[/safari (line)\/([\w\.]+)/i,/\b(line)\/([\w\.]+)\/iab/i,/(chromium|instagram)[\/ ]([-\w\.]+)/i],[E,m],[/\bgsa\/([\w\.]+) .*safari\//i],[m,[E,"GSA"]],[/headlesschrome(?:\/([\w\.]+)| )/i],[m,[E,j+" Headless"]],[/ wv\).+(chrome)\/([\w\.]+)/i],[[E,j+" WebView"],m],[/droid.+ version\/([\w\.]+)\b.+(?:mobile safari|safari)/i],[m,[E,"Android "+b]],[/(chrome|omniweb|arora|[tizenoka]{5} ?browser)\/v?([\w\.]+)/i],[E,m],[/version\/([\w\.]+) .*mobile\/\w+ (safari)/i],[m,[E,"Mobile Safari"]],[/version\/([\w\.]+) .*(mobile ?safari|safari)/i],[m,E],[/webkit.+?(mobile ?safari|safari)(\/[\w\.]+)/i],[E,[m,w,O]],[/(webkit|khtml)\/([\w\.]+)/i],[E,m],[/(navigator|netscape\d?)\/([-\w\.]+)/i],[[E,"Netscape"],m],[/mobile vr; rv:([\w\.]+)\).+firefox/i],[m,[E,q+" Reality"]],[/ekiohf.+(flow)\/([\w\.]+)/i,/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo browser|minimo|conkeror|klar)[\/ ]?([\w\.\+]+)/i,/(seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([-\w\.]+)$/i,/(firefox)\/([\w\.]+)/i,/(mozilla)\/([\w\.]+) .+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir|obigo|mosaic|(?:go|ice|up)[\. ]?browser)[-\/ ]?v?([\w\.]+)/i,/(links) \(([\w\.]+)/i],[E,m]],cpu:[[/(?:(amd|x(?:(?:86|64)[-_])?|wow|win)64)[;\)]/i],[[n,"amd64"]],[/(ia32(?=;))/i],[[n,R]],[/((?:i[346]|x)86)[;\)]/i],[[n,"ia32"]],[/\b(aarch64|arm(v?8e?l?|_?64))\b/i],[[n,"arm64"]],[/\b(arm(?:v[67])?ht?n?[fl]p?)\b/i],[[n,"armhf"]],[/windows (ce|mobile); ppc;/i],[[n,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?: mac|;|\))/i],[[n,/ower/,y,R]],[/(sun4\w)[;\)]/i],[[n,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|\barm(?=v(?:[1-7]|[5-7]1)l?|;|eabi)|(?=atmel )avr|(?:irix|mips|sparc)(?:64)?\b|pa-risc)/i],[[n,R]]],device:[[/\b(sch-i[89]0\d|shw-m380s|sm-[pt]\w{2,4}|gt-[pn]\d{2,4}|sgh-t8[56]9|nexus 10)/i],[v,[t,se],[i,o]],[/\b((?:s[cgp]h|gt|sm)-\w+|galaxy nexus)/i,/samsung[- ]([-\w]+)/i,/sec-(sgh\w+)/i],[v,[t,se],[i,c]],[/\((ip(?:hone|od)[\w ]*);/i],[v,[t,k],[i,c]],[/\((ipad);[-\w\),; ]+apple/i,/applecoremedia\/[\w\.]+ \((ipad)/i,/\b(ipad)\d\d?,\d\d?[;\]].+ios/i],[v,[t,k],[i,o]],[/\b((?:ag[rs][23]?|bah2?|sht?|btv)-a?[lw]\d{2})\b(?!.+d\/s)/i],[v,[t,J],[i,o]],[/(?:huawei|honor)([-\w ]+)[;\)]/i,/\b(nexus 6p|\w{2,4}-[atu]?[ln][01259x][012359][an]?)\b(?!.+d\/s)/i],[v,[t,J],[i,c]],[/\b(poco[\w ]+)(?: bui|\))/i,/\b; (\w+) build\/hm\1/i,/\b(hm[-_ ]?note?[_ ]?(?:\d\w)?) bui/i,/\b(redmi[\-_ ]?(?:note|k)?[\w_ ]+)(?: bui|\))/i,/\b(mi[-_ ]?(?:a\d|one|one[_ ]plus|note lte|max)?[_ ]?(?:\d?\w?)[_ ]?(?:plus|se|lite)?)(?: bui|\))/i],[[v,/_/g," "],[t,oe],[i,c]],[/\b(mi[-_ ]?(?:pad)(?:[\w_ ]+))(?: bui|\))/i],[[v,/_/g," "],[t,oe],[i,o]],[/; (\w+) bui.+ oppo/i,/\b(cph[12]\d{3}|p(?:af|c[al]|d\w|e[ar])[mt]\d0|x9007|a101op)\b/i],[v,[t,"OPPO"],[i,c]],[/vivo (\w+)(?: bui|\))/i,/\b(v[12]\d{3}\w?[at])(?: bui|;)/i],[v,[t,"Vivo"],[i,c]],[/\b(rmx[12]\d{3})(?: bui|;|\))/i],[v,[t,"Realme"],[i,c]],[/\b(milestone|droid(?:[2-4x]| (?:bionic|x2|pro|razr))?:?( 4g)?)\b[\w ]+build\//i,/\bmot(?:orola)?[- ](\w*)/i,/((?:moto[\w\(\) ]+|xt\d{3,4}|nexus 6)(?= bui|\)))/i],[v,[t,K],[i,c]],[/\b(mz60\d|xoom[2 ]{0,2}) build\//i],[v,[t,K],[i,o]],[/((?=lg)?[vl]k\-?\d{3}) bui| 3\.[-\w; ]{10}lg?-([06cv9]{3,4})/i],[v,[t,$],[i,o]],[/(lm(?:-?f100[nv]?|-[\w\.]+)(?= bui|\))|nexus [45])/i,/\blg[-e;\/ ]+((?!browser|netcast|android tv)\w+)/i,/\blg-?([\d\w]+) bui/i],[v,[t,$],[i,c]],[/(ideatab[-\w ]+)/i,/lenovo ?(s[56]000[-\w]+|tab(?:[\w ]+)|yt[-\d\w]{6}|tb[-\d\w]{6})/i],[v,[t,"Lenovo"],[i,o]],[/(?:maemo|nokia).*(n900|lumia \d+)/i,/nokia[-_ ]?([-\w\.]*)/i],[[v,/_/g," "],[t,"Nokia"],[i,c]],[/(pixel c)\b/i],[v,[t,Y],[i,o]],[/droid.+; (pixel[\daxl ]{0,6})(?: bui|\))/i],[v,[t,Y],[i,c]],[/droid.+ ([c-g]\d{4}|so[-gl]\w+|xq-a\w[4-7][12])(?= bui|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[v,[t,ue],[i,c]],[/sony tablet [ps]/i,/\b(?:sony)?sgp\w+(?: bui|\))/i],[[v,"Xperia Tablet"],[t,ue],[i,o]],[/ (kb2005|in20[12]5|be20[12][59])\b/i,/(?:one)?(?:plus)? (a\d0\d\d)(?: b|\))/i],[v,[t,"OnePlus"],[i,c]],[/(alexa)webm/i,/(kf[a-z]{2}wi)( bui|\))/i,/(kf[a-z]+)( bui|\)).+silk\//i],[v,[t,U],[i,o]],[/((?:sd|kf)[0349hijorstuw]+)( bui|\)).+silk\//i],[[v,/(.+)/g,"Fire Phone $1"],[t,U],[i,c]],[/(playbook);[-\w\),; ]+(rim)/i],[v,t,[i,o]],[/\b((?:bb[a-f]|st[hv])100-\d)/i,/\(bb10; (\w+)/i],[v,[t,W],[i,c]],[/(?:\b|asus_)(transfo[prime ]{4,10} \w+|eeepc|slider \w+|nexus 7|padfone|p00[cj])/i],[v,[t,X],[i,o]],[/ (z[bes]6[027][012][km][ls]|zenfone \d\w?)\b/i],[v,[t,X],[i,c]],[/(nexus 9)/i],[v,[t,"HTC"],[i,o]],[/(htc)[-;_ ]{1,2}([\w ]+(?=\)| bui)|\w+)/i,/(zte)[- ]([\w ]+?)(?: bui|\/|\))/i,/(alcatel|geeksphone|nexian|panasonic|sony)[-_ ]?([-\w]*)/i],[t,[v,/_/g," "],[i,c]],[/droid.+; ([ab][1-7]-?[0178a]\d\d?)/i],[v,[t,"Acer"],[i,o]],[/droid.+; (m[1-5] note) bui/i,/\bmz-([-\w]{2,})/i],[v,[t,"Meizu"],[i,c]],[/\b(sh-?[altvz]?\d\d[a-ekm]?)/i],[v,[t,"Sharp"],[i,c]],[/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[-_ ]?([-\w]*)/i,/(hp) ([\w ]+\w)/i,/(asus)-?(\w+)/i,/(microsoft); (lumia[\w ]+)/i,/(lenovo)[-_ ]?([-\w]+)/i,/(jolla)/i,/(oppo) ?([\w ]+) bui/i],[t,v,[i,c]],[/(archos) (gamepad2?)/i,/(hp).+(touchpad(?!.+tablet)|tablet)/i,/(kindle)\/([\w\.]+)/i,/(nook)[\w ]+build\/(\w+)/i,/(dell) (strea[kpr\d ]*[\dko])/i,/(le[- ]+pan)[- ]+(\w{1,9}) bui/i,/(trinity)[- ]*(t\d{3}) bui/i,/(gigaset)[- ]+(q\w{1,9}) bui/i,/(vodafone) ([\w ]+)(?:\)| bui)/i],[t,v,[i,o]],[/(surface duo)/i],[v,[t,ae],[i,o]],[/droid [\d\.]+; (fp\du?)(?: b|\))/i],[v,[t,"Fairphone"],[i,c]],[/(u304aa)/i],[v,[t,"AT&T"],[i,c]],[/\bsie-(\w*)/i],[v,[t,"Siemens"],[i,c]],[/\b(rct\w+) b/i],[v,[t,"RCA"],[i,o]],[/\b(venue[\d ]{2,7}) b/i],[v,[t,"Dell"],[i,o]],[/\b(q(?:mv|ta)\w+) b/i],[v,[t,"Verizon"],[i,o]],[/\b(?:barnes[& ]+noble |bn[rt])([\w\+ ]*) b/i],[v,[t,"Barnes & Noble"],[i,o]],[/\b(tm\d{3}\w+) b/i],[v,[t,"NuVision"],[i,o]],[/\b(k88) b/i],[v,[t,"ZTE"],[i,o]],[/\b(nx\d{3}j) b/i],[v,[t,"ZTE"],[i,c]],[/\b(gen\d{3}) b.+49h/i],[v,[t,"Swiss"],[i,c]],[/\b(zur\d{3}) b/i],[v,[t,"Swiss"],[i,o]],[/\b((zeki)?tb.*\b) b/i],[v,[t,"Zeki"],[i,o]],[/\b([yr]\d{2}) b/i,/\b(dragon[- ]+touch |dt)(\w{5}) b/i],[[t,"Dragon Touch"],v,[i,o]],[/\b(ns-?\w{0,9}) b/i],[v,[t,"Insignia"],[i,o]],[/\b((nxa|next)-?\w{0,9}) b/i],[v,[t,"NextBook"],[i,o]],[/\b(xtreme\_)?(v(1[045]|2[015]|[3469]0|7[05])) b/i],[[t,"Voice"],v,[i,c]],[/\b(lvtel\-)?(v1[12]) b/i],[[t,"LvTel"],v,[i,c]],[/\b(ph-1) /i],[v,[t,"Essential"],[i,c]],[/\b(v(100md|700na|7011|917g).*\b) b/i],[v,[t,"Envizen"],[i,o]],[/\b(trio[-\w\. ]+) b/i],[v,[t,"MachSpeed"],[i,o]],[/\btu_(1491) b/i],[v,[t,"Rotor"],[i,o]],[/(shield[\w ]+) b/i],[v,[t,"Nvidia"],[i,o]],[/(sprint) (\w+)/i],[t,v,[i,c]],[/(kin\.[onetw]{3})/i],[[v,/\./g," "],[t,ae],[i,c]],[/droid.+; (cc6666?|et5[16]|mc[239][23]x?|vc8[03]x?)\)/i],[v,[t,Z],[i,o]],[/droid.+; (ec30|ps20|tc[2-8]\d[kx])\)/i],[v,[t,Z],[i,c]],[/(ouya)/i,/(nintendo) ([wids3utch]+)/i],[t,v,[i,h]],[/droid.+; (shield) bui/i],[v,[t,"Nvidia"],[i,h]],[/(playstation [345portablevi]+)/i],[v,[t,ue],[i,h]],[/\b(xbox(?: one)?(?!; xbox))[\); ]/i],[v,[t,ae],[i,h]],[/smart-tv.+(samsung)/i],[t,[i,l]],[/hbbtv.+maple;(\d+)/i],[[v,/^/,"SmartTV"],[t,se],[i,l]],[/(nux; netcast.+smarttv|lg (netcast\.tv-201\d|android tv))/i],[[t,$],[i,l]],[/(apple) ?tv/i],[t,[v,k+" TV"],[i,l]],[/crkey/i],[[v,j+"cast"],[t,Y],[i,l]],[/droid.+aft(\w)( bui|\))/i],[v,[t,U],[i,l]],[/\(dtv[\);].+(aquos)/i],[v,[t,"Sharp"],[i,l]],[/\b(roku)[\dx]*[\)\/]((?:dvp-)?[\d\.]*)/i,/hbbtv\/\d+\.\d+\.\d+ +\([\w ]*; *(\w[^;]*);([^;]*)/i],[[t,D],[v,D],[i,l]],[/\b(android tv|smart[- ]?tv|opera tv|tv; rv:)\b/i],[[i,l]],[/((pebble))app/i],[t,v,[i,A]],[/droid.+; (glass) \d/i],[v,[t,Y],[i,A]],[/droid.+; (wt63?0{2,3})\)/i],[v,[t,Z],[i,A]],[/(quest( 2)?)/i],[v,[t,H],[i,A]],[/(tesla)(?: qtcarbrowser|\/[-\w\.]+)/i],[t,[i,S]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+? mobile safari/i],[v,[i,c]],[/droid .+?; ([^;]+?)(?: bui|\) applew).+?(?! mobile) safari/i],[v,[i,o]],[/\b((tablet|tab)[;\/]|focus\/\d(?!.+mobile))/i],[[i,o]],[/(phone|mobile(?:[;\/]| safari)|pda(?=.+windows ce))/i],[[i,c]],[/(android[-\w\. ]{0,9});.+buil/i],[v,[t,"Generic"]]],engine:[[/windows.+ edge\/([\w\.]+)/i],[m,[E,Q+"HTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[m,[E,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/ekioh(flow)\/([\w\.]+)/i,/(khtml|tasman|links)[\/ ]\(?([\w\.]+)/i,/(icab)[\/ ]([23]\.[\d\.]+)/i],[E,m],[/rv\:([\w\.]{1,9})\b.+(gecko)/i],[m,E]],os:[[/microsoft (windows) (vista|xp)/i],[E,m],[/(windows) nt 6\.2; (arm)/i,/(windows (?:phone(?: os)?|mobile))[\/ ]?([\d\.\w ]*)/i,/(windows)[\/ ]?([ntce\d\. ]+\w)(?!.+xbox)/i],[E,[m,w,P]],[/(win(?=3|9|n)|win 9x )([nt\d\.]+)/i],[[E,"Windows"],[m,w,P]],[/ip[honead]{2,4}\b(?:.*os ([\w]+) like mac|; opera)/i,/cfnetwork\/.+darwin/i],[[m,/_/g,"."],[E,"iOS"]],[/(mac os x) ?([\w\. ]*)/i,/(macintosh|mac_powerpc\b)(?!.+haiku)/i],[[E,"Mac OS"],[m,/_/g,"."]],[/droid ([\w\.]+)\b.+(android[- ]x86)/i],[m,E],[/(android|webos|qnx|bada|rim tablet os|maemo|meego|sailfish)[-\/ ]?([\w\.]*)/i,/(blackberry)\w*\/([\w\.]*)/i,/(tizen|kaios)[\/ ]([\w\.]+)/i,/\((series40);/i],[E,m],[/\(bb(10);/i],[m,[E,W]],[/(?:symbian ?os|symbos|s60(?=;)|series60)[-\/ ]?([\w\.]*)/i],[m,[E,"Symbian"]],[/mozilla\/[\d\.]+ \((?:mobile|tablet|tv|mobile; [\w ]+); rv:.+ gecko\/([\w\.]+)/i],[m,[E,q+" OS"]],[/web0s;.+rt(tv)/i,/\b(?:hp)?wos(?:browser)?\/([\w\.]+)/i],[m,[E,"webOS"]],[/crkey\/([\d\.]+)/i],[m,[E,j+"cast"]],[/(cros) [\w]+ ([\w\.]+\w)/i],[[E,"Chromium OS"],m],[/(nintendo|playstation) ([wids345portablevuch]+)/i,/(xbox); +xbox ([^\);]+)/i,/\b(joli|palm)\b ?(?:os)?\/?([\w\.]*)/i,/(mint)[\/\(\) ]?(\w*)/i,/(mageia|vectorlinux)[; ]/i,/([kxln]?ubuntu|debian|suse|opensuse|gentoo|arch(?= linux)|slackware|fedora|mandriva|centos|pclinuxos|red ?hat|zenwalk|linpus|raspbian|plan 9|minix|risc os|contiki|deepin|manjaro|elementary os|sabayon|linspire)(?: gnu\/linux)?(?: enterprise)?(?:[- ]linux)?(?:-gnu)?[-\/ ]?(?!chrom|package)([-\w\.]*)/i,/(hurd|linux) ?([\w\.]*)/i,/(gnu) ?([\w\.]*)/i,/\b([-frentopcghs]{0,5}bsd|dragonfly)[\/ ]?(?!amd|[ix346]{1,2}86)([\w\.]*)/i,/(haiku) (\w+)/i],[E,m],[/(sunos) ?([\w\.\d]*)/i],[[E,"Solaris"],m],[/((?:open)?solaris)[-\/ ]?([\w\.]*)/i,/(aix) ((\d)(?=\.|\)| )[\w\.])*/i,/\b(beos|os\/2|amigaos|morphos|openvms|fuchsia|hp-ux)/i,/(unix) ?([\w\.]*)/i],[E,m]]},x=function(G,fe){if(typeof G===M&&(fe=G,G=d),!(this instanceof x))return new x(G,fe).getResult();var le=G||(typeof g!==T&&g.navigator&&g.navigator.userAgent?g.navigator.userAgent:y),_e=fe?V(B,fe):B;return this.getBrowser=function(){var Me={};return Me[E]=d,Me[m]=d,F.call(Me,le,_e.browser),Me.major=u(Me.version),Me},this.getCPU=function(){var Me={};return Me[n]=d,F.call(Me,le,_e.cpu),Me},this.getDevice=function(){var Me={};return Me[t]=d,Me[v]=d,Me[i]=d,F.call(Me,le,_e.device),Me},this.getEngine=function(){var Me={};return Me[E]=d,Me[m]=d,F.call(Me,le,_e.engine),Me},this.getOS=function(){var Me={};return Me[E]=d,Me[m]=d,F.call(Me,le,_e.os),Me},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return le},this.setUA=function(Me){return le=typeof Me===p&&Me.length>L?D(Me,L):Me,this},this.setUA(le),this};x.VERSION=f,x.BROWSER=te([E,m,C]),x.CPU=te([n]),x.DEVICE=te([v,t,i,h,c,l,o,A,S]),x.ENGINE=x.OS=te([E,m]),typeof N!==T?(ce.exports&&(N=ce.exports=x),N.UAParser=x):e.amdO?(I=function(){return x}.call(N,e,N,ce),I!==d&&(ce.exports=I)):typeof g!==T&&(g.UAParser=x);var ne=typeof g!==T&&(g.jQuery||g.Zepto);if(ne&&!ne.ua){var re=new x;ne.ua=re.getResult(),ne.ua.get=function(){return re.getUA()},ne.ua.set=function(G){re.setUA(G);var fe=re.getResult();for(var le in fe)ne.ua[le]=fe[le]}}})(typeof window=="object"?window:this)},"./node_modules/util-deprecate/browser.js":(ce,N,e)=>{ce.exports=I;function I(d,f){if(g("noDeprecation"))return d;var y=!1;function _(){if(!y){if(g("throwDeprecation"))throw new Error(f);g("traceDeprecation")?console.trace(f):console.warn(f),y=!0}return d.apply(this,arguments)}return _}function g(d){try{if(!e.g.localStorage)return!1}catch{return!1}var f=e.g.localStorage[d];return f==null?!1:String(f).toLowerCase()==="true"}},"?3e83":()=>{},"?19e6":()=>{},"./node_modules/bcp-47-normalize/lib/defaults.json":ce=>{ce.exports=JSON.parse('["mni-beng-in","mni-mtei-in","sat-deva-in","sat-olck-in","shi-latn-ma","shi-tfng-ma","vai-latn-lr","vai-vaii-lr","yue-hans-cn","yue-hant-hk","az-arab-ir","az-cyrl-az","az-latn-az","bm-nkoo-ml","bs-cyrl-ba","bs-latn-ba","en-dsrt-us","ff-adlm-gn","ff-latn-sn","ha-arab-ng","hi-latn-in","iu-latn-ca","ks-arab-in","ks-deva-in","mn-mong-cn","ms-arab-my","pa-arab-pk","pa-guru-in","sd-arab-pk","sd-deva-in","sr-cyrl-rs","sr-latn-rs","su-latn-id","uz-arab-af","uz-cyrl-uz","uz-latn-uz","zh-hans-cn","zh-hant-tw","mni-beng","sat-olck","shi-tfng","vai-vaii","yue-hant","az-latn","bs-latn","ff-latn","jbo-001","ks-arab","pa-guru","prg-001","sd-arab","sr-cyrl","su-latn","uz-latn","zh-hans","agq-cm","ar-001","arn-cl","asa-tz","ast-es","bas-cm","bem-zm","bez-tz","bgn-pk","blt-vn","brx-in","bss-cm","byn-er","cad-us","cch-ng","ccp-bd","ceb-ph","cgg-ug","chr-us","cic-us","ckb-iq","dav-ke","dje-ne","doi-in","dsb-de","dua-cm","dyo-sn","ebu-ke","eo-001","ewo-cm","fil-ph","fur-it","gaa-gh","gez-et","gsw-ch","guz-ke","haw-us","hsb-de","ia-001","ife-tg","io-001","jgo-cm","jmc-tz","kab-dz","kaj-ng","kam-ke","kcg-ng","kde-tz","kea-cv","ken-cm","khq-ml","kkj-cm","kln-ke","kok-in","kpe-lr","ksb-tz","ksf-cm","ksh-de","lag-tz","lkt-us","lrc-ir","luo-ke","luy-ke","mai-in","mas-ke","mer-ke","mfe-mu","mgh-mz","mgo-cm","moh-ca","mua-cm","mus-us","myv-ru","mzn-ir","naq-na","nds-de","nmg-cm","nnh-cm","nqo-gn","nso-za","nus-ss","nyn-ug","osa-us","pcm-ng","quc-gt","rof-tz","rwk-tz","sah-ru","saq-ke","sbp-tz","scn-it","sdh-ir","seh-mz","ses-ml","sid-et","sma-se","smj-se","smn-fi","sms-fi","ssy-er","syr-iq","szl-pl","teo-ug","tig-er","trv-tw","trw-pk","twq-ne","tzm-ma","vo-001","vun-tz","wae-ch","wal-et","wbp-au","xog-ug","yav-cm","yi-001","zgh-ma","aa-et","af-za","ak-gh","am-et","an-es","as-in","ba-ru","be-by","bg-bg","bm-ml","bn-bd","bo-cn","br-fr","ca-es","ce-ru","co-fr","cs-cz","cu-ru","cv-ru","cy-gb","da-dk","de-de","dv-mv","dz-bt","ee-gh","el-gr","en-us","es-es","et-ee","eu-es","fa-ir","fi-fi","fo-fo","fr-fr","fy-nl","ga-ie","gd-gb","gl-es","gn-py","gu-in","gv-im","ha-ng","he-il","hi-in","hr-hr","hu-hu","hy-am","id-id","ig-ng","ii-cn","is-is","it-it","iu-ca","ja-jp","jv-id","ka-ge","ki-ke","kk-kz","kl-gl","km-kh","kn-in","ko-kr","ku-tr","kw-gb","ky-kg","lb-lu","lg-ug","ln-cd","lo-la","lt-lt","lu-cd","lv-lv","mg-mg","mi-nz","mk-mk","ml-in","mn-mn","mr-in","ms-my","mt-mt","my-mm","nb-no","nd-zw","ne-np","nl-nl","nn-no","nr-za","nv-us","ny-mw","oc-fr","om-et","or-in","os-ge","pl-pl","ps-af","pt-br","qu-pe","rm-ch","rn-bi","ro-ro","ru-ru","rw-rw","sa-in","sc-it","se-no","sg-cf","si-lk","sk-sk","sl-si","sn-zw","so-so","sq-al","ss-za","st-za","sv-se","sw-tz","ta-in","te-in","tg-tj","th-th","ti-et","tk-tm","tn-za","to-to","tr-tr","ts-za","tt-ru","ug-cn","uk-ua","ur-pk","ve-za","vi-vn","wa-be","wo-sn","xh-za","yo-ng","zu-za"]')},"./node_modules/bcp-47-normalize/lib/fields.json":ce=>{ce.exports=JSON.parse('[{"from":{"field":"script","value":"qaai"},"to":{"field":"script","value":"zinh"}},{"from":{"field":"region","value":"bu"},"to":{"field":"region","value":"mm"}},{"from":{"field":"region","value":"ct"},"to":{"field":"region","value":"ki"}},{"from":{"field":"region","value":"dd"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"dy"},"to":{"field":"region","value":"bj"}},{"from":{"field":"region","value":"fx"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"hv"},"to":{"field":"region","value":"bf"}},{"from":{"field":"region","value":"jt"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"mi"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"nh"},"to":{"field":"region","value":"vu"}},{"from":{"field":"region","value":"nq"},"to":{"field":"region","value":"aq"}},{"from":{"field":"region","value":"pu"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"pz"},"to":{"field":"region","value":"pa"}},{"from":{"field":"region","value":"qu"},"to":{"field":"region","value":"eu"}},{"from":{"field":"region","value":"rh"},"to":{"field":"region","value":"zw"}},{"from":{"field":"region","value":"tp"},"to":{"field":"region","value":"tl"}},{"from":{"field":"region","value":"uk"},"to":{"field":"region","value":"gb"}},{"from":{"field":"region","value":"vd"},"to":{"field":"region","value":"vn"}},{"from":{"field":"region","value":"wk"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"yd"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"zr"},"to":{"field":"region","value":"cd"}},{"from":{"field":"region","value":"230"},"to":{"field":"region","value":"et"}},{"from":{"field":"region","value":"280"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"736"},"to":{"field":"region","value":"sd"}},{"from":{"field":"region","value":"886"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"958"},"to":{"field":"region","value":"aa"}},{"from":{"field":"region","value":"020"},"to":{"field":"region","value":"ad"}},{"from":{"field":"region","value":"784"},"to":{"field":"region","value":"ae"}},{"from":{"field":"region","value":"004"},"to":{"field":"region","value":"af"}},{"from":{"field":"region","value":"028"},"to":{"field":"region","value":"ag"}},{"from":{"field":"region","value":"660"},"to":{"field":"region","value":"ai"}},{"from":{"field":"region","value":"008"},"to":{"field":"region","value":"al"}},{"from":{"field":"region","value":"051"},"to":{"field":"region","value":"am"}},{"from":{"field":"region","value":"024"},"to":{"field":"region","value":"ao"}},{"from":{"field":"region","value":"010"},"to":{"field":"region","value":"aq"}},{"from":{"field":"region","value":"032"},"to":{"field":"region","value":"ar"}},{"from":{"field":"region","value":"016"},"to":{"field":"region","value":"as"}},{"from":{"field":"region","value":"040"},"to":{"field":"region","value":"at"}},{"from":{"field":"region","value":"036"},"to":{"field":"region","value":"au"}},{"from":{"field":"region","value":"533"},"to":{"field":"region","value":"aw"}},{"from":{"field":"region","value":"248"},"to":{"field":"region","value":"ax"}},{"from":{"field":"region","value":"031"},"to":{"field":"region","value":"az"}},{"from":{"field":"region","value":"070"},"to":{"field":"region","value":"ba"}},{"from":{"field":"region","value":"052"},"to":{"field":"region","value":"bb"}},{"from":{"field":"region","value":"050"},"to":{"field":"region","value":"bd"}},{"from":{"field":"region","value":"056"},"to":{"field":"region","value":"be"}},{"from":{"field":"region","value":"854"},"to":{"field":"region","value":"bf"}},{"from":{"field":"region","value":"100"},"to":{"field":"region","value":"bg"}},{"from":{"field":"region","value":"048"},"to":{"field":"region","value":"bh"}},{"from":{"field":"region","value":"108"},"to":{"field":"region","value":"bi"}},{"from":{"field":"region","value":"204"},"to":{"field":"region","value":"bj"}},{"from":{"field":"region","value":"652"},"to":{"field":"region","value":"bl"}},{"from":{"field":"region","value":"060"},"to":{"field":"region","value":"bm"}},{"from":{"field":"region","value":"096"},"to":{"field":"region","value":"bn"}},{"from":{"field":"region","value":"068"},"to":{"field":"region","value":"bo"}},{"from":{"field":"region","value":"535"},"to":{"field":"region","value":"bq"}},{"from":{"field":"region","value":"076"},"to":{"field":"region","value":"br"}},{"from":{"field":"region","value":"044"},"to":{"field":"region","value":"bs"}},{"from":{"field":"region","value":"064"},"to":{"field":"region","value":"bt"}},{"from":{"field":"region","value":"104"},"to":{"field":"region","value":"mm"}},{"from":{"field":"region","value":"074"},"to":{"field":"region","value":"bv"}},{"from":{"field":"region","value":"072"},"to":{"field":"region","value":"bw"}},{"from":{"field":"region","value":"112"},"to":{"field":"region","value":"by"}},{"from":{"field":"region","value":"084"},"to":{"field":"region","value":"bz"}},{"from":{"field":"region","value":"124"},"to":{"field":"region","value":"ca"}},{"from":{"field":"region","value":"166"},"to":{"field":"region","value":"cc"}},{"from":{"field":"region","value":"180"},"to":{"field":"region","value":"cd"}},{"from":{"field":"region","value":"140"},"to":{"field":"region","value":"cf"}},{"from":{"field":"region","value":"178"},"to":{"field":"region","value":"cg"}},{"from":{"field":"region","value":"756"},"to":{"field":"region","value":"ch"}},{"from":{"field":"region","value":"384"},"to":{"field":"region","value":"ci"}},{"from":{"field":"region","value":"184"},"to":{"field":"region","value":"ck"}},{"from":{"field":"region","value":"152"},"to":{"field":"region","value":"cl"}},{"from":{"field":"region","value":"120"},"to":{"field":"region","value":"cm"}},{"from":{"field":"region","value":"156"},"to":{"field":"region","value":"cn"}},{"from":{"field":"region","value":"170"},"to":{"field":"region","value":"co"}},{"from":{"field":"region","value":"188"},"to":{"field":"region","value":"cr"}},{"from":{"field":"region","value":"192"},"to":{"field":"region","value":"cu"}},{"from":{"field":"region","value":"132"},"to":{"field":"region","value":"cv"}},{"from":{"field":"region","value":"531"},"to":{"field":"region","value":"cw"}},{"from":{"field":"region","value":"162"},"to":{"field":"region","value":"cx"}},{"from":{"field":"region","value":"196"},"to":{"field":"region","value":"cy"}},{"from":{"field":"region","value":"203"},"to":{"field":"region","value":"cz"}},{"from":{"field":"region","value":"278"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"276"},"to":{"field":"region","value":"de"}},{"from":{"field":"region","value":"262"},"to":{"field":"region","value":"dj"}},{"from":{"field":"region","value":"208"},"to":{"field":"region","value":"dk"}},{"from":{"field":"region","value":"212"},"to":{"field":"region","value":"dm"}},{"from":{"field":"region","value":"214"},"to":{"field":"region","value":"do"}},{"from":{"field":"region","value":"012"},"to":{"field":"region","value":"dz"}},{"from":{"field":"region","value":"218"},"to":{"field":"region","value":"ec"}},{"from":{"field":"region","value":"233"},"to":{"field":"region","value":"ee"}},{"from":{"field":"region","value":"818"},"to":{"field":"region","value":"eg"}},{"from":{"field":"region","value":"732"},"to":{"field":"region","value":"eh"}},{"from":{"field":"region","value":"232"},"to":{"field":"region","value":"er"}},{"from":{"field":"region","value":"724"},"to":{"field":"region","value":"es"}},{"from":{"field":"region","value":"231"},"to":{"field":"region","value":"et"}},{"from":{"field":"region","value":"246"},"to":{"field":"region","value":"fi"}},{"from":{"field":"region","value":"242"},"to":{"field":"region","value":"fj"}},{"from":{"field":"region","value":"238"},"to":{"field":"region","value":"fk"}},{"from":{"field":"region","value":"583"},"to":{"field":"region","value":"fm"}},{"from":{"field":"region","value":"234"},"to":{"field":"region","value":"fo"}},{"from":{"field":"region","value":"250"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"249"},"to":{"field":"region","value":"fr"}},{"from":{"field":"region","value":"266"},"to":{"field":"region","value":"ga"}},{"from":{"field":"region","value":"826"},"to":{"field":"region","value":"gb"}},{"from":{"field":"region","value":"308"},"to":{"field":"region","value":"gd"}},{"from":{"field":"region","value":"268"},"to":{"field":"region","value":"ge"}},{"from":{"field":"region","value":"254"},"to":{"field":"region","value":"gf"}},{"from":{"field":"region","value":"831"},"to":{"field":"region","value":"gg"}},{"from":{"field":"region","value":"288"},"to":{"field":"region","value":"gh"}},{"from":{"field":"region","value":"292"},"to":{"field":"region","value":"gi"}},{"from":{"field":"region","value":"304"},"to":{"field":"region","value":"gl"}},{"from":{"field":"region","value":"270"},"to":{"field":"region","value":"gm"}},{"from":{"field":"region","value":"324"},"to":{"field":"region","value":"gn"}},{"from":{"field":"region","value":"312"},"to":{"field":"region","value":"gp"}},{"from":{"field":"region","value":"226"},"to":{"field":"region","value":"gq"}},{"from":{"field":"region","value":"300"},"to":{"field":"region","value":"gr"}},{"from":{"field":"region","value":"239"},"to":{"field":"region","value":"gs"}},{"from":{"field":"region","value":"320"},"to":{"field":"region","value":"gt"}},{"from":{"field":"region","value":"316"},"to":{"field":"region","value":"gu"}},{"from":{"field":"region","value":"624"},"to":{"field":"region","value":"gw"}},{"from":{"field":"region","value":"328"},"to":{"field":"region","value":"gy"}},{"from":{"field":"region","value":"344"},"to":{"field":"region","value":"hk"}},{"from":{"field":"region","value":"334"},"to":{"field":"region","value":"hm"}},{"from":{"field":"region","value":"340"},"to":{"field":"region","value":"hn"}},{"from":{"field":"region","value":"191"},"to":{"field":"region","value":"hr"}},{"from":{"field":"region","value":"332"},"to":{"field":"region","value":"ht"}},{"from":{"field":"region","value":"348"},"to":{"field":"region","value":"hu"}},{"from":{"field":"region","value":"360"},"to":{"field":"region","value":"id"}},{"from":{"field":"region","value":"372"},"to":{"field":"region","value":"ie"}},{"from":{"field":"region","value":"376"},"to":{"field":"region","value":"il"}},{"from":{"field":"region","value":"833"},"to":{"field":"region","value":"im"}},{"from":{"field":"region","value":"356"},"to":{"field":"region","value":"in"}},{"from":{"field":"region","value":"086"},"to":{"field":"region","value":"io"}},{"from":{"field":"region","value":"368"},"to":{"field":"region","value":"iq"}},{"from":{"field":"region","value":"364"},"to":{"field":"region","value":"ir"}},{"from":{"field":"region","value":"352"},"to":{"field":"region","value":"is"}},{"from":{"field":"region","value":"380"},"to":{"field":"region","value":"it"}},{"from":{"field":"region","value":"832"},"to":{"field":"region","value":"je"}},{"from":{"field":"region","value":"388"},"to":{"field":"region","value":"jm"}},{"from":{"field":"region","value":"400"},"to":{"field":"region","value":"jo"}},{"from":{"field":"region","value":"392"},"to":{"field":"region","value":"jp"}},{"from":{"field":"region","value":"404"},"to":{"field":"region","value":"ke"}},{"from":{"field":"region","value":"417"},"to":{"field":"region","value":"kg"}},{"from":{"field":"region","value":"116"},"to":{"field":"region","value":"kh"}},{"from":{"field":"region","value":"296"},"to":{"field":"region","value":"ki"}},{"from":{"field":"region","value":"174"},"to":{"field":"region","value":"km"}},{"from":{"field":"region","value":"659"},"to":{"field":"region","value":"kn"}},{"from":{"field":"region","value":"408"},"to":{"field":"region","value":"kp"}},{"from":{"field":"region","value":"410"},"to":{"field":"region","value":"kr"}},{"from":{"field":"region","value":"414"},"to":{"field":"region","value":"kw"}},{"from":{"field":"region","value":"136"},"to":{"field":"region","value":"ky"}},{"from":{"field":"region","value":"398"},"to":{"field":"region","value":"kz"}},{"from":{"field":"region","value":"418"},"to":{"field":"region","value":"la"}},{"from":{"field":"region","value":"422"},"to":{"field":"region","value":"lb"}},{"from":{"field":"region","value":"662"},"to":{"field":"region","value":"lc"}},{"from":{"field":"region","value":"438"},"to":{"field":"region","value":"li"}},{"from":{"field":"region","value":"144"},"to":{"field":"region","value":"lk"}},{"from":{"field":"region","value":"430"},"to":{"field":"region","value":"lr"}},{"from":{"field":"region","value":"426"},"to":{"field":"region","value":"ls"}},{"from":{"field":"region","value":"440"},"to":{"field":"region","value":"lt"}},{"from":{"field":"region","value":"442"},"to":{"field":"region","value":"lu"}},{"from":{"field":"region","value":"428"},"to":{"field":"region","value":"lv"}},{"from":{"field":"region","value":"434"},"to":{"field":"region","value":"ly"}},{"from":{"field":"region","value":"504"},"to":{"field":"region","value":"ma"}},{"from":{"field":"region","value":"492"},"to":{"field":"region","value":"mc"}},{"from":{"field":"region","value":"498"},"to":{"field":"region","value":"md"}},{"from":{"field":"region","value":"499"},"to":{"field":"region","value":"me"}},{"from":{"field":"region","value":"663"},"to":{"field":"region","value":"mf"}},{"from":{"field":"region","value":"450"},"to":{"field":"region","value":"mg"}},{"from":{"field":"region","value":"584"},"to":{"field":"region","value":"mh"}},{"from":{"field":"region","value":"807"},"to":{"field":"region","value":"mk"}},{"from":{"field":"region","value":"466"},"to":{"field":"region","value":"ml"}},{"from":{"field":"region","value":"496"},"to":{"field":"region","value":"mn"}},{"from":{"field":"region","value":"446"},"to":{"field":"region","value":"mo"}},{"from":{"field":"region","value":"580"},"to":{"field":"region","value":"mp"}},{"from":{"field":"region","value":"474"},"to":{"field":"region","value":"mq"}},{"from":{"field":"region","value":"478"},"to":{"field":"region","value":"mr"}},{"from":{"field":"region","value":"500"},"to":{"field":"region","value":"ms"}},{"from":{"field":"region","value":"470"},"to":{"field":"region","value":"mt"}},{"from":{"field":"region","value":"480"},"to":{"field":"region","value":"mu"}},{"from":{"field":"region","value":"462"},"to":{"field":"region","value":"mv"}},{"from":{"field":"region","value":"454"},"to":{"field":"region","value":"mw"}},{"from":{"field":"region","value":"484"},"to":{"field":"region","value":"mx"}},{"from":{"field":"region","value":"458"},"to":{"field":"region","value":"my"}},{"from":{"field":"region","value":"508"},"to":{"field":"region","value":"mz"}},{"from":{"field":"region","value":"516"},"to":{"field":"region","value":"na"}},{"from":{"field":"region","value":"540"},"to":{"field":"region","value":"nc"}},{"from":{"field":"region","value":"562"},"to":{"field":"region","value":"ne"}},{"from":{"field":"region","value":"574"},"to":{"field":"region","value":"nf"}},{"from":{"field":"region","value":"566"},"to":{"field":"region","value":"ng"}},{"from":{"field":"region","value":"558"},"to":{"field":"region","value":"ni"}},{"from":{"field":"region","value":"528"},"to":{"field":"region","value":"nl"}},{"from":{"field":"region","value":"578"},"to":{"field":"region","value":"no"}},{"from":{"field":"region","value":"524"},"to":{"field":"region","value":"np"}},{"from":{"field":"region","value":"520"},"to":{"field":"region","value":"nr"}},{"from":{"field":"region","value":"570"},"to":{"field":"region","value":"nu"}},{"from":{"field":"region","value":"554"},"to":{"field":"region","value":"nz"}},{"from":{"field":"region","value":"512"},"to":{"field":"region","value":"om"}},{"from":{"field":"region","value":"591"},"to":{"field":"region","value":"pa"}},{"from":{"field":"region","value":"604"},"to":{"field":"region","value":"pe"}},{"from":{"field":"region","value":"258"},"to":{"field":"region","value":"pf"}},{"from":{"field":"region","value":"598"},"to":{"field":"region","value":"pg"}},{"from":{"field":"region","value":"608"},"to":{"field":"region","value":"ph"}},{"from":{"field":"region","value":"586"},"to":{"field":"region","value":"pk"}},{"from":{"field":"region","value":"616"},"to":{"field":"region","value":"pl"}},{"from":{"field":"region","value":"666"},"to":{"field":"region","value":"pm"}},{"from":{"field":"region","value":"612"},"to":{"field":"region","value":"pn"}},{"from":{"field":"region","value":"630"},"to":{"field":"region","value":"pr"}},{"from":{"field":"region","value":"275"},"to":{"field":"region","value":"ps"}},{"from":{"field":"region","value":"620"},"to":{"field":"region","value":"pt"}},{"from":{"field":"region","value":"585"},"to":{"field":"region","value":"pw"}},{"from":{"field":"region","value":"600"},"to":{"field":"region","value":"py"}},{"from":{"field":"region","value":"634"},"to":{"field":"region","value":"qa"}},{"from":{"field":"region","value":"959"},"to":{"field":"region","value":"qm"}},{"from":{"field":"region","value":"960"},"to":{"field":"region","value":"qn"}},{"from":{"field":"region","value":"962"},"to":{"field":"region","value":"qp"}},{"from":{"field":"region","value":"963"},"to":{"field":"region","value":"qq"}},{"from":{"field":"region","value":"964"},"to":{"field":"region","value":"qr"}},{"from":{"field":"region","value":"965"},"to":{"field":"region","value":"qs"}},{"from":{"field":"region","value":"966"},"to":{"field":"region","value":"qt"}},{"from":{"field":"region","value":"967"},"to":{"field":"region","value":"eu"}},{"from":{"field":"region","value":"968"},"to":{"field":"region","value":"qv"}},{"from":{"field":"region","value":"969"},"to":{"field":"region","value":"qw"}},{"from":{"field":"region","value":"970"},"to":{"field":"region","value":"qx"}},{"from":{"field":"region","value":"971"},"to":{"field":"region","value":"qy"}},{"from":{"field":"region","value":"972"},"to":{"field":"region","value":"qz"}},{"from":{"field":"region","value":"638"},"to":{"field":"region","value":"re"}},{"from":{"field":"region","value":"642"},"to":{"field":"region","value":"ro"}},{"from":{"field":"region","value":"688"},"to":{"field":"region","value":"rs"}},{"from":{"field":"region","value":"643"},"to":{"field":"region","value":"ru"}},{"from":{"field":"region","value":"646"},"to":{"field":"region","value":"rw"}},{"from":{"field":"region","value":"682"},"to":{"field":"region","value":"sa"}},{"from":{"field":"region","value":"090"},"to":{"field":"region","value":"sb"}},{"from":{"field":"region","value":"690"},"to":{"field":"region","value":"sc"}},{"from":{"field":"region","value":"729"},"to":{"field":"region","value":"sd"}},{"from":{"field":"region","value":"752"},"to":{"field":"region","value":"se"}},{"from":{"field":"region","value":"702"},"to":{"field":"region","value":"sg"}},{"from":{"field":"region","value":"654"},"to":{"field":"region","value":"sh"}},{"from":{"field":"region","value":"705"},"to":{"field":"region","value":"si"}},{"from":{"field":"region","value":"744"},"to":{"field":"region","value":"sj"}},{"from":{"field":"region","value":"703"},"to":{"field":"region","value":"sk"}},{"from":{"field":"region","value":"694"},"to":{"field":"region","value":"sl"}},{"from":{"field":"region","value":"674"},"to":{"field":"region","value":"sm"}},{"from":{"field":"region","value":"686"},"to":{"field":"region","value":"sn"}},{"from":{"field":"region","value":"706"},"to":{"field":"region","value":"so"}},{"from":{"field":"region","value":"740"},"to":{"field":"region","value":"sr"}},{"from":{"field":"region","value":"728"},"to":{"field":"region","value":"ss"}},{"from":{"field":"region","value":"678"},"to":{"field":"region","value":"st"}},{"from":{"field":"region","value":"222"},"to":{"field":"region","value":"sv"}},{"from":{"field":"region","value":"534"},"to":{"field":"region","value":"sx"}},{"from":{"field":"region","value":"760"},"to":{"field":"region","value":"sy"}},{"from":{"field":"region","value":"748"},"to":{"field":"region","value":"sz"}},{"from":{"field":"region","value":"796"},"to":{"field":"region","value":"tc"}},{"from":{"field":"region","value":"148"},"to":{"field":"region","value":"td"}},{"from":{"field":"region","value":"260"},"to":{"field":"region","value":"tf"}},{"from":{"field":"region","value":"768"},"to":{"field":"region","value":"tg"}},{"from":{"field":"region","value":"764"},"to":{"field":"region","value":"th"}},{"from":{"field":"region","value":"762"},"to":{"field":"region","value":"tj"}},{"from":{"field":"region","value":"772"},"to":{"field":"region","value":"tk"}},{"from":{"field":"region","value":"626"},"to":{"field":"region","value":"tl"}},{"from":{"field":"region","value":"795"},"to":{"field":"region","value":"tm"}},{"from":{"field":"region","value":"788"},"to":{"field":"region","value":"tn"}},{"from":{"field":"region","value":"776"},"to":{"field":"region","value":"to"}},{"from":{"field":"region","value":"792"},"to":{"field":"region","value":"tr"}},{"from":{"field":"region","value":"780"},"to":{"field":"region","value":"tt"}},{"from":{"field":"region","value":"798"},"to":{"field":"region","value":"tv"}},{"from":{"field":"region","value":"158"},"to":{"field":"region","value":"tw"}},{"from":{"field":"region","value":"834"},"to":{"field":"region","value":"tz"}},{"from":{"field":"region","value":"804"},"to":{"field":"region","value":"ua"}},{"from":{"field":"region","value":"800"},"to":{"field":"region","value":"ug"}},{"from":{"field":"region","value":"581"},"to":{"field":"region","value":"um"}},{"from":{"field":"region","value":"840"},"to":{"field":"region","value":"us"}},{"from":{"field":"region","value":"858"},"to":{"field":"region","value":"uy"}},{"from":{"field":"region","value":"860"},"to":{"field":"region","value":"uz"}},{"from":{"field":"region","value":"336"},"to":{"field":"region","value":"va"}},{"from":{"field":"region","value":"670"},"to":{"field":"region","value":"vc"}},{"from":{"field":"region","value":"862"},"to":{"field":"region","value":"ve"}},{"from":{"field":"region","value":"092"},"to":{"field":"region","value":"vg"}},{"from":{"field":"region","value":"850"},"to":{"field":"region","value":"vi"}},{"from":{"field":"region","value":"704"},"to":{"field":"region","value":"vn"}},{"from":{"field":"region","value":"548"},"to":{"field":"region","value":"vu"}},{"from":{"field":"region","value":"876"},"to":{"field":"region","value":"wf"}},{"from":{"field":"region","value":"882"},"to":{"field":"region","value":"ws"}},{"from":{"field":"region","value":"973"},"to":{"field":"region","value":"xa"}},{"from":{"field":"region","value":"974"},"to":{"field":"region","value":"xb"}},{"from":{"field":"region","value":"975"},"to":{"field":"region","value":"xc"}},{"from":{"field":"region","value":"976"},"to":{"field":"region","value":"xd"}},{"from":{"field":"region","value":"977"},"to":{"field":"region","value":"xe"}},{"from":{"field":"region","value":"978"},"to":{"field":"region","value":"xf"}},{"from":{"field":"region","value":"979"},"to":{"field":"region","value":"xg"}},{"from":{"field":"region","value":"980"},"to":{"field":"region","value":"xh"}},{"from":{"field":"region","value":"981"},"to":{"field":"region","value":"xi"}},{"from":{"field":"region","value":"982"},"to":{"field":"region","value":"xj"}},{"from":{"field":"region","value":"983"},"to":{"field":"region","value":"xk"}},{"from":{"field":"region","value":"984"},"to":{"field":"region","value":"xl"}},{"from":{"field":"region","value":"985"},"to":{"field":"region","value":"xm"}},{"from":{"field":"region","value":"986"},"to":{"field":"region","value":"xn"}},{"from":{"field":"region","value":"987"},"to":{"field":"region","value":"xo"}},{"from":{"field":"region","value":"988"},"to":{"field":"region","value":"xp"}},{"from":{"field":"region","value":"989"},"to":{"field":"region","value":"xq"}},{"from":{"field":"region","value":"990"},"to":{"field":"region","value":"xr"}},{"from":{"field":"region","value":"991"},"to":{"field":"region","value":"xs"}},{"from":{"field":"region","value":"992"},"to":{"field":"region","value":"xt"}},{"from":{"field":"region","value":"993"},"to":{"field":"region","value":"xu"}},{"from":{"field":"region","value":"994"},"to":{"field":"region","value":"xv"}},{"from":{"field":"region","value":"995"},"to":{"field":"region","value":"xw"}},{"from":{"field":"region","value":"996"},"to":{"field":"region","value":"xx"}},{"from":{"field":"region","value":"997"},"to":{"field":"region","value":"xy"}},{"from":{"field":"region","value":"998"},"to":{"field":"region","value":"xz"}},{"from":{"field":"region","value":"720"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"887"},"to":{"field":"region","value":"ye"}},{"from":{"field":"region","value":"175"},"to":{"field":"region","value":"yt"}},{"from":{"field":"region","value":"710"},"to":{"field":"region","value":"za"}},{"from":{"field":"region","value":"894"},"to":{"field":"region","value":"zm"}},{"from":{"field":"region","value":"716"},"to":{"field":"region","value":"zw"}},{"from":{"field":"region","value":"999"},"to":{"field":"region","value":"zz"}},{"from":{"field":"variants","value":"aaland"},"to":{"field":"region","value":"ax"}},{"from":{"field":"variants","value":"polytoni"},"to":{"field":"variants","value":"polyton"}},{"from":{"field":"variants","value":"heploc"},"to":{"field":"variants","value":"alalc97"}},{"from":{"field":"variants","value":"arevela"},"to":{"field":"language","value":"hy"}},{"from":{"field":"variants","value":"arevmda"},"to":{"field":"language","value":"hyw"}}]')},"./node_modules/bcp-47-normalize/lib/many.json":ce=>{ce.exports=JSON.parse('{"region":{"172":["ru","am","az","by","ge","kg","kz","md","tj","tm","ua","uz"],"200":["cz","sk"],"530":["cw","sx","bq"],"532":["cw","sx","bq"],"536":["sa","iq"],"582":["fm","mh","mp","pw"],"810":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"830":["je","gg"],"890":["rs","me","si","hr","mk","ba"],"891":["rs","me"],"an":["cw","sx","bq"],"cs":["rs","me"],"fq":["aq","tf"],"nt":["sa","iq"],"pc":["fm","mh","mp","pw"],"su":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"yu":["rs","me"],"062":["034","143"],"ant":["cw","sx","bq"],"scg":["rs","me"],"ntz":["sa","iq"],"sun":["ru","am","az","by","ee","ge","kz","kg","lv","lt","md","tj","tm","ua","uz"],"yug":["rs","me"]}}')},"./node_modules/bcp-47-normalize/lib/matches.json":ce=>{ce.exports=JSON.parse('[{"from":"in","to":"id"},{"from":"iw","to":"he"},{"from":"ji","to":"yi"},{"from":"jw","to":"jv"},{"from":"mo","to":"ro"},{"from":"scc","to":"sr"},{"from":"scr","to":"hr"},{"from":"aam","to":"aas"},{"from":"adp","to":"dz"},{"from":"aue","to":"ktz"},{"from":"ayx","to":"nun"},{"from":"bgm","to":"bcg"},{"from":"bjd","to":"drl"},{"from":"ccq","to":"rki"},{"from":"cjr","to":"mom"},{"from":"cka","to":"cmr"},{"from":"cmk","to":"xch"},{"from":"coy","to":"pij"},{"from":"cqu","to":"quh"},{"from":"drh","to":"mn"},{"from":"drw","to":"fa-af"},{"from":"gav","to":"dev"},{"from":"gfx","to":"vaj"},{"from":"ggn","to":"gvr"},{"from":"gti","to":"nyc"},{"from":"guv","to":"duz"},{"from":"hrr","to":"jal"},{"from":"ibi","to":"opa"},{"from":"ilw","to":"gal"},{"from":"jeg","to":"oyb"},{"from":"kgc","to":"tdf"},{"from":"kgh","to":"kml"},{"from":"koj","to":"kwv"},{"from":"krm","to":"bmf"},{"from":"ktr","to":"dtp"},{"from":"kvs","to":"gdj"},{"from":"kwq","to":"yam"},{"from":"kxe","to":"tvd"},{"from":"kzj","to":"dtp"},{"from":"kzt","to":"dtp"},{"from":"lii","to":"raq"},{"from":"lmm","to":"rmx"},{"from":"meg","to":"cir"},{"from":"mst","to":"mry"},{"from":"mwj","to":"vaj"},{"from":"myt","to":"mry"},{"from":"nad","to":"xny"},{"from":"ncp","to":"kdz"},{"from":"nnx","to":"ngv"},{"from":"nts","to":"pij"},{"from":"oun","to":"vaj"},{"from":"pcr","to":"adx"},{"from":"pmc","to":"huw"},{"from":"pmu","to":"phr"},{"from":"ppa","to":"bfy"},{"from":"ppr","to":"lcq"},{"from":"pry","to":"prt"},{"from":"puz","to":"pub"},{"from":"sca","to":"hle"},{"from":"skk","to":"oyb"},{"from":"tdu","to":"dtp"},{"from":"thc","to":"tpo"},{"from":"thx","to":"oyb"},{"from":"tie","to":"ras"},{"from":"tkk","to":"twm"},{"from":"tlw","to":"weo"},{"from":"tmp","to":"tyj"},{"from":"tne","to":"kak"},{"from":"tnf","to":"fa-af"},{"from":"tsf","to":"taj"},{"from":"uok","to":"ema"},{"from":"xba","to":"cax"},{"from":"xia","to":"acn"},{"from":"xkh","to":"waw"},{"from":"xsj","to":"suj"},{"from":"ybd","to":"rki"},{"from":"yma","to":"lrr"},{"from":"ymt","to":"mtm"},{"from":"yos","to":"zom"},{"from":"yuu","to":"yug"},{"from":"asd","to":"snz"},{"from":"dit","to":"dif"},{"from":"llo","to":"ngt"},{"from":"myd","to":"aog"},{"from":"nns","to":"nbr"},{"from":"sgn-br","to":"bzs"},{"from":"sgn-co","to":"csn"},{"from":"sgn-de","to":"gsg"},{"from":"sgn-dk","to":"dsl"},{"from":"sgn-fr","to":"fsl"},{"from":"sgn-gb","to":"bfi"},{"from":"sgn-gr","to":"gss"},{"from":"sgn-ie","to":"isg"},{"from":"sgn-it","to":"ise"},{"from":"sgn-jp","to":"jsl"},{"from":"sgn-mx","to":"mfs"},{"from":"sgn-ni","to":"ncs"},{"from":"sgn-nl","to":"dse"},{"from":"sgn-no","to":"nsi"},{"from":"sgn-pt","to":"psr"},{"from":"sgn-se","to":"swl"},{"from":"sgn-us","to":"ase"},{"from":"sgn-za","to":"sfs"},{"from":"no-bokmal","to":"nb"},{"from":"no-nynorsk","to":"nn"},{"from":"aa-saaho","to":"ssy"},{"from":"sh","to":"sr-latn"},{"from":"cnr","to":"sr-me"},{"from":"no","to":"nb"},{"from":"tl","to":"fil"},{"from":"az-az","to":"az-latn-az"},{"from":"bs-ba","to":"bs-latn-ba"},{"from":"ha-latn-gh","to":"ha-gh"},{"from":"ha-latn-ne","to":"ha-ne"},{"from":"ha-latn-ng","to":"ha-ng"},{"from":"kk-cyrl-kz","to":"kk-kz"},{"from":"ky-cyrl-kg","to":"ky-kg"},{"from":"ks-arab-in","to":"ks-in"},{"from":"mn-cyrl-mn","to":"mn-mn"},{"from":"ms-latn-bn","to":"ms-bn"},{"from":"ms-latn-my","to":"ms-my"},{"from":"ms-latn-sg","to":"ms-sg"},{"from":"pa-in","to":"pa-guru-in"},{"from":"pa-pk","to":"pa-arab-pk"},{"from":"shi-ma","to":"shi-tfng-ma"},{"from":"sr-ba","to":"sr-cyrl-ba"},{"from":"sr-me","to":"sr-latn-me"},{"from":"sr-rs","to":"sr-cyrl-rs"},{"from":"sr-xk","to":"sr-cyrl-xk"},{"from":"tzm-latn-ma","to":"tzm-ma"},{"from":"ug-arab-cn","to":"ug-cn"},{"from":"uz-af","to":"uz-arab-af"},{"from":"uz-uz","to":"uz-latn-uz"},{"from":"vai-lr","to":"vai-vaii-lr"},{"from":"yue-cn","to":"yue-hans-cn"},{"from":"yue-hk","to":"yue-hant-hk"},{"from":"zh-cn","to":"zh-hans-cn"},{"from":"zh-hk","to":"zh-hant-hk"},{"from":"zh-mo","to":"zh-hant-mo"},{"from":"zh-sg","to":"zh-hans-sg"},{"from":"zh-tw","to":"zh-hant-tw"},{"from":"aju","to":"jrb"},{"from":"als","to":"sq"},{"from":"arb","to":"ar"},{"from":"ayr","to":"ay"},{"from":"azj","to":"az"},{"from":"bcc","to":"bal"},{"from":"bcl","to":"bik"},{"from":"bxk","to":"luy"},{"from":"bxr","to":"bua"},{"from":"cld","to":"syr"},{"from":"cmn","to":"zh"},{"from":"cwd","to":"cr"},{"from":"dgo","to":"doi"},{"from":"dhd","to":"mwr"},{"from":"dik","to":"din"},{"from":"diq","to":"zza"},{"from":"lbk","to":"bnc"},{"from":"ekk","to":"et"},{"from":"emk","to":"man"},{"from":"esk","to":"ik"},{"from":"fat","to":"ak"},{"from":"fuc","to":"ff"},{"from":"gaz","to":"om"},{"from":"gbo","to":"grb"},{"from":"gno","to":"gon"},{"from":"gug","to":"gn"},{"from":"gya","to":"gba"},{"from":"hdn","to":"hai"},{"from":"hea","to":"hmn"},{"from":"ike","to":"iu"},{"from":"kmr","to":"ku"},{"from":"knc","to":"kr"},{"from":"kng","to":"kg"},{"from":"knn","to":"kok"},{"from":"kpv","to":"kv"},{"from":"lvs","to":"lv"},{"from":"mhr","to":"chm"},{"from":"mup","to":"raj"},{"from":"khk","to":"mn"},{"from":"npi","to":"ne"},{"from":"ojg","to":"oj"},{"from":"ory","to":"or"},{"from":"pbu","to":"ps"},{"from":"pes","to":"fa"},{"from":"plt","to":"mg"},{"from":"pnb","to":"lah"},{"from":"quz","to":"qu"},{"from":"rmy","to":"rom"},{"from":"spy","to":"kln"},{"from":"src","to":"sc"},{"from":"swh","to":"sw"},{"from":"ttq","to":"tmh"},{"from":"tw","to":"ak"},{"from":"umu","to":"del"},{"from":"uzn","to":"uz"},{"from":"xpe","to":"kpe"},{"from":"xsl","to":"den"},{"from":"ydd","to":"yi"},{"from":"zai","to":"zap"},{"from":"zsm","to":"ms"},{"from":"zyb","to":"za"},{"from":"him","to":"srx"},{"from":"mnk","to":"man"},{"from":"bh","to":"bho"},{"from":"prs","to":"fa-af"},{"from":"swc","to":"sw-cd"},{"from":"aar","to":"aa"},{"from":"abk","to":"ab"},{"from":"ave","to":"ae"},{"from":"afr","to":"af"},{"from":"aka","to":"ak"},{"from":"amh","to":"am"},{"from":"arg","to":"an"},{"from":"ara","to":"ar"},{"from":"asm","to":"as"},{"from":"ava","to":"av"},{"from":"aym","to":"ay"},{"from":"aze","to":"az"},{"from":"bak","to":"ba"},{"from":"bel","to":"be"},{"from":"bul","to":"bg"},{"from":"bih","to":"bho"},{"from":"bis","to":"bi"},{"from":"bam","to":"bm"},{"from":"ben","to":"bn"},{"from":"bod","to":"bo"},{"from":"bre","to":"br"},{"from":"bos","to":"bs"},{"from":"cat","to":"ca"},{"from":"che","to":"ce"},{"from":"cha","to":"ch"},{"from":"cos","to":"co"},{"from":"cre","to":"cr"},{"from":"ces","to":"cs"},{"from":"chu","to":"cu"},{"from":"chv","to":"cv"},{"from":"cym","to":"cy"},{"from":"dan","to":"da"},{"from":"deu","to":"de"},{"from":"div","to":"dv"},{"from":"dzo","to":"dz"},{"from":"ewe","to":"ee"},{"from":"ell","to":"el"},{"from":"eng","to":"en"},{"from":"epo","to":"eo"},{"from":"spa","to":"es"},{"from":"est","to":"et"},{"from":"eus","to":"eu"},{"from":"fas","to":"fa"},{"from":"ful","to":"ff"},{"from":"fin","to":"fi"},{"from":"fij","to":"fj"},{"from":"fao","to":"fo"},{"from":"fra","to":"fr"},{"from":"fry","to":"fy"},{"from":"gle","to":"ga"},{"from":"gla","to":"gd"},{"from":"glg","to":"gl"},{"from":"grn","to":"gn"},{"from":"guj","to":"gu"},{"from":"glv","to":"gv"},{"from":"hau","to":"ha"},{"from":"heb","to":"he"},{"from":"hin","to":"hi"},{"from":"hmo","to":"ho"},{"from":"hrv","to":"hr"},{"from":"hat","to":"ht"},{"from":"hun","to":"hu"},{"from":"hye","to":"hy"},{"from":"her","to":"hz"},{"from":"ina","to":"ia"},{"from":"ind","to":"id"},{"from":"ile","to":"ie"},{"from":"ibo","to":"ig"},{"from":"iii","to":"ii"},{"from":"ipk","to":"ik"},{"from":"ido","to":"io"},{"from":"isl","to":"is"},{"from":"ita","to":"it"},{"from":"iku","to":"iu"},{"from":"jpn","to":"ja"},{"from":"jav","to":"jv"},{"from":"kat","to":"ka"},{"from":"kon","to":"kg"},{"from":"kik","to":"ki"},{"from":"kua","to":"kj"},{"from":"kaz","to":"kk"},{"from":"kal","to":"kl"},{"from":"khm","to":"km"},{"from":"kan","to":"kn"},{"from":"kor","to":"ko"},{"from":"kau","to":"kr"},{"from":"kas","to":"ks"},{"from":"kur","to":"ku"},{"from":"kom","to":"kv"},{"from":"cor","to":"kw"},{"from":"kir","to":"ky"},{"from":"lat","to":"la"},{"from":"ltz","to":"lb"},{"from":"lug","to":"lg"},{"from":"lim","to":"li"},{"from":"lin","to":"ln"},{"from":"lao","to":"lo"},{"from":"lit","to":"lt"},{"from":"lub","to":"lu"},{"from":"lav","to":"lv"},{"from":"mlg","to":"mg"},{"from":"mah","to":"mh"},{"from":"mri","to":"mi"},{"from":"mkd","to":"mk"},{"from":"mal","to":"ml"},{"from":"mon","to":"mn"},{"from":"mol","to":"ro"},{"from":"mar","to":"mr"},{"from":"msa","to":"ms"},{"from":"mlt","to":"mt"},{"from":"mya","to":"my"},{"from":"nau","to":"na"},{"from":"nob","to":"nb"},{"from":"nde","to":"nd"},{"from":"nep","to":"ne"},{"from":"ndo","to":"ng"},{"from":"nld","to":"nl"},{"from":"nno","to":"nn"},{"from":"nor","to":"nb"},{"from":"nbl","to":"nr"},{"from":"nav","to":"nv"},{"from":"nya","to":"ny"},{"from":"oci","to":"oc"},{"from":"oji","to":"oj"},{"from":"orm","to":"om"},{"from":"ori","to":"or"},{"from":"oss","to":"os"},{"from":"pan","to":"pa"},{"from":"pli","to":"pi"},{"from":"pol","to":"pl"},{"from":"pus","to":"ps"},{"from":"por","to":"pt"},{"from":"que","to":"qu"},{"from":"roh","to":"rm"},{"from":"run","to":"rn"},{"from":"ron","to":"ro"},{"from":"rus","to":"ru"},{"from":"kin","to":"rw"},{"from":"san","to":"sa"},{"from":"srd","to":"sc"},{"from":"snd","to":"sd"},{"from":"sme","to":"se"},{"from":"sag","to":"sg"},{"from":"hbs","to":"sr-latn"},{"from":"sin","to":"si"},{"from":"slk","to":"sk"},{"from":"slv","to":"sl"},{"from":"smo","to":"sm"},{"from":"sna","to":"sn"},{"from":"som","to":"so"},{"from":"sqi","to":"sq"},{"from":"srp","to":"sr"},{"from":"ssw","to":"ss"},{"from":"sot","to":"st"},{"from":"sun","to":"su"},{"from":"swe","to":"sv"},{"from":"swa","to":"sw"},{"from":"tam","to":"ta"},{"from":"tel","to":"te"},{"from":"tgk","to":"tg"},{"from":"tha","to":"th"},{"from":"tir","to":"ti"},{"from":"tuk","to":"tk"},{"from":"tgl","to":"fil"},{"from":"tsn","to":"tn"},{"from":"ton","to":"to"},{"from":"tur","to":"tr"},{"from":"tso","to":"ts"},{"from":"tat","to":"tt"},{"from":"twi","to":"ak"},{"from":"tah","to":"ty"},{"from":"uig","to":"ug"},{"from":"ukr","to":"uk"},{"from":"urd","to":"ur"},{"from":"uzb","to":"uz"},{"from":"ven","to":"ve"},{"from":"vie","to":"vi"},{"from":"vol","to":"vo"},{"from":"wln","to":"wa"},{"from":"wol","to":"wo"},{"from":"xho","to":"xh"},{"from":"yid","to":"yi"},{"from":"yor","to":"yo"},{"from":"zha","to":"za"},{"from":"zho","to":"zh"},{"from":"zul","to":"zu"},{"from":"alb","to":"sq"},{"from":"arm","to":"hy"},{"from":"baq","to":"eu"},{"from":"bur","to":"my"},{"from":"chi","to":"zh"},{"from":"cze","to":"cs"},{"from":"dut","to":"nl"},{"from":"fre","to":"fr"},{"from":"geo","to":"ka"},{"from":"ger","to":"de"},{"from":"gre","to":"el"},{"from":"ice","to":"is"},{"from":"mac","to":"mk"},{"from":"mao","to":"mi"},{"from":"may","to":"ms"},{"from":"per","to":"fa"},{"from":"rum","to":"ro"},{"from":"slo","to":"sk"},{"from":"tib","to":"bo"},{"from":"wel","to":"cy"}]')},"./node_modules/bcp-47/lib/normalize.json":ce=>{ce.exports=JSON.parse('{"en-gb-oed":"en-GB-oxendict","i-ami":"ami","i-bnn":"bnn","i-default":null,"i-enochian":null,"i-hak":"hak","i-klingon":"tlh","i-lux":"lb","i-mingo":null,"i-navajo":"nv","i-pwn":"pwn","i-tao":"tao","i-tay":"tay","i-tsu":"tsu","sgn-be-fr":"sfb","sgn-be-nl":"vgt","sgn-ch-de":"sgg","art-lojban":"jbo","cel-gaulish":null,"no-bok":"nb","no-nyn":"nn","zh-guoyu":"cmn","zh-hakka":"hak","zh-min":null,"zh-min-nan":"nan","zh-xiang":"hsn"}')},"./node_modules/bcp-47/lib/regular.json":ce=>{ce.exports=JSON.parse('["art-lojban","cel-gaulish","no-bok","no-nyn","zh-guoyu","zh-hakka","zh-min","zh-min-nan","zh-xiang"]')}},tr={};function bt(ce){var N=tr[ce];if(N!==void 0)return N.exports;var e=tr[ce]={exports:{}};return er[ce].call(e.exports,e,e.exports,bt),e.exports}bt.amdO={},bt.n=ce=>{var N=ce&&ce.__esModule?()=>ce.default:()=>ce;return bt.d(N,{a:N}),N},bt.d=(ce,N)=>{for(var e in N)bt.o(N,e)&&!bt.o(ce,e)&&Object.defineProperty(ce,e,{enumerable:!0,get:N[e]})},bt.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),bt.o=(ce,N)=>Object.prototype.hasOwnProperty.call(ce,N),bt.r=ce=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(ce,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(ce,"__esModule",{value:!0})};var Xt={};return(()=>{/*!******************!*\
  !*** ./index.js ***!
  \******************/bt.r(Xt),bt.d(Xt,{Debug:()=>d.default,MediaPlayer:()=>ce.MediaPlayer,MediaPlayerFactory:()=>g.default,MetricsReporting:()=>e.default,Protection:()=>I.default,default:()=>f,supportsMediaSource:()=>N.supportsMediaSource});var ce=bt("./index_mediaplayerOnly.js"),N=bt("./src/streaming/utils/Capabilities.js"),e=bt("./src/streaming/metrics/MetricsReporting.js"),I=bt("./src/streaming/protection/Protection.js"),g=bt("./src/streaming/MediaPlayerFactory.js"),d=bt("./src/core/Debug.js");dashjs.Protection=I.default,dashjs.MetricsReporting=e.default,dashjs.MediaPlayerFactory=g.default,dashjs.Debug=d.default,dashjs.supportsMediaSource=N.supportsMediaSource;const f=dashjs})(),Xt=Xt.default,Xt})())})(hn);function Dn(){const wt=zt.useContext(dn),Wt=gn(d=>d.cuedMedia),er=zt.useRef(null),tr=En(er),bt=_n(tr),Xt=mn(tr),ce=zt.useRef(),[N,e]=zt.useState(!1),I=zt.useCallback(()=>{ce.current&&(ce.current.destroy(),ce.current=void 0,e(!1))},[]),g=zt.useCallback(()=>{if(!ir.supportsMediaSource()){wt.getState().emit("error");return}const d=ir.MediaPlayer().create();d.on(ir.MediaPlayer.events.ERROR,f=>{wt.getState().emit("error",{sourceEvent:f})}),d.on(ir.MediaPlayer.events.PLAYBACK_METADATA_LOADED,()=>{const f=d.getBitrateInfoListFor("video");f!=null&&f.length&&(wt.getState().emit("playbackQualities",{qualities:["auto",...f.map(Dr)]}),wt.getState().emit("playbackQualityChange",{quality:"auto"}))}),d.initialize(er.current,void 0,!1),ce.current=d,e(!0)},[wt]);return zt.useEffect(()=>(g(),()=>{I()}),[g,I]),zt.useEffect(()=>{ce.current&&(Wt!=null&&Wt.src)&&ce.current.attachSource(Wt.src)},[Wt==null?void 0:Wt.src,N]),zt.useEffect(()=>{N&&wt.setState({providerApi:{...Xt,setPlaybackQuality:d=>{if(!ce.current)return;const y=ce.current.getBitrateInfoListFor("video").findIndex(_=>Dr(_)===d);ce.current.updateSettings({streaming:{abr:{autoSwitchBitrate:{video:y===-1}}}}),y>=0&&ce.current.setQualityFor("video",y),wt.getState().emit("playbackQualityChange",{quality:d})}}})},[wt,Xt,N]),cn.jsx("video",{className:"w-full h-full",ref:er,playsInline:!0,poster:Wt==null?void 0:Wt.poster,...bt})}const Dr=wt=>wt===-1?"auto":`${wt.height}p`;export{Dn as default};
//# sourceMappingURL=dash-provider-d67cf343.js.map
